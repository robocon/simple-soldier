/*
 Textbox.io JavaScript Library
 Copyright (c) 2013-2016 Ephox Corp. All rights reserved.
 This software is provided "AS IS," without a warranty of any kind.

 Version: 2.0.0.185
 Client Build: 2.0.0.269
*/
(function(){var ta,oa={},k=function(b,d,c){if("string"!==typeof b)throw"module id must be a string";if(void 0===d)throw"no dependencies for "+b;if(void 0===c)throw"no definition function for "+b;oa[b]={deps:d,defn:c,instance:void 0}},fa=function(b){var d=oa[b];if(void 0===d)throw"module ["+b+"] was undefined";if(void 0===d.instance){for(var c=oa[b],a=c.deps,e=c.defn,f=a.length,g=Array(f),h=0;h<f;++h)g[h]=fa(a[h]);a=e.apply(null,g);if(void 0===a)throw"module ["+b+"] returned undefined";c.instance=
a}return d.instance};ta={define:k,require:function(b,d){for(var c=b.length,a=Array(c),e=0;e<c;++e)a.push(fa(b[e]));d.apply(null,d)},demand:fa};var xa=fa,aa=function(b,d){k(b,[],function(){return d})};k("1",[],function(){return Function("return this;")()});k("8",[],function(){return function(){return{major:"2",minor:"0",full:"2.0.0.185"}}});aa("9",Array);k("7",["9"],function(b){return{noop:function(){},compose:function(b,c){return function(){return b(c.apply(null,arguments))}},constant:function(b){return function(){return b}},
identity:function(b){return b},tripleEquals:function(b,c){return b===c},curry:function(d){for(var c=new b(arguments.length-1),a=1;a<arguments.length;a++)c[a-1]=arguments[a];return function(){for(var a=new b(arguments.length),f=0;f<a.length;f++)a[f]=arguments[f];a=c.concat(a);return d.apply(null,a)}},not:function(b){return function(){return!b.apply(null,arguments)}},die:function(b){return function(){throw b;}},apply:function(b){return b()},call:function(b){b()}}});k("2",["8","7"],function(b,d){return function(c){c=
d.die(c);return{replace:c,replaceAll:c,inline:c,inlineAll:c,get:c,getActiveEditor:c,definePlugin:c,version:b,isSupported:d.constant(!1)}}});aa("w",String);k("a",["9","w"],function(b,d){var c=function(a){return function(c){if(null===c)c="null";else{var f=typeof c;c="object"===f&&b.prototype.isPrototypeOf(c)?"array":"object"===f&&d.prototype.isPrototypeOf(c)?"string":f}return c===a}};return{isString:c("string"),isObject:c("object"),isArray:c("array"),isNull:c("null"),isBoolean:c("boolean"),isUndefined:c("undefined"),
isFunction:c("function"),isNumber:c("number")}});k("b",["9","w"],function(b,d){var c=function(a){return function(b){return a===b}},a=function(){var a=b.prototype.indexOf,e=function(b,c){return a.call(b,c)},d=function(a,b){return n(a,c(b))};return void 0===a?d:e}(),e=function(b,c){return-1<a(b,c)},f=function(a,c){for(var e=a.length,d=new b(e),f=0;f<e;f++)d[f]=c(a[f],f,a);return d},g=function(a,b){for(var c=0,e=a.length;c<e;c++)b(a[c],c,a)},h=function(a,b){for(var c=[],e=0,d=a.length;e<d;e++){var f=
a[e];b(f,e,a)&&c.push(f)}return c},l=function(a,b,c){g(a,function(a){c=b(c,a)});return c},m=function(a,b){for(var c=0,e=a.length;c<e;c++){var d=a[c];if(b(d,c,a))return d}},n=function(a,b){for(var c=b||r,e=0,d=a.length;e<d;++e)if(!0===c(a[e]))return e;return-1},p=b.prototype.push,q=function(a){for(var b=[],c=0,e=a.length;c<e;++c)p.apply(b,a[c]);return b},r=c(!0),s=function(a,b){for(var c=b||r,e=0,d=a.length;e<d;++e)if(!0!==c(a[e],e))return!1;return!0},t=b.prototype.slice,u=function(a){a=t.call(a,0);
a.reverse();return a};return{map:f,each:g,partition:function(a,b){for(var c=[],e=[],d=0,f=a.length;d<f;d++){var g=a[d];(b(g,d,a)?c:e).push(g)}return{pass:c,fail:e}},filter:h,groupBy:function(a,b){if(0===a.length)return[];for(var c=b(a[0]),e=[],d=[],f=0,g=a.length;f<g;f++){var h=a[f],l=b(h);l!==c&&(e.push(d),d=[]);c=l;d.push(h)}0!==d.length&&e.push(d);return e},indexOf:a,foldr:function(a,b,c){return l(u(a),b,c)},foldl:l,find:m,findIndex:n,findOr:function(a,b,c){a=m(a,b);return void 0!==a?a:c},findOrDie:function(a,
b,c){b=m(a,b);if(void 0===b)throw c||"Could not find element in array: "+d(a);return b},flatten:q,bind:function(a,b){var c=f(a,b);return q(c)},forall:s,exists:function(a,b){return-1<n(a,b)},contains:e,equal:function(a,b){return a.length===b.length&&s(a,function(a,c){return a===b[c]})},reverse:u,chunk:function(a,b){for(var c=[],e=0;e<a.length;e+=b){var d=a.slice(e,e+b);c.push(d)}return c},difference:function(a,b){return h(a,function(a){return!e(b,a)})},mapToObject:function(a,b){for(var c={},e=0,f=
a.length;e<f;e++){var g=a[e];c[d(g)]=b(g,e)}return c},pure:function(a){return[a]}}});k("x",["7"],function(b){return function(d,c,a){var e=d.isiOS()&&!0===/ipad/i.test(a),f=d.isiOS()&&!e,g=d.isAndroid()&&3===d.version.major,h=d.isAndroid()&&4===d.version.major,g=e||g||h&&!0===/mobile/i.test(a),l=(h=d.isiOS()||d.isAndroid())&&!g;c=c.isSafari()&&d.isiOS()&&!1===/safari/i.test(a);return{isiPad:b.constant(e),isiPhone:b.constant(f),isTablet:b.constant(g),isPhone:b.constant(l),isTouch:b.constant(h),isAndroid:d.isAndroid,
isiOS:d.isiOS,isWebView:b.constant(c)}}});k("y",[],function(){return{create:function(b,d,c){return{browser:{current:b,version:d},os:{current:c}}}}});k("1q",[],function(){var b=function(b){return function(){return b}};return{getter:b,attachGetters:function(d,c,a){for(var e=0;e<a.length;e++)d["is"+a[e].name]=b(a[e].name===c)}}});k("z",["1q"],function(b){return{create:function(d,c,a){var e=b.attachGetters,f={};f.current=c;f.version=a;e(f,f.current,d);return f}}});aa("1r",Math);aa("1s",isFinite);aa("1t",
isNaN);aa("1u",parseFloat);k("1j",["1r","1s","1t","1u"],function(b,d,c,a){var e=function(a){return function(b,c){var e=typeof c;if(e!==a)throw b+" was not a "+a+". Was: "+c+" ("+e+")";}},f=e("string"),g=e("number"),h=function(a,c){g(a,c);if(c!==b.abs(c))throw a+" was not an integer. Was: "+c;};return{vString:f,vChar:function(a,b){f(a,b);if(1!==b.length)throw a+" was not a single char. Was: "+b;},vInt:h,vNat:function(a,b){h(a,b);if(0>b)throw a+" was not a natural number. Was: "+b;},pNum:function(b){return!c(a(b))&&
d(b)}}});k("v",["1j"],function(b){var d=function(a,b,c){return""===b?!0:a.length<b.length?!1:a.substr(c,c+b.length)===b},c=function(a){var b=function(a,b){for(var c=[],e=0;e<a.length;e++)c.push(b(a[e]));return c};return function(){var c=b(arguments,function(a){return"string"===typeof a?a.toLowerCase():a});return a.apply(this,c)}},a=function(a,b){return d(a,b,0)},e=c(a),f=function(a,b){return d(a,b,a.length-b.length)},g=c(f),h=function(a,b){return a.substr(0,b)},l=function(a,b){return a.substr(a.length-
b,a.length)},m=function(a,b){return function(c,e){return a(c,e)?b(c,c.length-e.length):c}},n=m(a,l),m=m(f,h),p=function(a,b){return function(c,e){return a(c,e)?c:b(c,e)}},q=p(a,function(a,b){return b+a}),p=p(f,function(a,b){return a+b}),r=function(a,b){return-1!=a.indexOf(b)},s=c(r),t=function(a,b){return a===b},c=c(t),u=function(a){if(""===a)throw"head on empty string";return a.substr(0,1)},v=function(a){if(""===a)throw"tail on empty string";return a.substr(1,a.length-1)},w=function(a,c){b.vString("str",
a);b.vNat("num",c);for(var e="",d=0;d<c;d++)e+=a;return e},x=function(a){return function(c,e,d){b.vString("str",c);b.vChar("c",e);b.vNat("width",d);var f=c.length;return f>=d?c:a(c,w(e,d-f))}},y=x(function(a,b){return b+a}),x=x(function(a,b){return a+b});return{supplant:function(a,b){return a.replace(/\${([^{}]*)}/g,function(a,c){var e=b[c],d=typeof e;return"string"===d||"number"===d?e:a})},startsWith:a,startsWithIgnoringCase:e,endsWith:f,endsWithIgnoringCase:g,first:h,last:l,removeLeading:n,removeTrailing:m,
ensureLeading:q,ensureTrailing:p,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},lTrim:function(a){return a.replace(/^\s+/g,"")},rTrim:function(a){return a.replace(/\s+$/g,"")},contains:r,containsIgnoringCase:s,htmlEncodeDoubleQuotes:function(a){return a.replace(/\"/gm,"&quot;")},equals:t,equalsIgnoringCase:c,head:u,repead:w,padLeft:y,padRight:x,toe:function(a){if(""===a)throw"toe on empty string";return a.substr(a.length-1,a.length)},tail:v,torso:function(a){if(""===a)throw"torso on empty string";
return a.substr(0,a.length-1)},capitalize:function(a){return""===a?a:u(a).toUpperCase()+v(a)}}});k("10",["v"],function(b){var d=b.contains,c=function(a){return function(b){return d(b,a)}},a=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;return{create:function(b){var f=[{name:"Spartan",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return d(a,"edge/")&&d(a,"chrome")&&d(a,"safari")&&d(a,"applewebkit")}},{name:"ChromeFrame",versionRegexes:[/.*?chromeframe\/([0-9]+)\.([0-9]+).*/,a],search:function(a){return d(a,
"chromeframe")?b():!1}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,a],search:function(a){return d(a,"chrome")&&!d(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){var c=d(a,"msie")||d(a,"trident");return d(a,"chromeframe")?c&&!b():c}},{name:"Opera",versionRegexes:[a,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:c("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:c("firefox")},
{name:"Safari",versionRegexes:[a,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(d(a,"safari")||d(a,"mobile/"))&&d(a,"applewebkit")}},{name:"Envjs",versionRegexes:[/.*?envjs\/\ ?([0-9]+)\.([0-9]+).*/],search:c("envjs")}],g=[{name:"Windows",search:c("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return d(a,"iphone")||d(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},
{name:"Android",search:c("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:c("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:c("linux")},{name:"Solaris",search:c("sunos")},{name:"FreeBSD",search:c("freebsd")}];return{browsers:f,oses:g}},chromeFrameChecker:function(){try{return!!new ActiveXObject("ChromeTab.ChromeFrame")}catch(a){return!1}}}});k("11",[],function(){return{meetsSpec:function(b,d){var c=typeof b;if("boolean"===c)return!!b;
if("object"===c)return c=b.minimum,d.major>c.major||d.major===c.major&&d.minor>=c.minor;throw"invalid spec";}}});k("1v",[],function(){return{findOneInArrayOr:function(b,d,c){for(var a=0;a<b.length;a++){var e=b[a];if(c(e,a,b))return e}return d}}});k("12",["1v"],function(b){return{detect:function(d,c){var a=b.findOneInArrayOr,e=String(c).toLowerCase();return a(d,{name:void 0},function(a){return a.search(e)})}}});k("13",[],function(){return{detectVersion:function(b,d){var c=String(d).toLowerCase(),a=
b.versionRegexes;if(a){a:{for(var e=0;e<a.length;e++){var f=a[e];if(f.test(c)){a=f;break a}}a=void 0}c=a?{major:Number(c.replace(a,"$1")),minor:Number(c.replace(a,"$2"))}:{major:0,minor:0}}else c={major:0,minor:0};return c}}});k("c","x y z 10 11 12 13".split(" "),function(b,d,c,a,e,f,g){var h=g.detectVersion,l=c.create,m=e.meetsSpec,n=f.detect,p=function(a,b,c,e){return a[b]?a[b][c]?m(a[b][c],e):!!a[b].All:!1},q=function(c,e){var d=a.create(e),f=d.browsers,d=d.oses,g=n(d,c),m=g.name,g=h(g,c),q=n(f,
c),y=q.name,k=h(q,c),d=l(d,m,g),f=l(f,y,k),g=b(d,f,c);return{browser:f,os:d,deviceType:g,isSupported:function(a){return p(a,m,y,k)}}};return{Platform:d,detect:function(){return q(navigator.userAgent,a.chromeFrameChecker)},doDetect:q,isSupported:p,isSupportedPlatform:function(a,b){var c=b.browser;return p(a,b.os.current,c.current,c.version)}}});k("48",["b"],function(b){var d=function(b){return b.replace(/\./g,"-")};return{create:function(c){var a=d(c);return{resolve:function(c){c=c.split(" ");return b.map(c,
function(b){return a+"-"+b}).join(" ")}}},cssNamespace:d,cssClass:function(b,a){return b+"-"+a}}});k("30",["48"],function(b){return{resolve:b.create("ephox-polish").resolve}});k("1w",["30"],function(b){return b});aa("19",Object);k("s",["7","19"],function(b,d){var c=b.constant(!1),a=b.constant(!0),e=function(){return f},f=function(){var f=function(a){return a.isNone()},g=function(a){return a()},m=function(a){return a},f={fold:function(a,b){return a()},is:c,isSome:c,isNone:a,getOr:m,getOrThunk:g,getOrDie:function(a){throw a||
"error: getOrDie called on none.";},or:m,orThunk:g,map:e,ap:e,each:e,bind:e,flatten:e,exists:c,forall:a,filter:e,equals:f,equals_:f,toArray:function(){return[]},toString:b.constant("none()")};d.freeze&&d.freeze(f);return f}(),g=function(b){var d=function(){return b},m=function(){return q},n=function(a){return g(a(b))},p=function(a){return a(b)},q={fold:function(a,c){return c(b)},is:function(a){return b===a},isSome:a,isNone:c,getOr:d,getOrThunk:d,getOrDie:d,or:m,orThunk:m,map:n,ap:function(a){return a.fold(e,
function(a){return g(a(b))})},each:n,bind:p,flatten:d,exists:p,forall:p,filter:function(a){return a(b)?q:f},equals:function(a){return a.is(b)},equals_:function(a,e){return a.fold(c,function(a){return e(b,a)})},toArray:function(){return[b]},toString:function(){return"some("+b+")"}};return q};return{some:g,none:e,from:function(a){return null===a||void 0===a?f:g(a)},equals:function(a,b){return a.equals(b)},equals_:function(a,b,c){return a.equals_(b,c)}}});k("2u",[],function(){return function(b,d,c){var a=
c||!1,e=function(){d();a=!0},f=function(){b();a=!1};return{on:e,off:f,toggle:function(){(a?f:e)()},isOn:function(){return a}}}});k("1n",["19"],function(b){var d=function(){var a=b.keys,c=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b};return void 0===a?c:a}(),c=function(a,b){for(var c=d(a),e=0,f=c.length;e<f;e++){var p=c[e];b(a[p],p,a)}},a=function(a,b){var e={};c(a,function(c,d){var f=b(c,d,a);e[f.k]=f.v});return e},e=function(a,b){var e=[];c(a,function(a,c){e.push(b(a,
c))});return e},f=function(a){return e(a,function(a){return a})};return{bifilter:function(a,b){var e={},d={};c(a,function(a,c){(b(a,c)?e:d)[c]=a});return{t:e,f:d}},each:c,map:function(b,c){return a(b,function(a,b,e){return{k:b,v:c(a,b,e)}})},mapToArray:e,tupleMap:a,find:function(a,b){for(var c=d(a),e=0,f=c.length;e<f;e++){var p=c[e],q=a[p];if(b(q,p,a))return q}},keys:d,values:f,size:function(a){return f(a).length}}});k("1p",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,
DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}});k("20",["1p"],function(b){var d=function(a){return a.dom().nodeName.toLowerCase()},c=function(a){return a.dom().nodeType},a=function(a){return function(b){return c(b)===a}},e=a(b.ELEMENT),f=a(b.TEXT),a=a(b.DOCUMENT);return{name:d,type:c,value:function(a){return a.dom().nodeValue},isElement:e,isText:f,isDocument:a,isComment:function(a){return c(a)===b.COMMENT||"#comment"===d(a)}}});aa("n",Error);
k("o",[],function(){"undefined"===typeof console&&(console={log:function(){}});return console});k("1a","a b 1n 20 n o".split(" "),function(b,d,c,a,e,f){var g=function(a,c,d){if(b.isString(d)||b.isBoolean(d)||b.isNumber(d))a.setAttribute(c,d+"");else throw f.error("Invalid call to Attr.set. Key ",c,":: Value ",d,":: Element ",a),new e("Attribute value was not simple");},h=function(a,b,c){g(a.dom(),b,c)},l=function(a,b){var c=a.dom().getAttribute(b);return null===c?void 0:c},m=function(a,b){var c=a.dom();
return c&&c.hasAttribute?c.hasAttribute(b):!1};return{clone:function(a){return d.foldl(a.dom().attributes,function(a,b){a[b.name]=b.value;return a},{})},set:h,setAll:function(a,b){var e=a.dom();c.each(b,function(a,b){g(e,b,a)})},get:l,has:m,remove:function(a,b){a.dom().removeAttribute(b)},hasNone:function(a){a=a.dom().attributes;return void 0===a||null===a||0===a.length},transfer:function(b,c,e){a.isElement(b)&&a.isElement(c)&&d.each(e,function(a){m(b,a)&&!m(c,a)&&h(c,a,l(b,a))})}}});k("1x",["2u",
"1a"],function(b,d){var c=function(a,b){var c=a.dom().classList;return void 0!==c&&c.contains(b)};return{add:function(a,b){a.dom().classList.add(b)},remove:function(a,b){var c=a.dom().classList;c.remove(b);0===c.length&&d.remove(a,"class")},toggle:function(a,b){return a.dom().classList.toggle(b)},toggler:function(a,e){var d=a.dom().classList;return b(function(){d.remove(e)},function(){d.add(e)},c(a,e))},has:c}});aa("q",document);k("l",["7","n","o","q"],function(b,d,c,a){var e=function(a){if(null===
a||void 0===a)throw new d("Node cannot be null or undefined");return{dom:b.constant(a)}};return{fromHtml:function(b,d){var h=(d||a).createElement("div");h.innerHTML=b;if(!h.hasChildNodes()||1<h.childNodes.length)throw c.error("HTML does not have a single root node",b),"HTML must have a single root node";return e(h.childNodes[0])},fromTag:function(b,c){var d=(c||a).createElement(b);return e(d)},fromText:function(b,c){var d=(c||a).createTextNode(b);return e(d)},fromDom:e}});k("14",["1w","7","s","1x",
"l"],function(b,d,c,a,e){return function(){var f=c.none(),g=b.resolve("layer-editor-active"),h=function(b){a.remove(e.fromDom(b.element()),g)},l=function(b){f.filter(function(a){return a!==b.api}).each(h);a.add(e.fromDom(b.api.element()),g);f=c.some(b.api)};return{add:function(a){var b=d.curry(l,a);f=f.orThunk(function(){a.api.events.loaded.addListener(b);return c.some(a.api)});a.api.events.focus.addListener(b)},get:function(){return f},remove:function(a){f.is(a.api)&&(f=c.none())}}}});k("2f",["1"],
function(b){var d=function(c,a){for(var e=a||b,d=0;d<c.length&&void 0!==e&&null!==e;++d)e=e[c[d]];return e};return{path:d,resolve:function(b,a){var e=b.split(".");return d(e,a)}}});k("2g",["2f"],function(b){return{getOrDie:function(d,c){var a=b.resolve(d,c);if(void 0===a)throw d+" not available on this browser";return a}}});k("1o",["2f","2g"],function(b,d){return{isPrototypeOf:function(c){var a=b.resolve("ownerDocument.defaultView",c);return d.getOrDie("HTMLElement",a).prototype.isPrototypeOf(c)}}});
k("i",["a","b","1o","7","n"],function(b,d,c,a,e){var f=function(b,c,d,f,g,h){return{name:a.constant(b),output:a.constant(h||b),required:a.constant(f),validate:function(a){if(!d(a))throw a=g(b,c),new e(a);}}},g=function(a,b){return'value of "'+a+'" is not a '+b},h=function(a,b){return'value of "'+a+'" is not an '+b},l=function(a,b,c){return function(e,d){return f(e,a,b,!0,c,d)}},m=function(a){return c.isPrototypeOf(a)},n=function(a){return b.isString(a)||b.isArray(a)||b.isObject(a)},p=l("array",b.isArray,
h),q=l("boolean",b.isBoolean,g),r=l("function",b.isFunction,g),s=l("number",b.isNumber,g),t=l("object",b.isObject,h),u=l("string",b.isString,g),g=l("DOM element",m,g),v=l("string or an array",function(a){return b.isString(a)||b.isArray(a)},h),l=l("string or a DOM element",function(a){return b.isString(a)||m(a)},h);return{arrayOfStrings:function(a){return f(a,"array of strings",function(c){p(a).validate(c);return d.forall(c,b.isString)},!0,h)},arrayOfObjects:function(a){return f(a,"array of objects",
function(c){p(a).validate(c);return d.forall(c,b.isObject)},!0,h)},arrayOfToolbarGroups:function(a){return f(a,"array of toolbar groups",function(b){p(a).validate(b);return d.forall(b,n)},!0,h)},bool:q,domElement:g,func:r,number:s,object:t,string:u,stringOrArray:v,stringOrDom:l,param:f}});k("2e",["i"],function(b){return{paramList:function(){return[b.object("aria"),b.func("fetch"),b.func("menuComplete"),b.func("menuExtra"),b.func("menuHover"),b.string("hoverSelector"),b.func("hover")]},encodeWithEditorApi:function(){return["menuComplete"]}}});
k("6",["a","9"],function(b,d){var c=function(a){return function(){for(var b=new d(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];if(0===b.length)throw"Can't merge zero objects";for(var c={},h=0;h<b.length;h++){var l=b[h],m;for(m in l)l.hasOwnProperty(m)&&(c[m]=a(c[m],l[m]))}return c}},a=c(function(c,d){return b.isObject(c)&&b.isObject(d)?a(c,d):d}),c=c(function(a,b){return b});return{deepMerge:a,merge:c}});k("1y","a b 1n 2e 6 7".split(" "),function(b,d,c,a,e,f){var g=function(a,b,c){return d.map(a,
function(a){return b(a,c)})},h=function(a,c){if(b.isString(a))return a;if(b.isArray(a))return g(a,h,c);if(b.isObject(a)&&void 0!==a.action){var d=f.compose(a.action,c);return e.merge(a,{action:d})}d=g(a.items,h,c);return e.deepMerge(a,{items:d})};return{mentions:function(b,e){var f=a.encodeWithEditorApi();return c.map(b,function(a,b){return d.contains(f,b)?function(b){return a(e(),b)}:a})},toolbar:function(a,b){return void 0===a.items?a:{items:g(a.items,h,b)}}}});k("p",["7","s"],function(b,d){var c=
function(a){return e(function(b,c){return c(a)})},a=function(a){return e(function(b,c){return b(a)})},e=function(e){var g=function(){return e(b.constant(!1),b.constant(!0))},h=b.not(g),l=function(a){return m(function(b){return c(a(b))})},m=function(b){return e(a,b)};return{is:function(a){return e(b.constant(!1),function(b){return b===a})},isValue:g,isError:h,getOr:function(a){return e(b.constant(a),b.identity)},getOrThunk:function(a){return e(a,b.identity)},getOrDie:function(){return e(function(a){b.die(a)()},
b.identity)},or:function(a){return e(b.constant(a),c)},orThunk:function(a){return e(a,c)},fold:e,map:l,each:l,bind:m,exists:function(a){return e(b.constant(!1),a)},forall:function(a){return e(b.constant(!0),a)},toOption:function(){return e(d.none,d.some)}}};return{value:c,error:a}});aa("1z",Date);k("15","1y 6 s p 1z w".split(" "),function(b,d,c,a,e,f){var g=function(){var a=(new e).getTime();return f(a).slice(-6)};return function(e,f,m){var n=c.from(e.ui.editorName).map(a.error);m=m.map(a.value);
n=n.or(m).getOrThunk(function(){return a.value(g())});m=b.toolbar(e.platform.toolbar,f);f=b.mentions(e.mentions,f);return d.deepMerge(e,{ui:{editorName:n},platform:{toolbar:m},mentions:f})}});k("m","1p b s l n q".split(" "),function(b,d,c,a,e,f){var g=function(){var a=f.createElement("span");return void 0!==a.matches?0:void 0!==a.msMatchesSelector?1:void 0!==a.webkitMatchesSelector?2:void 0!==a.mozMatchesSelector?3:-1}(),h=b.ELEMENT,l=b.DOCUMENT;return{all:function(b,c){var e=void 0===c?f:c.dom();
return e.nodeType!==h&&e.nodeType!==l||0===e.childElementCount?[]:d.map(e.querySelectorAll(b),a.fromDom)},is:function(a,b){var c=a.dom();if(c.nodeType!==h)return!1;if(0===g)return c.matches(b);if(1===g)return c.msMatchesSelector(b);if(2===g)return c.webkitMatchesSelector(b);if(3===g)return c.mozMatchesSelector(b);throw new e("Browser lacks native selectors");},one:function(b,e){var d=void 0===e?f:e.dom();return d.nodeType!==h&&d.nodeType!==l||0===d.childElementCount?c.none():c.from(d.querySelector(b)).map(a.fromDom)}}});
k("16",["b","s","m"],function(b,d,c){return function(){var a=[];return{get:function(c){return d.from(b.find(a,function(a){return a.is(c)}))},findAll:function(e){var d=c.all(e);return b.filter(a,function(a){return b.exists(d,a.is)})},add:function(b){a.push(b)},remove:function(c){c=b.indexOf(a,c);a.splice(c,1)}}}});k("17",["s","20"],function(b,d){return{one:function(c,a,e){var f=d.name(c);return b.from(a[f]).map(function(a){return a.replace(c,e)})}}});k("r",[],function(){return{cached:function(b){var d=
!1,c;return function(){d||(d=!0,c=b.apply(null,arguments));return c}}}});k("2k",["r","l","20","q"],function(b,d,c,a){var e=function(a){a=a.dom().body;if(null===a||void 0===a)throw"Body is not available yet";return d.fromDom(a)};return{body:b.cached(function(){return e(d.fromDom(a))}),getBody:e,inBody:function(a){a=c.isText(a)?a.dom().parentNode:a.dom();return void 0!==a&&null!==a&&a.ownerDocument.body.contains(a)}}});aa("31",window);k("2l","a b 1n s 1a 2k l 20 v n o 31".split(" "),function(b,d,c,
a,e,f,g,h,l,m,n,p){var q=function(a,c,e){if(!b.isString(e))throw n.error("Invalid call to CSS.set. Property ",c,":: Value ",e,":: Element ",a),new m("CSS value must be a string: "+e);a.style.setProperty(c,e)},r=function(a,b,c){a=a.dom();q(a,b,c)},s=function(b,c){var e=b.dom().style.getPropertyValue(c);return a.from(e).filter(function(a){return 0<a.length})},t=function(a,b,c){s(a,c).each(function(a){s(b,c).isNone()&&r(b,c,a)})};return{copy:function(a,b){b.dom().style.cssText=a.dom().style.cssText},
set:r,preserve:function(a,b){var c=e.get(a,"style"),d=b(a);(void 0===c?e.remove:e.set)(a,"style",c);return d},setAll:function(a,b){var e=a.dom();c.each(b,function(a,b){q(e,b,a)})},remove:function(a,b){a.dom().style.removeProperty(b);e.has(a,"style")&&""===l.trim(e.get(a,"style"))&&e.remove(a,"style")},get:function(a,b){var c=a.dom(),e=p.getComputedStyle(c).getPropertyValue(b),c=""!==e||f.inBody(a)?e:c.style.getPropertyValue(b);return null===c?void 0:c},getRaw:s,isValidValue:function(a,b,c){a=g.fromTag(a);
r(a,b,c);return s(a,b).isSome()},reflow:function(a){return a.dom().offsetWidth},transfer:function(a,b,c){h.isElement(a)&&h.isElement(b)&&d.each(c,function(c){t(a,b,c)})}}});k("1b",["b","7","m"],function(b,d,c){var a=function(a,b){return a.dom()===b.dom()};return{eq:a,member:function(c,f){return b.exists(f,d.curry(a,c))},is:c.is}});k("47",["a","s"],function(b,d){return function(c,a,e,f,g){return c(e,f)?d.some(e):b.isFunction(g)&&g(e)?d.none():a(e,f,g)}});k("49","a b 7 s 2k 1b l 47".split(" "),function(b,
d,c,a,e,f,g,h){var l=function(e,d,f){e=e.dom();for(f=b.isFunction(f)?f:c.constant(!1);e.parentNode;){e=e.parentNode;var h=g.fromDom(e);if(d(h))return a.some(h);if(f(h))break}return a.none()},m=function(b,e){var f=d.find(b.dom().childNodes,c.compose(e,g.fromDom));return a.from(f).map(g.fromDom)},n=function(b,c){var e=function(b){for(var d=0;d<b.childNodes.length;d++){if(c(g.fromDom(b.childNodes[d])))return a.some(g.fromDom(b.childNodes[d]));var f=e(b.childNodes[d]);if(f.isSome())return f}return a.none()};
return e(b.dom())};return{first:function(a){return n(e.body(),a)},ancestor:l,closest:function(a,b,c){return h(function(a){return b(a)},l,a,b,c)},sibling:function(b,c){var e=b.dom();return e.parentNode?m(g.fromDom(e.parentNode),function(a){return!f.eq(b,a)&&c(a)}):a.none()},child:m,descendant:n}});k("32",["49"],function(b){return{any:function(d){return b.first(d).isSome()},ancestor:function(d,c,a){return b.ancestor(d,c,a).isSome()},closest:function(d,c,a){return b.closest(d,c,a).isSome()},sibling:function(d,
c){return b.sibling(d,c).isSome()},child:function(d,c){return b.child(d,c).isSome()},descendant:function(d,c){return b.descendant(d,c).isSome()}}});k("4b",["b","1n","7","9"],function(b,d,c,a){return{product:function(e,f){return{nu:function(){for(var d=new a(arguments.length),f=0;f<d.length;f++)d[f]=arguments[f];if(e.length!==d.length)throw'Wrong number of arguments to struct. Expected "['+e.length+']", got '+d.length+" arguments";var l={};b.each(e,function(a,b){l[a]=c.constant(d[b])});return l},eq:function(a,
b){for(var d=0;d<e.length;d++){var m=e[d];if(!(f&&f[d]||c.tripleEquals)(a[m](),b[m]()))return!1}return!0},evaluate:function(a){return d.map(a,function(a){return a()})}}}}});k("4a",["4b"],function(b){return function(){return b.product(arguments).nu}});k("69",["a","b"],function(b,d){var c=function(a){return a.slice(0).sort()};return{sort:c,reqMessage:function(a,b){throw"All required keys ("+c(a).join(", ")+") were not specified. Specified keys were: "+c(b).join(", ")+".";},unsuppMessage:function(a){throw"Unsupported keys for object: "+
c(a).join(", ");},validateStrArr:function(a,c){if(!b.isArray(c))throw"The "+a+" fields must be an array. Was: "+c+".";d.each(c,function(c){if(!b.isString(c))throw"The value "+c+" in the "+a+" fields was not a string.";})},invalidTypeMessage:function(a,b){throw"All values need to be of type: "+b+". Keys ("+c(a).join(", ")+") were not.";},checkDupes:function(a){var b=c(a);a=d.find(b,function(a,c){return c<b.length-1&&a===b[c+1]});if(void 0!==a&&null!==a)throw"The field: "+a+" occurs more than once in the combined fields: ["+
b.join(", ")+"].";}}});k("4c","b 1n 7 s 69 19".split(" "),function(b,d,c,a,e,f){return function(g,h){var l=g.concat(h);if(0===l.length)throw"You must specify at least one required or optional field.";e.validateStrArr("required",g);e.validateStrArr("optional",h);e.checkDupes(l);return function(m){var n=d.keys(m);b.forall(g,function(a){return b.contains(n,a)})||e.reqMessage(g,n);var p=b.filter(n,function(a){return!b.contains(l,a)});0<p.length&&e.unsuppMessage(p);var q={};b.each(g,function(a){q[a]=c.constant(m[a])});
b.each(h,function(b){q[b]=c.constant(f.prototype.hasOwnProperty.call(m,b)?a.some(m[b]):a.none())});return q}}});k("33",["4a","4b","4c"],function(b,d,c){return{immutable:b,immutable2:d,immutableBag:c}});k("34",[],function(){return{toArray:function(b,d){var c=[],a=function(a){c.push(a);return d(a)},e=d(b);do e=e.bind(a);while(e.isSome());return c}}});k("29","a b 7 s 33 34 1b l".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a){return h.fromDom(a.dom().ownerDocument)},m=function(b){b=b.dom();return a.from(b.parentNode).map(h.fromDom)},
n=function(b){b=b.dom();return a.from(b.previousSibling).map(h.fromDom)},p=function(b){b=b.dom();return a.from(b.nextSibling).map(h.fromDom)},q=function(a){a=a.dom();return d.map(a.childNodes,h.fromDom)},r=function(b,c){var e=b.dom().childNodes;return a.from(e[c]).map(h.fromDom)},s=e.immutable("element","offset");return{owner:l,defaultView:function(a){a=a.dom().ownerDocument.defaultView;return h.fromDom(a)},documentElement:function(a){a=l(a);return h.fromDom(a.dom().documentElement)},parent:m,findIndex:function(b){return m(b).bind(function(c){c=
q(c);c=d.findIndex(c,function(a){return g.eq(b,a)});return-1<c?a.some(c):a.none()})},parents:function(a,e){for(var d=b.isFunction(e)?e:c.constant(!1),f=a.dom(),g=[];null!==f.parentNode&&void 0!==f.parentNode;){var f=f.parentNode,l=h.fromDom(f);g.push(l);if(!0===d(l))break}return g},siblings:function(a){return m(a).map(q).map(function(b){return d.filter(b,function(b){return!g.eq(a,b)})}).getOr([])},prevSibling:n,offsetParent:function(b){b=b.dom();return a.from(b.offsetParent).map(h.fromDom)},prevSiblings:function(a){return d.reverse(f.toArray(a,
n))},nextSibling:p,nextSiblings:function(a){return f.toArray(a,p)},children:q,child:r,firstChild:function(a){return r(a,0)},lastChild:function(a){return r(a,a.dom().childNodes.length-1)},leaf:function(a,b){var c=q(a);return 0<c.length&&b<c.length?s(c[b],0):s(a,b)}}});k("2v","7 s 1b l 32 29 q".split(" "),function(b,d,c,a,e,f,g){var h=function(a){a.dom().focus()},l=function(b){b=void 0!==b?b.dom():g;return d.from(b.activeElement).map(a.fromDom)};return{hasFocus:function(a){var b=f.owner(a).dom();return a.dom()===
b.activeElement},focus:h,blur:function(a){a.dom().blur()},active:l,search:function(a){return l(f.owner(a)).filter(function(b){return a.dom().contains(b.dom())})},focusInside:function(a){var d=f.owner(a);l(d).filter(function(d){return e.closest(d,b.curry(c.eq,a))}).fold(function(){h(a)},b.noop)}}});k("2m",["29"],function(b){var d=function(a,c){b.parent(a).each(function(b){b.dom().insertBefore(c.dom(),a.dom())})},c=function(a,b){a.dom().appendChild(b.dom())};return{before:d,after:function(a,e){b.nextSibling(a).fold(function(){b.parent(a).each(function(a){c(a,
e)})},function(a){d(a,e)})},prepend:function(a,e){b.firstChild(a).fold(function(){c(a,e)},function(b){a.dom().insertBefore(e.dom(),b.dom())})},append:c,appendAt:function(a,e,f){b.child(a,f).fold(function(){c(a,e)},function(a){d(a,e)})},wrap:function(a,b){d(a,b);c(b,a)}}});k("35",["b","2m"],function(b,d){return{before:function(c,a){b.each(a,function(a){d.before(c,a)})},after:function(c,a){b.each(a,function(b,f){d.after(0===f?c:a[f-1],b)})},prepend:function(c,a){b.each(a.slice().reverse(),function(a){d.prepend(c,
a)})},append:function(c,a){b.each(a,function(a){d.append(c,a)})}}});k("2o",["35","29"],function(b,d){var c=function(a){a=a.dom();null!==a.parentNode&&a.parentNode.removeChild(a)};return{empty:function(a){a.dom().textContent=""},remove:c,unwrap:function(a){var e=d.children(a);0<e.length&&b.before(a,e);c(a)}}});k("21","2l l 2v 2m 2o q 31".split(" "),function(b,d,c,a,e,f,g){return{blur:function(){var g=d.fromHtml('<input type="text" />');b.setAll(g,{"z-index":"-666",background:"transparent",border:"0px",
height:"50px",position:"absolute",top:"25%",left:"50%"});a.append(d.fromDom(f.body),g);c.focus(g);e.remove(g)}}});k("j",["b","n"],function(b,d){return function(c,a){b.each(a,function(a,b){if(b>c.length-1){if(a.required())throw new d('missing parameter "'+a.name()+'"');}else a.validate(c[b])})}});k("36",["b","1n","i","j"],function(b,d,c,a){var e=function(a){return[d.map(a,function(a){return a()})]};return{create:function(){var d=[];return{eventRegistry:{addListener:function(b){a(arguments,[c.func("handler")]);
d.push(b)},removeListener:function(a){a=b.indexOf(d,a);-1!==a&&d.splice(a,1)}},eventTrigger:function(a){b.each(d,function(b){var c=e(a);b.apply(null,c)})}}}}});k("4d",["b","7"],function(b,d){return function(){var c=[],a=[],e=function(a){return a.slice(0)},f=function(a){return-1!==b.indexOf(c,a)};return{get:function(e){return a[b.indexOf(c,e)]},put:function(b,e){if(void 0===b||null===b)throw"Invalid key, no undefined or null.";if(f(b))throw"Invalid key, key already exists.";c.push(b);a.push(e)},contains:f,
remove:function(e,d){var f=b.indexOf(c,e);if(-1===f)throw"Invalid key, does not exist.";c.splice(f,1);return a.splice(f,1)[0]},each:function(e){b.each(c,function(b,c){e(a[c],b,c)})},keys:d.curry(e,c),values:d.curry(e,a),reset:function(){c.splice(0,c.length);a.splice(0,a.length)}}}});k("37",["4d"],function(b){return{create:function(){var d=b();return{bind:function(b,a){d.put(b,a);b.bind(a)},unbind:function(b){var a=d.remove(b);b.unbind(a)},unbindAll:function(){d.each(function(b,a){a.unbind(b)});d.reset()}}}}});
k("22",["1n","36","37"],function(b,d,c){return function(a){var e=c.create(),f=b.map(a,function(a){var b=d.create();e.bind(a,b.eventTrigger);return b});a=b.map(f,function(a){return a.eventRegistry});f=b.map(f,function(a){return a.eventTrigger});return{registry:a,trigger:f,destroy:function(){e.unbindAll()}}}});k("f",["a","1n","19"],function(b,d,c){var a=function(e){c.freeze(e);d.each(e,function(c){b.isObject(c)&&a(c)});return e};return{makeReadOnly:a}});k("4p",["9"],function(b){return{bounce:function(d){return function(){var c=
b.prototype.slice.call(arguments),a=this;setTimeout(function(){d.apply(a,c)},0)}}}});k("3j",[],function(){return function(b,d){return{get:d,map:function(c){return b(function(a){d(function(b){b=c(b);a(b)})})},bind:function(c){return b(function(a){d(function(b){c(b).get(a)})})},anonBind:function(c){return b(function(a){d(function(b){c.get(a)})})}}}});k("3k",["b"],function(b){return function(d){var c=function(a){return d(function(c){var d=[],g=0,h=function(b){return function(h){d[b]=h;g++;g>=a.length&&
c(d)}};0===a.length?c([]):b.each(a,function(a,b){a.get(h(b))})})};return{nu:d,pure:function(a){return d(function(b){b(a)})},par:c,mapM:function(a,e){return c(b.map(a,e))},lift2:function(a,b,c){return d(function(d){var h=!1,l=!1,m=void 0,n=void 0,p=function(){if(h&&l){var a=c(m,n);d(a)}};a.get(function(a){m=a;h=!0;p()});b.get(function(a){n=a;l=!0;p()})})},compose:function(a,b){return function(c){return b(c).bind(a)}}}}});k("3l",["4p","3j","3k"],function(b,d,c){var a=function(c){return d(a,function(a){c(b.bounce(a))})};
return c(a)});k("3g",["1n","3l"],function(b,d){return function(){var c={};return{getOrSetIndexed:function(a,b){if(void 0!==c[a])return c[a];var d=b();return c[a]=d},waitForLoad:function(){var a=b.values(c);return d.par(a)}}}});aa("3m",setTimeout);k("2j","b 6 3j 3k 3l s 3m".split(" "),function(b,d,c,a,e,f,g){var h=function(a){var m=f.none(),n=[],p=function(){return m.isSome()},q=function(a){m.each(function(b){g(function(){a(b)},0)})};e.nu(a).get(function(a){m=f.some(a);b.each(n,q);n=[]});a=c(h,function(a){p()?
q(a):n.push(a)});return d.merge(a,{isSet:p})};return a(h)});k("6a",["1"],function(b){return{namespace:function(d,c){for(var a=c||b,e=d.split("."),f=0;f<e.length;++f){var g=e[f];if(void 0===a[g]||null===a[g])a[g]={};a=a[g]}return a}}});k("4q",["6a"],function(b){return{install:function(d){var c=b.namespace(d);c.callbacks={};var a=0,e=function(){var b="callback_"+a;a++;return b},f=function(a,b){var f=e();c.callbacks[f]=function(){b||g(f);a.apply(null,arguments)};return d+".callbacks."+f},g=function(a){a=
a.substring(a.lastIndexOf(".")+1);void 0!==c.callbacks[a]&&delete c.callbacks[a]};c.ephemeral=function(a){return f(a,!1)};c.permanent=function(a){return f(a,!0)};c.unregister=g;return c}}});k("4r",["7","l"],function(b,d){var c=function(a,c,e,d,f,p,q){return{target:b.constant(a),x:b.constant(c),y:b.constant(e),stop:d,prevent:f,kill:p,raw:b.constant(q)}},a=function(a,e){return function(f){if(a(f)){var m=d.fromDom(f.target),n=function(){f.stopPropagation()},p=function(){f.preventDefault()},q=b.compose(p,
n),m=c(m,f.clientX,f.clientY,n,p,q,f);e(m)}}},e=function(c,e,d,m,n){d=a(d,m);c.dom().addEventListener(e,d,n);return{unbind:b.curry(f,c,e,d,n)}},f=function(a,b,c,e){a.dom().removeEventListener(b,c,e)};return{bind:function(a,b,c,d){return e(a,b,c,d,!1)},capture:function(a,b,c,d){return e(a,b,c,d,!0)}}});k("3n",["7","4r"],function(b,d){var c=b.constant(!0);return{bind:function(a,b,f){return d.bind(a,b,c,f)},capture:function(a,b,f){return d.capture(a,b,c,f)}}});k("3h","2j 4q p 1a 3n l 2m q".split(" "),
function(b,d,c,a,e,f,g,h){var l=d.install("ephox.henchman.features");return{download:function(d){return b.nu(function(b){var p=function(){r.unbind();s.unbind()},q=f.fromTag("script");a.set(q,"src",d);a.set(q,"type","text/javascript");a.set(q,"async","async");a.set(q,"data-main",l.ephemeral(function(a){b(c.value(a))}));var r=e.bind(q,"error",function(){p();b(c.error("Error loading external script tag "+d))}),s=e.bind(q,"load",p);g.append(f.fromDom(h.head),q)})}}});k("4s",["1a","l","2m","q"],function(b,
d,c,a){return{addStylesheet:function(e,f){var g=f||d.fromDom(a),h=d.fromTag("link",g.dom());b.setAll(h,{rel:"stylesheet",type:"text/css",href:e});g=d.fromDom(g.dom().head);c.append(g,h);return h}}});k("3i","a b 2j 7 p 3n 4s".split(" "),function(b,d,c,a,e,f,g){return{download:function(h,l){return c.nu(function(c){var n=function(a){d.each(q,function(a){a.unbind()});c(a.orThunk(function(a){return e.error(a+'Unable to download editor stylesheets from "'+h+'"')}))},p=g.addStylesheet(h),q=[f.bind(p,"load",
function(a){var c;a:{try{var d=a.target().dom().sheet.cssRules;c=b.isObject(d)&&0===d.length;break a}catch(f){}c=!1}c?n(e.error("")):l(n)}),f.bind(p,"error",a.curry(n,e.error("")))]})}}});k("2h",["3g","3h","3i","7"],function(b,d,c,a){return function(){var e=b(),f=function(){return e.waitForLoad()};return{preload:function(){f().get(a.identity)},addStylesheet:function(a,b){return e.getOrSetIndexed(a,function(){return c.download(a,b)})},addScript:function(a,b){return e.getOrSetIndexed(a,function(){return d.download(a).map(b)})},
waitForLoad:f}}});k("4e",["2h"],function(b){var d=b();return{addStylesheet:function(b,a){return d.addStylesheet(b,a)},addScript:function(b,a){return d.addScript(b,a)}}});k("4f",[],function(){var b=function(d){var c=d;return{get:function(){return c},set:function(a){c=a},clone:function(){return b(c)}}};return b});k("39",["4e","4f","q"],function(b,d,c){var a=function(a){a.each(function(a){e.set(a.codemirror());f.set(a.jsbeautify())});return a},e=d(null),f=d(null);return{use:{codemirror:e.get,jsbeautify:f.get},
load:{codeview:function(c){return b.addScript(c+"/codeview.js",a)}}}});k("38",["39"],function(b){return{beautify:function(d){return b.use.jsbeautify().html(d,{indent_size:"2",indent_char:" ",max_preserve_newlines:"5",preserve_newlines:!0,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"normal",brace_style:"collapse",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!1,wrap_line_length:0,indent_inner_html:!1,comma_first:!1,e4x:!1})}}});k("23",["i","j",
"38","39","n"],function(b,d,c,a,e){var f=function(a){return a.map(function(a){return a.dom()}).getOr(null)};return{documentElement:function(a){if(a.content().isInline())throw new e("documentElement called on inline mode");return f(a.content().doc())},insertHtmlAtCursor:function(a,c){d(arguments,[b.object("polish"),b.string("html")]);a.content().focus();a.insertHtmlAtCursor(c)},getSelectedText:function(a){return a.content().getSelectedText().getOr("")},uploadImages:function(a,c){d(arguments,[b.object("polish"),
b.func("callback")]);return a.uploadImages(c)},get:function(b){var d=null!==a.use.jsbeautify()&&b.isPrettyPrinting();b=b.getContent();return d?c.beautify(b):b},set:function(a,c){d(arguments,[b.object("polish"),b.string("html")]);a.undo().disable(function(){a.setContent(c);a.undo().resetToCurrent()});a.setDirty(!1)},isDirty:function(a){d(arguments,[b.object("polish")]);return a.isDirty()},setDirty:function(a,c){d(arguments,[b.object("polish"),b.bool("state")]);a.setDirty(c)}}});k("4g",["a","b","1n",
"9"],function(b,d,c,a){return{generate:function(e){if(!b.isArray(e))throw"cases must be an array";if(0===e.length)throw"there must be at least one case";var f={};d.each(e,function(d,h){var l=c.keys(d);if(1!==l.length)throw"one and only one name per case";var m=l[0],n=d[m];if(void 0!==f[m])throw"duplicate key detected:"+m;if("cata"===m)throw"cannot have a case named cata (sorry)";if(!b.isArray(n))throw"case arguments must be an array";f[m]=function(){var b=arguments.length;if(b!==n.length)throw"Wrong number of arguments to case "+
m+". Expected "+n.length+" ("+n+"), got "+b;for(var c=new a(b),b=0;b<c.length;b++)c[b]=arguments[b];return{fold:function(){if(arguments.length!==e.length)throw"Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length;return arguments[h].apply(null,c)}}}});return f}}});k("3a",["6","4g"],function(b,d){var c=d.generate([{inputSelector:["selector","callback"]},{outputSelector:["selector","callback"]},{inputPredicate:["predicate","callback"]},{outputPredicate:["predicate","callback"]}]);
return b.merge(c,{cata:function(a,b,c,d,h){return a.fold(b,c,d,h)}})});k("24",["b","i","j","7","3a"],function(b,d,c,a,e){var f=function(a){return function(c){c=b.map(c,function(a){return a.dom()});a(c)}},g=function(a){return function(b){return a(b.dom())}};return function(b){var l=function(a,e,g){c(arguments,[d.func("filter"),d.string("selector"),d.func("callback")]);var l=a(e,f(g));b.filter().customFilters().addFilter(l)},m=function(a,e,l){c(arguments,[d.func("filter"),d.func("predicate"),d.func("callback")]);
var m=a(g(e),f(l));b.filter().customFilters().addFilter(m)};return{selector:{addInput:a.curry(l,e.inputSelector),addOutput:a.curry(l,e.outputSelector)},predicate:{addInput:a.curry(m,e.inputPredicate),addOutput:a.curry(m,e.outputPredicate)}}}});k("54",[],function(){return{zeroWidth:function(){return"\ufeff"}}});k("b4",["54","7"],function(b,d){var c="\\w'\\-\\u00C0-\\u00FF"+b.zeroWidth()+"\\u2018\\u2019",a="[^"+c+"]",e="["+c+"]";return{chars:d.constant(c),wordbreak:d.constant(a),wordchar:d.constant(e)}});
aa("5z",RegExp);k("b5",["5z"],function(b){return function(d,c,a,e){return{term:function(){return new b(d,e.getOr("g"))},prefix:c,suffix:a}}});k("b7",["7","s","b4","b5"],function(b,d,c,a){return{token:function(c){return a(c,b.constant(0),b.constant(0),d.none())},word:function(b){b="((?:^'?)|(?:"+c.wordbreak()+"+'?))"+b+"((?:'?$)|(?:'?"+c.wordbreak()+"+))";return a(b,function(a){return 1<a.length?a[1].length:0},function(a){return 2<a.length?a[2].length:0},d.none())}}});k("b6",["b7"],function(b){var d=
function(b){return b.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")};return{sanitise:d,word:function(c){c=d(c);return b.word(c)},token:function(c){c=d(c);return b.token(c)}}});k("6b",["b4","b5","b6","b7"],function(b,d,c,a){return{safeword:function(a){return c.word(a)},safetoken:function(a){return c.token(a)},custom:function(a,b,c,h){return d(a,b,c,h)},unsafeword:function(b){return a.word(b)},unsafetoken:function(b){return a.token(b)},sanitise:function(a){return c.sanitise(a)},chars:function(){return b.chars()},
wordbreak:function(){return b.wordbreak()},wordchar:function(){return b.wordchar()}}});k("4h",["7","6b","5z"],function(b,d,c){return function(a,e,f){var g=d.sanitise(a),h=d.sanitise(e);return{patterns:function(){return[new c(g+"(.*?)"+h,"gi")]},useCursor:b.constant(!0),generate:function(a,b){return f.generate(a,b.key(),b.value())},derive:function(a){var c=a[1];return f.get(c).map(function(d){return{startIndex:b.constant(a.index),finishIndex:b.constant(a.index+a[0].length),key:b.constant(c),value:b.constant(d)}})}}}});
k("4v",["a","b","1n","7","69"],function(b,d,c,a,e){var f=function(a,c){return g(a,c,{validate:b.isFunction,label:"function"})},g=function(a,b,f){if(0===b.length)throw"You must specify at least one required field.";e.validateStrArr("required",b);e.checkDupes(b);return function(g){var h=c.keys(g);d.forall(b,function(a){return d.contains(h,a)})||e.reqMessage(b,h);a(b,h);var r=d.filter(b,function(a){return!f.validate(g[a],a)});0<r.length&&e.invalidTypeMessage(r,f.label);return g}},h=a.noop;return{exactly:a.curry(f,
function(a,b){var c=d.filter(b,function(b){return!d.contains(a,b)});0<c.length&&e.unsuppMessage(c)}),ensure:a.curry(f,h),ensureWith:a.curry(g,h)}});k("4i",["4v"],function(b){var d=b.ensure(["elements","cursor","dictation","notify"]);b=b.ensure(["elements","cursor","dictation","range","notify"]);return{species:d,applicator:b}});k("4j",["b","l","29","q"],function(b,d,c,a){return{fromHtml:function(b,f){var g=(f||a).createElement("div");g.innerHTML=b;return c.children(d.fromDom(g))},fromTags:function(a,
c){return b.map(a,function(a){return d.fromTag(a,c)})},fromText:function(a,c){return b.map(a,function(a){return d.fromText(a,c)})},fromDom:function(a){return b.map(a,d.fromDom)}}});k("3b",["4h","4i","7","s","4j"],function(b,d,c,a,e){return function(f,g,h){return b(f,g,{get:function(b){b=h(b);return a.some(b)},generate:function(b,f,g){b=e.fromHtml(g,b.dom());return d.species({elements:c.constant(b),cursor:a.none,dictation:a.none,notify:a.none})}})}});k("25",["i","j","3b"],function(b,d,c){return{addSimpleMacro:function(a,
e,f,g){d(arguments,[b.object("polish"),b.string("startString"),b.string("endString"),b.func("callback")]);var h=c(e,f,g);return a.macros().customMacros().add(h)},removeMacro:function(a,b){a.macros().customMacros().remove(b)}}});k("26",["b","i","j"],function(b,d,c){var a=["error","info","warning"];return{message:function(e,f,g,h){if(!b.contains(a,f))throw'Message level: "'+f+'" is not supported. Supported levels are: ['+a.join(", ")+"].";c(arguments,[d.object("polish"),d.string("level"),d.number("timeout"),
d.string("msg")]);var l=e.ui().showMessage(f,g,h);return{hide:function(){l()}}}}});k("3c",["7"],function(b){var d=b.constant("pencil");b=b.constant("code");return{pencil:d,code:b}});k("27",["i","j","3c","n"],function(b,d,c,a){return{get:function(a){return a.getMode()===c.pencil()?"design":"code"},set:function(e,f){d(arguments,[b.object("polish"),b.string("mode")]);var g=f.toLowerCase();if("code"!==g&&"design"!==g)throw new a('Editor mode "'+f+'" not supported. Must be either design or code.');e.setMode("design"===
g?c.pencil():c.code())}}});k("g",["s","o"],function(b,d){var c=function(a){try{var c=xa(a);return b.some(c)}catch(d){return b.none()}};return{get:c,register:function(a,b){return k(a,[],function(){return b})},hookup:function(a,b){c(b).fold(function(){d&&d.error&&d.error('textbox.io Could not find plugin "'+b+'". Have you declared it?')},function(b){a.events.loaded.addListener(function(){b.initialize(a)})})}}});k("3d",["7"],function(b){var d=function(c,a){return{left:b.constant(c),top:b.constant(a),
translate:function(b,f){return d(c+b,a+f)}}};return d});k("4k","7 1b l 20 49 q".split(" "),function(b,d,c,a,e,f){return{attached:function(a,h){var l=h||c.fromDom(f.documentElement);return e.ancestor(a,b.curry(d.eq,l)).isSome()},windowOf:function(b){var c=b.dom();return c===c.window?b:a.isDocument(b)?c.defaultView||c.parentWindow:null}}});k("3e",["3d","4k","l"],function(b,d,c){var a=function(a,b){return void 0!==a?a:void 0!==b?b:0},e=function(a){var e=a.dom(),h=e.ownerDocument,l=h.body,h=c.fromDom(h.documentElement);
if(l===e)return b(l.offsetLeft,l.offsetTop);if(!d.attached(a,h))return b(0,0);a=e.getBoundingClientRect();return b(a.left,a.top)};return{absolute:function(b){var g=b.dom().ownerDocument,h=g.body,l=d.windowOf(c.fromDom(g)),m=g.documentElement,g=a(l.pageYOffset,m.scrollTop),l=a(l.pageXOffset,m.scrollLeft),n=a(m.clientTop,h.clientTop),h=a(m.clientLeft,h.clientLeft);return e(b).translate(l-h,g-n)},relative:function(a){a=a.dom();return b(a.offsetLeft,a.offsetTop)},viewport:e}});k("28",["3d","3e","q"],
function(b,d,c){return{get:function(a){a=void 0!==a?a.dom():c;return b(a.body.scrollLeft||a.documentElement.scrollLeft,a.body.scrollTop||a.documentElement.scrollTop)},setToElement:function(a,b){var c=d.absolute(b);a.scrollTo(c.left(),c.top())}}});k("18","b 21 22 f 23 24 25 26 27 g 7 r 28 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){return function(s,t,u){var v=c({loaded:s.events.loaded,focus:s.events.focus,dirty:s.events.dirty,internal:s.events.internal}),w=function(a,b){var c=r.owner(a),
d=r.defaultView(a),c=q.get(c),e=b();d.dom().scrollTo(c.left(),c.top());return e},x=a.makeReadOnly({content:{documentElement:n.curry(e.documentElement,s),insertHtmlAtCursor:n.curry(e.insertHtmlAtCursor,s),getSelectedText:n.curry(e.getSelectedText,s),uploadImages:n.curry(e.uploadImages,s),get:n.curry(e.get,s),set:n.curry(e.set,s),isDirty:n.curry(e.isDirty,s),setDirty:n.curry(e.setDirty,s)},mode:{set:n.curry(l.set,s),get:n.curry(l.get,s)},filters:f(s),macros:{addSimpleMacro:n.curry(g.addSimpleMacro,
s),removeMacro:n.curry(g.removeMacro,s)},message:n.curry(h.message,s),events:v.registry,element:function(){return s.element().dom()},focus:s.focus,restore:p.cached(function(){return w(s.element(),function(){d.blur();var a=e.get(s);v.destroy();s.destroy();return u.restore(a)})})});b.each(t,function(a){m.hookup(x,a)});return x}});k("d","b 14 15 16 17 18 s 1a 1b".split(" "),function(b,d,c,a,e,f,g,h,l){return function(){var m=d(),n=a(),p=function(a){return a.api},q=function(a,b){var d=c(b.options(),function(){return p.getOrDie("Internal Error")},
g.from(h.get(a,"id"))),p=e.one(a,b.constructors(),d).map(function(b){var c=f(b.polish,d&&d.plugins?d.plugins:[],{restore:function(a){n.remove(e);m.remove(e);return b.restore(a).dom()}}),e={is:function(b){return l.eq(a,b)},api:c};n.add(e);m.add(e);return c});return p};return{getOrCreate:function(a,b){return n.get(a).map(p).orThunk(function(){return q(a,b)})},get:function(a){a=n.findAll(a);return b.map(a,p)},getActiveEditor:m.get}}});k("2a",["6","1a"],function(b,d){return{withOptions:function(c,a){return d.has(c,
"tabindex")?b.deepMerge(a,{content:{tabindex:d.get(c,"tabindex")}}):a}}});k("2b",["1n","c","s","2l"],function(b,d,c,a){d=d.detect();var e=d.browser.isIE()&&10===d.browser.version.major,f=function(b,c){var d=a.getRaw(b,c).getOrThunk(function(){return a.get(b,c)});return e&&"0px"===d?"auto":d},g=function(a,b,d){a=f(a,b);return void 0===a?d:c.some(a)},h=function(a){return{width:g(a,"width",c.none()),"max-width":g(a,"max-width",c.some("none")),"min-width":g(a,"min-width",c.some("none")),"max-height":g(a,
"max-height",c.some("none")),"min-height":g(a,"min-height",c.some("none"))}},l=function(c,d){var e=a.getRaw(c,"display"),g=f(c,"height");a.set(c,"display","none");var l=f(c,"height"),g="auto"===l?g:l,l=h(c);e.fold(function(){a.remove(c,"display")},function(b){a.set(c,"display",b)});void 0!==g&&a.set(d,"height",g);b.each(l,function(b,c){b.each(function(b){a.set(d,c,b)})})};return{copyFrom:l,explicit:function(a){l(a,a)}}});k("4o",["48","7"],function(b,d){var c=b.create("ephox-elder");return{resolve:c.resolve,
scrollable:d.curry(c.resolve,"scrollable")}});k("43",["b","1x","9"],function(b,d,c){return{add:function(a,c){b.each(c,function(b){d.add(a,b)})},remove:function(a,c){b.each(c,function(b){d.remove(a,b)})},toggle:function(a,c){b.each(c,function(b){d.toggle(a,b)})},hasAll:function(a,c){return b.forall(c,function(b){return d.has(a,b)})},hasAny:function(a,c){return b.exists(c,function(b){return d.has(a,b)})},get:function(a){a=void 0===a.dom().classList?[]:a.dom().classList;for(var b=new c(a.length),d=0;d<
a.length;d++)b[d]=a.item(d);return b}}});k("6c",["1x","43"],function(b,d){return{addClass:function(c){return function(a){b.add(a,c)}},removeClass:function(c){return function(a){b.remove(a,c)}},removeClasses:function(b){return function(a){d.remove(a,b)}},hasClass:function(c){return function(a){return b.has(a,c)}}}});k("4l","b 4o 7 s 3n l 6c 28 3m 31".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=a.none();d=d.resolve("modal-scroll-lock");var p=function(a,c){b.each(c,function(b){a(b)})};return{block:function(){if(n.isNone()){var b=
h.get(),c=e.bind(f.fromDom(m),"scroll",function(a){a=h.get();a.left()===b.left()&&a.top()===b.top()||m.scrollTo(b.left(),b.top())});n=a.some(c)}},unblock:function(){n.each(function(b){n=a.none();l(function(){b.unbind()},250)})},lock:c.curry(p,g.addClass(d)),unlock:c.curry(p,g.removeClass(d))}});aa("65",clearTimeout);k("6d",["65","3m"],function(b,d){return function(c,a){var e=null;return{cancel:function(){null!==e&&(b(e),e=null)},schedule:function(){var b=arguments;e=d(function(){c.apply(null,b);e=
null},a)}}}});k("4x",["b","33"],function(b,d){return function(c){var a=d.immutable.apply(null,c),e=[];return{bind:function(a){if(void 0===a)throw"Event bind error: undefined handler";e.push(a)},unbind:function(a){e=b.filter(e,function(b){return b!==a})},trigger:function(){var c=a.apply(null,arguments);b.each(e,function(a){a(c)})}}}});k("3z",["1n"],function(b){return{create:function(d){var c=b.map(d,function(a){return{bind:a.bind,unbind:a.unbind}});d=b.map(d,function(a){return a.trigger});return{registry:c,
trigger:d}}}});k("4m",["6d","4x","3z","3n"],function(b,d,c,a){return function(e){var f=!1,g=c.create({started:d([]),stopped:d([])}),h=b(function(){!0===f&&(f=!1,g.trigger.stopped())},250),l=a.bind(e,"scroll",function(){h.cancel();!1===f&&g.trigger.started();f=!0;h.schedule()});return{events:g.registry,destroy:function(){l.unbind()},isScrolling:function(){return f}}}});k("4n",["s","28"],function(b,d){return{capture:function(c,a){var e=b.none();return{save:function(){e=b.some(d.get(c))},restore:function(){e.each(function(b){a.scrollTo(b.left(),
b.top())})}}},preserve:function(b,a){var e=d.get(b);a();var f=d.get(b);e.top()===f.top()&&e.left()===f.left()||b.dom().defaultView.scrollTo(e.left(),e.top())}}});k("3f",["4l","4m","4n","4o","1x"],function(b,d,c,a,e){return{register:function(b){e.add(b,a.scrollable())},deregister:function(b){e.remove(b,a.scrollable())},scrollable:a.scrollable,preserve:c.preserve,capture:c.capture,block:b.block,unblock:b.unblock,lock:b.lock,unlock:b.unlock,event:d}});k("1e",["2h"],function(b){var d=b();return{preload:function(){d.preload()},
addStylesheet:function(b,a){return d.addStylesheet(b,a)},addScript:function(b,a){return d.addScript(b,a)},waitForLoad:function(){return d.waitForLoad()}}});k("2i",["b","v"],function(b,d){var c=function(){return{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",
zh:"zh",zh_tw:"zh_tw"}},a=function(a){a=a.toLowerCase().replace("-","_");var b=a.indexOf(";");a=-1<b?a.substring(0,b):a;a=d.trim(a);b=a.indexOf("_");b=-1<b?a.substring(0,b):a;return{full:a,languageCode:b}},e=function(c,d){var e=c.split(","),e=b.map(e,function(b){b=a(b);return d[b.full]||d[b.languageCode]||""});return b.find(e,function(a){return""!==a})};return{extract:a,determine:function(a){var b=c();return e(a,b)},determineFrom:e,localeList:c}});k("k",["s"],function(b){return{cat:function(b){for(var c=
[],a=function(a){c.push(a)},e=0;e<b.length;e++)b[e].each(a);return c},findMap:function(d,c){for(var a=0;a<d.length;a++){var e=c(d[a],a);if(e.isSome())return e}return b.none()},liftN:function(d,c){for(var a=[],e=0;e<d.length;e++){var f=d[e];if(f.isSome())a.push(f.getOrDie());else return b.none()}return b.some(c.apply(null,a))}}});k("1f","2f 2i 7 s k o".split(" "),function(b,d,c,a,e,f){var g=function(){var a=b.resolve("navigator")||{};return a.userLanguage||a.language||"en"}(),h=a.none();return{determine:function(b){var h=
void 0!==b?[b,g]:[g];return e.findMap(h,function(b){return a.from(d.determine(b))}).fold(function(){f.warn("WARNING: locales not supported: "+h.join(", "));return"en"},c.identity)},get:function(){return h.getOrDie("locale used before it has been set")},set:function(b){h=a.from(b)}}});k("1g","a 1n 2f 7 1f n o".split(" "),function(b,d,c,a,e,f,g){var h={font:{arial:"Arial",courier:"Courier New",comicsans:"Comic Sans MS",consolas:"Consolas",georgia:"Georgia",impact:"Impact",tahoma:"Tahoma",timesnr:"Times New Roman",
trebuchet:"Trebuchet MS",verdana:"Verdana"},error:{duplicate:{code:"That snippet code is already taken.",uuid:"That snippet uuid is already taken."},unknown:{uuid:"The snippet uuid cannot be found"},code:{duplicate:"That snippet code is already taken."}},cog:{login:"Log in",logout:"Log out","not-logged-in":"Not logged in",user:"User: {0}"},banner:{"logged-in":"Logged in as: {0}"}},l={},m="",n={},p=function(a){return c.resolve(a,n)||c.resolve(a,l)||c.resolve(a,h)};return{loadEnglish:function(a){l=
a},load:function(a,b){m=a;n=b;e.set(a)},isLoaded:function(a){return m===a&&0<d.keys(n).length},get:function(a){var c=p(a);if(b.isString(c))return c;throw new f("key "+a+" does not exist");},has:function(c){if(!b.isString(c))throw c.fold?g.error("object details were",c.fold(a.identity,a.identity,a.identity)):g.error("object key was",c),"key was an object";return b.isString(p(c))}}});k("1h",["s","o"],function(b,d){var c=b.none();return{set:function(a){c.fold(function(){c=b.some(a)},function(b){b!==
a&&d.error('Only one base URL supported per page. Requested value "'+a+'", already using "'+b+'"')})},get:function(){return c.getOrDie("Must begin loading with a base URL")}}});k("2n",["3n","l","q"],function(b,d,c){return{execute:function(a){if("complete"===c.readyState||"interactive"===c.readyState)a();else var e=b.bind(d.fromDom(c),"DOMContentLoaded",function(){a();e.unbind()})}}});k("3o",["a","b","2l"],function(b,d,c){return function(a,e){var f=function(b){var d=e(b);return 0>=d||null===d?(b=c.get(b,
a),parseFloat(b)||0):d},g=function(a,b){return d.foldl(b,function(b,d){var e=c.get(a,d),e=void 0===e?0:parseInt(e,10);return isNaN(e)?b:b+e},0)};return{set:function(c,d){if(!b.isNumber(d)&&!d.match(/^[0-9]+$/))throw a+".set accepts only positive integer values. Value was "+d;c.dom().style[a]=d+"px"},get:f,getOuter:f,aggregate:g,max:function(a,b,c){a=g(a,c);return b>a?b-a:0}}}});k("2p",["2l","3o"],function(b,d){var c=d("width",function(a){return a.dom().offsetWidth});return{set:function(a,b){c.set(a,
b)},get:function(a){return c.get(a)},getOuter:function(a){return c.getOuter(a)},setMax:function(a,d){var f=c.max(a,d,"margin-left border-left-width padding-left padding-right border-right-width margin-right".split(" "));b.set(a,"max-width",f+"px")}}});aa("2q",clearInterval);aa("2r",setInterval);k("1i","2j r 2k 1x 2l l 2m 2n 2o 2p v 2q 2r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=function(){var b=f.fromTag("div");a.add(b,"ephox-textbox-font");var d=f.fromTag("span");a.add(d,"ephox-chameleon-icon");
g.append(b,d);g.append(c.body(),b);var h=m.get(d),d=e.get(d,"font-family");l.remove(b);return 0<h&&void 0!==d&&n.contains(d,"Textbox Icons")},s=function(a){var b=0,c=q(function(){b+=250;r()?(p(c),a(!0)):2E3<b&&(p(c),a(!1))},250)};return{wait:d.cached(function(){return b.nu(function(a){h.execute(function(){r()?a(!0):s(a)})})})}});k("t","b 1e 7 p 1f 1g 1h 1i o".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(b){h.wait().get(function(c){b(c?a.value(!0):a.error("Stylesheet loaded, but did not contain Textbox.io styles"))})},
n=function(a,b){return d.addScript(a+"/i18n/tbio_"+b+".js",function(a){return a.map(function(a){return a.strings()})})},p=function(a){d.addStylesheet(a+"/textboxio.css",m)};return{load:function(a){g.set(a);a=g.get();p(a+"/css");n(a,"en").get(function(a){a.each(f.loadEnglish)});return a},devLoad:p,setLanguage:function(a){var b=e.determine(a);f.isLoaded(b)||(a=g.get(),n(a,b).get(function(a){a.each(function(a){f.load(b,a)})}))},waitForLoad:function(){return d.waitForLoad()},getFailures:function(a){return b.bind(a,
function(a){return a.fold(function(a){return[a]},c.constant([]))})}}});k("68",["b","2k","29"],function(b,d,c){var a=function(d,f){var g=[];b.each(c.children(d),function(b){f(b)&&(g=g.concat([b]));g=g.concat(a(b,f))});return g};return{all:function(b){return a(d.body(),b)},ancestors:function(a,d,g){return b.filter(c.parents(a,g),d)},siblings:function(a,d){return b.filter(c.siblings(a),d)},children:function(a,d){return b.filter(c.children(a),d)},descendants:a}});k("46",["68","m"],function(b,d){return{all:function(b){return d.all(b)},
ancestors:function(c,a,e){return b.ancestors(c,function(b){return d.is(b,a)},e)},siblings:function(c,a){return b.siblings(c,function(b){return d.is(b,a)})},children:function(c,a){return b.children(c,function(b){return d.is(b,a)})},descendants:function(b,a){return d.all(a,b)}}});k("2y",["s","46","m","47"],function(b,d,c,a){var e=function(a,c,e){return b.from(d.ancestors(a,c,e)[0])};return{first:function(a){return b.from(d.all(a)[0])},ancestor:e,sibling:function(a,c){return b.from(d.siblings(a,c)[0])},
child:function(a,c){return b.from(d.children(a,c)[0])},descendant:function(a,c){return b.from(d.descendants(a,c)[0])},closest:function(b,d,h){return a(c.is,e,b,d,h)}}});k("6e",["2y"],function(b){return{any:function(d){return b.first(d).isSome()},ancestor:function(d,c,a){return b.ancestor(d,c,a).isSome()},sibling:function(d,c){return b.sibling(d,c).isSome()},child:function(d,c){return b.child(d,c).isSome()},descendant:function(d,c){return b.descendant(d,c).isSome()},closest:function(d,c,a){return b.closest(d,
c,a).isSome()}}});k("4t","c 7 30 1a 1x 2l l 2m 2o 6e q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=c.resolve("highcontrast-mode"),q=function(a){var b=g.fromTag("div");e.add(b,c.resolve("highcontrast-detect"));h.append(a,b);f.reflow(b);(!0===("none"===f.get(b,"background-image")?!0:!1)?e.add:e.remove)(a,p);l.remove(b)},r=function(b){var c=g.fromDom(n.documentElement);(!0===(a.has(c,"hc")&&a.has(c,"hcx"))?e.add:e.remove)(b,p)},s=d.noop;return{detect:function(a){var c=b.detect();c.os.isWindows()&&
(c.browser.isIE()||c.browser.isSpartan()||c.browser.isFirefox()?q:c.browser.isChrome()?r:s)(a)},isHighContrast:function(a){return m.ancestor(a.uiContainer(),"."+p)}}});k("4u",["4g"],function(b){b=b.generate([{unchanged:["html"]},{changed:["html"]}]);return{unchanged:b.unchanged,changed:b.changed,cata:function(b,c,a){return b.fold(c,a)}}});k("3v",["a","4v"],function(b,d){var c=function(){return{validate:function(a,c){return b.isFunction(a)||"events"===c&&b.isObject(a)},label:"Function (or events)"}}(),
a="activateInline communication connect content deactivateInline element events filter focus getContent getMode insertHtmlAtCursor isDirty isPrettyPrinting keyboard macros operations setContent setDirty smartview state ui undo".split(" "),e=d.ensureWith(a.concat([]),c),c=d.ensureWith(a.concat("blur cleanup destroy fromTransfer fullscreen uploader toTransfer viewport".split(" ")),c);return{external:e,internal:c}});k("6f",["b","7"],function(b,d){return function(c){return b.mapToObject(c,function(){return{bind:d.noop,
unbind:d.noop}})}});k("6g",["4x","3z","4f"],function(b,d,c){return function(a){a=c(a.dirty);var e=a.get,f=a.set,g=d.create({dirty:b([])});return{events:g.registry,isDirty:e,setDirty:function(a){var b=e();a!==b&&(f(a),!0===a&&g.trigger.dirty())},state:function(){return{dirty:e()}}}}});k("6h",["b","7","3a"],function(b,d,c){return function(a,e,f){var g=[],h=d.curry(e,"input"),l=d.curry(e,"output"),m=d.curry(f,"input"),n=d.curry(f,"output");e=function(a){c.cata(a,h,l,m,n);g.push(a)};b.each(a.customs,
e);return{state:function(){return{customs:g.slice(0)}},addFilter:e}}});k("2w",[],function(){var b=0;return{generate:function(d){var c=(new Date).getTime(),a=Math.floor(1E9*Math.random());b++;return d+"_"+a+b+String(c)}}});k("6i",["1n","2w","6"],function(b,d,c){return function(a){var e={};b.each(a,function(a,b){e[b]=a});return{get:function(){return b.values(e)},add:function(a){var b=d.generate("macro");e[b]=a;return b},remove:function(a){delete e[a]},state:function(){return c.merge({},e)}}}});k("6j",
["b","7","s","6f"],function(b,d,c,a){return{noSituation:function(){return{primary:d.constant([]),secondary:d.constant([]),submenus:d.constant({})}},basic:function(){return{destroy:d.noop,ui:c.none,state:d.constant({}),events:a(["analytics"])}}}});k("6k",["7","s","6f","6j","1a"],function(b,d,c,a,e){return function(){var f=b.noop;return{setAutocorrect:b.noop,setSpelling:b.noop,events:c(["analytics"]),init:function(a){a.body().each(function(a){e.set(a,"spellcheck","false");f=function(){e.remove(a,"spellcheck")}})},
check:b.noop,situation:a.noSituation,handle:b.noop,assign:b.noop,destroy:function(){f()},state:b.constant({}),exclude:b.noop,lookup:b.constant(d.none()),name:b.constant("spelling-disabled")}}});k("6l",["b","1n","6a","7","s"],function(b,d,c,a,e){var f=function(e,f){var l={};d.each(e,function(a,b){var d=b.split(".");if(1>=d.length)l[b]={finalvalue:a};else{var e=l;c.namespace(b,l);for(var f=0;f<d.length-1;f++)e=e[d[f]];e[d[d.length-1]]={finalvalue:a}}});var m=function(c){var e={},g=d.keys(c);b.each(g,
function(b){e[b]=void 0!==c[b].finalvalue?f(c[b].finalvalue):a.constant(m(c[b]))});return e};return m(l)};return{ui:function(b,c){var d=f(b,void 0!==c?c:a.constant);return a.constant(e.some(d))},actions:function(b){b=f(b,a.identity);return a.constant(b)}}});k("4w","b 6 3l 7 s p 6f 6g 6h 6i 6j 6k 6l 4x 3z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return{basic:n.basic,communication:function(){return{headers:a.constant({}),destroy:a.noop}},fullscreen:function(){return{ui:e.none,actions:q.actions({maximize:a.noop,
restore:a.noop}),select:a.noop,deselect:a.noop,destroy:a.noop,events:g(["analytics","maximize","restore"])}},dialog:function(){return{destroy:a.noop,ui:e.none,events:g(["analytics"]),actions:q.actions({show:a.noop})}},spelling:function(){return p()},usersettings:function(){return{ui:e.none,init:a.noop,actions:q.actions({showLogin:a.noop}),destroy:a.noop,events:g("analytics login logout autocorrect spellcheck wordcount help".split(" ")),get:a.constant({})}},editorcontext:function(){return{events:g(["blockChanged",
"enterDown","enterUp"]),destroy:a.noop}},highlighter:function(){return{destroy:a.noop,run:a.noop}},macros:function(){return{events:g(["analytics"]),state:a.constant({}),customMacros:a.constant(m({})),destroy:a.noop}},table:function(){return{ui:e.none,state:a.constant({}),events:g(["analytics"]),situation:n.noSituation,handle:a.noop,assign:a.noop,destroy:a.noop,name:a.constant("table-disabled")}},image:function(){return{events:g(["changed","contextmenu"]),situation:n.noSituation,handle:a.noop,assign:a.noop,
destroy:a.noop,fireChanged:a.noop,name:a.constant("image-disabled")}},imageEdit:function(){var d=function(a){a=b.map(a,f.value);return c.pure(a)};return{situation:n.noSituation,handle:a.noop,assign:a.noop,ui:e.none,destroy:a.noop,insertResample:a.constant({assets:d,correlated:d,destroy:a.noop}),name:a.constant("imageEdit-disabled")}},mobile:function(){return{ui:e.none,events:g(["fullscreen"]),destroy:a.noop}},noAnalytics:function(){return{log:a.noop,register:a.noop}},state:function(b){var c=h(b.laundry),
e=l(b.filters,a.noop,a.noop),f=m(b.macros.customs);return{filter:a.constant({customFilters:a.constant(e)}),macros:a.constant({customMacros:a.constant(f)}),laundry:c,getState:function(){return d.merge(b,{laundry:c.state(),filters:e.state(),macros:{customs:f.state()}})}}},uploader:function(){var b=s.create({reconstitute:r([]),uploadAssets:r(["assets"])});return{destroy:a.noop,events:b.registry,reconstitute:a.noop,uploadAssets:a.noop}},undo:function(){return{reset:a.noop,resetToCurrent:a.noop,disable:a.apply,
save:a.noop}}}});k("3y",["7","4w","4x","3z"],function(b,d,c,a){return{activateInline:b.noop,deactivateInline:b.noop,communication:d.communication,events:function(){return a.create({loaded:c([]),focus:c([]),dirty:c([]),internal:c(["command","data"])}).registry},keyboard:b.die("the keyboard feature is not implemented in this mode"),operations:b.die("the operations feature is not implemented in this mode"),smartview:b.die("the smartview feature is not implemented in this mode"),ui:b.die("the ui feature is not implemented in this mode")}});
k("40",["b","7","4x"],function(b,d,c){return function(a,e){var f=c(a),g=0,h=function(c){var d=b.map(a,function(a){return c[a]()});f.trigger.apply(null,d)};return{bind:function(a){f.bind(a);g++;1===g&&e.bind(h)},unbind:function(a){f.unbind(a);g--;0===g&&e.unbind(h)},trigger:d.die("Cannot trigger a source event.")}}});k("3p","7 s 4t 38 4u 3c 3v 4w 39 3y 30 4x 3z 40 43 l 2m 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w){return function(x,y,k){var z=h.state(k),A=d.none(),C=d.none(),
D=q.create({loaded:p([]),focus:p([]),dirty:r([],z.laundry.events.dirty),internal:p(["command","data"])}),E=function(){var a=F().display.wrapper,a=t.fromDom(a);return w.parent(a).getOrDie()},F=function(){return C.getOrDie("CodeMirror not added to DOM")},G=function(b){return H()?a.beautify(b):b},I=function(a){var b=F().doc;a=G(a);b.setValue(a);b.clearHistory()};k=function(){F().focus()};var H=function(){return!0===x.content.prettyprint};return g.internal({activateInline:m.activateInline,blur:b.die("blur is not supported in the API."),
cleanup:b.noop,communication:h.communication,connect:function(a){var b=t.fromTag("div");u.append(a,b);y.updateUi(b);c.detect(b);a=l.use.codemirror()(b.dom(),{mode:"text/html",extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!0});a.on("focus",function(){D.trigger.focus()});s.add(b,[n.resolve("source-container"),"ephox-textbox-font",n.resolve("layer-editor")]);C=d.some(a);D.trigger.loaded();return!0},content:b.constant({body:b.constant(d.none()),doc:b.die("content.doc is not supported in code view"),
execCommand:b.die("content.execCommand is not supported in code view"),getSelectedText:function(){var a=F().getSelection();return void 0!==a&&null!==a&&0<a.length?d.some(a):d.none()},focus:k}),deactivateInline:m.deactivateInline,destroy:function(){var a=E();s.remove(a,[n.resolve("source-container"),"ephox-textbox-font",n.resolve("layer-editor")]);v.remove(a);C=d.none()},element:E,events:D.registry,filter:z.filter,focus:k,fromTransfer:function(a){var b=function(a){I(a);A=d.some(a);C.bind(function(a){a.on("change",
function(a,b){z.laundry.setDirty(!0)})})};e.cata(a,b,b)},fullscreen:h.fullscreen,getContent:function(){return F().doc.getValue()},getMode:f.code,insertHtmlAtCursor:function(a){F().replaceSelection(a)},isDirty:z.laundry.isDirty,isPrettyPrinting:H,keyboard:m.keyboard,macros:z.macros,operations:m.operations,setContent:function(a){I(a);z.laundry.setDirty(!1)},setDirty:z.laundry.setDirty,smartview:m.smartview,state:z.getState,toTransfer:function(){var a=F().doc.getValue();return A.filter(function(b){return G(b)===
a}).fold(function(){return e.changed(a)},e.unchanged)},ui:m.ui,undo:b.constant(h.undo()),uploader:b.constant(h.uploader()),viewport:E})}});k("4y",[],function(){return"undo insert style emphasis align listindent format tools".split(" ")});k("6p",["33"],function(b){return b.immutable("x","y","width","height")});k("6m",["6p","1r"],function(b,d){return{intersect:function(c,a){var e=d.max(c.x(),a.x()),f=d.max(c.y(),a.y()),g=d.min(c.x()+c.width(),a.x()+a.width()),g=d.max(0,g-e),h=d.min(c.y()+c.height(),
a.y()+a.height()),h=d.max(0,h-f);return b(e,f,g,h)}}});k("qx",["b","4g"],function(b,d){var c=d.generate([{unbundled:[]},{unsupported:["message"]},{item:["info","blueprint"]},{customMenu:["info","groups","blueprint"]},{textboxMenu:["info","blueprint"]},{palette:["info","children","blueprint"]}]);return{create:function(a){var d=function(a,b){return a.feature.fold(function(){return void 0!==a.unsupported?[c.unsupported(a.unsupported)]:[c.unbundled()]},function(c){if(void 0===c[a.command])return console.warn("unknown command: "+
a.command),[];c=c[a.command]();return[b(c)]})},f=function(a,f){return d(f,function(d){return b.contains(["widget","inline-widget","split-widget"],f.type)?c.item({instance:d.widget},a[f.type]):c.item(d[f.type](),a[f.type])})},g={dropdown:f,general:f,widget:f,"split-widget":f,"inline-widget":f,palette:function(a,f){return d(f,function(d){d=d.palette();var e=b.map(d.items,function(d){return b.contains(["widget","inline-widget","split-widget"],d.type)?c.item({instance:d.build},a[d.type]):c.item(d.spec,
a[d.type])});return c.palette(d,e,a.palette)})},submenu:function(d,e){var f=b.map(e.commands,a);return[c.customMenu(e,f,d.menu)]},menu:function(a,b){return d(b,function(d){return c.textboxMenu(d[b.type](),a[b.type])})}};return{classify:function(a,b){var c=g[b.type];return void 0!==c?c(a,b):[]}}},cata:function(a,b,c,d,h,l,m){return a.fold(b,c,d,h,l,m)}}});k("ix",["qx","b","7"],function(b,d,c){return{fromConfig:function(a,e,f){var g=function(a,b){var e=c.curry(h.classify,a),e=d.bind(b.items,e);return{category:b.category,
books:e}};a=c.curry(g,a);e=c.curry(g,e);var h=b.create(e);return d.map(f,a)}}});k("6w",["48"],function(b){return{resolve:b.create("ephox-chameleon").resolve}});k("x2",["2l"],function(b){return{show:function(d){b.remove(d,"display")},hide:function(d){b.set(d,"display","none")},isShowing:function(d){return b.getRaw(d,"display").isNone()},isHiding:function(d){return b.getRaw(d,"display").is("none")}}});k("qz",["4v"],function(b){return{group:b.ensure(["component","isVisible","refreshUi","destroy"])}});
k("qy","6w x2 qz b 1x l 35".split(" "),function(b,d,c,a,e,f,g){return function(h){var l=f.fromTag("span");e.add(l,b.resolve("toolbar-group"));var m=a.map(h,function(a){return a.component()});g.append(l,m);return c.group({component:function(){return l},isVisible:function(){return a.exists(m,d.isShowing)},refreshUi:function(){a.each(h,function(a){a.refreshUi()})},destroy:function(){a.each(h,function(a){a.destroy()})}})}});k("iy","qy qz b 6 7 4x 3z".split(" "),function(b,d,c,a,e,f,g){return{menu:function(b,
d){var m=g.create({done:f([]),abort:f(["item"])}),n=function(b){b.done.bind(function(){m.trigger.done()});b.abort.bind(function(a){m.trigger.abort(a.item())});return a.merge(b,{done:m.registry.done,abort:m.registry.abort})},p=c.foldr(d,function(b,c){var d=a.merge(c.structure(),b.structures),e=c.submenus().concat(b.submenus),f=a.merge(c.handlers(),b.actions),g=[c.refreshMenu].concat(b.refreshMenu),h=[c.destroyer].concat(b.destroyers),l=n(c.events);return{structures:d,submenus:e,refreshMenu:g,actions:f,
destroyers:h,events:l}},{structures:{},submenus:[],actions:{},refreshMenu:[],destroyers:[]});return{structure:e.constant(p.structures),init:function(a){c.each(p.refreshMenu,e.apply)},name:e.constant(b),handlers:e.constant(p.actions),submenus:e.constant(p.submenus),events:p.events,destroy:function(){c.each(p.destroyers,e.apply)}}},toolbar:function(a){a=b(a);var c=g.create({escaped:f([]),executed:f([])});return d.group({component:a.component,isVisible:a.isVisible,refreshUi:a.refreshUi,destroy:a.destroy,
events:c.registry})}}});k("j6",["6w","1x","2l","2y"],function(b,d,c,a){var e=function(a,e){d.add(a,b.resolve("user-icon"));c.setAll(a,{"background-image":"url("+e+")"})};return{setUrl:e,findAndSetUrl:function(b,c){a.descendant(b,".ephox-pastry-icon-content").each(function(a){e(a,c)})}}});k("e6",["b","1a","w"],function(b,d,c){var a=function(a){d.set(a,"aria-pressed","true")},e=function(a){d.set(a,"aria-pressed","false")};return{expanded:function(a){d.set(a,"aria-expanded","true")},collapsed:function(a){d.set(a,
"aria-expanded","false")},checked:function(a,b){d.set(a,"aria-checked",c(b))},press:a,release:e,pressed:function(b){(b.selected()?a:e)(b.element())},enable:function(a){d.set(a,"aria-disabled","false")},disable:function(a){d.set(a,"aria-disabled","true")},tabSelected:function(a,c){d.setAll(a,{"aria-selected":"true","aria-pressed":"true"});b.each(c,function(a){d.setAll(a,{"aria-selected":"false","aria-pressed":"false"})})},showPanel:function(a){d.set(a,"aria-selected","true");d.set(a,"aria-hidden",
"false")},hidePanel:function(a){d.set(a,"aria-selected","false");d.set(a,"aria-hidden","true")}}});k("r0",["e6","7"],function(b,d){var c=function(a){a.enable();b.enable(a.element())},a=function(a){a.disable();b.disable(a.element())};return{control:function(b){return{enable:d.curry(c,b),disable:d.curry(a,b)}},ariaPressed:function(a){return{press:d.curry(b.press,a.element()),release:d.curry(b.release,a.element())}}}});k("c1",["48"],function(b){return{resolve:b.create("ephox-echo").resolve}});k("7i",
"a b 1n c1 2w 7 1a 1x l 2m".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=a.resolve("aria-help"),p=a.resolve("aria-help-visible"),q=function(a,b){g.set(a,"aria-describedby",b)};return{document:function(a){g.set(a,"role","document")},presentation:function(a){g.setAll(a,{role:"presentation","aria-hidden":"true"})},controls:function(a,b){g.set(a,"aria-controls",b)},editor:function(a,b,t,u,v){g.setAll(a,{role:"application","aria-label":t});u.each(function(c){var d=l.fromTag("span");m.append(d,l.fromText(c));
c=e.generate("ephox-aria");g.set(d,"id",c);q(b,c);h.add(d,n);!0===v&&h.add(d,p);m.append(a,d)});var w={"aria-multiline":"true","aria-label":t,title:t};g.setAll(b,w);return{destroy:function(){var a=f.curry(g.remove,b);d.each(c.keys(w),a);a("aria-describedby")}}},toolbar:function(a,b){g.setAll(a,{role:"group","aria-label":b})},toolbarGroup:function(a,c){g.set(a,"role","toolbar");null===c||void 0===c||""===c||b.isArray(c)&&0===c.length||g.set(a,"aria-label",c)},toolbarButton:function(a,b,c,d){g.setAll(a,
{role:"button","aria-label":b,"aria-haspopup":""+c});d&&g.set(a,"aria-pressed","false");c&&g.set(a,"aria-expanded","false")},menu:function(a,b){g.setAll(a,{role:"menu","aria-label":b})},menuItem:function(a,b,c){g.setAll(a,{role:"menuitem","aria-label":b,"aria-haspopup":!0===c?"true":"false"})},menuItemCheckbox:function(a,b){g.setAll(a,{role:"menuitemcheckbox","aria-label":b,"aria-checked":!1})},checkbox:function(a,b){g.setAll(a,{role:"checkbox","aria-label":b,"aria-checked":!1})},dialog:function(a,
b){g.setAll(a,{role:"dialog","aria-label":b})},button:function(a,b){g.setAll(a,{"aria-label":b,role:"button"})},textarea:function(a){g.setAll(a,{"aria-multiline":"true",role:"textbox"})},label:function(a,b){g.set(a,"aria-label",b)},widget:function(a){g.set(a,"role","widget")},listBox:function(a){g.set(a,"role","listbox")},live:function(a,b,c){g.setAll(a,{"aria-live":c?c:"polite",id:b})},tabList:function(a){g.set(a,"role","tablist")},tabButton:function(a,b){g.setAll(a,{"aria-label":b,role:"tab"})},
tabPanel:function(a){g.setAll(a,{role:"tabpanel"})},linkTabToPanel:function(a,b){var c=e.generate("ephox-aria");g.set(b,"id",c);g.setAll(a,{"aria-controls":c,"aria-owns":c})},describedBy:q,labelledBy:function(a,b){g.set(a,"aria-labelledby",b)},required:function(a){g.set(a,"aria-required","true")},hidden:function(a,b){g.set(a,"aria-hidden",b)}}});k("r1",["1a","2l","3n"],function(b,d,c){return{disable:function(a){b.set(a,"unselectable","on");d.setAll(a,{"-webkit-user-select":"none","user-select":"none",
"-ms-user-select":"none"});a.dom().style.setProperty("-moz-user-select","-moz-none");return c.bind(a,"onselectstart",function(){return!1})}}});k("kb",["48"],function(b){return{resolve:b.create("ephox-pastry").resolve}});k("ka","r1 kb 4x 3z 1x 3n 2m 2o".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){e.add(l,d.resolve("button"));var n=b.disable(l),p=null,q=e.toggler(l,d.resolve("button-disabled")),r=function(){q.isOn()||t.trigger.click()},s=f.bind(l,"click",r),t=a.create({click:c([])});return{element:function(){return l},
name:function(){return m},destroy:function(){s.unbind();n.unbind();h.remove(l)},content:function(a){null!==p&&h.remove(p.element());g.append(l,a.element());p=a},enable:q.off,disable:q.on,disabled:q.isOn,click:r,events:t.registry}}});k("g9",["ka","kb","1x","l"],function(b,d,c,a){return function(e){var f=a.fromTag("span");c.add(f,d.resolve("independent-button"));return b(f,e)}});k("ga",["kb","43","l","2o"],function(b,d,c,a){return function(e){var f=c.fromTag("span");d.add(f,[b.resolve("icon-content")].concat(e));
return{element:function(){return f},destroy:function(){a.remove(f)}}}});k("nm","ka kb 1x 1b 3n l 2m 2o".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var m=f.fromTag("span");c.add(m,d.resolve("statebutton"));var n=b(f.fromTag("span"),l);c.add(n.element(),d.resolve("dependent-button"));g.append(m,n.element());var p=e.bind(m,"click",function(b){a.eq(m,b.target())&&(b.kill(),n.click())});l=c.toggler(m,d.resolve("statebutton-selected"));var q=c.toggler(m,d.resolve("statebutton-disabled"));return{element:function(){return m},
destroy:function(){p.unbind();n.destroy();h.remove(m)},name:n.name,content:n.content,enable:function(){q.off();n.enable()},disable:function(){q.on();n.disable()},disabled:function(){return q.isOn()&&n.disabled()},click:n.click,events:n.events,select:l.on,deselect:l.off,selected:l.isOn}}});k("kc",["nm","4x","3z"],function(b,d,c){return function(a){var e=b(a),f=c.create({click:d([])}),g=function(){e.selected()?e.deselect():e.select();f.trigger.click()};e.events.click.bind(g);return{element:e.element,
name:e.name,content:e.content,destroy:function(){e.events.click.unbind(g);e.destroy()},enable:e.enable,disable:e.disable,disabled:e.disabled,click:e.click,events:f.registry,select:e.select,deselect:e.deselect,selected:e.selected}}});k("r2","g9 ga kc kb 4x 3z 1x l 2m 35 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p){var q=h.fromTag("span");g.add(q,a.resolve("dropbutton"));var r=h.fromTag("span");g.add(r,a.resolve("dropbutton-button"));var s=h.fromTag("span");g.add(s,a.resolve("dropbutton-arrow"));
m.append(q,[r,s]);var t=b(),u=c();u.content(d(["ephox-pastry-arrow-icon"]));l.append(r,t.element());l.append(s,u.element());var v=f.create({click:e([]),open:e([]),close:e([])}),w=function(){v.trigger.click()},x=function(){(u.selected()?v.trigger.open:v.trigger.close)()};t.events.click.bind(w);u.events.click.bind(x);return{element:function(){return q},name:function(){return p},content:t.content,events:v.registry,open:function(){u.select();v.trigger.open()},close:function(){u.deselect();v.trigger.close()},
destroy:function(){t.events.click.unbind(w);u.events.click.unbind(x);t.destroy();u.destroy();n.remove(q)},isOpen:function(){return u.selected()}}}});k("r3","ga kc kb 7 4x 3z 1x l 2m 35 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p){var q=h.fromTag("span");g.add(q,c.resolve("dropbutton"));var r=h.fromTag("span");g.add(r,c.resolve("dropbutton-button"));var s=h.fromTag("span");g.add(s,c.resolve("dropbutton-arrow"));m.append(q,[r,s]);var t=d(),u=d();u.content(b(["ephox-pastry-arrow-icon"]));
l.append(r,t.element());l.append(s,u.element());var v=f.create({click:e([]),open:e([]),close:e([])}),w=function(){v.trigger.click()},x=function(){(u.selected()?v.trigger.open:v.trigger.close)()};t.events.click.bind(w);u.events.click.bind(x);return{element:a.constant(q),name:a.constant(p),content:t.content,events:v.registry,open:function(){u.select();v.trigger.open()},close:function(){u.deselect();v.trigger.close()},destroy:function(){t.events.click.unbind(w);u.events.click.unbind(x);t.destroy();u.destroy();
n.remove(q)},isOpen:function(){return u.selected()},click:t.click,enable:t.enable,disable:t.disable,disabled:t.disabled,select:t.select,deselect:t.deselect,selected:t.selected}}});k("dd",["kb","1x","l","2m","2o"],function(b,d,c,a,e){return function(f){var g=c.fromTag("span");d.add(g,b.resolve("text-content"));a.append(g,c.fromText(f));return{element:function(){return g},destroy:function(){e.remove(g)}}}});k("j7","r0 6w 7i g9 r2 r3 ga dd kc 7 s 1a 1x 35 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,
n,p,q,r,s){var t=function(a,d,e,f){c.toolbarButton(a.element(),d,e,f);d=b.control(a);e=b.ariaPressed(a);return{enable:d.enable,disable:d.disable,press:e.press,release:e.release,destroy:function(){a.destroy()}}},u=function(a,b,c,e,f,l,m,q){m=n.from(m).fold(function(){return q(f)},function(a){return a(f,b)});l=n.from(l).getOr(!1);a=a(b);c=g([d.resolve("icon"),d.resolve(c)]);l=!0===l?[h(q(f)).element()]:[];r.append(c.element(),l);a.content(c);a.events.click.bind(function(){e()});p.set(a.element(),"title",
m);a.initAria=t;return a},v=function(a,b,c,e,f,g,h,l){a=u(a,b,c,e,f,g,h,l);q.add(a.element(),d.resolve("split-"+b));s.descendant(a.element(),".ephox-pastry-dropbutton-arrow .ephox-pastry-icon-content").bind(function(a){q.add(a,d.resolve("icon"));q.add(a,d.resolve("arrow-"+b))});return a};return{aria:t,typical:function(b,c,d,e,f,g,h){return u(a,b,c,d,e,f,g,h)},toggle:function(a,b,c,d,e,f,g){return u(l,a,b,c,d,e,f,g)},splitToggle:function(a,b,c,d,e,g,h){return v(f,a,b,c,d,e,g,h)},split:function(a,b,
c,d,f,g,h){return v(e,a,b,c,d,f,g,h)}}});k("j8",["48"],function(b){return{resolve:b.create("ephox-gopher").resolve}});k("r4",["j8","s","1x","46","2y"],function(b,d,c,a,e){return function(f){var g=b.resolve(f);return{set:function(a){c.add(a,g)},up:function(a){return c.has(a,g)?d.some(a):e.ancestor(a,"."+g)},all:function(b){return a.descendants(b,"."+g)},first:function(a){return e.descendant(a,"."+g)},is:function(a){return c.has(a,g)}}}});k("j9",["j8","r4","1a","1x"],function(b,d,c,a){var e=d("item"),
f=b.resolve("disabled-item"),g="data-"+b.resolve("item-value");return{set:function(a,b){e.set(a);c.set(a,g,b)},get:function(a){return c.get(a,g)},up:e.up,all:e.all,disable:function(b){a.add(b,f)},enable:function(b){a.remove(b,f)},isEnabled:function(b){return!a.has(b,f)}}});k("ja","b j8 r4 j9 s 1a 1x 2y".split(" "),function(b,d,c,a,e,f,g,h){var l=c("menu"),m="data-"+d.resolve("menu-value"),n=d.resolve("active-menu");return{set:function(a,b){l.set(a);f.set(a,m,b)},active:function(a){return h.descendant(a,
"."+n)},inactive:function(a){a=l.all(a);return b.filter(a,function(a){return!g.has(a,n)})},activate:function(a,c){var d=l.all(a);b.each(d,function(a){g.remove(a,n)});g.add(c,n)},up:l.up,all:l.all,submenu:function(b,c,d){d=a.get(d);return(c.hasOwnProperty(d)?e.from(c[d]):e.none()).bind(function(a){return h.descendant(b,"["+m+'="'+a+'"]')})}}});k("jb",["r4","7"],function(b,d){var c=b("submenu"),a=b("main-menu");return{main:d.constant(a),submenu:d.constant(c)}});k("fi","b j8 j9 ja jb 7 1a 1x l 2m 35".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a,b,d){c.set(d,b);g.set(d,"tabindex",-1);return d},q=function(a,b,c){return r(a,b,c,!1)},r=function(a,b,c,e){var f=l.fromTag("li",a.dom()),g=l.fromTag("span");h.add(g,d.resolve("item-text"));!0===e&&h.add(g,d.resolve("item-ellipsis"));m.append(g,l.fromText(c));m.append(f,g);p(a,b,f);return f},s=function(a){a=l.fromTag("li",a.dom());h.add(a,d.resolve("separator"));return a},t=function(a,b){return"-"!==b.value()?q(a,b.value(),b.text()):s(a)},u=function(c,
d,e){var g=l.fromTag("ol",c.dom());a.set(g,d);c=b.map(e,f.curry(t,c));n.append(g,c);return g},v=function(b,c){var d=l.fromTag("div",b.dom());a.set(d,c);return d};return{item:q,ellipsisItem:function(a,b,c){return r(a,b,c,!0)},mainmenu:function(a,b,c){a=u(a,b,c);e.main().set(a);return a},submenu:function(a,b,c){a=u(a,b,c);e.submenu().set(a);return a},widget:v,widgetSubmenu:function(a,b){var c=v(a,b);e.submenu().set(c);return c},separator:s,custom:p,enableItem:c.enable,disableItem:c.disable}});k("jc",
[],function(){var b=function(b,c){if(void 0===b)throw"Cannot intersperse undefined";if(1>=b.length)return b;var a=[];a.push(b[0]);for(var e=1;e<b.length;e++)a.push(c()),a.push(b[e]);return a};return{intersperse:function(d,c){return b(d,function(){return c})},intersperseThunk:b,untabulate:function(b){var c=[],a;for(a in b)if(Object.prototype.hasOwnProperty.call(b,a))for(var e=b[a],f=0;f<e.length;f++){var g=e[f];c[f]=c[f]||{};c[f][a]=g}return c},tabulate:function(b){for(var c={},a=0;a<b.length;a++){var e=
b[a],f;for(f in e)if(Object.prototype.hasOwnProperty.call(e,f)){var g=e[f];Object.prototype.hasOwnProperty.call(c,f)||(c[f]=[]);c[f][a]=g}}return c}}});k("r5",[],function(){return{css:function(b){var d=/^[a-zA-Z]/.test(b)?"":"e";b=b.replace(/[^\w]/gi,"-");return d+b}}});k("r6",["b"],function(b){return{splits:function(d,c){if(0===c.length)return[d];var a=b.foldl(c,function(a,b){if(0===b)return a;var c=d.substring(a.prev,b);return{prev:b,values:a.values.concat([c])}},{prev:0,values:[]}),e=c[c.length-
1];return e<d.length?a.values.concat(d.substring(e)):a.values}}});k("jd",["r5","r6"],function(b,d){return{cssSanitise:function(c){return b.css(c)},splits:function(b,a){return d.splits(b,a)}}});k("bh","iy j6 j7 a b 7i fi jc 7 s jd l 35 q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a,c){var d=e.flatten(c);return b.menu(a,d)},t=function(a){return e.map(a,function(a){a=e.map(a,function(a){return a.items()});return e.flatten(a)})};return{create:function(b,v,w){var x=b.name,y=b.textkey,
k=b.tooltip,z=b.label,A=m.from(b.icon),C=l.constant(void 0!==b.contentFocus?b.contentFocus:!1),D=p.fromDom(r),E=a.isString(y)?n.cssSanitise(x):x,F=w(y),G=g.mainmenu(D,E+"-menu",[]),I=c.toggle(x,E,l.identity,y,z,k,w);A.filter(a.isString).each(function(a){d.findAndSetUrl(I.element(),a)});var H=I.initAria(I,F,!0,b.toggle);b=t(v);var L=s(E,v);v=h.intersperseThunk(b,function(){return[g.separator(D)]});f.menu(G,F);q.append(G,e.flatten(v));return{button:l.constant(I),contentFocus:C,destroy:function(){I.destroy();
L.destroy();H.destroy()},element:l.constant(G),events:L.events,handlers:L.handlers,icon:l.constant(A),init:L.init,label:l.constant(F),name:L.name,structure:L.structure,submenus:L.submenus,textkey:l.constant(y),updateMenu:l.noop,enable:H.enable,disable:H.disable}}}});k("iz",["qx","bh","b","7","s"],function(b,d,c,a,e){var f=function(a,b){return e.some(b(a))},g=function(a,b){return e.some(b(a,[]))},h=function(l,m){var n=a.curry(h,l);return b.cata(m,e.none,e.none,f,function(a,b,f){b=c.map(b,function(a){return c.bind(a.books,
n)});a=d.create(a,b,l);return e.some(f(a,[]))},g,function(a,b,d){b=c.bind(b,n);return e.some(d(a,b))}).toArray()};return{build:function(a,b){return{items:c.bind(a.books,function(a){return h(b,a)}),category:a.category}}}});k("b8",["ix","iy","iz","b","7i"],function(b,d,c,a,e){return{build:function(f,g,h){var l=h.translations();f=b.fromConfig(g.toolbar(),g.menu(),f);f=a.map(f,function(a){return c.build(a,l)});return a.map(f,function(a){var b=d.toolbar(a.items);a=a.category;e.toolbarGroup(b.component(),
l(a));return b})}}});k("b9",["33"],function(b){var d=b.immutable("toolbar","menu");b=b.immutable("smartview","translations");var c=function(a){return function(){return a.apply(null,arguments)}};return{blueprints:c(d),env:c(b)}});k("em","30 4x 3z 1x 43 3n l 2m 35 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n,p){var q=void 0!==p?p:"info",r=g.fromTag("div");e.add(r,[b.resolve("banner"),b.resolve("banner-"+q)]);q=g.fromTag("div");a.add(q,b.resolve("banner-message"));h.append(q,g.fromText(n));
var s=g.fromTag("div");a.add(s,b.resolve("banner-buttons"));var t=g.fromTag("span");a.add(t,b.resolve("banner-close"));h.append(s,t);l.append(r,[q,s]);var u=f.bind(t,"click",function(){v.trigger.close()}),v=c.create({close:d([])});return{element:function(){return r},action:function(a){h.prepend(s,a.element())},destroy:function(){u.unbind();m.remove(r)},events:v.registry}}});k("ba","7 s em 1a 3n l 2m 31".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var m=l.description();l=l.link();var n=
c(m,"error"),p=d.none(),q=function(a,b){return e.bind(a,"click",function(){h.open(b.url())})},m=function(c){var e=f.fromTag("a");a.set(e,"href",c.url());a.set(e,"target","_blank");var h=f.fromText(c.text());p=d.some(q(e,c));g.append(e,h);n.action({element:b.constant(e)})};null!==l&&l.url()&&l.text()&&m(l);return{element:n.element,action:n.action,destroy:function(){n.destroy();p.each(function(a){a.unbind()})},events:n.events}}});k("rb",["4v"],function(b){return{dropdown:b.exactly("enable disable select clear selectElement populate tick untick activate deactivate".split(" ")),
menu:b.exactly(["enable","disable"]),general:b.exactly("enable disable select deselect selected element".split(" ")),widget:b.exactly("enable disable select deselect press release".split(" ")),palette:b.exactly(["show","hide"])}});k("x3",["fi","l","2m"],function(b,d,c){return{generateItem:function(a,e,f,g){return f.fold(function(){return b.item(a,e.value(),g(e.textkey()))},function(f){f=f(e);var g=d.fromTag("li",a.dom());c.append(g,f);return b.custom(a,e.value(),g)})},generateSeparator:function(a,
e,f){var g=b.separator(a);c.append(g,d.fromText(f(e),a.dom()));return g}}});k("x4","a b e6 kb 7 s 1a 1x 46 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a,b){var c=d.find(a,function(a){return a.value()===b});return f.from(c)},p=function(a){a=l.children(a,".ephox-pastry-toggle-list-item-selected");d.each(a,function(a){h.remove(a,"ephox-pastry-toggle-list-item-selected");c.checked(a,!1)})};return{updateDropdown:function(c,d,g,l,m){d.fold(c.clear,e.noop,function(d){m.fold(function(){(b.isString(d)?
n(l,d):f.some(d)).each(c.select)},function(b){b=b(d);var e=a.resolve("arrow-righticon");h.add(b,e);c.selectElement(b)})});g.fold(c.disable,e.noop,c.enable)},tick:function(a,b){p(a);var e=l.descendants(a,".ephox-gopher-item"),e=d.find(e,function(a){return g.get(a,"data-ephox-gopher-item-value")===b});void 0!==e&&null!==e&&(h.add(e,"ephox-pastry-toggle-list-item-selected"),c.checked(e,!0))},untick:p,activate:function(a){h.add(a,"ephox-pastry-statebutton-selected")},deactivate:function(a){h.remove(a,
"ephox-pastry-statebutton-selected")}}});k("ra",["e6","fi","kb","7","1x"],function(b,d,c,a,e){var f=c.resolve("toggle-list-item-selected"),g=function(a){d.enableItem(a);b.enable(a)},h=function(a){d.disableItem(a);b.disable(a)},l=function(a){e.remove(a,f);b.checked(a,!1)},m=function(a){e.add(a,f);b.checked(a,!0)};return{control:function(b){return{enable:a.curry(g,b),disable:a.curry(h,b)}},selected:function(b){return{deselect:a.curry(l,b),select:a.curry(m,b),selected:a.curry(e.has,b,f)}}}});k("rc",
["j6","a","43","2l","l"],function(b,d,c,a,e){var f=function(a){var b=e.fromTag("span");c.add(b,["ephox-pastry-icon-content","ephox-chameleon-icon"].concat([a]));return[b]},g=function(a){var d=e.fromTag("span");c.add(d,["ephox-pastry-icon-content","ephox-chameleon-"+a.value]);b.setUrl(d,a.icon);return[d]},h=function(a){return f(!0===a.icon?"ephox-chameleon-"+a.value:a.icon)};return{generate:f,generateFrom:function(a){return void 0===a.icon?[]:(d.isString(a.icon)?g:h)(a)}}});k("9m","2w c 7 1a 2l l 2m 2o 29 3m".split(" "),
function(b,d,c,a,e,f,g,h,l,m){var n=d.detect().browser.isFirefox(),p={position:"absolute",left:"-9999px"},q=function(a,b){var c=f.fromTag("span",a.dom()),d=f.fromText(b,a.dom());g.append(c,d);return c},r=function(c,d){var e=b.generate("ephox-echo-voice");a.set(d,"id",e);a.set(c,"aria-describedby",e)},s=function(b,c,d){var f=l.owner(c),s=q(f,d);n&&r(c,s);a.setAll(s,b(d));e.setAll(s,p);g.append(c,s);m(function(){a.remove(s,"aria-live");h.remove(s)},1E3)};d=c.curry(s,function(a){return{"aria-live":"polite",
"aria-atomic":"true","aria-label":a}});c=c.curry(s,c.constant({"aria-live":"assertive","aria-atomic":"true",role:"alert"}));return{describe:function(a,b){var c=l.owner(a),c=q(c,b);e.set(c,"display","none");r(a,c);return c},speak:d,shout:c,tokenSelector:function(){return'span[id^="ephox-echo-voice"]'}}});k("x5","ra rc 6w 7i 9m fi 7 4x 3z 1x l 2m 35 2o 2y q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){var u=n.fromDom(t),v=c.resolve("label-default");return function(t,x){var y=l.create({populate:h(["items"])}),
k=function(b){var e=t(b.textkey),g=f.item(u,b.name+"-menu-trigger",e);m.add(g,c.resolve("menu-more"));b=d.generate("ephox-chameleon-"+b.name);q.prepend(g,b);a.menuItem(g,e,!0);return g}(x),z=function(a){a=n.fromText(a);A(a)},A=function(a){s.child(k,".ephox-gopher-item-text").each(function(b){r.empty(b);p.append(b,a);m.remove(b,v)})},C=b.control(k);return{element:g.constant(k),populate:function(a){y.trigger.populate(a)},select:function(a){s.child(k,e.tokenSelector()).each(r.remove);var b=e.describe(k,
x.describe(a));p.append(k,b);a=t(a.textkey());z(a)},selectElement:A,disable:C.disable,enable:C.enable,clear:function(){z(t(x.textkey));s.child(k,".ephox-gopher-item-text").each(function(a){m.add(a,v)})},destroy:function(){r.remove(k)},events:y.registry}}});k("r7","rb x3 x4 x5 b 7i fi j8 7 4x 3z 1a 1x l 35 2o q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){var v=r.fromDom(u),w="data-"+h.resolve("item-value"),x=function(a){a=g.submenu(v,a+"-menu",[]);q.remove(a,"ephox-gopher-main-menu");q.add(a,
"ephox-gopher-submenu");return a},y=function(a,b){var c=p.get(b,"data-ephox-gopher-menu-value"),d={};d[a.name+"-menu-trigger"]=c;return d};return{init:function(g,h){var q=x(h.name);f.menu(q,g(h.textkey,!1));var r=y(h,q),u=a(g,h),k=function(a){a=e.bind(a,function(a){var b=e.map(a.items(),function(a){var b=d.generateItem(v,a,h.render,g);f.menuItemCheckbox(b,g(a.textkey()),!1);return b});return a.label().fold(l.constant(b),function(a){return[d.generateSeparator(v,a,g)].concat(b)})});t.empty(q);s.append(q,
a)},F=n.create({done:m([]),abort:m(["item"])}),G={};e.each(h.values,function(a){G[a.value()]=function(a){a=p.get(a,w);h.action(a);F.trigger.done()}});u.events.populate.bind(function(a){k(a.items())});return{items:l.constant([u.element()]),structure:l.constant(r),submenus:l.constant([q]),refreshMenu:function(){h.updateDropdown(b.dropdown({enable:u.enable,disable:u.disable,select:u.select,clear:u.clear,selectElement:u.selectElement,populate:u.populate,tick:l.curry(c.tick,q),untick:l.curry(c.untick,
q),activate:l.noop,deactivate:l.noop}))},destroyer:function(){u.destroy()},handlers:l.constant(G),events:F.registry}}}});k("r8","ra rb rc 6w 7i fi 7 4x 3z 1x l 35 q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=n.fromDom(q);return{init:function(a,m){var n=a(m.textkey),q=(!0===m.hasDialog?f.ellipsisItem:f.item)(r,m.value,n),w=b.control(q),x=!0===m.toggle?b.selected(q):{select:g.noop,deselect:g.noop,selected:g.constant(!1)};(!0===m.toggle?e.menuItemCheckbox:e.menuItem)(q,n,!1);var y=function(){m.updateGeneral(d.general({disable:w.disable,
enable:w.enable,select:x.select,deselect:x.deselect,selected:x.selected,element:g.constant(q)}))},k=l.create({done:h([]),abort:h(["item"])}),n={};n[m.value]=function(){k.trigger.done();m.action();y()};var z=c.generateFrom(m);p.prepend(q,z);return{items:g.constant([q]),structure:g.constant({}),submenus:g.constant([]),refreshMenu:y,handlers:g.constant(n),destroyer:g.identity,events:k.registry}}}});k("r9","ra j6 rc 6w 7i fi 6 7 1a 1x l 35 q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=n.fromDom(q),
s=function(b){return{submenu:function(a){var c=a.textkey();a=a.element();e.menu(a,b(c));m.remove(a,"ephox-gopher-main-menu");m.add(a,"ephox-gopher-submenu");return a},item:function(c){var d=c.textkey(),d=b(d);c=f.item(r,c.name()+"-menu-trigger",d);m.add(c,a.resolve("menu-more"));e.menuItem(c,d,!0);return c}}};return{nested:function(a,e,f){f=s(a);a=f.submenu(e);var m=l.get(a,"data-ephox-gopher-menu-value");f=f.item(e);var n={};n[e.name()+"-menu-trigger"]=m;var m=g.merge(n,e.structure()),q=c.generate("ephox-chameleon-"+
e.name());p.prepend(f,q);e.icon().each(function(a){0<q.length&&d.setUrl(q[0],a)});var r=b.control(f),n=void 0!==e.destroyer?e.destroyer:void 0!==e.destroy?e.destroy:h.noop;return{items:h.constant([f]),structure:h.constant(m),submenus:h.constant([a].concat(e.submenus())),refreshMenu:function(){e.updateMenu({enable:r.enable,disable:r.disable})},destroyer:n,handlers:e.handlers,events:e.events}}}});k("jf","ra rb rc 6w 7i fi 7 4x 3z 40 1x 43 1b l 2v 2m 35 32 q".split(" "),function(b,d,c,a,e,f,g,h,l,m,
n,p,q,r,s,t,u,v,w){var x=r.fromDom(w),y=a.resolve("menu-widget"),k=function(a,b){var c=f.widgetSubmenu(x,b);t.append(c,a.element());p.add(a.element(),[y,"ephox-gopher-item"]);return c},z=function(b,d,e){b=b(d.textkey());b=f.item(x,e,b);n.add(b,a.resolve("menu-more"));e=c.generate(a.resolve(e));u.prepend(b,e);return b};w=function(a,c){var f=c.instance(),n=f.name(),p=n+"-submenu",q=k(f,p),r=z(a,f,n);e.menu(q,a(f.textkey()));e.menuItem(r,a(f.textkey()),!0);var s=b.control(r),u={};u[n]=p;var t=l.create({done:m([],
f.events.done),abort:h(["item"])});f.events.abort.bind(function(){t.trigger.abort(r)});return{items:g.constant([r]),structure:g.constant(u),submenus:g.constant([q]),refreshMenu:function(){f.updateWidget(d.widget({enable:s.enable,disable:s.disable,select:g.noop,deselect:g.noop,press:g.noop,release:g.noop}))},destroyer:f.destroy,handlers:g.constant({}),events:t.registry}};return{widget:w,inline:function(c,p){var u=p.instance(),w=u.name();n.add(u.element(),a.resolve("menu-inline-widget"));var y=r.fromTag("li");
t.append(y,u.element());var k=f.custom(x,w,y),B=b.control(k);e.menuItem(k,c(u.textkey()),!1);y={};y[w]=function(a){var b=s.active().filter(function(b){return v.ancestor(b,g.curry(q.eq,a))});u.element().dom().click();b.each(s.focus)};var z=l.create({done:m([],u.events.done),abort:h(["item"])});u.events.abort.bind(function(){z.trigger.abort(k)});return{items:g.constant([k]),structure:g.constant({}),submenus:g.constant([]),refreshMenu:function(){u.updateInlineWidget(d.widget({enable:B.enable,disable:B.disable,
select:g.noop,deselect:g.noop,press:g.noop,release:g.noop}))},destroyer:u.destroy,handlers:g.constant(y),events:z.registry}},split:w,styles:g.constant(y)}});k("jk","6w s 1x 2l 3n l 2m 2y m".split(" "),function(b,d,c,a,e,f,g,h,l){var m=b.resolve("keyfocus"),n=function(b,d){var h=f.fromTag("span");a.set(h,"display","none");c.add(h,m);g.append(b,h);return e.bind(h,"click",function(a){d();a.kill()})};return{onButton:function(a){return n(a.element(),a.click)},custom:n,trigger:function(a){var b="."+m;a=
l.is(a,b)?d.some(a):h.descendant(a,b);a.each(function(a){a.dom().click()});return a}}});k("x6","6w b 4d 7 s 4x 3z 33 1x 2l 2o q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(p){l.add(p,b.resolve("card-layout-main"));var r=e.none(),s=e.none(),t=h.immutable("key","element"),u=c(),v=g.create({onActiveMenuChange:f(["activeMenu","lastActiveMenu"]),onItemBack:f(["activeMenu","lastActiveMenu"]),reveal:f(["item","trigger"])}),w=function(a){return u.get(a)},x=function(a){a=t(a,u.get(a));k(a,
r);s=r;r=e.some(a);v.trigger.onActiveMenuChange(a,s)},y=function(a,b){x(a);r.bind(function(a){v.trigger.reveal(a,b)})},k=function(a,b){var c=b.exists(function(a){return a.key()});d.each(u.keys(),function(b){var d=a.key()===b||c===b?"block":"none";m.set(w(b),"display",d)})},z=function(){u.reset();r=e.none();n.empty(p)};return{element:a.constant(p),addItem:function(a,b){u.put(a,b)},getItem:w,getActiveItem:function(){return r},clear:z,open:x,reveal:y,back:function(a,b){y(a,b);r.bind(function(a){v.trigger.onItemBack(a,
s)})},events:v.registry,destroy:z}}});k("x7","6w fi 7 1x l 2m q".split(" "),function(b,d,c,a,e,f,g){var h=e.fromDom(g);return function(g){var m=function(){var c=d.item(h,"card-back-button",g("toolbar.backbutton")),e=d.submenu(h,"menu-back",[]);a.add(c,b.resolve("card-layout-back"));a.add(c,b.resolve("icon"));f.append(e,c);return e},n=function(c){var d=e.fromTag("div");a.add(d,b.resolve("card-layout"));f.append(d,c);return d};return{child:function(c){c=n(c);a.add(c,b.resolve("card-layout-child"));
f.prepend(c,m());return c},parent:function(c){c=n(c);a.add(c,b.resolve("card-layout-root"));return c},getBackAttr:c.constant("card-back-button")}}});k("64",["2l","3o"],function(b,d){var c=d("height",function(a){return a.dom().offsetHeight});return{set:function(a,b){c.set(a,b)},get:function(a){return c.get(a)},getOuter:function(a){return c.getOuter(a)},setMax:function(a,d){var f=c.max(a,d,"margin-top border-top-width padding-top padding-bottom border-bottom-width margin-bottom".split(" "));b.set(a,
"max-height",f+"px")}}});k("x8",["2l","64","2p"],function(b,d,c){return{copy:function(a,e){var f=d.getOuter(a),g=c.getOuter(a);b.setAll(e,{height:f+"px",width:g+"px"})}}});k("x9",["7","s","1a"],function(b,d,c){var a=function(a,b){return d.from(c.get(b,a))};return{item:b.curry(a,"data-ephox-gopher-item-value"),menu:b.curry(a,"data-ephox-gopher-menu-value")}});k("xa","6w 33 1x 2l 64 2p".split(" "),function(b,d,c,a,e,f){var g=d.immutable("from","to"),h=b.resolve("left-animate"),l=function(b,d,l,q,r){r=
f.getOuter(l);var s=e.getOuter(d),t="left"===q?g("0px",-r+"px"):g("0px",r+"px");q="left"===q?g(r+"px","0px"):g(-r+"px","0px");c.remove(l,h);c.remove(d,h);a.set(d,"left",q.from());a.set(l,"left",t.from());a.set(l,"width",r+"px");a.reflow(l);c.add(l,h);c.add(d,h);a.set(l,"left",t.to());a.set(d,"left",q.to());a.set(b,"height",s+"px")};return{left:function(a,b,c,d){l(a,b,c,"left",d)},right:function(a,b,c,d){l(a,b,c,"right",d)}}});k("eb",["7","3d"],function(b,d){return function(c,a){return{southeast:b.constant(d(-c/
2,a)),southwest:b.constant(d(c,a)),northeast:b.constant(d(-c/2,-a)),northwest:b.constant(d(c,-a))}}});k("k4",["7","s"],function(b,d){var c=function(a,d){return a.view(d).fold(b.constant([]),function(b){var d=a.owner(b),d=c(a,d);return[b].concat(d)})};return{pathTo:function(a,b){var f=b.owner(a),f=c(b,f);return d.some(f)}}});k("k5",["s","l","29","q"],function(b,d,c,a){return{view:function(c){return(c.dom()===a?b.none():b.from(c.dom().defaultView.frameElement)).map(d.fromDom)},owner:function(a){return c.owner(a)}}});
k("bp","b 7 k4 k5 3d l 3e 28 q".split(" "),function(b,d,c,a,e,f,g,h,l){return{find:function(m){var n=f.fromDom(l),p=h.get(n);return c.pathTo(m,a).fold(d.curry(g.absolute,m),function(a){var c=g.viewport(m);a=b.foldr(a,function(a,b){var c=g.viewport(b);return{left:a.left+c.left(),top:a.top+c.top()}},{left:0,top:0});return e(a.left+c.left()+p.left(),a.top+c.top()+p.top())})}}});k("6q","bp 6p l 64 28 2p q 31".split(" "),function(b,d,c,a,e,f,g,h){return{absolute:function(c){var e=b.find(c),g=f.getOuter(c);
c=a.getOuter(c);return d(e.left(),e.top(),g,c)},view:function(){var a=h.innerWidth,b=h.innerHeight,f=c.fromDom(g),f=e.get(f);return d(f.left(),f.top(),a,b)}}});k("xb",["48"],function(b){return{resolve:b.create("ephox-repartee").resolve}});k("rp",["7","xb"],function(b,d){var c=d.resolve("caret-top-align"),a=d.resolve("caret-bottom-align"),e=d.resolve("caret-right-align"),f=d.resolve("caret-left-align"),g=d.resolve("caret-middle-align");return{east:b.constant(f),south:b.constant(c),west:b.constant(e),
north:b.constant(a),middle:b.constant(g),all:b.constant([c,a,f,e,g])}});k("rq",["33"],function(b){return b.immutable("x","y","bubble","anchors","label")});k("mh",["rp","rq"],function(b,d){var c=function(a,b){return a.y()-b.height()},a=function(a){return a.y()+a.height()},e=function(c,e,f){return d(c.x(),a(c),f.southeast(),[b.south(),b.east()],"layout-se")},f=function(c,e,f){e=c.x()-e.width();return d(e,a(c),f.southwest(),[b.south(),b.west()],"layout-sw")},g=function(a,e,f){return d(a.x(),c(a,e),f.northeast(),
[b.north(),b.east()],"layout-ne")},h=function(a,e,f){var g;g=a.x()-e.width();return d(g,c(a,e),f.northwest(),[b.north(),b.west()],"layout-nw")},l=function(a,e,f){var g;g=a.x()-e.width()/2;return d(g,c(a,e),f.northeast(),[b.north(),b.middle()],"layout-nm")},m=function(c,e,f){e=c.x()-e.width()/2;return d(e,a(c),f.southeast(),[b.south(),b.middle()],"layout-sm")};return{southeast:e,northeast:g,southwest:f,northwest:h,southmiddle:m,northmiddle:l,all:function(){return[e,f,g,h,m,l]},allRtl:function(){return[f,
e,h,g,m,l]}}});k("jj",["7","2l","64","1r"],function(b,d,c,a){var e=function(b,e){c.setMax(b,a.floor(e));d.setAll(b,{"overflow-x":"hidden","overflow-y":"auto"})},f=b.noop;return{anchored:b.constant(function(a,b,c,d){e(a,b?c:d)}),available:b.constant(function(a,b,c,d){e(a,d)}),expandable:b.constant(f)}});k("mi","7 bp 6p 6q 4g 33 3d 64 28 2p".split(" "),function(b,d,c,a,e,f,g,h,l,m){e=e.generate([{none:[]},{relative:["x","y"]},{fixed:["x","y","width","height"]}]);var n=f.immutable("position","left",
"top");return{none:e.none,relative:e.relative,fixed:e.fixed,reposition:function(a,b){return a.fold(function(){return n("absolute",b.x(),b.y())},function(a,c){return n("absolute",b.x()-a,b.y()-c)},function(a){return n("fixed",b.x(),b.y())})},viewport:function(b,d){return d.fold(function(){return b.fold(a.view,a.view,c)},function(a){return b.fold(a,a,c)})},toBox:function(a,e){var f=b.curry(d.find,e),f=a.fold(f,f,function(){var a=l.get();return d.find(e).translate(-a.left(),-a.top())}),g=m.getOuter(e),
n=h.getOuter(e);return c(f.left(),f.top(),g,n)},translate:function(a,c,d,e){var f=g(d,e);return a.fold(b.constant(f),b.constant(f),function(){var a=l.get();return f.translate(-a.left(),-a.top())})},cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("xc",["33"],function(b){return b.immutable("x","y","height","classes","label","layoutY")});k("rr","b 7 s xc 4g 1r".split(" "),function(b,d,c,a,e,f){var g=e.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),h=function(b,c,d,e){var h=
b.x()+b.bubble().left(),r=b.y()+b.bubble().top(),s=h>=e.x(),t=r>=e.y(),u=s&&t,v=h+c<=e.x()+e.width(),w=r+d<=e.y()+e.height(),v=v&&w;c=s?f.min(c,e.x()+e.width()-h):f.abs(e.x()-(h+c));e=t?f.min(d,e.y()+e.height()-r):f.abs(e.y()-(r+d));b=a(h,t?r:r+(d-e),e,b.anchors(),b.label(),r);return u&&v?g.fit(b):g.nofit(b,c,e)};return{attempts:function(c,e,n,p,q){var r=function(a,b,c,d){a=a(e,n,p);return h(a,n.width(),n.height(),q).fold(g.fit,function(a,e,f){return e>c||f>d?g.nofit(a,e,f):g.nofit(b,c,d)})},s=function(b){return a(f.max(0,
b.x()),b.y(),b.height(),b.classes(),b.label(),b.layoutY())};return b.foldl(c,function(a,b){var c=d.curry(r,b);return a.fold(g.fit,c)},g.nofit(a(e.x(),e.y(),n.height(),[],"none",e.y()),-1,-1)).fold(s,s)}}});k("mg","7 6q mh jj mi rp rr 3d 43 2l 64 2p".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=function(a,c,d){return b.constant(void 0===a[c]?d:a[c])},r=function(b){b=void 0!==b?b:{};return{bounds:q(b,"bounds",d.view()),origin:q(b,"origin",e.none()),preference:q(b,"preference",c.all()),maxHeightFunction:q(b,
"maxHeightFunction",a.anchored())()}};return{layout:function(a,c,d,e){m.remove(c.element(),"max-height");e=r(e);c={width:b.constant(p.getOuter(c.element())),height:b.constant(n.getOuter(c.element()))};return g.attempts(e.preference(),a,c,d,e.bounds())},setClasses:function(a,b){l.remove(a.element(),f.all());l.add(a.element(),b.classes())},setHeight:function(c,d,f,g,h){var l=r(g);g=l.bounds();var m=l.origin(),l=e.cata(m,b.constant(l.maxHeightFunction),b.constant(l.maxHeightFunction),a.anchored);c=f.y()-
h.southeast().top()<c.y();h=g.y()+g.height()-f.y();l(d.element(),c,f.height(),h)},position:function(a,b,c,d){c=e.reposition(d,c);m.set(a.panel(),"position",c.position());(b.isRtl()?a.positionRtl:a.positionLtr)(h(c.left(),c.top()))}}});k("rs",["rp","rq"],function(b,d){var c=function(a){return a.x()+a.width()},a=function(a,b){return a.y()-b.height()+a.height()},e=function(a,e,f){return d(c(a),a.y(),f.southeast(),[b.south(),b.east()],"link-layout-se")},f=function(a,c,e){c=a.x()-c.width();return d(c,
a.y(),e.southwest(),[b.south(),b.west()],"link-layout-sw")},g=function(e,f,g){return d(c(e),a(e,f),g.northeast(),[b.north(),b.east()],"link-layout-ne")},h=function(c,e,f){var g;g=c.x()-e.width();return d(g,a(c,e),f.northwest(),[b.north(),b.west()],"link-layout-nw")};return{southeast:e,northeast:g,southwest:f,northwest:h,all:function(){return[e,f,g,h]}}});k("jg","c 7 s eb mg mh rs mi 3d 3e 29 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=!b.detect().deviceType.isiOS(),r=function(a,b,d,f,g,
r,y){return function(k){var z,A;!0===q?A=h.fixed(0,0,p.innerWidth,p.innerHeight):(A=a(),A=n.offsetParent(A).map(m.absolute).getOr(l(0,0)),A=h.relative(A.left(),A.top()));var C=A;z=h.viewport(C,c.some(b));A=h.toBox(C,d());var D;D=g.isRtl()?[r.southwest,r.southeast,r.northwest,r.northeast]:[r.southeast,r.southwest,r.northeast,r.northwest];z={bounds:z,origin:C,preference:D,maxHeightFunction:y};D=e.layout(A,k,f,z);e.position(k,g,D,C);e.setClasses(k,D);e.setHeight(A,k,D,z,f)}};return{main:function(a,b,
c,e,g,h){a=r(a,b,c,e,g,f,h);return{recalculate:a,isAnchored:d.constant(!0),place:a}},submenu:function(b,c,e,f,h){b=r(b,c,e,a(3,-2),f,g,h);return{recalculate:b,isAnchored:d.constant(!0),place:b}}}});k("xd",["3d","2p"],function(b,d){return function(c){return{northwest:function(){return b(d.getOuter(c)-1,1)},northeast:function(){return b(-1,1)},southwest:function(){return b(d.getOuter(c)-1,-2)},southeast:function(){return b(-1,-2)}}}});k("je",["b","s","33"],function(b,d,c){var a=function(a){return function(b){return b.key()===
a}},e=c.immutable("key","value");return{put:function(c,d,h,l,m){var n=void 0!==l?l:e,p=void 0!==m?m:a(d);c=b.foldl(c,function(a,b){var c=p(b)?n(d,h):b;return{updated:p(b)||a.updated,acc:a.acc.concat([c])}},{updated:!1,acc:[]});return c.updated?c.acc:c.acc.concat([n(d,h)])},get:function(c,e,h){e=void 0!==h?h:a(e);c=b.find(c,e);return d.from(c)}}});k("jh",["b","2k"],function(b,d){return{triage:function(c){c=b.foldr(c,function(a,b){var c=d.inBody(b.menu());return{keep:c?[b].concat(a.keep):a.keep,throwaway:!1===
c?[b].concat(a.throwaway):a.throwaway}},{throwaway:[],keep:[]});b.each(c.throwaway,function(a){a.popup().destroy()});return c.keep}}});k("c2",["b","7","1b","32"],function(b,d,c,a){var e=function(b,e){return a.ancestor(b,d.curry(c.eq,e))};return{ancestor:e,anyAncestor:function(a,c){return b.exists(c,function(b){return e(a,b)})},sibling:function(b,e){return a.sibling(b,d.curry(c.eq,e))},child:function(b,e){return a.child(b,d.curry(c.eq,e))},descendant:function(b,e){return a.descendant(b,d.curry(c.eq,
e))}}});k("a3","b 7 1b 3n l c2 q".split(" "),function(b,d,c,a,e,f,g){return function(h,l,m){m=m||[e.fromDom(g)];var n=[],p=function(a){var b=l();a=a.target();c.member(a,b)||f.anyAncestor(a,b)||h()};return{on:function(){b.each(m,function(b){n.push(a.bind(b,"mousedown",p).unbind)})},off:function(){b.each(n,d.apply)},mousedown:p}}});k("9z",["7","2u","2l"],function(b,d,c){var a=function(a,f,g,h){var l=c.get(a,f);void 0===l&&(l="");g=l===g?h:g;l=b.curry(c.set,a,f,l);a=b.curry(c.set,a,f,g);return d(l,a,
!1)};return{toggler:function(b){return a(b,"visibility","hidden","visible")},displayToggler:function(b,c){return a(b,"display","none",c)},isVisible:function(a){a=a.dom();return!(0>=a.offsetWidth&&0>=a.offsetHeight)}}});k("rt","b c 6 kb 1x 2l l 2m 2o 2y m 29 9z 2p 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){var t=d.detect();return function(d){var s=c.merge({layerClass:null,zindex:null},d),w=g.fromTag("div");e.add(w,a.resolve("panel"));f.setAll(w,{position:"absolute",display:"none",top:"0px"});
s.zindex&&f.set(w,"z-index",s.zindex);s.layerClass&&e.add(w,s.layerClass);d=void 0!==d.container?d.container:m.first("body").getOrDie();h.append(d,w);d=q.displayToggler(w,"block");var x=function(){b.each(["top","bottom","right","left"],function(a){f.remove(w,a)})},y=function(){return f.preserve(w,function(){f.set(w,"right","0px");return r.get(w)})};return{element:function(){return w},destroy:function(){l.remove(w)},content:function(a){l.empty(w);h.append(w,a)},positionLtr:function(a){x();f.setAll(w,
{left:a.left()+"px",top:a.top()+"px"})},positionRtl:function(a){x();var b=t.browser.isIE()?y():r.get(w),c=function(){return p.defaultView(w).dom().innerWidth},d=function(){return f.getRaw(w,"position").is("fixed")?w.dom().ownerDocument.documentElement.clientWidth:p.offsetParent(w).orThunk(function(){var a=p.owner(w);return n.one("body",a)}).fold(c,r.get)}();f.setAll(w,{right:d-b-a.left()+"px",top:a.top()+"px"})},show:d.on,hide:d.off,toggle:d.toggle}}});k("m0",[],function(){return{create:function(){var b=
!1;return{isBlocked:function(){return b},block:function(){b=!0},unblock:function(){b=!1}}}}});k("m1",[],function(){return{create:function(b,d){return{control:b,instance:d}}}});k("dv",["m0","m1"],function(b,d){return{tap:function(c){var a=b.create();return d.create(a,function(){a.isBlocked()||c.apply(null,arguments)})}}});k("ji","6w a3 rt dv 4x 3z 1x 2l l 2m".split(" "),function(b,d,c,a,e,f,g,h,l,m){return{create:function(n){var p=f.create({open:e([]),close:e([]),uistale:e([])});if(void 0===n)throw"uicontainer not specified";
var q=c({layerClass:b.resolve("layer-menus"),container:n()}),r=l.fromTag("div");g.add(r,b.resolve("popup-container"));q.content(r);var s=!1;n=function(){s&&(u.off(),q.hide(),s=!1,v.control.block(),p.trigger.close())};var t=[r],u=d(n,function(){return t}),v=a.tap(function(){p.trigger.uistale()});v.control.block();return{element:function(){return r},panel:q.element,destroy:function(){q.hide();q.destroy();u.off()},open:function(){s||(v.control.unblock(),h.set(q.element(),"opacity","0"),q.show(),h.reflow(q.element()),
u.on(),s=!0,p.trigger.open(),h.set(q.element(),"opacity","1"))},close:n,closed:function(){return!s},mousedown:function(a){u.mousedown(a.original())},uiStale:function(){v.instance()},positionLtr:q.positionLtr,positionRtl:q.positionRtl,setContent:function(a){m.append(r,a)},setComponents:function(a){t=a.concat([r])},events:p.registry}}}});k("bi","je jf jg jh ji b 7 jj 33 1b 2l 6e".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=l.immutable("menu","popup"),r=function(a){return function(b){return m.eq(b.menu(),
a)}};return function(l,m,u,v){var w=[],x=function(){var a=f.map(w,function(a){return a.popup().panel()}).concat(v);f.each(w,function(b){b.popup().setComponents(a)})},y=function(a){var c=b.get(w,a,r(a)).fold(function(){return z(a)},function(a){return a.popup()});x();w=b.put(w,a,c,q,r(a));return c},k=function(a){b.get(w,a,r(a)).each(function(a){a.popup().close()});n.set(a,"display","none")},z=function(a){var c=e.create(l);c.setContent(a);w=b.put(w,a,c,q,r(a));x();return c};return{initMenu:z,registerMenus:function(b){w=
a.triage(w);return f.map(b,y)},hideAll:function(){f.each(w,function(a){k(a.menu())})},hideMenu:k,expandMenu:function(a,b){var e=y(a),f=p.descendant(a,"."+d.styles())?h.expandable():h.anchored(),f=c.submenu(l,m,g.constant(b),u.uiDirection(),f);n.set(a,"display","block");e.open();f.recalculate(e);return{popup:e,anchorage:f}}}}});k("rn","b j8 j9 s 1x 2y".split(" "),function(b,d,c,a,e,f){var g=d.resolve("item-selected"),h=function(a,b){e.add(b,g)},l=function(a,b){e.remove(b,g)};return{is:function(a){return e.has(a,
g)},none:function(a){var d=c.all(a);b.each(d,function(b){l(a,b)})},selectAll:function(a,d){var f=c.all(a);b.each(f,function(a){e.remove(a,g)});b.each(d,function(a){e.add(a,g)})},select:h,deselect:l,selected:function(a){return f.descendant(a,"."+g)},first:function(b){var d=c.all(b);return a.from(d[0]).map(function(a){h(b,a);return a})},last:function(b){var d=c.all(b);return a.from(d[d.length-1]).map(function(a){h(b,a);return a})}}});k("rm","b rn j9 7 s 1b".split(" "),function(b,d,c,a,e,f){var g=function(d,
g){var h=c.all(d),l=b.findIndex(h,function(a){return f.eq(g,a)});return 0<=l?e.some({index:a.constant(l),all:a.constant(h)}):e.none()},h=function(a,b){return 0===b?a.length-1:b-1},l=function(a,b){return b===a.length-1?0:b+1},m=function(a,b,c){return g(a,b).map(function(e){var f=c(e.all(),e.index());e=e.all()[f];d.deselect(a,b);d.select(a,e);return e})};return{first:function(a){var b=c.all(a);return e.from(b[0]).map(function(b){d.select(a,b);return b})},prev:function(a,b){return m(a,b,h)},next:function(a,
b){return m(a,b,l)}}});k("9n",[],function(){var b=function(b){return function(){return b}};return{BACKSPACE:b([8]),TAB:b([9]),ENTER:b([13]),SHIFT:b([16]),CTRL:b([17]),ALT:b([18]),CAPSLOCK:b([20]),ESCAPE:b([27]),SPACE:b([32]),PAGEUP:b([33]),PAGEDOWN:b([34]),END:b([35]),HOME:b([36]),LEFT:b([37]),UP:b([38]),RIGHT:b([39]),DOWN:b([40]),INSERT:b([45]),DEL:b([46]),META:b([91,93,224]),F10:b([121])}});k("uh",["b","9n","w"],function(b,d,c){return{isCommand:function(a,e){var f=[];b.each(e,function(a){a="string"===
typeof a?[a.toUpperCase().charCodeAt(0)]:a;f=f.concat(a)});var g=function(a){return 0<b.filter(f,function(c){return b.contains(d[a](),c)}).length};if(!!a.altKey!==g("ALT")||!!a.shiftKey!==g("SHIFT")||!!a.ctrlKey!==g("CTRL")||!!a.metaKey!==g("META"))return!1;var g=null!==a.charCode&&void 0!==a.charCode&&0!==a.charCode?c.fromCharCode(a.charCode).toUpperCase().charCodeAt(0):a.which,h=d.CTRL().concat(d.ALT()).concat(d.SHIFT()).concat(d.META()),l=b.filter(f,function(a){return!b.contains(h,a)});return 1<
l.length?!1:0===l.length&&void 0===a.which||l[0]===g}}});k("uj",[],function(){return{stop:function(b){b.preventDefault();b.stopPropagation&&b.stopPropagation()}}});k("xe",["b","1n","9n"],function(b,d,c){return function(a,e){var f=e?a.slice(0):[],g=e,h=e?b.map(d.values(c),function(a){return a()}):[];return{swallowShortcuts:function(a){f=a.slice(0)},yieldShortcuts:function(a){f=b.difference(f,a)},swallowChars:function(){g=!0},yieldChars:function(){g=!1},swallowKeys:function(a){h=a.slice(0)},yieldKeys:function(a){h=
b.difference(h,a)},process:function(a,c){a.fold(function(a){b.contains(f,a)&&c()},function(a){b.contains(h,a)&&c()},function(){g&&c()})}}}});k("ul",["b","1n","9n"],function(b,d,c){var a={BACKSPACE:c.BACKSPACE,TAB:c.TAB,ENTER:c.ENTER,CAPSLOCK:c.CAPSLOCK,ESCAPE:c.ESCAPE,SPACE:c.SPACE,PAGEUP:c.PAGEUP,PAGEDOWN:c.PAGEDOWN,END:c.END,HOME:c.HOME,LEFT:c.LEFT,UP:c.UP,DOWN:c.DOWN,RIGHT:c.RIGHT,INSERT:c.INSERT,DEL:c.DEL};return{getSpecial:function(c){var f=null;d.each(a,function(a,d){b.contains(a(),c)&&(f=d)});
return f},noModifiers:function(a){return!(a.metaKey||a.altKey||a.ctrlKey)},isCharCode:function(a){return a.charCode===a.keyCode}}});k("xf","b uh ul 9n s w".split(" "),function(b,d,c,a,e,f){var g=function(a,c){return e.from(b.find(c,function(b){return d.isCommand(a,b)}))},h=function(a){return c.isCharCode(a)?e.none():e.from(c.getSpecial(a.keyCode))};return{identify:function(b,c){return{fold:function(d,e,q){g(b,c).fold(function(){h(b).fold(function(){q(b.which&&f.fromCharCode(b.which))},function(b){e(a[b]())})},
d)}}},shortcut:g,special:h}});k("ui",["uj","xe","xf","7"],function(b,d,c,a){return function(e,f){var g=!1,h=d(e,f);return{on:function(){g=!0},off:function(){g=!1},isOn:function(){return g},handle:function(a){return function(b){g&&a(b.raw())}},stop:function(d){var f=c.identify(d,e);h.process(f,a.curry(b.stop,d))},swallowShortcuts:h.swallowShortcuts,yieldShortcuts:h.yieldShortcuts,swallowChars:h.swallowChars,yieldChars:h.yieldChars,swallowKeys:h.swallowKeys,yieldKeys:h.yieldKeys}}});k("uk",["4x","3z"],
function(b,d){return function(){return d.create({character:b(["character"]),space:b(["shift","stopper"]),left:b(["shift","stopper"]),right:b(["shift","stopper"]),backspace:b(["shift","stopper"]),tab:b(["shift","stopper"]),enter:b(["shift","stopper"]),capslock:b(["shift","stopper"]),escape:b(["shift","stopper"]),pageup:b(["shift","stopper"]),pagedown:b(["shift","stopper"]),end:b(["shift","stopper"]),home:b(["shift","stopper"]),down:b(["shift","stopper"]),up:b(["shift","stopper"]),insert:b(["shift",
"stopper"]),del:b(["shift","stopper"]),command:b(["command"])})}});k("mn","b 6 uh ui uj uk ul w".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var m=d.merge({shortcuts:[],swallow:!1},l),n=f(),p=a(m.shortcuts,m.swallow),q=function(a){return b.find(m.shortcuts,function(b){return c.isCommand(a,b)})||null},r=function(a,b,c){t(a);n.trigger[b].apply(void 0,c)},s=function(a){return function(){p.isOn()&&e.stop(a)}};l=p.handle(function(a){var b=q(a);null!==b?r(a,"command",[b]):(b=g.getSpecial(a.keyCode),
g.noModifiers(a)&&null!==b&&(b=b.toLowerCase(),r(a,b,[a.shiftKey,s(a)])))});var t=function(a){p.isOn()&&p.stop(a)},u=p.handle(function(a){if(g.noModifiers(a))g.isCharCode(a)||null===g.getSpecial(a.keyCode)?null!==q(a)?t(a):a.which&&r(a,"character",[h.fromCharCode(a.which)]):t(a);else return!1});return{off:p.off,on:p.on,events:n.registry,swallowShortcuts:p.swallowShortcuts,yieldShortcuts:p.yieldShortcuts,swallowChars:p.swallowChars,yieldChars:p.yieldChars,swallowKeys:p.swallowKeys,yieldKeys:p.yieldKeys,
keypress:u,keydown:l}}});k("ro","b j9 9n mn 7 4x 3z 3n".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var m=g.create({mouseover:f(["item"]),click:f(["item"])}),n=[],p=a({shortcuts:l.shortcuts,swallow:l.swallow});l=l.tabs?[c.TAB()]:[];p.swallowKeys([c.UP(),c.DOWN(),c.ENTER(),c.SPACE(),c.ESCAPE()].concat(l));var q=function(){b.each(n,function(a){a.mouseover().unbind();a.click().unbind();a.keydown().unbind()});n=[];p.off()};return{destroy:function(){q()},attach:function(a){q();n=b.map(a,function(a){var b=
h.bind(a,"mouseover",function(a){d.up(a.target()).each(m.trigger.mouseover)}),c=h.bind(a,"click",function(a){d.up(a.target()).each(m.trigger.click)});a=h.bind(a,"keydown",function(a){p.keydown(a)});return{mouseover:e.constant(b),click:e.constant(c),keydown:e.constant(a)}});p.on()},detach:q,simulateKey:function(a){p.keydown(a)},events:m.registry,keys:p.events}}});k("b3",["2l"],function(b){var d=function(c){return"rtl"===b.get(c,"direction")?"rtl":"ltr"};return{onDirection:function(b,a){return function(e){return"rtl"===
d(e)?a:b}},getDirection:d}});k("j5","b rm rn ro j9 ja jb 6 7 4x 3z 1b b3 l 2v 20 9z q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){return function(w,x){var y=n.create({select:m(["item"]),active:m(["item"]),show:m(["menu"]),hide:m(["menu"]),collapse:m(["menu"]),expand:m(["menu","trigger"]),escaped:m([])}),k=a({shortcuts:[],swallow:[],tabs:x.tabs}),z={},A=function(a){f.activate(w,a)},C=function(){var a=f.inactive(w);b.each(a,function(a){g.submenu().is(a)&&y.trigger.hide(a)})},D=function(a){e.isEnabled(a)&&
f.submenu(w,z,a).each(function(b){y.trigger.expand(b,a)})},E=function(a){f.up(a).each(function(b){A(b);c.selectAll(b,[a]);y.trigger.active(a)})},F=function(a){f.active(w).bind(function(b){c.selected(b).orThunk(function(){return d.first(b)}).each(function(c){a(b,c)})})},G=function(a){F(function(b,c){e.isEnabled(c)&&a(b,c)})},I=function(a){F(function(b,c){a(b,c).each(function(a){p.eq(c,a)||(f.submenu(w,z,c).each(y.trigger.collapse),y.trigger.active(a))})})},H=l.curry(I,d.prev),L=l.curry(I,d.next),J=
function(){g.main().first(w).each(function(a){A(a);c.selected(a).each(y.trigger.active)})},K=function(a){s.active().fold(a.stopper(),function(c){!1===b.contains(["input"],t.name(c))&&a.stopper()()});G(function(a,b){f.submenu(w,z,b).fold(function(){g.submenu().is(a)&&(y.trigger.collapse(a),J())},function(a){y.trigger.expand(a,b);c.none(a);c.first(a).each(y.trigger.active);A(a)})})},I=function(a){s.active().fold(a.stopper(),function(c){!1===b.contains(["input"],t.name(c))&&a.stopper()()});G(function(a,
b){g.submenu().is(a)&&(y.trigger.collapse(a),J())})},M=function(a){G(function(b,c){var d=e.get(c);z.hasOwnProperty(d)&&void 0!==z[d]?K(a):y.trigger.select(c)})},Q=function(a){a.shift()?H(a):L(a)};k.keys.up.bind(H);k.keys.down.bind(L);x.tabs&&k.keys.tab.bind(Q);k.keys.enter.bind(M);k.keys.space.bind(M);k.keys.escape.bind(function(a){a.stopper()();F(function(a,b){g.submenu().is(a)?(y.trigger.collapse(a),J()):y.trigger.escaped()})});"ltr"===q.getDirection(w)?(k.keys.left.bind(I),k.keys.right.bind(K)):
(k.keys.right.bind(I),k.keys.left.bind(K));k.events.mouseover.bind(function(a){a=a.item();c.is(a)&&f.submenu(w,z,a).forall(u.isVisible)||(E(a),C(),D(a))});k.events.click.bind(function(a){a=a.item();var b=e.get(a);z.hasOwnProperty(b)&&void 0!==z[b]||!e.isEnabled(a)||y.trigger.select(a)});return{destroy:function(){k.destroy()},populate:function(a){z=h.merge({},a)},on:function(a){a=void 0!==a?a:[r.fromDom(v)];k.attach(a)},off:function(){k.detach()},selectFirst:function(){f.active(w).each(function(a){c.none(a);
c.first(a).each(y.trigger.active)})},select:function(a){E(a);C()},setActiveMenu:A,simulateKey:k.simulateKey,state:function(){return f.active(w).bind(function(a){return c.selected(a).map(function(b){return{menu:l.constant(a),item:l.constant(b)}})})},events:y.registry}}});k("rd","jk x6 x7 x8 x9 xa jg xd bi 6w b j5 6 7 s 4x 3z 40 jj 4f 1a 1x 2l 3n l 2v 64 2m 2y 2p 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w,x,y,k,z,A,C,D,E,F,G,I,H){return{init:function(E,J,K,M,Q){var R=M.button(),P=
b.onButton(R),O=c(K),V=O.getBackAttr(),U=C.fromTag("div");k.add(U,m.resolve("card-system-main"));K=C.fromTag("div");k.add(K,m.resolve("toolbar-menu-"+M.name()+"-sandbox"));y.set(K,"tabindex",-1);var N=p(K,{tabs:!1});F.append(E.uiContainer(),K);var X=x({}),T=x(),W=d(U),Z=l(r.constant(K),E.bounds,J,[R.element()]).initMenu(U);Q=h(R.element());var ba=g.main(E.uiContainer,E.bounds,R.element,Q,J.uiDirection(),w.available()),$=function(a,b,c){var d=e.menu(a).getOrDie("Main menu Attr key is required");W.clear();
var f={};f[V]=d;c=q.merge(c,f);X.set(c);ea(a,O.parent);T.set(d);n.each(b,function(a){ea(a,O.child)});M.init(M);ga();R.select();N.setActiveMenu(M.element());N.selectFirst()};N.events.active.bind(function(a){D.focusInside(a.item())});var ha=function(){ba.recalculate(Z)},ga=function(){var b=T.get();W.open(b);Z.open();b=W.getItem(b);a.copy(b,W.element());k.add(Z.element(),m.resolve("height-animate"));z.reflow(Z.element())},ea=function(a,b){e.menu(a).each(function(c){var d=b(a);F.append(U,d);W.addItem(c,
d)})},da=function(){Z.close();k.remove(W.element(),m.resolve("height-animate"));R.deselect();ca.trigger.close()},Y=function(a,b){s.from(M.handlers()[a]).bind(function(c){c(b);ca.trigger.itemAction(a,b)})},S=function(){var a=I.get(Z.element());z.set(Z.element(),"width",a+"px");H(function(){z.remove(Z.element(),"width")},10)},Fa=function(b,c){var d=T.get()===b.key()?f.right:f.left,e=b.element();a.copy(e,W.element());d(W.element(),b.element(),c.element(),r.noop);S()},ca=u.create({open:t(["menu","popup",
"anchor"]),close:t([]),itemAction:t(["value","item"]),itemReveal:t(["menu","trigger","popup","anchorage"]),itemChanged:v(["activeMenu","lastActiveMenu"],W.events.onActiveMenuChange),itemBack:v(["activeMenu","lastActiveMenu"],W.events.onItemBack)});M.events.done.bind(da);Z.events.close.bind(da);Z.events.open.bind(function(){ca.trigger.open(M.element(),Z,ba)});W.events.reveal.bind(function(a){var b=a.item().element();a=a.trigger();ca.trigger.itemReveal(b,a,Z,ba)});W.events.onActiveMenuChange.bind(function(a){var b=
a.activeMenu();a.lastActiveMenu().each(r.curry(Fa,b))});var ia=A.bind(K,"click",function(a){var b=a.target();G.closest(b,".ephox-gopher-item").each(function(a){e.item(a).each(function(c){var d=X.get();s.from(d[c]).fold(function(){Y(c,a)},function(a){(c===V?W.back:W.reveal)(a,b)})})})});R.events.click.bind(function(){(R.selected()?$:da)(M.element(),M.submenus(),M.structure())});return{cards:function(){return{events:ca.registry,close:da,uiStale:Z.uiStale,recalculate:ha}},component:R.element,refreshUi:r.noop,
destroy:function(){P.unbind();M.destroy();W.destroy();ia.unbind()}}}}});k("9l",["33"],function(b){return{menu:b.immutableBag(["focusActive"],[])}});k("bg","6w b 1n j5 7 s 4x 3z 40 4f 33 1a 1x l 2v 2m 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){return function(v,w,x){var y=r.fromTag("div");q.add(y,b.resolve("menu-"+w()+"-sandbox"));p.set(y,"tabindex",-1);t.append(v(),y);var k=f.none(),z=a(y,{tabs:!0}),A=m({}),C=function(){z.off();F();E.trigger.close()},D=function(a){var b=c.mapToArray(A.get(),
n.immutable("submenu","item")),g=p.get(a,"data-ephox-gopher-menu-value"),b=d.find(b,function(a){return a.submenu()===g});return f.from(b).bind(function(b){return u.descendant(y,"[data-ephox-gopher-item-value="+b.item()+"]").map(function(b){return{menu:e.constant(a),item:e.constant(b)}})})};v=function(a){var b=D(a.menu()).map(function(a){return a.item()});E.trigger.collapse(a.menu(),b)};var E=h.create({open:g([]),close:g([]),itemAction:g(["value","item"]),itemHover:l(["item"],z.events.active),reveal:l(["menu",
"trigger"],z.events.expand),collapse:g(["menu","item"]),escaped:l([],z.events.escaped)});z.events.hide.bind(v);z.events.collapse.bind(v);z.events.escaped.bind(function(){z.state().fold(C,function(a){D(a.menu()).fold(function(){C()},function(a){E.trigger.collapse(a.menu(),f.some(a.item()));z.select(a.item())})})});z.events.select.bind(function(a){a=a.item();var b=p.get(a,"data-ephox-gopher-item-value");E.trigger.itemAction(b,a)});z.events.active.bind(function(a){x.focusActive()&&s.focusInside(a.item())});
var F=function(){c.each(A.get(),function(a,b){u.descendant(y,'[data-ephox-gopher-menu-value="'+a+'"]').each(function(a){var c=u.descendant(y,'[data-ephox-gopher-item-value="'+b+'"]');E.trigger.collapse(a,c)})})};return{update:function(a){A.set(a);z.populate(a)},setActiveMenu:function(a){k=f.from(a);z.setActiveMenu(a);z.selectFirst()},getActiveMenu:function(){return k},structure:A,destroy:function(){C();z.destroy()},open:function(a,b){s.focus(b);z.on(a);z.selectFirst();E.trigger.open()},close:C,events:E.registry,
sandbox:e.constant(y),select:z.select,simulateKey:z.simulateKey}}});k("10w",["kb","43","l","2m","2o"],function(b,d,c,a,e){return function(f,g){var h=c.fromTag("span");d.add(h,[b.resolve("righticon-content"),g]);a.append(h,f);return{element:function(){return h},destroy:function(){e.remove(h)}}}});k("10x",["10w","dd"],function(b,d){return function(c,a){var e=d(c),f=b(e.element(),a);return{element:f.element,destroy:function(){e.destroy();f.destroy()}}}});k("xg","9l r0 bg x3 x4 rc jg xd bi 6w b 7i e6 fi 10w 10x kc 7 4x 3z 40 jj 1a 1x 43 l 2m 35 2o q".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w,x,y,k,z,A,C,D,E,F,G,I){return function(H,L,J,K,M,Q,R,P){var O=u(J);Q=d.control(O);C.add(O.element(),[m.resolve("dropdown-button"),m.resolve(J+"-dropdown-button")]);z.set(O.element(),"title",R(K));p.toolbarButton(O.element(),R(K),!0,P);var V=c(H.uiContainer,v.constant("dropdown-"+J),b.menu({focusActive:!0})),U=D.fromDom(I),N=r.mainmenu(U,J+"-menu",[]),X=l(V.sandbox,H.bounds,L,[O.element()]).initMenu(N);J=h(O.element());var T=g.main(H.uiContainer,H.bounds,
O.element,J,L.uiDirection(),k.anchored());p.menu(N,R(K));var W=D.fromTag("span");A.add(W,m.resolve("dropdown-viewport"));O.content({element:v.constant(W)});var Z=function(a,b){var c=b.map(f.generate).getOr([]);F.prepend(a,c)};L=function(){ba(R(K))};var ba=function(a){G.empty(W);E.append(W,t(a,"ephox-pastry-arrow-righticon").element())},$=function(){O.deselect();P&&q.pressed(O);q.collapsed(O.element());X.close();V.close()},ha=function(){O.select();P&&q.pressed(O);q.expanded(O.element());X.open();var a=
[H.uiContainer()];V.open(a,O.element())},ga=x.create({select:y(["value","item"],V.events.itemAction),itemHover:y(["item"],V.events.itemHover),escaped:y([],V.events.escaped),open:w(["menu","popup","anchor"]),close:y([],V.events.close)});O.events.click.bind(function(){(O.selected()?ha:$)()});X.events.close.bind($);V.events.open.bind(function(){ga.trigger.open(N,X,T);V.update({});V.setActiveMenu(N)});V.events.escaped.bind($);L();return{element:v.constant(O.element()),menu:X.element,list:v.constant(N),
click:O.click,populate:function(b){G.empty(N);n.each(b,function(b){b.label().each(function(b){b=a.generateSeparator(U,b,R);E.append(N,b)});n.each(b.items(),function(b){var c=a.generateItem(U,b,M,R);p.menuItemCheckbox(c,R(b.textkey()),!1);Z(c,b.icon());E.append(N,c)})})},enable:Q.enable,disable:Q.disable,close:$,uiStale:X.uiStale,recalculate:function(){T.recalculate(X)},clear:L,select:function(a){ba(R(a.textkey()));Z(W,a.icon())},selectElement:function(a){a=s(a,"ephox-pastry-arrow-righticon");O.content({element:a.element,
destroy:v.noop})},tick:v.curry(e.tick,N),untick:v.curry(e.untick,N),activate:v.curry(e.activate,O.element()),deactivate:v.curry(e.deactivate,O.element()),destroy:function(){V.destroy();O.destroy()},events:ga.registry}}});k("re","jk rb xg 3z 40 1a".split(" "),function(b,d,c,a,e,f){return{init:function(g,h,l,m){var n=c(g,h,m.name,m.textkey,m.render,m.layout,l,m.toggle);g=function(){m.updateDropdown(d.dropdown({enable:n.enable,disable:n.disable,select:n.select,clear:n.clear,selectElement:n.selectElement,
populate:n.populate,tick:n.tick,untick:n.untick,activate:n.activate,deactivate:n.deactivate}))};var p=b.onButton(n);n.events.select.bind(function(a){m.action(a.value());n.close()});var q=a.create({select:e(["value","item"],n.events.select),itemHover:e(["item"],n.events.itemHover),escaped:e([],n.events.escaped),open:e(["menu","popup","anchor"],n.events.open),close:e([],n.events.close)});g();f.set(n.element(),"tabindex","-1");return{dropdown:function(){return{events:q.registry,close:n.close,uiStale:n.uiStale,
enable:n.enable,disable:n.disable,list:n.list,menu:n.menu,recalculate:n.recalculate}},component:n.element,refreshUi:g,destroy:function(){p.unbind();n.destroy()}}}}});k("rf","jk rb j6 j7 a e6 7 3z 40 1a".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(b,c){var d=a.typical(b.value,b.value,b.action,b.textkey,b.label,b.tooltip,c);b.setup&&b.setup(d,b);return d},p=function(b,c){var d=a.toggle(b.value,b.value,b.action,b.textkey,b.label,b.tooltip,c);b.setup&&b.setup(d,b);b.selected&&d.select();return d};
return{init:function(a,r){var s=!0===r.hasPopup,t=(!0===r.toggle?p:n)(r,a);e.isString(r.icon)&&c.findAndSetUrl(t.element(),r.icon);var u=t.initAria(t,a(r.textkey),s,r.toggle);m.set(t.element(),"tabindex","-1");var v=function(){!0===r.toggle&&f.pressed(t)},w=b.onButton(t);t.events.click.bind(function(){v()});var x=!0===r.toggle?t.select:g.noop,y=!0===r.toggle?t.deselect:g.noop,k=!0===r.toggle?t.selected:g.constant(!1);v();var z=h.create({click:l([],t.events.click)});return{generals:function(){return{events:z.registry,
enableButton:t.enable,disableButton:t.disable}},component:t.element,refreshUi:function(){r.updateGeneral(d.general({disable:u.disable,enable:u.enable,select:x,deselect:y,selected:k,element:t.element}));v()},destroy:function(){w.unbind();t.destroy();u.destroy()}}}}});k("rg","9l jk bg jg xd bi 6w b e6 4x 3z 40 jj 1a 1x 2l l 2v 2m 35 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w,x,y,k){return{init:function(z,A,C,D,E){var F=D.button(),G=d.onButton(F),I=c(z.uiContainer,D.name,b.menu({focusActive:!0}));
r.set(F.element(),"tabindex","-1");var H=u.fromTag("div");s.add(H,g.resolve("menu-system-main"));var L=f(I.sandbox,z.bounds,A,[F.element()]),J=L.initMenu(H);C=e(F.element());var K=a.main(z.uiContainer,z.bounds,F.element,C,A.uiDirection(),q.anchored()),M=function(){K.recalculate(J)},Q=function(){var a=k.children(I.sandbox());h.each(a,function(a){t.set(a,"display","none")})},R=function(a){I.update(a.structure());y.empty(H);w.append(H,a.element());a=L.registerMenus(a.submenus());a=h.map(a,function(a){return a.panel()});
y.empty(I.sandbox());x.append(I.sandbox(),[J.panel()].concat(a));Q()},P=function(a){D.init(a)},O=n.create({open:m(["menu","popup","anchor"]),close:p([],I.events.close),itemAction:p(["value","item"],I.events.itemAction),itemHover:p(["item"],I.events.itemHover),reveal:m(["menu","trigger","popup","anchor"]),collapse:p(["menu","item"],I.events.collapse),escaped:p([],I.events.escaped)});F.events.click.bind(function(){return(F.selected()?J.open:J.close)()});D.events.done.bind(function(){I.close()});D.events.abort.bind(function(a){I.select(a.item());
v.focus(a.item())});J.events.uistale.bind(function(){I.getActiveMenu().bind(function(a){P(a)})});J.events.close.bind(function(){I.close();l.collapsed(F.element())});J.events.open.bind(function(){var a=void 0!==E?E:[],a=[I.sandbox()].concat(a);R(D);P(D);t.set(J.panel(),"display","block");t.set(H,"display","block");I.open(a,H);l.expanded(F.element())});I.events.open.bind(function(){O.trigger.open(D.element(),J,K);I.setActiveMenu(D.element())});I.events.close.bind(function(){L.hideAll();F.deselect()});
I.events.itemAction.bind(function(a){var b=D.handlers();if(void 0!==b[a.value()])(0,b[a.value()])(a.item())});I.events.reveal.bind(function(a){l.expanded(a.trigger());var b=L.expandMenu(a.menu(),a.trigger(),J);O.trigger.reveal(a.menu(),a.trigger(),b.popup,b.anchorage)});I.events.collapse.bind(function(a){L.hideMenu(a.menu());a.item().each(l.collapsed)});return{menus:function(){return{events:O.registry,enable:D.enable,disable:D.disable,close:J.close,uiStale:J.uiStale,mousedown:J.mousedown,contentFocus:D.contentFocus,
menu:J.element,refreshMenus:P,recalculate:M}},component:F.element,refreshUi:function(){D.updateMenu({enable:D.enable,disable:D.disable})},destroy:function(){G.unbind();I.destroy();D.destroy();J.destroy()}}}}});k("rh","rb 6w x2 b 9m 7 s 2k 1x l 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return{init:function(p,q){var r=m.fromTag("span");l.add(r,d.resolve("palette-group"));var s=f.curry(e.speak,h.body()),t=function(a){var b=c.isShowing(r);c.hide(r);b&&a.each(s);return b},u=b.palette({show:function(a){var b=
c.isHiding(r);c.show(r);b&&a.each(s);return b},hide:t});t(g.none());n.append(r,a.map(q,function(a){return a.component()}));return{component:f.constant(r),destroy:function(){a.each(q,function(a){a.destroy()})},refreshUi:function(){p.updatePalette(u);a.each(q,function(a){a.refreshUi()})}}}}});k("ri","jk rb jg xd bi j7 7i e6 fi 7 4x 3z 40 jj 1a l 2m q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){return{widget:function(w,x,y,k){var z=k.instance();k=t.fromDom(v);var A=(z.toggle?f.splitToggle:
f.split)(z.name(),z.name(),m.identity,z.textkey(),z.label(),z.tooltip,y),C=b.custom(A.element(),function(){A.open();z.enter()});s.set(A.element(),"tabindex","-1");var D=A.initAria(A,y(z.textkey()),!0,z.toggle),E=e(w.uiContainer,w.bounds,x,[A.element()]),F=a(A.element()),G=l.widget(k,z.name());g.menu(G,y(z.textkey(),!1));u.append(G,z.element());var I=E.initMenu(G),H=c.main(w.uiContainer,w.bounds,A.element,F,x.uiDirection(),r.expandable()),L=function(){H.recalculate(I)};I.events.open.bind(function(){h.expanded(A.element());
z.open();J.trigger.open(G,I,H)});I.events.close.bind(function(){h.collapsed(A.element());z.close();A.close()});z.events.done.bind(function(){I.close();A.close()});z.events.abort.bind(function(){I.close();A.close();J.trigger.abort()});A.events.open.bind(function(){I.open();H.recalculate(I)});A.events.close.bind(function(){z.close();I.close()});A.events.click.bind(function(){z.action()});var J=p.create({abort:n([]),close:q([],z.events.close),open:n(["menu","popup","anchor"])});return{widgets:function(){return{events:J.registry,
open:A.open,close:A.close,recalculate:L}},component:A.element,refreshUi:function(){z.updateWidget(d.widget({select:A.select,deselect:A.deselect,enable:A.enable,disable:A.disable,press:D.press,release:D.release}))},destroy:function(){C.unbind();D.destroy();I.destroy();z.destroy();A.destroy()}}}}});k("rj","jk rb jg xd bi 6w j7 7i e6 7 4x 3z jj 1a 1x".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return{widget:function(h,u,v,w){var x=w.instance(),y=g.toggle(x.name(),x.name(),m.identity,x.textkey(),
x.label(),x.tooltip,v),k=b.onButton(y),z=y.initAria(y,v(x.textkey()),!0,!0);v=e(h.uiContainer,h.bounds,u,[y.element()]);w=a(y.element());var A=v.initMenu(x.element()),C=c.main(h.uiContainer,h.bounds,y.element,w,u.uiDirection(),q.expandable());r.set(y.element(),"tabindex","-1");s.add(A.element(),f.resolve("toolbar-widget"));var D=function(){C.recalculate(A)};A.events.open.bind(function(){l.expanded(y.element());x.open();E.trigger.open(x.element(),A,C)});A.events.close.bind(function(){l.collapsed(y.element());
x.close()});x.events.done.bind(function(){A.close();y.deselect()});x.events.abort.bind(function(){A.close();y.deselect();E.trigger.abort()});y.events.click.bind(function(){y.selected()?(A.open(),C.recalculate(A)):A.close();l.pressed(y)});var E=p.create({abort:n([]),open:n(["menu","popup","anchor"])}),F=function(){y.deselect();A.close()};return{widgets:function(){return{events:E.registry,close:F,recalculate:D}},component:y.element,refreshUi:function(){x.updateWidget(d.widget({select:m.noop,deselect:m.noop,
enable:z.enable,disable:z.disable,press:m.noop,release:m.noop}))},destroy:function(){k.unbind();z.destroy();A.destroy();x.destroy();y.destroy()}}},inline:function(a,c){var e=c.instance(),g=b.custom(e.element(),function(){e.element().dom().click()});r.remove(e.element(),"tabindex");s.add(e.element(),f.resolve("toolbar-inline-widget"));h.toolbarButton(e.element(),a(e.textkey()),!1);var q=p.create({abort:n([]),open:n(["menu","popup","anchor"])});return{widgets:function(){return{events:q.registry,recalculate:m.noop,
close:m.noop}},component:e.element,refreshUi:function(){e.updateInlineWidget(d.widget({select:m.noop,deselect:m.noop,enable:m.curry(l.enable,e.element()),disable:m.curry(l.disable,e.element()),press:m.noop,release:m.noop}))},destroy:function(){g.unbind();e.destroy()}}}}});k("j0","r7 r8 r9 jf rd re rf rg rh ri rj 7".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return{menu:function(e){return{general:p.curry(d.init,e),menu:p.curry(c.nested,e),dropdown:p.curry(b.init,e),widget:p.curry(a.widget,e),"split-widget":p.curry(a.split,
e),"inline-widget":p.curry(a.inline,e),palette:p.die("No palettes for menus yet")}},toolbar:function(a,b,c){var d=function(d){return p.curry(d,a,b,c)};return{menu:d(h.init),dropdown:d(f.init),cards:d(e.init),widget:d(n.widget),"split-widget":d(m.widget),"inline-widget":p.curry(n.inline,c),general:p.curry(g.init,c),palette:l.init}}}});k("gf",["4g"],function(b){b=b.generate([{toolbar:[]},{menu:[]}]);return{toolbar:b.toolbar,menu:b.menu,cata:function(b,c,a){return b.fold(c,a)}}});k("bb",["j0","gf"],
function(b,d){return function(c){var a=b.menu(c);return{widget:a.widget,menu:a.menu,general:a.general,"inline-widget":function(b){return a["inline-widget"]({instance:function(){return b.instance(d.menu())}})},"split-widget":a["split-widget"],dropdown:a.dropdown,palette:a.palette}}});k("j1",["b","c","3f","2v"],function(b,d,c,a){var e=function(b,c,d,e){b.events.escaped.bind(function(b){d.focused()&&a.focus(e.component())});b.events.close.bind(function(a){c.focus()})},f=function(a,b,d,e){a.events.open.bind(function(a){c.register(a.popup().element())})};
return{init:function(c,h,l,m,n,p,q,r,s){var t=c.dropdown(s),u=t.dropdown();c=l.toolbar;(d.detect().deviceType.isTouch()?f:e)(u,n,c,t);var v=!1;u.events.open.bind(function(a){n.toReading();q.show(a.popup(),a.anchor());v=!0});u.events.close.bind(function(){v=!1});u.events.escaped.bind(function(){a.focus(t.component())});n.events.mousedown.bind(function(){v&&u.close()});n.events.uiStale.bind(u.uiStale);l.toolbar.events.transitionend.bind(function(a){b.contains(["top","height"],a.property())&&u.recalculate()});
return{component:t.component,refreshUi:t.refreshUi,destroy:t.destroy}}}});k("j2",[],function(){return{init:function(b,d,c,a,e,f,g,h,l){b=b.general(l);d=b.generals();b.refreshUi();return{generals:d,component:b.component,refreshUi:b.refreshUi,destroy:b.destroy}}}});k("e7",["s","28"],function(b,d){var c=function(a,c){var f=b.none();return{begin:function(){f=b.some(d.get(a))},end:function(){f.each(function(a){c.scrollTo(a.left(),a.top())});f=b.none()}}};return{fromSafe:function(a){return c(a.doc(),a.win())},
fromUnsafe:function(a){var b=a.doc().getOrDie();a=a.win().getOrDie();return c(b,a)}}});k("rk","7 s e7 3f l 2v 20 29 q".split(" "),function(b,d,c,a,e,f,g,h,l){return{init:function(m,n,p,q,r,s,t,u,v){var w=m.menu(v,[]),x=w.menus(),y=c.fromUnsafe(r);x.events.open.bind(function(a){r.toReading();x.refreshMenus(a.menu());t.show(a.popup(),a.anchor())});x.events.close.bind(function(){r.focus();y.end()});x.events.escaped.bind(function(){f.focus(w.component())});x.events.reveal.bind(function(a){v.init(a.menu());
t.show(a.popup(),a.anchor())});x.events.itemAction.bind(function(a){y.end()});x.events.itemHover.bind(function(c){y.begin();if(null!==l.activeElement&&void 0!==l.activeElement){var d=e.fromDom(l.activeElement),m=h.owner(c.item());"input"!==g.name(d)&&a.preserve(m,b.curry(f.focusInside,c.item()))}else r.backupSelection(),f.focus(c.item())});r.events.mousedown.bind(x.mousedown);r.events.uiStale.bind(x.uiStale);r.events.focus.bind(x.enable);var k=!r.isInline()&&v.contentFocus();k&&x.disable();return{component:w.component,
refreshUi:function(){w.refreshUi();var a=k?d.none():d.some(!0);r.getSelection().or(a).fold(x.disable,x.enable)},destroy:function(){r.events.mousedown.unbind(x.mousedown);r.events.uiStale.unbind(x.update);w.destroy()}}}}});k("rl",["b","3f","3m"],function(b,d,c){return{init:function(a,e,f,g,h,l,m,n,p){a=a.cards(p);var q=a.cards();q.events.open.bind(function(a){h.toReading();d.register(a.popup().element());c(function(){m.show(a.popup(),a.anchor())},0)});h.events.mousedown.bind(q.close);h.events.uiStale.bind(q.uiStale);
f.toolbar.events.transitionend.bind(function(a){b.contains(["top","height"],a.property())&&q.recalculate()});return{component:a.component,refreshUi:a.refreshUi,destroy:a.destroy}}}});k("j3",["c","rk","rl"],function(b,d,c){var a=b.detect().deviceType.isTouch();return function(b,f,g,h,l,m,n,p,q){return(a?c.init:d.init)(b,f,g,h,l,m,n,p,q)}});k("j4","c kb 7 gf 1x 3n 2v".split(" "),function(b,d,c,a,e,f,g){var h=function(a,c,d,e,f,h,u,v,w,x,y){var k=d[c]({instance:a(y.instance)});a=k.widgets();f=f.toolbar;
a.events.open.bind(function(a){u.toReading();w.show(a.popup(),a.anchor())});a.events.abort.bind(function(){g.focus(k.component())});u.events.mousedown.bind(a.close);return(b.detect().deviceType.isTouch()&&"split-widget"===c?m:l)(a,u,f,k)},l=function(a,b,c,d){return d},m=function(a,b,c,g){var h=f.capture(g.component(),"click",function(b){b.kill();a.open();e.add(g.component(),d.resolve("statebutton-selected"))});a.events.close.bind(function(){e.remove(g.component(),d.resolve("statebutton-selected"))});
return{widgets:g.widgets,component:g.component,refreshUi:g.refreshUi,destroy:function(){h.unbind();g.destroy()}}};return{widget:c.curry(h,c.identity,"widget"),inlineWidget:c.curry(h,function(b){return function(){return b(a.toolbar())}},"inline-widget"),splitWidget:c.curry(h,c.identity,"split-widget")}});k("bc","j0 7 j1 j2 j3 j4".split(" "),function(b,d,c,a,e,f){return function(g,h,l,m,n,p,q){var r=b.toolbar(p,l,q),s=function(a){return d.curry(a,r,g,h,l,m,n,p,q)};return{widget:s(f.widget),"inline-widget":s(f.inlineWidget),
"split-widget":s(f.splitWidget),cards:r.cards,general:s(a.init),dropdown:s(c.init),menu:s(e),palette:r.palette}}});k("bd",[],function(){return{link:function(){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\.\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w\.]+@)[A-Za-z0-9\.\-]+)(:[0-9]+)?((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-_.~*+=!&;:'%@?^${}()\w,]*)#?(?:[\-_.~*+=!&;:'%@?^${}()\w,\/]*))?)/g},tokens:function(b,d){return b.replace(/\{(\d+)\}/g,function(c,a,e,f){a=parseInt(a,10);if(void 0===d[a])throw"No value for token: "+
c+" in translation: "+b;return d[a]})}}});k("6u","a 7 bd 1g 4g 9".split(" "),function(b,d,c,a,e,f){var g=e.generate([{raw:["text"]},{key:["key"]},{pkey:["key","params"]}]),h=function(b){var d=a.get(b);if(1<arguments.length||/\{(\d+)\}/.test(d)){for(var e=new f(arguments.length-1),g=1;g<arguments.length;g++)e[g-1]=arguments[g];return c.tokens(d,e)}return d};return{get:function(a){if(b.isString(a))throw"string passed to I18n.get:"+a;return a.fold(d.identity,h,h)},has:a.has,translate:h,raw:g.raw,key:function(b){a.get(b);
return g.key(b)},pkey:function(b,c){a.get(b);return g.pkey(b,c)},cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("be",["c","7","s","6u","33"],function(b,d,c,a,e){var f=e.immutable("key","link"),g=e.immutable("url","text"),h=function(b,d,e){return function(h){var l=g(d,a.translate(e));return f(a.pkey(b,h),c.some(l))}},l=function(b){return function(d){return f(a.pkey(b,d),c.none())}};e=function(b){return function(d){var e=b(d);d=g(d[0].websiteUrl,a.translate("cloud.dashboard"));return f(e.key(),c.some(d))}};
var m={"no.api.key":e(l("cloud.error.apikey")),"domain.not.supported":e(function(b){return f(a.pkey("cloud.error.domain",[b[0].details.domain]),c.none())}),"plan.exceeded":e(l("cloud.error.plan")),"error.code.invalid.toolbar":l("errors.toolbar.invalid"),"error.code.spelling.not.found":l("errors.spelling.missing.service"),"error.code.images.not.found":l("errors.images.missing.service"),"safari.imagepaste":h("errors.safari.image","https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work",
"errors.safari.url"),"flash.clipboard.no.rtf":function(a){return(b.detect().browser.isSafari()?h("errors.images.missing.flash","https://support.ephox.com/entries/59328357-Safari-6-1-and-7-Flash-Sandboxing","errors.safari.rtf"):l("errors.images.missing.flash"))(a)},"fileupload.invalidimages":l("errors.images.upload.invalid"),"error.imageupload":l("errors.images.upload.failed"),"error.imageupload.generic":l("errors.images.upload.unknown"),"error.imageupload.cors":l("errors.images.upload.cors"),"errors.local.images.disallowed":l("errors.images.disallowed.local"),
"errors.dragdrop.images.disallowed":l("errors.images.disallowed.dragdrop"),"errors.paste.word.notready":l("errors.paste.notready"),"errors.paste.process.failure":l("errors.paste.generic"),"flash.crashed":l("errors.flash.crashed"),"errors.imageimport.failed":l("errors.images.import.failed"),"errors.imageimport.unsupported":l("errors.images.import.unsupported"),"errors.imageimport.invalid":l("errors.images.import.invalid"),"imageedit.needsproxy":l("errors.images.edit.needsproxy"),"imageedit.proxyerror":l("errors.images.edit.proxyerror"),
"imageedit.generic":l("errors.images.edit.generic")};return{get:function(b,c){var e=(0,m[b])(c);return{description:d.constant(a.get(e.key())),link:d.constant(e.link().getOr(null))}}}});k("bf",["em","6u","65","3m"],function(b,d,c,a){return{setup:function(e,f){f.events.initialLogin.bind(function(f){var h=b(d.translate("banner.logged-in",f.email()));h.events.close.bind(function(){c(l)});e.displayBanner(h);var l=a(function(){e.hideBanner(h)},5E3)})}}});k("6n","b8 b9 a b 7 ba bb bc 6u be 30 bf 1x o".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(b,c){var d=function(c){var d=m.get("error.code.invalid.toolbar",[c.small()]),d=f(d);b.displayBanner(d);a.each(c.big(),function(a){r.error(a)})};return c.fold(function(a){d(a);return[]},e.identity)};return{setup:function(e,f,m,r,x,y,k){k=s(e,k);var z=function(a){a=c.isString(a)?l.has(a)?l.key(a):l.raw(a):a;return l.get(a)};q.add(e.toolbar.element(),n.resolve("layer-above-editor"));f=d.blueprints(h(x.uiContainer,e,f,m,r,x,z),g(z));x=d.env(x.uiContainer,
z);x=b.build(k,f,x);a.each(x,e.toolbar.add);p.setup(e,y);e.position();a.each(x,function(a){m.events.uiStale.bind(function(){a.refreshUi()})})}}});k("jl","jk iy 6w j7 nm dd 7 1a 1x 2v".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n){var p=e("overflower");l.add(p.element(),c.resolve("more-button"));p.content(f(n("toolbar.more")));var q=b.onButton(p);h.set(p.element(),"tabindex","-1");n=n("aria.label.more");h.set(p.element(),"title",n);var r=a.aria(p,n,!0,!0),s=d.toolbar([{component:p.element,
destroy:p.destroy,refreshUi:g.noop}]);return{group:s.component,select:function(){p.select();r.press()},deselect:function(){r.release();p.deselect()},focus:function(){m.focus(p.element())},destroy:function(){q.unbind();r.destroy();s.destroy()},events:p.events}}});k("kg",["s","1b","2v","49","29"],function(b,d,c,a,e){return{preserve:function(f,g){var h=e.owner(g),l=c.active(h).bind(function(c){var e=function(a){return d.eq(c,a)};return e(g)?b.some(g):a.descendant(g,e)}),m=f(g);l.each(function(a){c.active(h).filter(function(b){return d.eq(b,
a)}).orThunk(function(){c.focus(a)})});return m}}});k("xh",["33"],function(b){return b.immutable("component","index")});k("ru",["b","xh"],function(b,d){return function(c){var a=[];return{add:function(b,f){var g=f?c.indexOf(a,f).getOrDie():a.length;a.splice(g,0,b);return d(b,g)},remove:function(e){e=c.resolve(a,e).getOrDie();var f=b.indexOf(a,e);a.splice(f,1);return d(e,f)},get:function(){return a.slice(0)},itemAt:function(b){return c.resolve(a,b)}}}});k("rv",["a","b","p"],function(b,d,c){return function(a){var e=
function(a,d){return b.isNumber(d)?f(a,d):b.isString(d)?g(a,d):b.isObject(d)?h(a,d):c.error("Unsupported specifier type: "+d)},f=function(a,b){return 0===a.length?c.error("Items is empty"):0>b||b>=a.length?c.error("Item index: "+b+" is out of range (0-"+(a.length-1)+")"):c.value(a[b])},g=function(b,e){var f=d.find(b,function(b){return a(b)===e});return void 0===f?c.error("No item with value: ["+e+"]"):c.value(f)},h=function(a,b){return-1===d.indexOf(a,b)?c.error("Specified object is not a registered item: "+
b):c.value(b)};return{resolve:e,indexOf:function(a,b){return e(a,b).bind(function(e){e=d.indexOf(a,e);return-1<e?c.value(e):c.error("Item not found: "+b)})},index:f,value:g,item:h}}});k("jm","6w b kg ru rv 7 4x 3z 1x 43 2l l 2m 35 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t,u){var v=h.create({grow:g([]),shrink:g([]),exit:g([])}),w=a(e(f.identity)),x=p.fromTag("div");n.set(x,"overflow-x","auto");l.add(x,b.resolve("toolstrip"));var y=p.fromTag("div");m.add(y,[b.resolve("toolbar"),
b.resolve("toolbar-primary")]);var k=p.fromTag("div");m.add(k,[b.resolve("toolbar"),b.resolve("toolbar-more")]);q.append(x,y);q.append(x,k);var z=function(){var a=w.get();return d.bind(a,function(a){return a.isVisible()?[a.component()]:[]})};return{element:function(){return x},main:f.constant(y),mores:f.constant(k),destroy:function(){var a=w.get();d.each(a,function(a){a.destroy()})},focused:f.constant(!1),enter:f.noop,restore:f.noop,refocus:f.noop,refresh:f.curry(c.preserve,function(){var a=z(),a=
t.build(a);s.empty(y);s.empty(k);r.append(y,a);n.reflow(y)},x),add:function(a){w.add(a)},events:v.registry}}});k("jn",["7"],function(b){return{item:b.constant('.ephox-chameleon-toolbar-group [tabindex="-1"]'),group:b.constant(".ephox-chameleon-toolbar-group"),sector:b.constant(".ephox-chameleon-toolstrip > *")}});k("nw","6w 1x 43 2l 3n 64".split(" "),function(b,d,c,a,e,f){var g=b.resolve("toolbar-more-closed"),h=b.resolve("toolbar-more-open"),l=b.resolve("toolbar-more-hide"),m=b.resolve("toolbar-more-show"),
n=function(b,c){a.set(b,"height",c+"px");a.reflow(b)},p=function(a){d.remove(a,h);d.add(a,g);n(a,0)},q=function(b){d.remove(b,g);d.add(b,h);a.remove(b,"height")};return function(b){p(b);var g=!1,h=e.bind(b,"transitionend",function(d){"height"===d.raw().propertyName&&(c.remove(b,[m,l]),g&&a.remove(b,"height"))});return{visible:function(){return g},hide:function(){g=!1;n(b,f.get(b));d.add(b,l);p(b)},show:function(){q(b);var a=f.get(b);p(b);d.add(b,m);q(b);n(b,a);g=!0},destroy:function(){h.unbind()}}}});
k("xi",["33"],function(b){return b.immutable("within","extra","withinWidth")});k("oa",["b","7"],function(b,d){return{make:function(c,a,e){return b.foldl(c,function(b,c){return a(c,b.len).fold(d.constant(b),function(a){return{len:a.finish(),list:b.list.concat([a])}})},{len:void 0!==e?e:0,list:[]}).list}}});k("ob",["b","s"],function(b,d){var c=function(a,b){return b>=a.start()&&b<=a.finish()},a=function(a,c){return b.findIndex(a,function(a){return a.start()===c})};return{get:function(a,f){var g=b.find(a,
function(a){return c(a,f)});return d.from(g)},find:function(a,c){return d.from(b.find(a,c))},inUnit:c,sublist:function(b,c,d){c=a(b,c);var h=a(b,d);d=-1<h?h:b[b.length-1]&&b[b.length-1].finish()===d?b.length+1:-1;return-1<c&&-1<d?b.slice(c,d):[]}}});k("od",["b","6","7"],function(b,d,c){return{translate:function(a,e){return b.map(a,function(a){return d.merge(a,{start:c.constant(a.start()+e),finish:c.constant(a.finish()+e)})})}}});k("oc",["b","ob","od"],function(b,d,c){var a=function(a,b,d){b=d(a,b);
return c.translate(b,a.start())};return{splits:function(c,f,g){return 0===f.length?c:b.bind(c,function(c){var e=b.bind(f,function(a){return d.inUnit(c,a)?[a-c.start()]:[]});return 0<e.length?a(c,e,g):[c]})}}});k("go",["oa","ob","oc","od"],function(b,d,c,a){return{generate:function(a,c,d){return b.make(a,c,d)},get:function(a,b){return d.get(a,b)},find:function(a,b){return d.find(a,b)},splits:function(a,b,d){return c.splits(a,b,d)},translate:function(b,c){return a.translate(b,c)},sublist:function(a,
b,c){return d.sublist(a,b,c)}}});k("rw",["b","xi","7","s","go"],function(b,d,c,a,e){var f=function(d,f,g){var h=e.generate(d,function(b,d){var e=g(b);return a.some({element:c.constant(b),start:c.constant(d),finish:c.constant(d+e),width:c.constant(e)})});d=b.filter(h,function(a){return a.finish()<f});var l=b.foldr(d,function(a,b){return a+b.width()},0),h=h.slice(d.length);return{within:c.constant(d),extra:c.constant(h),withinWidth:c.constant(l)}},g=function(a){return b.map(a,function(a){return a.element()})},
h=function(a,b,c){a=g(a.concat(b));return d(a,[],c)},l=function(a,b,c,e){a=g(a).concat([c]);return d(a,g(b),e)},m=function(a,b,c){return d(g(a),[],c)},n=function(b,c,d){b=f(c,b,d);return 0===b.extra().length?a.some(b):a.none()};return{partition:function(a,b,c,d){var e=n(a,b,c).getOrThunk(function(){return f(b,a-c(d),c)}),g=e.within(),v=e.extra(),e=e.withinWidth();return 1===v.length&&v[0].width()<=c(d)?h(g,v,e):1<=v.length?l(g,v,d,e):m(g,v,e)}}});k("jo","6w nw b kg ru rv rw 7 4x 3z 1x 43 2l l 2m 35 2o 2p".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){return function(w,x){var y=m.create({grow:l([]),shrink:l([]),exit:l([])}),k=e(f(h.identity)),z=r.fromTag("div");n.add(z,b.resolve("toolstrip"));var A=r.fromTag("div");p.add(A,[b.resolve("toolbar"),b.resolve("toolbar-primary")]);var C=r.fromTag("div");p.add(C,[b.resolve("toolbar"),b.resolve("toolbar-more")]);s.append(z,A);s.append(z,C);var D=d(C);x.events.click.bind(function(){D.visible()?(D.hide(),x.deselect(),y.trigger.shrink()):(D.show(),x.select(),
y.trigger.grow())});var E=function(){var a=k.get();return c.bind(a,function(a){return a.isVisible()?[a.component()]:[]})};return{element:function(){return z},main:h.constant(A),mores:h.constant(C),destroy:function(){var a=k.get();c.each(a,function(a){a.destroy()});x.destroy();D.destroy()},focused:h.constant(!1),enter:h.noop,restore:h.noop,refocus:h.noop,refresh:h.curry(a.preserve,function(){w.update();var a=E(),a=w.build(a);q.set(A,"visibility","hidden");w.clearWidth();u.empty(A);t.append(A,a);var b=
w.width(A);s.append(A,x.group());var a=g.partition(b,a,v.getOuter,x.group()),b=a.extra(),c=a.within();u.empty(A);u.empty(C);t.append(A,c);t.append(C,b);w.updateWidth(x,a);q.remove(A,"visibility")},z),add:function(a){k.add(a)},events:y.registry}}});k("fk",["33"],function(b){return{grid:b.immutableBag(["trigger"],["isValid","first"]),flow:b.immutableBag(["trigger"],["first","executeOnArrow"]),sectors:b.immutableBag(["trigger","first"],[]),radio:b.immutableBag(["one"],[]),input:b.immutableBag([],["execute"]),
button:b.immutableBag(["execute"],["process"]),dialog:b.immutableBag(["execute","ok","cancel"],["index"]),inlineDialog:b.immutableBag(["ok","cancel"],["index"]),page:b.immutableBag(["trigger"],["first"]),tabular:b.immutableBag(["trigger"],["first","isValid"]),dynamic:b.immutableBag([],["execute"])}});k("jp",["4v"],function(b){return b.ensure(["enter","exit","destroy"])});k("jq",["b"],function(b){var d=function(b){return function(a){return a.raw().which===b}};return{inSet:function(c){return function(a){return b.contains(c,
a.raw().which)}},and:function(c){return function(a){return b.forall(c,function(b){return b(a)})}},is:d,isShift:function(b){return!0===b.raw().shiftKey},basic:function(b,a){return{matches:d(b),run:a}},rule:function(b,a){return{matches:b,run:a}}}});k("jr",["b","1a","2v","46"],function(b,d,c,a){var e=function(a){d.has(a,"tabIndex")||d.set(a,"tabIndex","-1")};return{set:function(a){e(a);c.focus(a)},find:function(a){return c.search(a)},isFocused:c.hasFocus,mark:e,markSelectors:function(c,d){b.each(d,function(d){d=
a.descendants(c,d);b.each(d,e)})}}});k("cf","b jp jr 7 4x 3z 3n".split(" "),function(b,d,c,a,e,f,g){return function(h,l,m){var n=g.bind(h,"keydown",m.getOr(function(a){var c=b.find(l,function(b){return b.matches(a)});void 0!==c&&null!==c&&c.run(a).each(function(b){a.kill()})})),p=f.create({enter:e([]),exit:e([])});return d({isFocused:a.curry(c.isFocused,h),element:a.constant(h),clear:a.noop,enter:function(){c.set(h);p.trigger.enter()},refresh:a.noop,isEnabled:a.constant(!0),exit:function(){p.trigger.exit()},
events:p.registry,destroy:function(){n.unbind()}})}});k("c3","jp jq cf 9n 7 s".split(" "),function(b,d,c,a,e,f){return function(g,h){var l=c(g,[d.rule(d.inSet(a.SPACE().concat(a.ENTER())),function(){h.execute()(g);return f.some(!0)})],h.process());return b({element:l.element,destroy:l.destroy,clear:l.clear,isFocused:l.isFocused,isEnabled:e.constant(!0),refresh:e.noop,enter:l.enter,exit:l.exit})}});k("jv",["b","s"],function(b,d){return{adjust:function(b,a,d,f){b+=a;return b>f?d:b<d?f:b},findPrev:function(c,
a,e){var f=b.reverse(c.slice(0,a));c=b.reverse(c.slice(a+1));e=b.find(f.concat(c),e);return void 0!==e&&null!==e?d.some(e):d.none()},findNext:function(c,a,e){var f=c.slice(0,a);c=c.slice(a+1);e=b.find(c.concat(f),e);return d.from(e)}}});k("js","b jv 7 s 1b 2l 32 9z".split(" "),function(b,d,c,a,e,f,g,h){var l=function(c){c=b.find(c,m);return a.from(c)},m=function(a){return h.isVisible(a.element())&&a.isEnabled()&&"hidden"!==f.get(a.element(),"visibility")};return{exit:function(a){b.each(a,function(a){a.clear();
a.exit()})},clear:function(a){b.each(a,function(a){a.clear()})},refresh:function(a){b.each(a,function(a){a.refresh()})},first:l,enterFirst:function(b,c){c.index().bind(function(c){return a.from(b[c]).filter(m)}).orThunk(function(){return l(b)}).each(function(a){a.enter()})},isEnabled:function(a){return b.exists(a,function(a){return a.isEnabled()})},locate:function(a,d){return b.find(a,function(a){var b=d.target();a=a.element();return g.closest(b,c.curry(e.eq,a))})},next:function(a,c){var e=b.indexOf(a,
c);return d.findNext(a,e,m).getOr(c)},prev:function(a,c){var e=b.indexOf(a,c);return d.findPrev(a,e,m).getOr(c)},prevNoCycle:function(c,d){var e=b.indexOf(c,d);return 0<e?a.some(c[e-1]):a.none()},nextNoCycle:function(c,d){var e=b.indexOf(c,d);return e+1<c.length?a.some(c[e+1]):a.none()},progress:function(a,b){a.exit();b.enter()},destroy:function(a){b.each(a,function(a){a.destroy()})}}});k("c4","jp fk jq c3 jr js 9n 7 4x 3z 3n 20".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(q,r,s){var t=
s.execute(),u=d.button({execute:t}),v=r.slice(0).concat([a(s.cancel(),u),a(s.ok(),u)]),w=n.bind(q,"keydown",function(a){var b=f.locate(v,a);if(void 0!==b&&null!==b){var d=c.isShift(a);c.is(g.TAB()[0])(a)?(d=(d?f.prev:f.next)(v,b),f.progress(b,d),a.kill()):c.is(g.ESCAPE()[0])(a)?(x(),a.kill(),t(s.cancel())):(b=b.element(),"button"!==p.name(b)&&!d&&c.is(g.ENTER()[0])(a)&&(t(s.ok()),a.kill()))}}),x=function(){f.exit(v);y.trigger.exit()},y=m.create({enter:l([]),exit:l([])});return b({enter:function(){f.enterFirst(v,
s)},exit:x,clear:h.curry(f.clear,v),refresh:h.curry(f.refresh,v),isEnabled:h.curry(f.isEnabled,v),isFocused:h.curry(e.isFocused,q),events:y.registry,destroy:function(){f.destroy(v);w.unbind()}})}});k("c5","jp jq jr js 9n 7 4x 3z 4f 3n".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n){var p=l([]),q=function(b,c){d.is(e.TAB()[0])(c)&&(d.isShift(c)?a.prevNoCycle:a.nextNoCycle)(p.get(),b).each(function(d){a.progress(b,d);c.kill()})},r=m.bind(n,"keydown",function(b){var c=a.locate(p.get(),b);
void 0!==c&&null!==c&&q(c,b)}),s=h.create({enter:g([]),exit:g([])}),t=function(a){return function(){return a(p.get())}};return b({element:f.constant(n),enter:function(){a.first(p.get()).each(function(a){a.enter()})},exit:function(){a.exit(p.get());s.trigger.exit()},set:function(b){a.destroy(p.get());p.set(b)},clear:t(a.clear,p),refresh:t(a.refresh,p),isEnabled:t(a.isEnabled,p),isFocused:t(c.isFocused,n),destroy:function(){a.destroy(p.get());r.unbind()},events:s.registry})}});k("jx","b jr 7 s 33 1b 46 2y 29 9z".split(" "),
function(b,d,c,a,e,f,g,h,l,m){var n=e.immutableBag(["index","focused","group","items"],[]),p=e.immutableBag(["index","sectors","sector"],[]),q=e.immutableBag(["index","candidates"],[]);return{ofFocus:function(e,l,p){return d.find(e).bind(function(d){return h.closest(d,l).bind(function(e){var h=g.descendants(e,p),h=b.filter(h,m.isVisible),l=b.findIndex(h,c.curry(f.eq,d));return-1<l?a.some(n({index:l,focused:d,group:e,items:h})):a.none()})})},ofSector:function(d,e,l){var m=g.descendants(d,e);return h.closest(l,
e).bind(function(d){var e=b.findIndex(m,c.curry(f.eq,d));return-1<e?a.some(p({index:e,sectors:m,sector:d})):a.none()})},within:function(d,e,h){d=g.descendants(d,h);e=b.findIndex(d,c.curry(f.eq,e));return-1<e?a.some(q({index:e,candidates:d})):a.none()}}});k("jt",["jv","jx","s"],function(b,d,c){return{horizontal:function(a,e,f,g){return d.within(a,f,e).bind(function(a){var d=a.index();a=a.candidates();d=b.adjust(d,g,0,a.length-1);return c.from(a[d])})}}});k("ju",["7","b3"],function(b,d){return function(c,
a){var e=b.curry(a,-1,0),f=b.curry(a,1,0),g=d.onDirection(e,f),h=d.onDirection(f,e),e=b.curry(a,0,-1),f=b.curry(a,0,1),l=function(a){return a(c)()},g=b.curry(l,g),h=b.curry(l,h);return{west:g,east:h,north:e,south:f}}});k("c6","jp jq cf jt jr ju 9n 7 s 2y m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p,q,r){var s=l.none();e.markSelectors(p,[q.item()]);var t=function(b){return e.find(p).bind(function(c){return a.horizontal(p,q.item(),c,b)})},u=f(p,function(a){return t(a).bind(function(a){x(a);
return r.executeOnArrow().fold(function(){return l.some(!0)},v)})}),v=function(){return e.find(p).bind(r.trigger()).map(h.constant(!0))},w=c(p,[d.rule(d.inSet(g.LEFT().concat(g.UP())),u.west),d.rule(d.inSet(g.RIGHT().concat(g.DOWN())),u.east),d.rule(d.inSet(g.SPACE().concat(g.ENTER())),v)],l.none()),x=function(a){s=l.some(a);e.set(a)};return b({element:w.element,destroy:w.destroy,clickFocus:function(a){n.is(a,q.item())&&x(a)},clear:function(){s=l.none()},isFocused:w.isFocused,isEnabled:h.constant(!0),
refresh:h.noop,enter:function(){w.enter();s.orThunk(function(){return r.first().fold(function(){return m.descendant(p,q.item())},h.apply)}).bind(x)},exit:w.exit})}});k("jw","jq cf jr 9n 7 s 2y".split(" "),function(b,d,c,a,e,f,g){return{delegate:function(g,l,m){return d(g,[b.basic(a.LEFT()[0],l.west),b.basic(a.RIGHT()[0],l.east),b.basic(a.UP()[0],l.north),b.basic(a.DOWN()[0],l.south),b.rule(b.inSet(a.SPACE().concat(a.ENTER())),function(){return c.find(g).bind(m.trigger()).map(e.constant(!0))})],f.none())},
findRecent:function(a,b,c,d){return d.isValid().fold(e.constant(c),function(a){return c.filter(a)}).orThunk(function(){return d.first().bind(function(a){return a()}).orThunk(function(){return g.descendant(a,b)})})}}});k("c7","jp jv jr jw ju 7 s 4f 33 2v 46 29 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=l.immutable("row","column");return function(l,t,u,v,w){var x=u,y=v;c.markSelectors(l,[t.cell()]);var k=h(g.none()),z=function(a){return p.findIndex(a).map(function(a){return r(q.floor(a/
y),a%y)})},A=function(a,b){return c.find(l).bind(function(c){return z(c).bind(function(c){var e=d.adjust(c.row(),b,0,x-1),f=d.adjust(c.column(),a,0,y-1);c=n.descendants(l,t.cell());var h=c.length-1,e=e*y,e=e+f>h?0<a?e:h:e+f;return 0<=e&&e<c.length?g.some(c[e]):g.none()})})};u=e(l,function(a,b){return A(a,b).bind(function(a){c.set(a);k.set(g.some(a));return g.some(!0)})});var C=a.delegate(l,u,w);return b({element:C.element,destroy:C.destroy,clear:function(){k.set(g.none())},isFocused:C.isFocused,isEnabled:f.constant(!0),
refresh:f.noop,enter:function(){C.enter();k.set(a.findRecent(l,t.cell(),k.get(),w));k.get().each(m.focus)},exit:C.exit,resize:function(a,b){x=a;y=b}})}});k("c8","jp jq jr js 9n 7 4x 3z 3n".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,n,p){var q=p.ok(),r=p.cancel(),s=l.bind(m,"keydown",function(b){var c=a.locate(n,b);if(void 0!==c&&null!==c){var f=d.isShift(b);d.is(e.TAB()[0])(b)?(f=(f?a.prev:a.next)(n,c),a.progress(c,f),b.kill()):d.is(e.ESCAPE()[0])(b)?(t(),b.kill(),r(b.target())):!f&&
d.is(e.ENTER()[0])(b)&&(q(b.target()),b.kill())}}),t=function(){a.exit(n);u.trigger.exit()},u=h.create({enter:g([]),exit:g([])});return b({enter:function(){a.enterFirst(n,p)},exit:t,clear:f.curry(a.clear,n),refresh:f.curry(a.refresh,n),isEnabled:f.curry(a.isEnabled,n),isFocused:f.curry(c.isFocused,m),events:u.registry,destroy:function(){a.destroy(n);s.unbind()}})}});k("2z",["n"],function(b){return{set:function(d,c){if(void 0===c)throw new b("Value.set was undefined");d.dom().value=c},get:function(b){return b.dom().value}}});
k("c9","jp jq cf 9n 7 s 1a 2z".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){var n=c(l,[d.basic(a.ENTER()[0],function(a){return m.execute().map(function(b){var c={isShift:e.constant(d.isShift(a))},f=h.get(l);b(f,c);return!0})})],f.none());return b({element:n.element,destroy:n.destroy,clear:n.clear,isFocused:n.isFocused,isEnabled:function(){return!g.has(l,"disabled")},refresh:e.noop,enter:function(){n.enter();l.dom().setSelectionRange(0,h.get(l).length)},exit:n.exit})}});k("ca","jp jq jr js 9n 7 4x 3z 3n".split(" "),
function(b,d,c,a,e,f,g,h,l){return function(m,n){var p=l.bind(m,"keydown",function(b){var c=a.locate(n,b);if(d.is(e.ESCAPE()[0])(b))q(),b.kill();else if(void 0!==c&&null!==c&&d.is(e.TAB()[0])(b)){var f=(d.isShift(b)?a.prev:a.next)(n,c);a.progress(c,f);b.kill()}}),q=function(){a.exit(n);r.trigger.exit()},r=h.create({enter:g([]),exit:g([])});return b({enter:function(){a.first(n).each(function(a){a.enter()})},exit:q,clear:f.curry(a.clear,n),refresh:f.curry(a.refresh,n),isEnabled:f.curry(a.isEnabled,
n),isFocused:f.curry(c.isFocused,m),destroy:function(){a.destroy(n);p.unbind()},events:r.registry})}});k("cb","jp jq jr js 9n 7 4x 3z 3n".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,n){var p=l.bind(m,"keydown",function(b){var c=a.locate(n,b);if(d.is(e.ESCAPE()[0])(b))q(),b.kill();else if(void 0!==c&&null!==c)if(d.is(e.UP()[0])(b))a.progress(c,a.prev(n,c)),b.kill();else if(d.is(e.DOWN()[0])(b))a.progress(c,a.next(n,c)),b.kill();else if(d.is(e.TAB()[0])(b)){var f=(d.isShift(b)?a.prev:a.next)(n,
c);a.progress(c,f);b.kill()}}),q=function(){a.exit(n);r.trigger.exit()},r=h.create({enter:g([]),exit:g([])});return b({enter:function(){a.first(n).each(function(a){a.enter()})},exit:q,clear:f.curry(a.clear,n),refresh:f.curry(a.refresh,n),isEnabled:f.curry(a.isEnabled,n),isFocused:f.curry(c.isFocused,m),events:r.registry,destroy:function(){a.destroy(n);p.unbind()}})}});k("cc","b jp jq cf jr 9n 7 s 1b 2v 46 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(q,r,s){var t=r.stops().join(","),
u=function(){return s.first().bind(function(a){return p.descendant(q,a)}).getOr(q)},v=function(a){var c=u();return(m.hasFocus(c)?h.some:e.find)(c).bind(function(c){var d;d=u();if(l.eq(d,c)&&0>a)d=h.none();else{var e=n.descendants(d,t);c=b.findIndex(e,g.curry(l.eq,c))+a;d=c>=e.length?h.none():0>c?h.some(d):0<=c&&c<e.length?h.some(e[c]):h.none()}return d})};r=function(a){return v(a).bind(function(a){e.set(a);return h.some(!0)})};var w=a(q,[c.rule(c.and([c.isShift,c.inSet(f.TAB())]),g.curry(r,-1)),c.rule(c.inSet(f.TAB()),
g.curry(r,1)),c.rule(c.inSet(f.SPACE().concat(f.ENTER())),function(){return e.find(q).bind(s.trigger()).map(g.constant(!0))})],h.none());return d({element:w.element,destroy:w.destroy,clear:g.noop,isFocused:w.isFocused,isEnabled:g.constant(!0),refresh:g.noop,enter:function(){w.enter();e.set(u())},exit:w.exit})}});k("cd","jp jq cf jt jr ju 9n 7 s 2y m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p,q,r){var s=function(b){return e.find(p).bind(function(c){return a.horizontal(p,q.item(),
c,b)})},t=f(p,function(a){return s(a).bind(function(a){e.set(a);r.one()(p,a);return l.some(!0)})}),u=c(p,[d.rule(d.inSet(g.LEFT().concat(g.UP())),t.west),d.rule(d.inSet(g.RIGHT().concat(g.DOWN())),t.east),d.rule(d.inSet(g.SPACE()),h.curry(l.some,!0))],l.none());return b({element:u.element,destroy:u.destroy,clear:h.noop,refresh:function(){u.isFocused()&&m.descendant(p,q.selected()).each(e.set)},isFocused:u.isFocused,isEnabled:h.constant(!0),enter:function(){u.enter();m.descendant(p,q.selected()).orThunk(function(){return m.descendant(p,
q.item())}).each(function(a){n.is(a,q.selected())||r.one()(p,a);e.set(a)})},exit:u.exit})}});k("ce","b jp jq cf jv jr jx ju 9n 7 s 4x 3z 64 68 49 46 m 29 9z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w,x){return function(y,k,z){f.markSelectors(y,[k.sector(),k.group(),k.item()]);var A=function(a){return t.descendant(a,function(a){return v.is(a,k.item())&&G(a)})},C=function(a){return t.child(a,L)},D=function(a){a=s.children(a,L);return 0<a.length?n.some(a[a.length-1]):n.none()},E=h(y,
function(a){return g.ofFocus(y,k.group(),k.item()).bind(function(b){var c=b.items();b=e.adjust(b.index(),a,0,c.length-1);return n.from(c[b])})}),F=function(a){return g.ofFocus(y,k.group(),k.item()).bind(function(b){return a(b.group()).bind(A)})},G=function(a){return 0<r.get(a)},I=function(a){return g.ofSector(y,k.sector(),a).map(function(a){return e.findPrev(a.sectors(),a.index(),G).getOr(a.sector())})},H=function(a){return g.ofSector(y,k.sector(),a).map(function(a){return e.findNext(a.sectors(),
a.index(),G).getOr(a.sector())})},L=function(a){var c;if(c=v.is(a,k.group()))a=u.descendants(a,k.item()),c=b.exists(a,x.isVisible);return c},J=function(a){return function(){return a().map(function(a){f.set(a);K.trigger.active(a);return a})}},K=q.create({enter:p([]),exit:p([]),active:p(["element"])}),M=a(y,[c.rule(c.inSet(l.ESCAPE()),function(){M.exit();K.trigger.exit();return n.some(!0)}),c.rule(c.inSet(l.RIGHT().concat(l.DOWN())),J(E.east)),c.rule(c.inSet(l.LEFT().concat(l.UP())),J(E.west)),c.rule(c.and([c.isShift,
c.inSet(l.TAB())]),J(m.curry(F,function(a){return w.prevSibling(a).filter(L).orThunk(function(){return I(a).bind(D)})}))),c.rule(c.inSet(l.TAB()),J(m.curry(F,function(a){return w.nextSibling(a).filter(L).orThunk(function(){return H(a).bind(C)})}))),c.rule(c.inSet(l.SPACE().concat(l.ENTER())),function(){return f.find(y).bind(z.trigger()).map(m.constant(!0))})],n.none());return d({element:M.element,clear:m.noop,isFocused:M.isFocused,enter:function(){M.enter();K.trigger.enter();z.first()().orThunk(function(){return A(y)}).each(function(a){f.set(a);
K.trigger.active(a)})},refresh:m.noop,isEnabled:m.constant(!0),exit:M.exit,destroy:M.destroy,events:K.registry})}});k("jy",["jv","33","1r"],function(b,d,c){return{move:function(a,e,f){var g=d.immutable("row","col"),h=a.length-1,l=a[e.row()]-1,h=b.adjust(e.row(),f.dr(),0,h);a=a[h]-1;l=c.max(l,a);e=c.min(a,b.adjust(e.col(),f.dc(),0,l));return g(h,e)}}});k("cg","b jp jr jw jx jy ju 7 s 4f 33 46 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){return function(r,s,t){var u=s.row(),v=s.cell();c.markSelectors(r,
[u,v]);var w=m(l.none()),x=g(r,function(a,b){return D(a,b).bind(function(a){c.set(a);w.set(l.some(a));return l.some(!0)})}),y=n.immutable("row","col"),k=n.immutable("dc","dr"),z=function(a){a=p.descendants(a,u);return b.map(a,function(a){return p.descendants(a,v).length})},A=function(a){return q.closest(a,u).bind(function(b){return e.within(r,b,u).bind(function(c){return e.within(b,a,v).map(function(a){return y(c.index(),a.index())})})})},C=function(a){var b=p.descendants(r,u);return l.from(b[a.row()]).bind(function(b){b=
p.descendants(b,v);return l.from(b[a.col()])})},D=function(a,b){return c.find(r).bind(function(c){return A(c).bind(function(c){var d=z(r);c=f.move(d,c,k(a,b));return C(c)})})},E=a.delegate(r,x,t);return d({element:E.element,destroy:E.destroy,clear:function(){w.set(l.none())},isFocused:E.isFocused,isEnabled:h.constant(!0),refresh:h.noop,enter:function(){E.enter();w.set(a.findRecent(r,s.cell(),w.get(),t));w.get().each(c.set)},exit:E.exit})}});k("85","1n c c3 c4 c5 c6 c7 c8 c9 ca cb cc cd ce cf cg 7 4x 3z".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w){c={single:s,multiple:m,multipleAll:n,flow:f,grid:g,sectors:r,radio:q,input:l,dialog:a,button:c,inlineDialog:h,tabular:t,page:p,dynamic:e};a=function(){return{element:u.noop,clear:u.noop,isFocused:u.noop,isEnabled:u.noop,refresh:u.noop,enter:u.noop,exit:u.noop,events:w.create({enter:v([]),exit:v([]),active:v([])}).registry,destroy:u.noop,set:u.noop,clickFocus:u.noop,resize:u.noop}};return d.detect().deviceType.isTouch()?b.map(c,u.constant(a)):c});k("bj",
"jk jl jm jn jo 7i c fk 85 s 4x 3z 40 3n 2v".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t,u){var v=d(u),w=g.detect().deviceType.isTouch()?c(t,v):e(t,v);f.toolbar(w.main(),u("aria.label.toolbar"));var x=p.create({drawer:q(["delta","total"],w.events.drawer),grow:q([],w.events.grow),shrink:n([]),transitionend:n(["property"]),exit:n([])}),y=r.bind(w.element(),"transitionend",function(a){x.trigger.transitionend(a.raw().propertyName)}),k=m.none(),z=h.sectors({first:m.none,trigger:b.trigger}),
A=l.sectors(w.element(),a,z);A.events.exit.bind(function(){k=m.none();x.trigger.exit()});A.events.active.bind(function(a){k=m.some(a.element())});var C=function(){return A.isFocused()},D=function(){k.each(s.focus)};w.events.shrink.bind(function(){s.search(w.mores()).isSome()&&v.focus();x.trigger.shrink()});return{element:w.element,refresh:w.refresh,add:w.add,enter:function(){A.enter()},destroy:function(){A.exit();k=m.none();y.unbind();w.destroy();A.destroy()},focused:C,restore:D,refocus:function(){C()&&
D()},events:x.registry}}});k("9k",["bg","bh","bi","bj"],function(b,d,c,a){return{toolbar:function(b,c){return a(b,c)},menu:function(a,b,c){return d.create(a,b,c)},popup:function(a,b,d,h){return c(a,b,d,h)},menuSystem:function(a,c,d){return b(a,c,d)}}});k("hg",["b","c","s","31"],function(b,d,c,a){var e=d.detect(),f=e.deviceType.isTouch,g=function(b,c){return a.screen.width>=b&&a.screen.height>=c},h=function(){return!g(620,700)&&f()};return{isTouch:f,choice:function(a,d){return b.foldl(a,function(a,
b){return a.orThunk(function(){return b.predicate()?c.some(b.value()):c.none()})},c.none()).getOr(d)},isLarge:function(){return g(620,700)},isLargeTouch:function(){return g(620,700)&&f()},isSmallTouch:h,isLargeDesktop:function(){return g(620,700)&&!f()},isSmallAndroid:function(){return h()&&e.deviceType.isAndroid()}}});k("bk",["1n","c","43","hg"],function(b,d,c,a){d=d.detect();a={"ephox-platform-desktop":!d.deviceType.isTouch(),"ephox-platform-touch":d.deviceType.isTouch(),"ephox-platform-small-touch":a.isSmallTouch(),
"ephox-platform-android":d.deviceType.isAndroid(),"ephox-platform-ios":d.deviceType.isiOS(),"ephox-platform-ie":d.browser.isIE()||d.browser.isSpartan(),"ephox-platform-firefox":d.browser.isFirefox()};var e=[];b.each(a,function(a,b){!0===a&&e.push(b)});return{addClasses:function(a){c.add(a,e)}}});k("jz","b 30 37 4x 3z 1x l 2m 2o".split(" "),function(b,d,c,a,e,f,g,h,l){return function(){var m=g.fromTag("div");f.add(m,d.resolve("bannerarium"));f.add(m,d.resolve("layer-above-editor"));var n=[],p=c.create(),
q=function(a){-1<n.indexOf(a)&&(n=b.filter(n,function(b){return b!==a}));a.destroy();p.unbind(a.events.close);l.remove(a.element())},r=e.create({close:a(["banner"])});return{element:function(){return m},display:function(a){n.push(a);p.bind(a.events.close,function(){q(a);r.trigger.close(a)});h.append(m,a.element())},hide:q,destroy:function(){l.remove(m);b.each(n,q)},events:r.registry}}});k("bl",["jz","4x","3z"],function(b,d,c){return function(){var a=b();a.events.close.bind(function(){e.trigger.resize()});
var e=c.create({resize:d([])});return{element:a.element,display:function(b){a.display(b);e.trigger.resize()},hide:function(b){a.hide(b);e.trigger.resize()},destroy:a.destroy,events:e.registry}}});k("rx",["2g"],function(b){return{atob:function(d){return b.getOrDie("atob")(d)},requestAnimationFrame:function(d){b.getOrDie("requestAnimationFrame")(d)}}});k("gy",["3m"],function(b){return function(d,c){var a=null,e=null;return{throttle:function(){e=arguments;null===a&&(a=b(function(){d.apply(null,e);e=
a=null},c))}}}});k("ry","rx 7 gy 29 9z 2q 2r 31".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,b){var c=g(b,500);return function(){f(c)}},m=function(b,c){var d=new h.MutationObserver(c);d.observe(a.owner(b).dom(),{attributes:!0,subtree:!0,childList:!0,attributeFilter:["style","class"]});return function(){d.disconnect()}},n=void 0!==h.MutationObserver&&null!==h.MutationObserver?m:l;return{onShow:function(a,f){if(e.isVisible(a))return b.requestAnimationFrame(f),d.noop;var g=c(function(){e.isVisible(a)&&
(h(),b.requestAnimationFrame(f))},100),h=n(a,g.throttle);return h}}});k("rz",["b","s","1b"],function(b,d,c){var a=[],e=function(d){return b.findIndex(a,function(a){return c.eq(a.element,d)})};return{begin:function(b,c){if(-1===e(b)){var d=c();a.push({element:b,unbind:d})}},query:function(b){b=e(b);return-1===b?d.none():d.some(a[b])},end:function(b){b=e(b);if(-1!==b){var c=a[b];a.splice(b,1);c.unbind()}}}});k("k0","b rx 7 s 1b 3n l 64 ry 9z 2p rz 3m 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,
q,r){var s=function(a){return{element:a,handlers:[],lastWidth:n.get(a),lastHeight:h.get(a)}},t=[],u=function(a){return b.findIndex(t,function(b){return e.eq(b.element,a)})},v=function(a){var d=n.get(a.element),e=h.get(a.element);if(d!==a.lastWidth||e!==a.lastHeight)a.lastWidth=d,a.lastHeight=e,b.each(a.handlers,c.apply)},w=function(a){var b=a.element;m.isVisible(b)?v(a):p.begin(b,function(){return l.onShow(b,function(){p.end(b);v(a)})})},x=!1,y=function(){x=!1;b.each(t,w)},k=function(){x||(x=!0,d.requestAnimationFrame(y))},
z=a.none(),A=function(){z.each(function(b){b.unbind();z=a.none()})};return{bind:function(c,d){var h=b.find(t,function(a){return e.eq(a.element,c)});void 0===h&&(h=s(c),t.push(h));h.handlers.push(d);z.isNone()&&(z=a.some(f.bind(g.fromDom(r),"resize",k)));q(function(){-1!==u(h.element)&&w(h)},100)},unbind:function(a,c){p.end(a);var d=u(a);if(-1!==d){var e=b.indexOf(t[d].handlers,c);-1!==e&&(t[d].handlers.splice(e,1),0===t[d].handlers.length&&t.splice(d,1),0===t.length&&A())}}}});k("bm","7 s 4x 3z 64 k0 2p".split(" "),
function(b,d,c,a,e,f,g){return function(h){var l=a.create({change:c(["width","height","element"])}),m=void 0!==h.resize&&void 0!==h.resize.container?d.some(h.resize.container):d.none(),n=d.none();return{hookup:function(a){var c=m.getOr(a);a=function(){h.resize&&h.resize.callback&&h.resize.callback();var a=g.get(c),b=e.get(c);l.trigger.change(a,b,c)};n=d.some({target:b.constant(c),f:a});f.bind(c,a)},destroy:function(){n.each(function(a){f.unbind(a.target(),a.f)})},events:l.registry}}});k("bn",["7",
"4x","3z"],function(b,d,c){return function(){var a=c.create({change:d(["width","height","element"])});return{hookup:b.noop,destroy:b.noop,events:a.registry}}});k("k1",["7","s","6f","35","2p"],function(b,d,c,a,e){return function(){return{updateWidth:b.noop,clearWidth:b.noop,build:b.identity,update:b.noop,width:e.getOuter,init:function(a,b,c,d,e){a.refresh()},state:b.constant({toolbar:{drag:d.none()}}),integrate:function(b,c,d,e){a.append(b,[c.element(),d.element(),e])},destroy:b.noop,events:c(["changed"])}}});
k("vy",["4v"],function(b){var d=b.exactly(["compare","extract","mutate","sink"]),c=b.exactly(["element","start","stop","destroy"]);b=b.exactly(["forceDrop","drop","move","delayDrop"]);return{mode:d,sink:c,api:b}});k("zw",["48"],function(b){return{resolve:b.create("ephox-dragster").resolve}});k("vz","zw 6 1x 2l l 2o".split(" "),function(b,d,c,a,e,f){return function(g){g=d.merge({layerClass:b.resolve("blocker")},g);var h=e.fromTag("div");a.setAll(h,{position:"fixed",left:"0px",top:"0px",width:"100%",
height:"100%"});c.add(h,b.resolve("blocker"));c.add(h,g.layerClass);return{element:function(){return h},destroy:function(){f.remove(h)}}}});k("pb","vy vz s 3d 3n 2m 2o".split(" "),function(b,d,c,a,e,f,g){return b.mode({compare:function(b,c){return a(c.left()-b.left(),c.top()-b.top())},extract:function(b){return c.some(a(b.x(),b.y()))},sink:function(a,c){var m=d(c),n=e.bind(m.element(),"mousedown",a.forceDrop),p=e.bind(m.element(),"mouseup",a.drop),q=e.bind(m.element(),"mousemove",a.move),r=e.bind(m.element(),
"mouseout",a.delayDrop);return b.sink({element:m.element,start:function(a){f.append(a,m.element())},stop:function(){g.remove(m.element())},destroy:function(){m.destroy();p.unbind();q.unbind();r.unbind();n.unbind()}})},mutate:function(a,b){a.mutate(b.left(),b.top())}})});k("zx",["s","4x","3z"],function(b,d,c){return function(){var a=b.none(),e=function(c,d){var e=a.map(function(a){return c.compare(a,d)});a=b.some(d);return e},f=c.create({move:d(["info"])});return{onEvent:function(a,b){b.extract(a).each(function(a){e(b,
a).each(function(a){f.trigger.move(a)})})},reset:function(){a=b.none()},events:f.registry}}});k("zy",["7"],function(b){return function(d){return{onEvent:function(b,a){},reset:b.noop}}});k("w0",["zx","zy"],function(b,d){return function(){var c=d(),a=b(),e=c;return{on:function(){e.reset();e=a},off:function(){e.reset();e=c},isOn:function(){return e===a},onEvent:function(a,b){e.onEvent(a,b)},events:a.events}}});k("pc","vy w0 6d 4x 3z 9".split(" "),function(b,d,c,a,e,f){return{setup:function(g,h,l){var m=
!1,n=e.create({start:a([]),stop:a([])}),p=d(),q=function(){t.stop();p.isOn()&&(p.off(),n.trigger.stop())},r=c(q,200);p.events.move.bind(function(a){h.mutate(g,a.info())});var s=function(a){return function(){var b=f.prototype.slice.call(arguments,0);if(m)return a.apply(null,b)}},t=h.sink(b.api({forceDrop:q,drop:s(q),move:s(function(a,b){r.cancel();p.onEvent(a,h)}),delayDrop:s(r.schedule)}),l);return{element:t.element,go:function(a){t.start(a);p.on();n.trigger.start()},on:function(){m=!0},off:function(){m=
!1},destroy:function(){t.destroy()},events:n.registry}}}});k("ho",["pb","pc","9"],function(b,d,c){return{transform:function(a,c){var f=void 0!==c?c:{};return d.setup(a,void 0!==f.mode?f.mode:b,c)}}});k("10y",["4x","3z","3e"],function(b,d,c){return{both:function(a){var e=d.create({relocate:b(["x","y","deltaX","deltaY"])});return{mutate:function(b,d){var h=c.absolute(a),l=h.left()+b,h=h.top()+d;e.trigger.relocate(l,h,b,d)},events:e.registry}}}});k("xj","ho 10y 4x 3z 2l 3n l 6e q".split(" "),function(b,
d,c,a,e,f,g,h,l){return function(m,n){var p=a.create({relocate:c(["x","y","deltaX","deltaY"]),dragend:c([])}),q=d.both(m);e.set(m,"position","absolute");var r=b.transform(q),s=f.bind(m,"mousedown",function(a){0!==a.raw().button||h.closest(a.target(),n)||(r.on(),r.go(g.fromDom(l.body)))});r.events.stop.bind(function(){p.trigger.dragend();r.off()});q.events.relocate.bind(function(a){p.trigger.relocate(a.x(),a.y(),a.deltaX(),a.deltaY())});return{blocker:r.element,destroy:function(){s.unbind();r.destroy()},
events:p.registry}}});k("10z",["b","s","33","1r"],function(b,d,c,a){var e=c.immutable("hx","hy","position","x","y"),f=function(a,b,c,d,f,p){p=b.x();b=b.y()-c;return(b>=a.y()&&b<=a.y()+a.h()?[e(p,b,"absolute",p,b)]:[]).concat([e(f,a.y(),"fixed",f-d.left(),a.fy())])};return{detect:function(c,e,l,m,n,p){c=f(c,e,n,p,l,m);c=b.find(c,function(b){return 10>a.abs(m-b.hy())&&38>a.abs(l-b.hx())});return d.from(c)}}});k("110",["7"],function(b){return function(d,c,a,e){return{x:b.constant(d),y:b.constant(c),
width:b.constant(a),height:b.constant(e),right:b.constant(d+a),bottom:b.constant(c+e)}}});k("xm",["110","64","3e","2p"],function(b,d,c,a){return{box:function(e){var f=c.absolute(e),g=a.getOuter(e);e=d.getOuter(e);return b(f.left(),f.top(),g,e)}}});k("13s",["48"],function(b){return{resolve:b.create("ephox-ego").resolve}});aa("cy",parseInt);k("111","13s 7 s 1a 1t cy".split(" "),function(b,d,c,a,e,f){return{make:function(g){var h="data-"+b.resolve(g+"-left"),l="data-"+b.resolve(g+"-top"),m="data-"+b.resolve(g+
"-position");return{get:function(b){var g=f(a.get(b,h),10),q=f(a.get(b,l),10);b=a.get(b,m);return e(g)||e(q)?c.none():c.some({left:d.constant(g),top:d.constant(q),position:d.constant(b)})},set:function(b,c,d,e){a.set(b,m,c);a.set(b,h,d+"px");a.set(b,l,e+"px")},clear:function(b){a.remove(b,m);a.remove(b,h);a.remove(b,l)}}}}});k("xk","10z xm 111 33 3d 28 29".split(" "),function(b,d,c,a,e,f,g){var h=c.make("pre-snap");a.immutable("fixed","loc");var l=function(a,b,c,d,e,f){return h.get(b).fold(function(){return a.fromLocation(b,
c,d)},function(c){return a.fromFixed(b,c.left()+e,c.top()+f)})},m=function(a,c,e,h){var l=g.owner(c),l=f.get(l);c=d.box(c);e=e.loc();return b.detect(a,c,e.left(),e.top(),h,l)};return{move:function(a,b,c,d,f,g){var u=a.graph(),v=a.lazyTheatre(),w=a.lazyHeight();c=l(u,b,c,d,f,g);var x=c.loc(),y=c.fixed();return m(v,a.container(),c,w).fold(function(){var a=u.boundToFixed(v,b,x.left(),x.top(),y.left(),y.top(),w);h.set(b,"fixed",a.left(),a.top());return{position:"fixed",left:a.left()+"px",top:a.top()+
"px"}},function(a){var c=u.boundToFixed(v,b,x.left(),x.top(),y.left(),y.top(),w);h.set(b,"fixed",c.left()+"px",c.top()+"px");c="absolute"===a.position()?u.locationToAbsolute(b,a.x(),a.y()):e(a.x(),a.y());return{position:a.position(),left:c.left()+"px",top:c.top()+"px"}})},forget:function(a){h.clear(a)}}});k("xn",[],function(){return{isInside:function(b,d,c){return!(d>b.y()+b.h()||c<b.y())},isAllInside:function(b,d,c){return d>b.y()&&d<b.y()+b.h()&&c>b.y()&&c<b.y()+b.h()}}});k("xl","111 xn s 3d 2l 3e cy".split(" "),
function(b,d,c,a,e,f,g){var h=b.make("old"),l=function(b,c,d){return e.getRaw(c,"left").bind(function(b){return e.getRaw(c,"top").map(function(c){var d=g(b,10);c=g(c,10);return a(d,c)})}).getOrThunk(function(){return b.locationToAbsolute(c,d.left(),d.top())})},m=function(a,b,g,m,n,u){g=f.absolute(m);n="absolute"===e.get(m,"position");var v=d.isAllInside(b,g.top(),g.top()+u());return n&&!v?(n=l(a,m,g),h.set(m,"absolute",n.left(),n.top()),a=a.absoluteToFixed(m,g.left(),g.top()),b=g.top()<=b.y()?b.fy():
b.fy()+b.h()-u(),c.some({position:"fixed",left:a.left()+"px",top:b+"px"})):c.none()},n=function(a,b,f,g,l,m){return h.get(g).bind(function(f){var l="fixed"===e.get(g,"position"),n=a.absoluteToLocation(g,f.left(),f.top()),n=d.isAllInside(b,n.top(),n.top()+m());return l&&n?(h.clear(g),c.some({position:"absolute",left:f.left()+"px",top:f.top()+"px"})):c.none()})};return{forget:function(a){h.clear(a)},update:function(a,b,c,d,f,g){m(a,b,c,d,f,g).orThunk(function(){return n(a,b,c,d,f,g)}).each(function(a){e.setAll(d,
a)})},state:function(a){return h.get(a)},set:function(a,b){h.set(a,b.position(),b.left(),b.top())}}});k("s0","xj xk xl 7 s 4x 3z 40 2l 3e".split(" "),function(b,d,c,a,e,f,g,h,l,m){return{none:function(b,c){var d=g.create({dragend:f([]),moved:f([])});return{blocker:a.die("no blocker"),setState:a.noop,getState:a.constant({}),init:function(a,b){l.setAll(c,{left:a+"px",top:b+"px",position:"absolute"});d.trigger.moved()},update:a.noop,destroy:a.noop,events:d.registry}},except:function(e){return function(p,
q){var r=b(q,e.join(",")),s=g.create({dragend:h([],r.events.dragend),moved:f([])});r.events.relocate.bind(function(a){var b=a.x(),e=a.y(),f=a.deltaX();a=a.deltaY();b=d.move(p,q,b,e,f,a);l.setAll(q,b);"absolute"!==b.position&&c.forget(q)});r.events.dragend.bind(function(){s.trigger.moved()});return{blocker:r.blocker,setState:function(a){l.setAll(q,{position:a.position(),left:a.x()+"px",top:a.y()+"px"})},getState:function(){var b=m.viewport(q),c=l.get(q,"position");return{x:b.left,y:b.top,position:a.constant(c)}},
init:function(a,b){l.setAll(q,{left:a+"px",top:b+"px",position:"absolute"});s.trigger.moved()},update:function(){d.forget(q)},destroy:function(){r.destroy()},events:s.registry}}}}});k("s1","6 s 3z 40 2l 3e 2p 1r cy".split(" "),function(b,d,c,a,e,f,g,h){return{register:function(g,m,n,p){g.container();var q=n(g,m),r=p(g,m);n=c.create({dragend:a([],q.events.dragend),appear:a(["element"],r.events.appear),disappear:a(["element"],r.events.disappear)});q.events.moved.bind(function(){t();s=!0});r.events.scrolled.bind(function(){t()});
var s=!1,t=function(){q.update();r.update();var a=g.lazyTheatre(),b=f.absolute(m),a=h.max(0,a.x()+a.w()-b.left());e.set(m,"max-width",a+"px")};return{blocker:q.blocker,setState:function(a){q.setState(a);r.setState(a);t();s=!0},state:function(){if(!s)return d.none();var a=b.deepMerge(q.getState(),r.getState());return d.some(a)},init:function(a,b){q.init(a,b);t()},update:t,destroy:function(){r.destroy();q.destroy()},events:n.registry}}}});k("s2","xl xm xn 7 4x 3z 3n 28 29".split(" "),function(b,d,c,
a,e,f,g,h,l){return{transitions:function(m,n){var p=m.container(),q=l.defaultView(n),r=f.create({appear:e(["element"]),disappear:e(["element"]),scrolled:e([])}),s=g.bind(q,"scroll",function(){r.trigger.scrolled()});return{update:function(){var a=m.lazyTheatre(),e=d.box(p);if(c.isInside(a,e.y(),e.bottom())){r.trigger.appear(n);var f=m.graph(),g=l.owner(p),g=h.get(g);b.update(f,a,e,n,g,m.lazyHeight)}else r.trigger.disappear(n)},destroy:function(){s.unbind()},setState:function(c){c.transition().each(a.curry(b.set,
n))},getState:function(){return{transition:a.constant(b.state(n))}},events:r.registry}}}});k("112",["33","3d","28","29"],function(b,d,c,a){var e=b.immutable("fixed","loc");return function(b){var g=function(b,e,f){b=a.owner(b);b=c.get(b);e-=b.left();f-=b.top();return d(e,f)},h=function(b,e,f){b=a.owner(b);b=c.get(b);e+=b.left();f+=b.top();return d(e,f)};return{locationToFixed:g,fixedToLocation:h,absoluteToFixed:function(e,g,h){var p=b();e=a.owner(e);e=c.get(e);g-=e.left();return d(g,p.top()-h)},locationToAbsolute:function(a,
c,e){a=b();return d(c,e).translate(-a.left(),-a.top())},absoluteToLocation:function(a,c,e){a=b();return d(c,e).translate(a.left(),a.top())},fromFixed:function(a,b,c){var f=d(b,c);a=h(a,b,c);return e(f,a)},fromLocation:function(a,b,c){a=g(a,b,c);b=d(b,c);return e(a,b)},boundToFixed:function(a,b,c,e,f,g,h){b=c<a.x()?a.fx():c>a.x()+a.w()?a.fx()+a.w():f;a=e<a.y()?a.fy():e+h>a.y()+a.h()?a.fy()+a.h()-h:g;return d(b,a)}}}});k("xo",["112","7"],function(b,d){return function(c,a,e,f){a=b(a);return{lazyTheatre:c,
graph:d.constant(a),lazyHeight:e,container:d.constant(f)}}});k("s3","xo 7 3d 64 3e 28 2y 29 31".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,n){var p=m.isInline()?m.element():h.parent(m.placeholder()).getOr(m.placeholder());return b(function(){var a=f.get();return{x:a.left,y:a.top,w:d.constant(l.innerWidth),h:d.constant(l.innerHeight),fx:d.constant(0),fy:d.constant(0)}},function(){return m.isInline()?c(0,0):e.absolute(p)},function(){var b=g.descendant(n,".ephox-chameleon-toolbar").getOr(n);
return a.getOuter(b)},p)}});k("63","30 1x 2l 3e 29 2p".split(" "),function(b,d,c,a,e,f){var g=b.resolve("drag-show"),h=b.resolve("fade-container");return{width:function(b,d){return c.getRaw(b,"max-width").fold(function(){return e.owner(d).dom().defaultView.innerWidth-a.absolute(d).left()},function(a){return parseInt(a,10)})},updateWidth:function(a,b,d){b=0===d.extra().length?d.withinWidth():d.withinWidth()+f.getOuter(b.group());0<b&&c.set(a,"width",b+"px")},clearWidth:function(a){c.remove(a,"width")},
offsetFrom:function(b,c,d,e){c=void 0!==e.toolbar.offset?e.toolbar.offset:{left:0,top:-1*d};d=a.absolute(b.element());b=b.isInline()?{left:d.left(),top:d.top()}:{left:0,top:0};return{left:b.left+c.left,top:b.top+c.top}},initFade:function(a,b){d.add(b,g)},fadeIn:function(a,b){d.remove(a,h);d.add(b,g)},fadeOut:function(a,b){d.remove(b,g);d.add(a,h)}}});k("k2","7i s0 s1 s2 c 7 30 s3 63 3z 40 1x 43 2l l 64 2m 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){return function(w,x){var y=s.fromTag("div");
r.set(y,"position","relative");p.add(y,g.resolve("dragging-container"));var k=s.fromTag("div");p.add(k,g.resolve("draggable-container"));var z=w.isInline()?x:k,A=h(w,z,k),C=a.transitions,D=d.except([".ephox-pastry-button","."+g.resolve("banner-buttons")+" *",".ephox-polish-ui-container",".ephox-polish-socket"]),E=c.register(A,z,D,C);l.initFade(z,k);E.events.appear.bind(f.curry(l.fadeIn,z,k));E.events.disappear.bind(f.curry(l.fadeOut,z,k));p.add(k,g.resolve("layer-above-editor"));q.add(E.blocker(),
[g.resolve("above-outside"),g.resolve("dragging")]);var F=s.fromTag("span");q.add(F,[g.resolve("toolbar-drag-handle"),g.resolve("general-drag-handle"),"ephox-textbox-font",g.resolve("icon")]);b.presentation(F);A=e.detect();A.browser.isIE()&&10===A.browser.version.major&&p.add(F,g.resolve("ie10"));return{updateWidth:f.curry(l.updateWidth,z),clearWidth:f.curry(l.clearWidth,z),build:function(a){return[F].concat(a)},width:f.curry(l.width,z),init:function(a,b,c,d,e){var f=r.preserve(z,function(){r.set(z,
"visibility","hidden");r.remove(z,"display");a.refresh();return t.get(a.element())});e.toolbar.drag.fold(function(){var a=l.offsetFrom(w,z,f,d);E.init(a.left,a.top)},E.setState);v.append(k,[a.element(),b.element()])},update:function(){E.update()},state:function(){return{toolbar:{drag:E.state()}}},integrate:function(a,b,c,d){u.append(k,b.element());w.isInline()?(v.append(y,[k,d]),u.append(x,y)):v.append(x,[k,d])},destroy:function(){E.destroy()},events:m.create({changed:n([],E.events.dragend)}).registry}}});
k("k3","s0 s1 s2 7 s 30 s3 63 3z 40 1x 2l l 64 2m 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){return function(u,v){var w=q.fromTag("div");p.set(w,"position","relative");n.add(w,f.resolve("floating-container"));var x=q.fromTag("div");n.add(x,f.resolve("draggable-container"));var y=u.isInline()?v:x,k=g(u,y),z=d.register(k,y,b.none,c.transitions);h.initFade(y,x);z.events.appear.bind(a.curry(h.fadeIn,y,x));z.events.disappear.bind(a.curry(h.fadeOut,y,x));n.add(x,f.resolve("layer-above-editor"));
return{updateWidth:a.curry(h.updateWidth,y),clearWidth:a.curry(h.clearWidth,y),build:a.identity,width:a.curry(h.width,y),init:function(a,b,c,d,e){c=p.preserve(y,function(){p.set(y,"visibility","hidden");p.remove(y,"display");a.refresh();return r.get(a.element())});d=h.offsetFrom(u,y,c,d);z.init(d.left,d.top);t.append(x,[a.element(),b.element()])},update:function(){z.update()},state:a.constant({toolbar:{drag:e.none()}}),integrate:function(a,b,c,d){s.append(x,b.element());u.isInline()?(t.append(w,[x,
d]),s.append(v,w)):t.append(v,[x,d])},destroy:function(){z.destroy()},events:l.create({changed:m([],z.events.dragend)}).registry}}});k("bo",["k1","k2","k3"],function(b,d,c){return{setup:function(a,e,f,g){return(!0===f.toolbar.draggable?d:void 0!==f.toolbar.offset||a.isInline()?c:b)(a,e)}}});k("6o","9k 7 4t 6u 1f bk 30 bl bm bn bo 1a 1x 43 2l l 2m 2o 2p".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w){return function(x,y,k,z,A,C){var D=t.fromTag("div");z.updateUi(D);r.add(D,[g.resolve("editor-container"),
"ephox-textbox-font",g.resolve("layer-editor")]);p.set(D,"lang",e.get());f.addClasses(D);var E=n.setup(x,D,A,C),F=b.toolbar(E,a.translate);!1===A.toolbar.visible&&q.add(D,"ephox-polish-no-toolbar");y.events.toolbar.bind(F.enter);F.events.exit.bind(x.focus);var G=h(),I=t.fromTag("div");q.add(I,g.resolve("socket"));var H=A.autoresize?l(A):m();E.integrate(D,F,G,I);var L=x.isInline()?function(){s.set(G.element(),"min-width",w.getOuter(x.element())+"px")}:d.noop;H.events.change.bind(function(a){F.refresh();
k.refresh();L()});E.events.changed.bind(function(){F.refresh()});return{element:function(){return D},socket:function(a){a.connect(I)},viewport:d.constant(I),connect:function(a){u.append(a,D);c.detect(D);H.hookup(x.element());return!0},destroy:function(){H.destroy();F.destroy();E.destroy();G.destroy();v.remove(D)},toolbar:F,position:function(){L();E.init(F,G,I,A,C)},refresh:function(){E.update();F.refresh()},banners:G.element,displayBanner:G.display,hideBanner:G.hide,state:E.state}}});k("4z","a c 1o 7 s 6m 6n 6o 6p 6q l".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a){a=m.absolute(a);var b=m.view();a=f.intersect(a,b);return l(a.x(),a.y(),a.width(),a.height())};return{build:function(a,b,c,d,e,f,l,m){var n=h(a,b,c,f,l,m),p=d.tabbed(n);p.init();return{element:n.element,socket:n.socket,viewport:n.viewport,init:function(b,d,h,l){d=p.config(a.isInline(),d,e,h,l);g.setup(n,f,a,b,c,h,d);p.loaded()},connect:n.connect,destroy:function(){n.destroy();p.destroy()},displayBanner:n.displayBanner,hideBanner:n.hideBanner,position:n.position,
refresh:n.refresh,tabstrip:n.toolbar,state:n.state}},bounds:function(){var f=function(a){var d=function(){return e.from(a.bounds()).filter(c.isPrototypeOf).map(n.fromDom).map(p).getOrThunk(m.view)};return b.isFunction(a.bounds)?d:m.view};return d.detect().deviceType.isTouch()?a.constant(m.view):f}()}});k("3q",["s","p","4y","4z"],function(b,d,c,a){return{settings:function(e){return{onprem:!0,blocktag:{styles:[{rule:"p"},{rule:"h1"},{rule:"h2"},{rule:"h3"},{rule:"h4"},{rule:"div"},{rule:"pre"}],bundled:!0},
image:{bundled:!0},imageEdit:{bundled:!0},imageupload:{immediate:!1,bundled:!1},content:{css:e+"/css",tabindex:null,stylesheets:[],documentStyles:"",prettyprint:!0},ui:{layout:a,toolbar:{draggable:!1},autoresize:!0,locale:{},editorName:d.value("debug"),bounds:null,showHelpHint:!1},shortcuts:{features:!0},spelling:{bundled:!0},specialchar:{bundled:!0},fileupload:{bundled:!0,allowLocalImages:!0},horizontalrule:{bundled:!0},media:{bundled:!0},mentions:{bundled:!1},usersettings:{bundled:!0,menu:["spellcheck",
"capitalisation","autocorrect"],login:!1},registration:{bundled:!1},help:{baseUrl:e+"/html",integration:{},bundled:!0},wordcount:{bundled:!0},formatting:{bundled:!0},alignindent:{bundled:!0},directionality:{bundled:!0},parlance:{bundled:!0,languages:"en es fr de pt zh".split(" ")},font:{faces:[],bundled:!0},lists:{bundled:!0},link:{bundled:!0},removeformat:{bundled:!0},fullscreen:{bundled:!0,autoresize:!1},editorcontext:{bundled:!0},macros:{whitelist:b.none(),bundled:!0},highlighter:{external:[],
bundled:!0},table:{bundled:!0},contextmenu:{bundled:!0},project:{apiKey:null},smartclipboard:{bundled:!0,copy:{},paste:{forceText:!1,baseUrl:e+"/js",swf:e+"/flash/textboxpaste.swf",officeStyles:"prompt",htmlStyles:"merge",allowLocalImages:!0,enableFlashImport:!0}},resize:{bundled:!0},platform:{toolbar:{items:c,contextual:["table-tools","image-tools"]},allowLocalImages:!0,fillscreen:!1},codeview:{bundled:!0,showButton:!0,mode:"pencil",css:e+"/css",js:e+"/js"},findreplace:{bundled:!0},accessibility:{bundled:!0},
plaincodeview:{bundled:!0}}},state:function(){return{spelling:{words:{}},undo:{initial:{clean:"",marked:""},undo:[],redo:[]},profile:{spelling:!1,autocorrect:!0,capitalisation:!1,linkpreviews:!1},content:{clean:"",marked:""},ui:{toolbar:{drag:b.none()}},macros:{customs:{}},filters:{customs:[]},laundry:{dirty:!1}}}}});k("3r",["s","3v","4x","3z"],function(b,d,c,a){return function(e){var f=b.none(),g=function(a){return function(){var b=e.get()[a];if(null===b||void 0===b)throw"can't find instance method: "+
a;return b.apply(null,arguments)}},h=function(){var a=f.getOrDie("Cannot reconnect the editor before it has been connected the first time.");g("connect")(a)&&l.trigger.connected()},l=a.create({connected:c([])});return d.external({activateInline:g("activateInline"),deactivateInline:g("deactivateInline"),content:g("content"),keyboard:g("keyboard"),smartview:g("smartview"),macros:g("macros"),ui:g("ui"),filter:g("filter"),undo:g("undo"),operations:g("operations"),getMode:g("getMode"),element:g("element"),
connect:function(a){f=b.some(a);h()},reconnect:h,focus:g("focus"),getContent:g("getContent"),setContent:g("setContent"),insertHtmlAtCursor:g("insertHtmlAtCursor"),state:g("state"),communication:g("communication"),uploader:g("uploader"),isDirty:g("isDirty"),setDirty:g("setDirty"),isPrettyPrinting:g("isPrettyPrinting"),events:l.registry})}});k("kw",[],function(){return"body p div article aside figcaption figure footer header nav section ol ul li table thead tbody tfoot caption tr td th h1 h2 h3 h4 h5 h6 blockquote pre address".split(" ")});
k("e5",["c","s","n"],function(b,d,c){return function(a,e){var f=function(a){try{return g(a)}catch(b){return d.none()}},g=function(b){return a(b)?d.from(b.dom().nodeValue):d.none()},h=b.detect().browser,l=h.isIE()&&10===h.version.major?f:g;return{get:function(b){if(!a(b))throw new c("Can only get "+e+" value of a "+e+" node");return l(b).getOr("")},getOption:l,set:function(b,d){if(!a(b))throw new c("Can only set raw "+e+" value of a "+e+" node");b.dom().nodeValue=d}}}});k("9y",["20","e5"],function(b,
d){var c=d(b.isText,"text");return{get:function(a){return c.get(a)},getOption:function(a){return c.getOption(a)},set:function(a,b){c.set(a,b)}}});k("dg","kw b 7 1a 1b 2l l 2m 35 20 68 49 2o 46 2y 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){return function(){return{up:c.constant({selector:s.ancestor,closest:s.closest,predicate:p.ancestor,all:u.parents}),down:c.constant({selector:r.descendants,predicate:n.descendants}),styles:c.constant({get:f.get,getRaw:f.getRaw,set:f.set,remove:f.remove}),
attrs:c.constant({get:a.get,set:a.set,remove:a.remove,copyTo:function(b,c){var d=a.clone(b);a.setAll(c,d)}}),insert:c.constant({before:h.before,after:h.after,afterAll:l.after,append:h.append,appendAll:l.append,prepend:h.prepend,wrap:h.wrap}),remove:c.constant({unwrap:q.unwrap,remove:q.remove}),create:c.constant({nu:g.fromTag,clone:function(a){return g.fromDom(a.dom().cloneNode(!1))},text:g.fromText}),query:c.constant({comparePosition:function(a,b){return a.dom().compareDocumentPosition(b.dom())},
prevSibling:u.prevSibling,nextSibling:u.nextSibling}),property:c.constant({children:u.children,name:m.name,parent:u.parent,isText:m.isText,isElement:m.isElement,getText:t.get,setText:t.set,isBoundary:function(a){return m.isElement(a)?"body"===m.name(a)?!0:d.contains(b,m.name(a)):!1},isEmptyTag:function(a){return m.isElement(a)?d.contains(["br","img","hr"],m.name(a)):!1}}),eq:e.eq,is:e.is}}});k("mu",["b","s","33"],function(b,d,c){var a=c.immutable("item","mode");c=function(b,c,d,f){var g=void 0!==
f?f:e;return b.property().parent(c).map(function(b){return a(b,g)})};var e=function(b,c,d,e){var g=void 0!==e?e:f;return d.sibling(b,c).map(function(b){return a(b,g)})},f=function(b,c,d,e){var g=void 0!==e?e:f;b=b.property().children(c);return d.first(b).map(function(b){return a(b,g)})},g=[{current:c,next:e,fallback:d.none()},{current:e,next:f,fallback:d.some(c)},{current:f,next:f,fallback:d.some(e)}],h=function(a,c,e,f,q){var r=b.find(void 0!==q?q:g,function(a){return a.current===e});return void 0===
r||null===r?d.none():r.current(a,c,f,r.next).orThunk(function(){return r.fallback.bind(function(b){return h(a,c,b,f)})})};return{backtrack:c,sidestep:e,advance:f,go:h}});k("mv",["s"],function(b){return{left:function(){return{sibling:function(b,c){return b.query().prevSibling(c)},first:function(d){return 0<d.length?b.some(d[d.length-1]):b.none()}}},right:function(){return{sibling:function(b,c){return b.query().nextSibling(c)},first:function(d){return 0<d.length?b.some(d[0]):b.none()}}}}});k("mt",["s",
"mu","mv"],function(b,d,c){var a=function(c,f,g,h,l,m){return d.go(c,f,h,l).bind(function(d){return m(d.item())?b.none():g(d.item())?b.some(d.item()):a(c,d.item(),g,d.mode(),l,m)})};return{left:function(b,f,g,h){return a(b,f,g,d.sidestep,c.left(),h)},right:function(b,f,g,h){return a(b,f,g,d.sidestep,c.right(),h)}}});k("hj",["7","mt","mu","mv"],function(b,d,c,a){var e=function(a,b){return 0===a.property().children(b).length},f=function(a,b,c,e){return d.left(a,b,c,e)},g=function(a,b,c,e){return d.right(a,
b,c,e)};return{before:function(a,c,d){return f(a,c,b.curry(e,a),d)},after:function(a,c,d){return g(a,c,b.curry(e,a),d)},seekLeft:f,seekRight:g,walkers:function(){return{left:a.left,right:a.right}},walk:function(a,b,d,e,f){return c.go(a,b,d,e,f)},backtrack:c.backtrack,sidestep:c.sidestep,advance:c.advance}});k("i8",["dg","hj"],function(b,d){var c=b();return{gather:function(a,b,f){return d.gather(c,a,b,f)},before:function(a,b){return d.before(c,a,b)},after:function(a,b){return d.after(c,a,b)},seekLeft:function(a,
b,f){return d.seekLeft(c,a,b,f)},seekRight:function(a,b,f){return d.seekRight(c,a,b,f)},walkers:function(){return d.walkers()},walk:function(a,b,f,g){return d.walk(c,a,b,f,g)}}});k("ei","1a l 2m 35 2o 29".split(" "),function(b,d,c,a,e,f){var g=function(a){return d.fromDom(a.dom().cloneNode(!0))},h=function(a,c){var e=d.fromTag(c),f=b.clone(a);b.setAll(e,f);return e};return{shallow:function(a){return d.fromDom(a.dom().cloneNode(!1))},shallowAs:h,deep:g,copy:function(b,c){var d=h(b,c),e=f.children(g(b));
a.append(d,e);return d},mutate:function(b,d){var g=h(b,d);c.before(b,g);var p=f.children(b);a.append(g,p);e.remove(b);return g}}});k("k6","b p i8 l 2m 35 20 2o ei 46 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return{convertToHeading:function(c,g){var r=n.owner(c),r=a.fromTag(g,r.dom()),s=n.children(c),s=b.map(s,l.deep);f.append(r,s);s=m.descendants(r,"b,strong");b.each(s,h.unwrap);e.before(c,r);h.remove(c);return d.value(r)},joinLinks:function(a,b){return c.seekLeft(b,function(a){return"a"===
g.name(a)},a).fold(function(){return d.value(b)},function(a){var c=n.children(b);f.append(a,c);h.remove(b);return d.value(a)})}}});k("s4",["7","p"],function(b,d){return function(c){var a=b.compose(d.error,c);return{invalidError:a,different:function(b,c,g,h,l){return 0===c.length?a(h):c===g?a(l):d.value(b)}}}});k("k7",["s4","1a"],function(b,d){return function(c){var a=b(c);return{changeAlt:function(b,c,g,h){var l=d.get(b,"src");return a.different(b,c,l,g,h).map(function(a){d.set(a,"alt",c);return a})}}}});
k("il",["7","1b"],function(b,d){return function(c,a,e,f){var g=d.eq(c,e)&&a===f;return{startContainer:b.constant(c),startOffset:b.constant(a),endContainer:b.constant(e),endOffset:b.constant(f),collapsed:b.constant(g)}}});k("pk","1n 1a 2l l 2m 20 ei 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,b){return c.getRaw(a,b).getOrThunk(function(){return c.get(a,b)})},m=function(){var b=a.fromTag("td");e.append(b,a.fromTag("br"));return b},n=function(a,c,e){var f=g.copy(a,c);b.each(e,function(a,
b){null===a?d.remove(f,b):d.set(f,b,a)});return f},p=function(a){return a},q=function(b){return function(){return a.fromTag("tr",b.dom())}};return{cellOperations:function(b,d){return{row:q(d),cell:function(d){var g=h.owner(d.element()),g=a.fromTag(f.name(d.element()),g.dom());e.append(g,a.fromTag("br"));1===d.colspan()&&c.set(g,"width",l(d.element(),"width"));b(d.element(),g);return g},replace:n,gap:m}},paste:function(a){return{row:q(a),cell:m,replace:p,gap:m}}}});k("io","b 7 33 64 3e 2p".split(" "),
function(b,d,c,a,e,f){var g=c.immutable("row","y"),h=c.immutable("col","x"),l=function(a){return e.absolute(a).left()+f.getOuter(a)},m=function(a){return e.absolute(a).left()},n=function(a,b){return h(a,m(b))},p=function(a,b){return h(a,l(b))},q=function(a){return e.absolute(a).top()},r=function(a,c,d){if(0===d.length)return[];var e=b.map(d.slice(1),function(b,c){return b.map(function(b){return a(c,b)})}),f=d[d.length-1].map(function(a){return c(d.length-1,a)});return e.concat([f])};c={delta:d.identity,
positions:d.curry(r,function(a,b){return g(a,q(b))},function(b,c){return g(b,q(c)+a.getOuter(c))}),edge:q};var s={delta:d.identity,edge:m,positions:d.curry(r,n,p)};d={delta:function(a,b){return-a},edge:l,positions:d.curry(r,p,n)};return{height:c,rtl:d,ltr:s}});k("ie",["io"],function(b){return{ltr:b.ltr,rtl:b.rtl}});k("ai",["ie"],function(b){return function(d){var c=function(a){return d.directionAt(a).isRtl()?b.rtl:b.ltr};return{delta:function(a,b){return c(b).delta(a,b)},edge:function(a){return c(a).edge(a)},
positions:function(a,b){return c(b).positions(a,b)}}}});k("if","il s pk ai l 2m 2o".split(" "),function(b,d,c,a,e,f,g){return{erase:function(a,c,m,n){a=e.fromText("");f.after(c,a);g.remove(c);return d.some(b(a,0,a,0))},execute:function(d,e,f,g){return function(p,q,r){var s=g(),t=p.doc().getOrDie();p=a(d);t=c.cellOperations(f,t);return e(s,q,r,t,p).map(function(a){return b(a,0,a,0)})}}}});k("al",["7","s","3d","l","3e"],function(b,d,c,a,e){return{only:function(e){var g=d.from(e.dom().documentElement).map(a.fromDom).getOr(e);
return{parent:b.constant(g),view:b.constant(e),origin:b.constant(c(0,0))}},detached:function(a,c){var d=b.curry(e.absolute,c);return{parent:b.constant(c),view:b.constant(a),origin:d}}}});k("ad",["al"],function(b){var d=function(c,a,d){return c.isInline()?b.detached(c.element(),a.uiContainer()):b.only(d)};return{get:d,fromEngine:function(b){var a=b.content(),e=b.smartview();return a.doc().map(function(b){return d(a,e,b)})}}});k("f2",["33"],function(b){var d=b.immutable("width","height"),c=b.immutable("rows",
"columns"),a=b.immutable("row","column"),e=b.immutable("x","y"),f=b.immutable("element","rowspan","colspan"),g=b.immutable("element","rowspan","colspan","row","column"),h=b.immutable("before","on","after"),l=b.immutable("element","cells"),m=b.immutableBag(["startRow","startCol","finishRow","finishCol"],[]);b=b.immutableBag(["row","col"],[]);return{dimensions:d,grid:c,address:a,coords:e,extended:g,detail:f,context:h,rowdata:l,bounds:m,cell:b}});k("am","b 7 s f2 1a 20 46 2y 29 cy".split(" "),function(b,
d,c,a,e,f,g,h,l,m){var n=function(a,d){return b.contains(a,f.name(d))?c.some(d):h.ancestor(d,a.join(","))},p=function(a,b){return l.parent(b).map(function(b){return g.children(b,a)})},q=d.curry(p,"th,td");d=d.curry(p,"tr");var r=function(a,b){return m(e.get(a,b),10)};return{cell:function(a){return n(["td","th"],a)},firstCell:function(a){return h.descendant(a,"th,td")},cells:function(a){return g.descendants(a,"th,td")},neighbourCells:q,table:function(a){return n(["table"],a)},row:function(a){return n(["tr"],
a)},rows:function(a){return g.descendants(a,"tr")},neighbourRows:d,attr:r,grid:function(b,c,d){c=r(b,c);b=r(b,d);return a.grid(c,b)}}});k("pe",["b","7","f2","am","1a"],function(b,d,c,a,e){return{fromTable:function(f){f=a.rows(f);return b.map(f,function(f){var h=b.map(a.cells(f),function(a){var b=e.has(a,"rowspan")?parseInt(e.get(a,"rowspan"),10):1,d=e.has(a,"colspan")?parseInt(e.get(a,"colspan"),10):1;return c.detail(a,b,d)});return{element:d.constant(f),cells:d.constant(h)}})}}});k("pf",["b","7",
"s","f2","1r"],function(b,d,c,a,e){var f=function(a,c){var d=b.bind(a.all(),function(a){return a.cells()});return b.filter(d,c)};return{generate:function(c){var f={},l=[],m=0,n=0;b.each(c,function(c,d){var g=[];b.each(c.cells(),function(b,c){for(var l=0;void 0!==f[d+","+l];)l++;for(var p=a.extended(b.element(),b.rowspan(),b.colspan(),d,l),w=0;w<b.colspan();w++)for(var x=0;x<b.rowspan();x++){var y=d+x,k=l+w;f[y+","+k]=p;m=e.max(m,y+1);n=e.max(n,k+1)}g.push(p)});l.push(a.rowdata(c.element(),g))});c=
a.grid(m,n);return{grid:d.constant(c),access:d.constant(f),all:d.constant(l)}},getAt:function(a,b,d){a=a.access()[b+","+d];return void 0!==a?c.some(a):c.none()},findItem:function(a,b,d){a=f(a,function(a){return d(b,a.element())});return 0<a.length?c.some(a[0]):c.none()},filterItems:f,justCells:function(a){a=b.map(a.all(),function(a){return a.cells()});return b.flatten(a)}}});k("s6",["b","s","k","1r"],function(b,d,c,a){return{repeat:function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},range:function(a,
b){for(var c=[],d=a;d<b;d++)c.push(d);return c},unique:function(a,c){var d=[];b.each(a,function(b,l){l<a.length-1&&!c(b,a[l+1])?d.push(b):l===a.length-1&&d.push(b)});return d},deduce:function(e,f){if(0>f||f>=e.length-1)return d.none();var g=e[f].fold(function(){var a=b.reverse(e.slice(0,f));return c.findMap(a,function(a,b){return a.map(function(a){return{value:a,delta:b+1}})})},function(a){return d.some({value:a,delta:0})}),h=e[f+1].fold(function(){var a=e.slice(f+1);return c.findMap(a,function(a,
b){return a.map(function(a){return{value:a,delta:b+1}})})},function(a){return d.some({value:a,delta:1})});return g.bind(function(b){return h.map(function(c){var d=c.delta+b.delta;return a.abs(c.value-b.value)/d})})}}});k("s5",["b","7","s","pf","s6"],function(b,d,c,a,e){var f=function(a,d,e){var f=a();a=b.find(f,d);return c.from(a).orThunk(function(){return c.from(f[0]).orThunk(e)}).map(function(a){return a.element()})};return{columns:function(c){var h=c.grid(),l=e.range(0,h.columns()),m=e.range(0,
h.rows());return b.map(l,function(e){return f(function(){return b.bind(m,function(b){return a.getAt(c,b,e).filter(function(a){return a.column()===e}).fold(d.constant([]),function(a){return[a]})})},function(a){return 1===a.colspan()},function(){return a.getAt(c,0,e)})})},rows:function(c){var h=c.grid(),l=e.range(0,h.rows()),m=e.range(0,h.columns());return b.map(l,function(e){return f(function(){return b.bind(m,function(b){return a.getAt(c,e,b).filter(function(a){return a.row()===e}).fold(d.constant([]),
function(a){return[a]})})},function(a){return 1===a.rowspan()},function(){return a.getAt(c,e,0)})})}}});k("px","am 1a 2l 64 20 2p v 1r cy".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a,b){c.set(a,"width",b+"px")},n=function(a,b){c.set(a,"height",b+"px")},p=function(a,b){return c.getRaw(a,b).getOrThunk(function(){return c.get(a,b)})},q=function(a,c,d){var e=b.table(a).map(function(a){a=f.get(a);return h.floor(c/100*a)}).getOr(c);d(a,e);return e},r=function(a,b,c){var d=l(a,10);return g.endsWith(a,
"%")&&"table"!==e.name(b)?q(b,d,c):d},s=function(a){var b=p(a,"width");return b?r(b,a,m):f.get(a)},t=function(b){var c=p(b,"height");return c?r(c,b,n):a.get(b)},u=function(a,b,c){c=c(a);a=d.has(a,b)?l(d.get(a,b),10):1;return c/a};return{setWidth:m,setHeight:n,getWidth:function(a){return u(a,"colspan",s)},getHeight:function(a){return u(a,"rowspan",t)}}});k("py",["7","1a","2l","cy"],function(b,d,c,a){var e=function(b,c){return d.has(b,c)&&1<a(d.get(b,c),10)};return{hasColspan:function(a){return e(a,
"cellspan")},hasRowspan:function(a){return e(a,"rowspan")},minWidth:b.constant(10),minHeight:b.constant(10),getInt:function(b,d){return a(c.get(b,d),10)}}});k("pv","b 7 s5 px py s6 2l".split(" "),function(b,d,c,a,e,f,g){var h=function(a,b,c){return g.getRaw(a,b).fold(function(){return c(a)+"px"},function(a){return a})},l=function(b){return h(b,"width",a.getWidth)},m=function(b){return h(b,"height",a.getHeight)},n=function(b){return a.getWidth(b)},p=function(a,g,h,l){a=c.columns(a);var m=b.map(a,function(a){return a.map(g.edge)});
return b.map(a,function(a,b){return a.filter(d.not(e.hasColspan)).fold(function(){var a=f.deduce(m,b);return l(a)},function(a){return h(a)})})},q=function(a){return a.map(function(a){return a+"px"}).getOr("")},r=function(b){return a.getHeight(b)},s=function(a,g,h,l){a=c.rows(a);var m=b.map(a,function(a){return a.map(g.edge)});return b.map(a,function(a,b){return a.filter(d.not(e.hasRowspan)).fold(function(){var a=f.deduce(m,b);return l(a)},function(a){return h(a)})})};return{getRawWidths:function(a,
b){return p(a,b,l,q)},getPixelWidths:function(a,b){return p(a,b,n,function(a){return a.getOrThunk(e.minWidth)})},getPixelHeights:function(a,b){return s(a,b,r,function(a){return a.getOrThunk(e.minHeight)})},getRawHeights:function(a,b){return s(a,b,m,q)}}});k("qk","b 7 4g s6 v 1r 1u cy".split(" "),function(b,d,c,a,e,f,g,h){var l=c.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),m=function(a,b,c){a=c.substring(0,c.length-a.length);var d=g(a);return a===d.toString()?b(d):l.invalid(c)},
n=function(a){return e.endsWith(a,"%")?m("%",l.percent,a):e.endsWith(a,"px")?m("px",l.pixels,a):l.invalid(a)},p=function(a,c){return b.map(a,function(a){return n(a).fold(function(){return a},function(a){return a/c*100+"%"},function(a){return a+"%"})})},q=function(a,c,d){var e=d/c;return b.map(a,function(a){return n(a).fold(function(){return a},function(a){return a*e+"px"},function(a){return a/100*d+"px"})})},r=function(b,c){var e=b.fold(function(){return d.constant("")},function(a){return d.constant(a/
c+"px")},function(a){return d.constant(a/c+"px")});return a.repeat(c,e)},s=function(a,b,c){return a.fold(function(){return b},function(a){return q(b,c,a)},function(a){return p(b,c)})},t=function(a,b){var c=f.floor(a);return{value:c+b,remainder:a-c}},u=function(a,b){return n(a).fold(d.constant(a),function(a){return a+b+"px"},function(a){return a+b+"%"})},v=function(a){if(0===a.length)return a;a=b.foldr(a,function(a,b){var c=n(b).fold(function(){return{value:b,remainder:0}},function(a){return t(a,"px")},
function(a){return t(a,"%")});return{output:[c.value].concat(a.output),remainder:a.remainder+c.remainder}},{output:[],remainder:0});var c=a.output;return c.slice(0,c.length-1).concat([u(c[c.length-1],f.round(a.remainder))])};return{validate:n,redistribute:function(a,c,d){d=n(d);a=b.forall(a,function(a){return"0px"===a})?r(d,a.length):s(d,a,c);return v(a)},sum:function(a,c){return 0===a.length?c:b.foldr(a,function(a,b){return n(b).fold(d.constant(0),d.identity,d.identity)+a},0)},toIntegers:v}});k("ij",
"b 7 pe pf io pv qk px py 2l 64 2p".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=function(a,c,d){b.each(c,function(b){var c=a.slice(b.column(),b.colspan()+b.column()),c=g.sum(c,l.minWidth());m.set(b.element(),"width",c+d)})},r=function(a,c,d,e){b.each(d,function(b){var c=a.slice(b.row(),b.rowspan()+b.row()),c=g.sum(c,l.minHeight());m.set(b.element(),"height",c+e)});b.each(c,function(b,c){m.set(b.element(),"height",a[c])})},s=function(a){return g.validate(a).fold(d.constant("px"),d.constant("px"),
d.constant("%"))};return{setWidth:h.setWidth,getWidth:h.getWidth,setHeight:h.setHeight,getHeight:h.getHeight,redistribute:function(b,d,h,l){var x=c.fromTable(b),k=a.generate(x),B=k.all(),z=a.justCells(k);d.each(function(a){var c=s(a),d=p.get(b),e=f.getRawWidths(k,l),d=g.redistribute(e,d,a);q(d,z,c);m.set(b,"width",a)});h.each(function(a){var c=s(a),d=n.get(b),h=f.getRawHeights(k,e.height),d=g.redistribute(h,d,a);r(d,B,z,c);m.set(b,"height",a)})}}});k("pm","b 7 s 4f 4v 1a 2l cy".split(" "),function(b,
d,c,a,e,f,g,h){var l=function(a){var b=f.has(a,"colspan")?h(f.get(a,"colspan"),10):1,c=f.has(a,"rowspan")?h(f.get(a,"rowspan"),10):1;return{element:d.constant(a),colspan:d.constant(b),rowspan:d.constant(c)}},m=e.exactly(["cell","row","replace","gap"]);return{modification:function(b,d){m(b);var e=a(c.none()),f=void 0!==d?d:l,g=function(a){var d;d=f(a);d=b.cell(d);e.get().isNone()&&e.set(c.some(d));h=c.some({item:a,replacement:d});return d},h=c.none();return{getOrInit:function(a,b){return h.fold(function(){return g(a)},
function(c){return b(a,c.item)?c.replacement:g(a)})},cursor:e.get}},transform:function(d,e){return function(f){var g=a(c.none());m(f);var h=[],l=function(a,d){var e=b.find(h,function(b){return d(b.item,a)});return c.from(e)},u=function(a){var b=f.replace(a,e,{scope:d});h.push({item:a,sub:b});g.get().isNone()&&g.set(c.some(b));return b};return{replaceOrInit:function(a,b){return l(a,b).fold(function(){return u(a)},function(c){return b(a,c.item)?c.sub:u(a)})},cursor:g.get}}},merging:function(b){m(b);
var e=a(c.none());return{combine:function(a){e.get().isNone()&&e.set(c.some(a));return function(){var c=b.cell({element:d.constant(a),colspan:d.constant(1),rowspan:d.constant(1)});g.remove(c,"width");g.remove(a,"width");return c}},cursor:e.get}}}});k("d1","b s 20 49 9y 29".split(" "),function(b,d,c,a,e,f){var g=["img","br"],h=function(a){return c.isText(a)&&e.get(a).length||b.contains(g,c.name(a))},l=function(a,b){var c=function(a){a=f.children(a);for(var e=a.length-1;0<=e;e--){var g=a[e];if(b(g))return d.some(g);
g=c(g);if(g.isSome())return g}return d.none()};return c(a)};return{firstCursor:function(b){return a.descendant(b,h)},lastCursor:function(a){return l(a,h)}}});k("ky",["b"],function(b){var d="body p div article aside figcaption figure footer header nav section ol ul table thead tfoot tbody caption tr td th h1 h2 h3 h4 h5 h6 blockquote pre address".split(" "),c=function(a,c){var g=a.property().name(c);return b.contains(d,g)},a=function(a,c){return b.contains(["br","img","hr","input"],a.property().name(c))};
return{isBlock:c,isList:function(a,c){var d=a.property().name(c);return b.contains(["ol","ul"],d)},isFormatting:function(a,c){var d=a.property().name(c);return b.contains("address pre p h1 h2 h3 h4 h5 h6".split(" "),d)},isContainer:function(a,c){return b.contains("div li td th blockquote body caption".split(" "),a.property().name(c))},isEmptyTag:a,isFrame:function(a,b){return"iframe"===a.property().name(b)},isInline:function(b,d){return!(c(b,d)||a(b,d))&&"li"!==b.property().name(d)}}});k("e4",["dg",
"ky"],function(b,d){var c=b();return{isBlock:function(a){return d.isBlock(c,a)},isList:function(a){return d.isList(c,a)},isFormatting:function(a){return d.isFormatting(c,a)},isContainer:function(a){return d.isContainer(c,a)},isEmptyTag:function(a){return d.isEmptyTag(c,a)},isFrame:function(a){return d.isFrame(c,a)},isInline:function(a){return d.isInline(c,a)}}});k("pn","b d1 e4 1b l 35 20 49 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m){return{merge:function(n){var p=function(a){return m.nextSibling(a).each(function(a){if(c.isBlock(a))return!0;
if(c.isEmptyTag(a))return"img"===g.name(a)?!1:!0}).getOr(!1)},q=function(b){return d.lastCursor(b).bind(function(d){var f=p(d);return m.parent(d).map(function(l){var m;(m=!0===f)||(m="li"===g.name(l)||h.ancestor(l,c.isList).isSome()||"br"===g.name(d)||c.isBlock(l)&&!a.eq(b,l));return m?[]:[e.fromTag("br")]})}).getOr([])},r=function(){return b.bind(n,function(a){var b=m.children(a);return 1<b.length||1==b.length&&"br"!==g.name(b[0])?b.concat(q(a)):[]})}();l.empty(n[0]);f.append(n[0],r)}}});k("s7",
["b","7"],function(b,d){var c=function(a,c){return b.map(a,function(a){return a[c]})},a=function(a,c){if(0===a.length)return 0;var d=a[0],h=b.findIndex(a,function(a){return!c(d,a)});return-1===h?a.length:h};return{subgrid:function(b,f,g,h){var l=b[f].slice(g),l=a(l,h);b=c(b,g).slice(f);h=a(b,h);return{colspan:d.constant(l),rowspan:d.constant(h)}}}});k("pq",["b","f2","s7","pf"],function(b,d,c,a){return{toDetails:function(a,f){var g=b.map(a,function(a,c){return b.map(a,function(a,b){return!1})});return b.map(a,
function(h,l){return b.bind(h,function(b,h){if(!1===g[l][h]){for(var p=c.subgrid(a,l,h,f),q=p.rowspan(),r=p.colspan(),s=l;s<l+q;s++)for(var t=h;t<h+r;t++)g[s][t]=!0;return[d.detail(b,p.rowspan(),p.colspan())]}return[]})})},toGrid:function(b,c){for(var d=[],h=0;h<b.grid().rows();h++){for(var l=[],m=0;m<b.grid().columns();m++){var n=a.getAt(b,h,m).map(function(a){return a.element()}).getOrThunk(c.gap);l.push(n)}d.push(l)}return d}}});k("s8","b 1a l 2m 35 2o 2y 29".split(" "),function(b,d,c,a,e,f,g,
h){return{render:function(l,m){var n=g.child(l,"tbody").getOrThunk(function(){var b=c.fromTag("tbody",h.owner(l).dom());a.append(l,b);return b});f.empty(n);var p=b.map(m,function(c){var e=c.element();f.empty(e);b.each(c.cells(),function(b){var c=b.element(),f=b.colspan();1===f?d.remove(c,"colspan"):d.set(c,"colspan",f);c=b.element();f=b.rowspan();1===f?d.remove(c,"rowspan"):d.set(c,"rowspan",f);a.append(e,b.element())});return e});e.append(n,p)}}});k("s9",["1a","2l","l"],function(b,d,c){return{col:function(a,
e,f,g,h){var l=c.fromTag("div");d.setAll(l,{position:"absolute",left:e-g/2+"px",top:f+"px",height:h+"px",width:g+"px"});b.set(l,"data-column",a);return l},row:function(a,e,f,g,h){var l=c.fromTag("div");d.setAll(l,{position:"absolute",left:e+"px",top:f-h/2+"px",height:h+"px",width:g+"px"});b.set(l,"data-row",a);return l}}});k("qn",["48"],function(b){return{resolve:b.create("ephox-snooker").resolve}});k("qm","b s5 pe pf s9 qn 1x 2l 64 2m 3e 2o 46 2p".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=
f.resolve("resizer-bar"),t=f.resolve("resizer-rows"),u=f.resolve("resizer-cols"),v=function(a){a=q.descendants(a.parent(),"."+s);b.each(a,p.remove)},w=function(a,c,d){var e=a.origin();b.each(c,function(b,c){b.each(function(b){b=d(e,b);g.add(b,s);m.append(a.parent(),b)})})},x=function(a,b,c,d){w(a,b,function(a,b){var f=e.col(b.col(),b.x()-a.left(),c.top()-a.top(),7,d);g.add(f,u);return f})},k=function(a,b,c,d){w(a,b,function(a,b){var f=e.row(b.row(),c.left()-a.left(),b.y()-a.top(),d,7);g.add(f,t);
return f})},B=function(a,c){var d=q.descendants(a.parent(),"."+s);b.each(d,c)};return{refresh:function(b,e,f,g){v(b,e);var h=c.fromTable(e),h=a.generate(h),m=d.rows(h),p=d.columns(h),h=n.absolute(e);f=0<m.length?f.positions(m,e):[];k(b,f,h,r.getOuter(e));g=0<p.length?g.positions(p,e):[];x(b,g,h,l.getOuter(e))},hide:function(a){B(a,function(a){h.set(a,"display","none")})},show:function(a){B(a,function(a){h.set(a,"display","block")})},destroy:v,isRowBar:function(a){return g.has(a,t)},isColBar:function(a){return g.has(a,
u)}}});k("po","b 6 7 s k am pe pq pf s8 io qm 1b 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a,d){var f=function(a){return e.findMap(a,function(a){return r.parent(a.element())}).getOrThunk(function(){return d.row()})};return b.map(a,function(a){var b=f(a);return{element:c.constant(b),cells:c.constant(a)}})},t=function(c,d){var e=b.flatten(b.map(c.all(),function(a){return a.cells()})),e=b.find(e,function(a){return q.eq(d,a.element())});return a.from(e)};return{run:function(b,
d,e,f,r){return function(t,k,A,C,D){var E=g.fromTable(k),F=l.generate(E);return d(F,A).map(function(a){var d=h.toGrid(F,C);a=b(d,a,q.eq,r(C));d=a.grid();d=h.toDetails(d,q.eq);d=s(d,C);return{grid:c.constant(d),cursor:a.cursor}}).fold(function(){return a.none()},function(a){m.render(k,a.grid());e(a.grid(),D);f(k);p.refresh(t,k,n.height,D);return a.cursor()})}},onCell:function(a,b){return f.cell(b.element()).bind(function(b){return t(a,b)})},onPaste:function(a,b){return f.cell(b.element()).bind(function(c){return t(a,
c).map(function(a){return d.merge(a,{generators:b.generators,clipboard:b.clipboard})})})},onMergable:function(a,b){return b.mergable()},onUnmergable:function(a,b){return b.unmergable()}}});k("sa","b 7 p s6 9 n 1r".split(" "),function(b,d,c,a,e,f,g){var h=function(a,c){return b.map(a,c.cell)},l=function(b,c,d){return b.concat(a.repeat(c,function(a){return h(b[0],d)}))},m=function(c,d,e){return b.map(c,function(b){return b.concat(h(a.range(0,d),e))})};return{measure:function(a,b,e){if(a.row()>=b.length||
a.column()>b[0].length)return c.error("invalid start address out of table bounds, row: "+a.row()+", column: "+a.column());b=b.slice(a.row());a=b[0].slice(a.column());var f=e[0].length;return c.value({rowDelta:d.constant(b.length-e.length),colDelta:d.constant(a.length-f)})},tailor:function(a,b,c,e){var f=0>c.colDelta()?m:d.identity;a=0>c.rowDelta()?l:d.identity;b=f(b,g.abs(c.colDelta()),e);return a(b,g.abs(c.rowDelta()),e)}}});k("pr",[],function(){return{merge:function(b,d,c,a){if(0===b.length)return b;
for(c=d.startRow();c<=d.finishRow();c++)for(var e=d.startCol();e<=d.finishCol();e++)b[c][e]=a();return b},unmerge:function(b,d,c,a){for(var e=!0,f=0;f<b.length;f++)for(var g=0;g<b[0].length;g++){var h=c(b[f][g],d);!0===h&&!1===e?b[f][g]=a():!0===h&&(e=!1)}return b}}});k("pp",["7","sa","pr"],function(b,d,c){return{merge:function(a,e,f,g,h){return d.measure(a,e,f).map(function(l){l=d.tailor(a,e,l,g);for(var m=a.row(),n=a.column(),p=m+f.length,q=n+f[0].length,r=m;r<p;r++)for(var s=n;s<q;s++){var t=l,
u=r,v=s,w=b.curry(h,t[u][v]),x=t[u];1<t.length&&1<x.length&&(0<v&&w(x[v-1])||v<x.length-1&&w(x[v+1])||0<u&&w(t[u-1][v])||u<t.length-1&&w(t[u+1][v]))&&c.unmerge(l,l[r][s],h,g.cell);l[r][s]=g.replace(f[r-m][s-n])}return l})}}});k("ps",["b"],function(b){return{insertRowAt:function(d,c,a,e,f){var g=d.slice(0,c),h=d.slice(c);a=b.map(d[a],function(a,b){return 0<c&&c<d.length&&e(d[c-1][b],d[c][b])?d[c][b]:f(a,e)});return g.concat([a]).concat(h)},insertColumnAt:function(d,c,a,e,f){return b.map(d,function(b){var d=
0<c&&c<b.length&&e(b[c-1],b[c])?b[c]:f(b[a],e);return b.slice(0,c).concat([d]).concat(b.slice(c))})},deleteRowAt:function(b,c){return b.slice(0,c).concat(b.slice(c+1))},deleteColumnAt:function(d,c){return b.map(d,function(a){return a.slice(0,c).concat(a.slice(c+1))})}}});k("pt",["b","7"],function(b,d){var c=function(a,c,f,g){return b.map(a,function(a){return b.map(a,function(a){return b.exists(c,d.curry(f,a))?g(a,f):a})})};return{replaceColumn:function(a,d,f,g){var h=b.bind(a,function(b,c){return void 0!==
a[c][d]&&0<c&&f(a[c-1][d],a[c][d])||0<d&&f(b[d-1],b[d])?[]:[b[d]]});return c(a,h,f,g)},replaceRow:function(a,d,f,g){var h=a[d],l=b.bind(h,function(b,c){return void 0!==a[d][c]&&0<d&&f(a[d-1][c],a[d][c])||0<c&&f(h[c-1],h[c])?[]:[b]});return c(a,l,f,g)}}});k("sb",[],function(){var b=function(b){return{fold:b}};return{none:function(){return b(function(b,c,a,e,f){return b()})},only:function(d){return b(function(b,a,e,f,g){return a(d)})},left:function(d,c){return b(function(a,b,f,g,h){return f(d,c)})},
middle:function(d,c,a){return b(function(b,f,g,h,l){return h(d,c,a)})},right:function(d,c){return b(function(a,b,f,g,h){return h(d,c)})}}});k("pu",["b","7","sb","1r"],function(b,d,c,a){var e=function(a,b){return 0===a.length?c.none():1===a.length?c.only(0):0===b?c.left(0,1):b===a.length-1?c.right(b-1,b):0<b&&b<a.length-1?c.middle(b-1,b,b+1):c.none()};return{determine:function(c,g,h,l){var m=c.slice(0);c=e(c,g);var n=function(a){return b.map(a,d.constant(0))};g=d.constant(n(m));var p=function(b,c){if(0<=
h){var d=a.max(l,m[c]-h);return n(m.slice(0,b)).concat([h,d-m[c]]).concat(n(m.slice(c+1)))}var d=a.max(l,m[b]+h),e=m[b]-d;return n(m.slice(0,b)).concat([d-m[b],e]).concat(n(m.slice(c+1)))};return c.fold(g,function(b){return[a.max(l,m[b]+h)-m[b]]},p,function(a,b,c){return p(b,c)},function(b,c){if(0<=h)return n(m.slice(0,c)).concat([h]);var d=a.max(l,m[c]+h);return n(m.slice(0,c)).concat([d-m[c]])})}}});k("pw",["b","7","pf","cy"],function(b,d,c,a){var e=function(b,c,d){for(var e=0;b<c;b++)e+=void 0!==
d[b]?a(d[b],10):0;return e};return{recalculateWidth:function(a,g){var h=c.justCells(a);return b.map(h,function(a){var b=e(a.column(),a.column()+a.colspan(),g);return{element:a.element,width:d.constant(b),colspan:a.colspan}})},recalculateHeight:function(a,g){var h=c.justCells(a);return b.map(h,function(a){var b=e(a.row(),a.row()+a.rowspan(),g);return{element:a.element,height:d.constant(b),rowspan:a.rowspan}})},matchRowHeight:function(a,c){return b.map(a.all(),function(a,b){return{element:a.element,
height:d.constant(c[b])}})}}});k("im","b pu pe pf pv pw px py 2y 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a){return b.foldr(a,function(a,b){return a+b},0)},p=function(b){b=c.fromTable(b);return a.generate(b)};return{adjustWidth:function(a,c,l,m){var u=p(a),v=e.getPixelWidths(u,m);c=d.determine(v,l,c,h.minWidth());c=b.map(c,function(a,b){return a+v[b]});u=f.recalculateWidth(u,c);b.each(u,function(a){g.setWidth(a.element(),a.width())});u=n(c);g.setWidth(a,u)},adjustHeight:function(a,
c,d,l){var u=p(a);l=e.getPixelHeights(u,l);l=b.map(l,function(a,b){return d===b?m.max(c+a,h.minHeight()):a});var v=f.recalculateHeight(u,l),u=f.matchRowHeight(u,l);b.each(u,function(a){g.setHeight(a.element(),a.height())});b.each(v,function(a){g.setHeight(a.element(),a.height())});u=n(l);g.setHeight(a,u)},adjustWidthTo:function(c,d){var h=a.generate(c),m=e.getPixelWidths(h,d),h=f.recalculateWidth(h,m);b.each(h,function(a){g.setWidth(a.element(),a.width())});var n=b.foldr(m,function(a,b){return b+
a},0);0<h.length&&l.ancestor(h[0].element(),"table").each(function(a){g.setWidth(a,n)})}}});k("ik","b 7 s 33 pm f2 pn am pe po pp pq pf pr ps pt im 2o cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w){w=function(a){0===h.cells(a).length&&v.remove(a)};var x=a.immutable("grid","cursor"),k=function(a,b,c){return B(a,b,c).orThunk(function(){return B(a,0,0)})},B=function(a,b,d){return c.from(a[b]).bind(function(a){return c.from(a[d])})},z=function(a,b,c){return x(a,B(a,b,c))};a=u.adjustWidthTo;
return{insertRowBefore:m.run(function(a,b,c,d){var e=b.row(),f=b.row();a=s.insertRowAt(a,f,e,c,d.getOrInit);return z(a,f,b.column())},m.onCell,d.noop,d.noop,e.modification),insertRowAfter:m.run(function(a,b,c,d){var e=b.row(),f=b.row()+b.rowspan();a=s.insertRowAt(a,f,e,c,d.getOrInit);return z(a,f,b.column())},m.onCell,d.noop,d.noop,e.modification),insertColumnBefore:m.run(function(a,b,c,d){var e=b.column(),f=b.column();a=s.insertColumnAt(a,f,e,c,d.getOrInit);return z(a,b.row(),f)},m.onCell,a,d.noop,
e.modification),insertColumnAfter:m.run(function(a,b,c,d){var e=b.column(),f=b.column()+b.colspan();a=s.insertColumnAt(a,f,e,c,d.getOrInit);return z(a,b.row(),f)},m.onCell,a,d.noop,e.modification),eraseColumn:m.run(function(a,b,c,d){a=s.deleteColumnAt(a,b.column());b=k(a,b.row(),b.column());return x(a,b)},m.onCell,a,w,e.modification),eraseRow:m.run(function(a,b,c,d){a=s.deleteRowAt(a,b.row());b=k(a,b.row(),b.column());return x(a,b)},m.onCell,d.noop,w,e.modification),makeColumnHeader:m.run(function(a,
b,c,d){a=t.replaceColumn(a,b.column(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform("row","th")),unmakeColumnHeader:m.run(function(a,b,c,d){a=t.replaceColumn(a,b.column(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform(null,"td")),makeRowHeader:m.run(function(a,b,c,d){a=t.replaceRow(a,b.row(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform("col","th")),unmakeRowHeader:m.run(function(a,
b,c,d){a=t.replaceRow(a,b.row(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform(null,"td")),mergeCells:m.run(function(a,b,e,f){f=b.cells();g.merge(f);a=r.merge(a,b.bounds(),e,d.constant(f[0]));return x(a,c.from(f[0]))},m.onMergable,d.noop,d.noop,e.merging),unmergeCells:m.run(function(a,d,e,f){a=b.foldr(d,function(a,b){return r.unmerge(a,b,e,f.combine(b))},a);return x(a,c.from(d[0]))},m.onUnmergable,a,d.noop,e.merging),pasteCells:m.run(function(a,b,d,e){e=function(a,
b){var c=l.fromTable(a),c=q.generate(c);return p.toGrid(c,b)}(b.clipboard(),b.generators());var g=f.address(b.row(),b.column());return n.merge(g,a,e,b.generators(),d).fold(function(){return x(a,c.some(b.element()))},function(a){var c=k(a,b.row(),b.column());return x(a,c)})},m.onPaste,a,d.noop,e.modification)}});k("2d",["l","2m"],function(b,d){var c=function(a){return a.dom().innerHTML};return{get:c,set:function(a,b){a.dom().innerHTML=b},getOuter:function(a){var e=b.fromTag("div");a=b.fromDom(a.dom().cloneNode(!0));
d.append(e,a);return c(e)}}});k("qj","b 7 p if ad ie ij ik 1a l 2d 2m 2o 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a){return function(d,e){return b.foldl(a,function(a,b){return a.bind(function(a){return w(e,function(a){return v(b,d,e,a)})})},c.value(e))}},t=s([h.makeRowHeader,h.makeColumnHeader]),u=s([h.makeRowHeader]);h=s([h.makeColumnHeader]);var v=function(b,c,f,g){return e.fromEngine(c).bind(function(e){e=d.constant(e);var h=d.noop;return a.execute(c.region(),b,h,e)(c.content(),
f,{element:d.constant(g)})})},w=function(a,b){return r.descendant(a,"td,th").bind(function(a){return b(a)}).fold(function(){return c.error("Could not run the operation on table")},function(b){return c.value(a)})};return{setCaption:function(a,b){var c=r.child(a,"caption").fold(function(){return m.fromTag("caption")},function(a){q.empty(a);return a});n.set(c,b);p.prepend(a,c)},setSummary:function(a,b){l.set(a,"summary",b)},setDimensions:function(a,b){g.redistribute(a,b.width(),b.height(),"rtl"===l.get(a,
"dir")?f.rtl:f.ltr)},addBothHeaders:t,addRowHeader:u,addColumnHeader:h}});k("k8","7 p s4 qj 1a 2d 2y".split(" "),function(b,d,c,a,e,f,g){return function(h){var l=c(h);return{changeCaption:function(b,c,d,f){var g=e.get(b,"summary");return l.different(b,c,g,d,f).map(function(b){a.setCaption(b,c);return b})},changeSummary:function(b,c,d,e){var h=g.descendant(b,"caption").map(f.get).getOr("");return l.different(b,c,h,d,e).map(function(b){a.setSummary(b,c);return b})},setHeaders:function(c,d,e,f){return(!0===
e&&!0===f?a.addBothHeaders:!0===e?a.addRowHeader:!0===f?a.addColumnHeader:b.constant(l.invalidError("a11y.t4b.repair.errors.none")))(c,d)},setScope:function(a,b){e.set(a,"scope",b);return d.value(a)}}}});k("k9",["4g","33"],function(b,d){var c=b.generate([{field:["name","textkey","f"]},{select:["name","textkey","values"]},{toggles:["name","textkey","options"]}]),a=d.immutable("value","text"),e=d.immutable("value","icon","textkey");return{field:c.field,select:c.select,toggles:c.toggles,pair:a,toggle:e,
cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("bq","b 7 s p k6 k7 k8 33 1a l k9".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p){var q=h.immutableBag("id description prompts element severity url repair".split(" "),[]),r=h.immutableBag(["ui","repair"],[]),s=f(p),t=g(p),u={I1:c.some(r({ui:[n.field("image-alt","a11y.i1.repair.info",d.constant(""))],repair:function(a,b,c){return s.changeAlt(b.element(),c["image-alt"](),"a11y.i1.repair.errors.empty","a11y.i1.repair.errors.duplicate")}})),
I2:c.some(r({ui:[n.field("image-alt","a11y.i2.repair.info",function(a){return l.get(a.element(),"alt")})],repair:function(a,b,c){return s.changeAlt(b.element(),c["image-alt"](),"a11y.i2.repair.errors.empty","a11y.i2.repair.errors.duplicate")}})),T1:c.some(r({ui:[n.field("table-caption","a11y.t1.repair.info",d.constant(""))],repair:function(a,b,c){return t.changeCaption(b.element(),c["table-caption"](),"a11y.t1.repair.errors.empty","a11y.t1.repair.errors.duplicate")}})),T2:c.some(r({ui:[n.field("table-summary",
"a11y.t2.repair.info",d.constant(""))],repair:function(a,b,c){return t.changeSummary(b.element(),c["table-summary"](),"a11y.t2.repair.errors.empty","a11y.t2.repair.errors.duplicate")}})),T3:c.some(r({ui:[n.field("table-caption","a11y.t3.repair.info",function(a){return l.get(a.element(),"summary")})],repair:function(a,b,c){return t.changeCaption(b.element(),c["table-caption"](),"a11y.t3.repair.errors.empty","a11y.t3.repair.errors.duplicate")}})),T4A:c.none(),T4B:c.some(r({ui:[n.toggles("table-headers",
"a11y.t4b.repair.info",[n.toggle("row-header","ephox-polish-row-header","a11y.t4b.repair.row"),n.toggle("col-header","ephox-polish-column-header","a11y.t4b.repair.column")])],repair:function(a,b,c){var d=c["row-header"]();c=c["col-header"]();return t.setHeaders(a,b.element(),d,c)}})),T4C:c.some(r({ui:[n.select("scope-type","a11y.t4c.repair.info",[n.pair("row","a11y.t4c.repair.scope.row"),n.pair("col","a11y.t4c.repair.scope.col"),n.pair("rowgroup","a11y.t4c.repair.scope.rowgroup"),n.pair("colgroup",
"a11y.t4c.repair.scope.colgroup")])],repair:function(a,b,c){return t.setScope(b.element(),c["scope-type"]())}})),D1:c.some(r({ui:[n.select("heading-type","a11y.d1.repair.info",[n.pair("h1","a11y.d1.repair.block.h1"),n.pair("h2","a11y.d1.repair.block.h2"),n.pair("h3","a11y.d1.repair.block.h3"),n.pair("h4","a11y.d1.repair.block.h4"),n.pair("h5","a11y.d1.repair.block.h5"),n.pair("h6","a11y.d1.repair.block.h6")])],repair:function(a,b,c){return e.convertToHeading(b.element(),c["heading-type"]())}})),D2:c.none(),
D3:c.some(r({ui:[],repair:function(a,b,c){return e.joinLinks(a.content().isRoot,b.element())}})),D4:c.none(),D5:c.none(),O1:c.none(),O2:c.none()};return{convert:function(d,e){var f=function(a){var b=a.repair();return function(a,c){return d.undo().transaction(function(){return b(d,a,c)})}};return b.map(e,function(b){var d=b.rule(),e=d.id().toUpperCase(),g=void 0!==u[e]?u[e]:c.none(),h=d.desckey();return q({id:e,description:h,prompts:g.map(function(a){return a.ui()}),element:m.fromDom(b.element()),
url:d.url(),severity:d.severity(),repair:g.map(f).getOr(function(){return a.error("no repair")})})})}}}});k("bu",["b","1a"],function(b,d){var c=function(a,b){var c=d.get(a,b);return void 0===c||""===c?[]:c.split(" ")};return{read:c,merge:function(a,b,f){f=c(a,b).concat([f]);d.set(a,b,f.join(" "))},purge:function(a,e,f){var g=b.filter(c(a,e),function(a){return a!==f});0<g.length?d.set(a,e,g.join(" ")):d.remove(a,e)}}});k("br","b s bu 1a 1x 43 46 o".split(" "),function(b,d,c,a,e,f,g,h){var l=function(e,
g){b.each(e,function(a){g.get(a.severity()).fold(function(){h.warn("unknown severity for accessibility rule: ",a.id(),a.severity())},function(b){f.add(a.element(),[g.violation(),b.style()]);c.merge(a.element(),b.attribute(),a.id())})});d.from(e[0]).each(function(b){var c=b.element(),d=g.currentAttr();b=b.severity();a.set(c,d,b)})},m=function(c,d,e,f){c=g.descendants(c,"["+d+"]");b.each(c,function(b){a.remove(b,d)});a.set(e,d,f)},n=function(c,d){var f=g.descendants(c,"."+d.violation());b.each(f,function(c){e.remove(c,
d.violation());a.remove(c,d.currentAttr());b.each(d.all(),function(b){e.remove(c,b.style());a.remove(c,b.attribute())})})},p=function(a,d,f){var g=function(b){return 0===c.read(a,b.attribute()).length};d.get(f).each(function(b){g(b)&&e.remove(a,b.style())});b.forall(d.all(),g)&&e.remove(a,d.violation())},q=function(b,d,e,f){d.get(f).each(function(f){c.purge(b,f.attribute(),e);c.merge(b,d.ignoreAttr(),e);f=d.currentAttr();a.remove(b,f)})},r=function(b,d,e,f){d.get(f).each(function(f){c.purge(b,f.attribute(),
e);f=d.currentAttr();a.remove(b,f)})};return{manager:function(a){var b=a.content();return{start:function(b){l(b,a)},moveTo:function(c,d){b.body().each(function(b){m(b,a.currentAttr(),c,d)})},stop:function(){b.body().each(function(b){n(b,a)})},ignore:function(b,c,d){q(b,a,c,d);p(b,a,d)},solve:function(b,c,d){r(b,a,c,d);p(b,a,d)}}}}});k("bs","b 1a 1x 35 2o 29".split(" "),function(b,d,c,a,e,f){var g=function(a){return function(c){b.each(c,a)}},h=g(e.remove),l=g(function(a){d.set(a,"class","")}),m=g(function(b){var c=
f.children(b);a.before(b,c);e.remove(b)});return{remove:h,clearClasses:l,removeClass:function(a){return g(function(b){c.remove(b,a)})},removeAttr:function(a){return g(function(b){d.remove(b,a)})},unwrap:m}});k("6s","b 7 s br 30 33 bs".split(" "),function(b,d,c,a,e,f,g){var h=function(a){return"data-"+e.resolve(a)},l=h("a11y-current-violation"),m=e.resolve("a11y-violation"),n=e.resolve("a11y-severity-info"),p=e.resolve("a11y-severity-warn"),q=e.resolve("a11y-severity-error"),r=h("a11y-ignore"),s=h("a11y-error"),
t=h("a11y-warning"),u=h("a11y-info");f=f.immutableBag(["style","attribute"],[]);var v=f({style:q,attribute:s}),w=f({style:p,attribute:t}),x=f({style:n,attribute:u}),k=function(a){return"error"===a?c.some(v):"warning"===a?c.some(w):"info"===a?c.some(x):c.none()};return{configure:function(a){a.addSelector(a.output(),"["+r+"]",g.removeAttr(r));b.each([a.output(),a.input(),a.history(),a.internal()],function(c){b.each([m,n,p,q],function(b){a.add(c,b,g.removeClass(b))});b.each([l,s,t,u],function(b){a.addSelector(c,
"["+b+"]",g.removeAttr(b))})})},ignoreAttr:d.constant(r),manager:function(b){return a.manager({content:d.constant(b),violation:d.constant(m),currentAttr:d.constant(l),ignoreAttr:d.constant(r),get:k,all:d.constant([v,w,x])})}}});k("co",["9y","29"],function(b,d){var c=function(a){return b.getOption(a).fold(function(){return d.children(a).length},function(a){return a.length})};return{getEnd:c,isEnd:function(a,b){return c(a)===b},isStart:function(a,b){return 0===b}}});k("du",["33"],function(b){var d=
b.immutable("element","offset"),c=b.immutable("element","deltaOffset"),a=b.immutable("element","start","finish"),e=b.immutable("begin","end");b=b.immutable("element","text");return{point:d,delta:c,range:a,points:e,text:b}});k("en","co du 1a 20 9y 29".split(" "),function(b,d,c,a,e,f){var g=function(a){return"false"===c.get(a,"contenteditable")},h=function(a){a=a[a.length-1];var c=b.getEnd(a);return d.point(a,c)};return{descend:function(b,c){var g=f.children(b);if(0===g.length)return d.point(b,c);if(c<
g.length)return d.point(g[c],0);var g=g[g.length-1],h=a.isText(g)?e.get(g).length:f.children(g).length;return d.point(g,h)},descendUntilLeaf:function(a,b){var c=d.point(a,b),e=function(a){return g(a.element())?c:f.child(a.element(),a.offset()).fold(function(){return a},function(a){return e(d.point(a,0))})},q=f.children(a);return 0<q.length&&b<q.length?e(d.point(q[b],0)):0<q.length&&b===q.length?e(h(q)):c}}});k("bt","54 7 en 2l l 64 2m 3e 20 2o 28 29 1r cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,
n,p,q,r){var s=function(b){var c=r(a.get(b,"padding-top"),10),d=r(a.get(b,"padding-bottom"),10);b=p.owner(b);return n.get(b).top()-(c+d)},t=function(a,l){var n=c.descend(a,l),p=e.fromText(b.zeroWidth()),q=e.fromTag("span");g.append(q,p);g.before(n.element(),q);n=h.absolute(q);p=f.get(q);return{element:d.constant(q),bottom:d.constant(n.top()+p),pos:d.constant(n),cleanup:function(){m.remove(q)}}},u=function(a){var b=h.absolute(a),c=f.get(a);return{element:d.constant(a),bottom:d.constant(b.top()+c),
pos:d.constant(b),cleanup:d.noop}},v=function(b,c){b.getSelection().each(function(d){b.body().each(function(e){b.win().each(function(b){a.reflow(e);var f=s(e),g=t(d.startContainer(),d.startOffset());c(b,f,g);g.cleanup()})})})},w=function(a,b,c){a.body().each(function(d){a.win().each(function(a){c(a,s(d),b)})})},x=function(a,b,c){var d=a.innerHeight,e=c.pos();c.bottom()>d+b?(b=e.top()-d+1.5*f.get(c.element()),a.scrollTo(e.left(),b)):e.top()<b&&a.scrollTo(e.left(),e.top())},k=function(b,c,d,e){b.body().each(function(g){var h=
f.get(b.element()),l;l=g.dom();l=q.max(l.offsetHeight,l.scrollHeight);var m=e.pos();e.bottom()>l?a.set(g,"min-height",e.bottom()+"px"):a.remove(g,"min-height");(m.top()>h+d||m.top()<d)&&c.scrollTo(m.left(),m.top())})},B=function(a){v(a,x)},z=function(a,b){w(a,u(b),x)},A=function(a){v(a,d.curry(k,a))},C=function(a,b){w(a,u(b),d.curry(k,a))};return{cursorIntoView:function(a){(a.isInline()?B:A)(a)},elementIntoView:function(a,b){(a.isInline()?z:C)(a,b)},putInView:function(a,b,c,d){p.parent(d).each(function(e){var g=
l.isText(d)||"br"===l.name(d)?e:d;e=f.get(c.element());var m=n.get(a),g=h.absolute(g),p=m.top(),r=p+e;(g.top()>r||g.top()<p)&&b.scrollTo(m.left(),q.max(0,g.top()-e/2))})},createMarker:t}});k("kd","7i 2w 7 6u 30 1a 1x l 2m 35 20".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=function(b,c,d){b=h.fromTag(b);d=a.translate(d);return q(b,c,d)},q=function(a,l,n){var p=l+d.generate("");l=e.resolve(l);var q=h.fromTag("div");g.add(q,e.resolve("form-group"));var x=h.fromHtml("<label>"+n+"</label>");f.set(x,
"for",p);f.set(a,"id",p);b.label(a,n);n=r(a);g.add(q,l);m.append(q,[x,n]);return{element:c.constant(q),field:c.constant(a),id:c.constant(p),label:c.constant(x)}},r=function(a){if("select"===n.name(a)){var b=h.fromTag("div");g.add(b,e.resolve("select-wrap"));l.append(b,a);return b}return a};return{input:function(a,b){var c=p("input",a,b);f.setAll(c.field(),{type:"text"});return{element:c.element,input:c.field,label:c.label}},textarea:function(a,c){var d=p("textarea",a,c);b.textarea(d.field());return{element:d.element,
textarea:d.field,label:d.label}},wrapSelect:r,common:p,commonWith:q}});k("fn","7i e6 g9 dd 7 6u 30 3z 40 1x l 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=function(a){m.add(a,g.resolve("dialog-button-default"))},r=function(a){m.add(a,g.resolve("dialog-button"))},s=function(e,h,l){var n=c(e+h);m.add(n.element(),g.resolve("dialog-"+h));b.toolbarButton(n.element(),f.translate(l),!1,!1);n.content(a(f.translate(l)));return{enable:function(){n.enable();d.enable(n.element())},disable:function(){n.disable();
d.disable(n.element())},element:n.element,name:n.name,destroy:n.destroy,content:n.content,disabled:n.disabled,click:n.click,events:n.events}},t=function(a){a=s(a,"ok","button.ok");q(a.element());return a},u=function(a){a=s(a,"cancel","button.cancel");r(a.element());return a};return{button:s,okCancel:function(a){var b=void 0!==a?a+"-":"";a=n.fromTag("div");m.add(a,g.resolve(b+"dialog-controls"));var c=u(b),d=t(b);p.append(a,[c.element(),d.element()]);b=h.create({ok:l([],d.events.click),cancel:l([],
c.events.click)});return{element:e.constant(a),ok:e.constant(d),cancel:e.constant(c),destroy:function(){d.destroy();c.destroy()},events:b.registry}},makeNormal:r,makeDefault:q}});k("bv","7i g9 ga dd kc kb kd fn 30 1a 1x 43 2v 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a,c){var d=a(),e=d.element();b.button(e,c);m.set(e,"tabindex","-1");d.events.click.bind(function(){q.focus(e)});return d},t=function(a,b){var e=s(d,b);e.content(c([a,l.resolve("icon")]));m.set(e.element(),"title",
b);return e};return{setDefaultAction:function(a){h.makeDefault(a)},setNormalButton:function(a){h.makeNormal(a)},makeTextButton:function(b,c,e){c=s(d,c);p.add(c.element(),b);c.content(a(e));return c},makeIconToggle:function(a,b,d){var f=s(e,d);f.content(c([b,l.resolve("icon")]));n.add(f.element(),l.resolve("choice-button"));m.set(f.element(),"data-value",a);m.set(f.element(),"title",d);return f},makeField:function(a,b,c){return g.commonWith(a,b,c)},makeIconButton:t,makeIconStepperButton:function(a,
b){var c=t(a,b);n.add(c.element(),l.resolve("stepper-button"));return c}}});k("bw",["s","6u","9"],function(b,d,c){var a={"a11y.widget.ok.label":"button.ok","a11y.widget.ok.text":"button.ok","a11y.widget.ignore.label":"a11y.widget.ignore","a11y.widget.ignore.text":"a11y.widget.ignore","a11y.widget.repair.label":"a11y.widget.repair","a11y.widget.repair.text":"a11y.widget.repair","a11y.widget.repair.available":"a11y.widget.available","a11y.i1.description":"a11y.image.alttext.empty","a11y.i1.repair.info":"a11y.image.alttext.set",
"a11y.i1.repair.errors.empty":"a11y.image.alttext.validation.empty","a11y.i1.repair.errors.duplicate":"a11y.image.alttext.validation.filenameduplicate","a11y.i2.description":"a11y.image.alttext.filenameduplicate","a11y.i2.repair.info":"a11y.image.alttext.set","a11y.i2.repair.errors.empty":"a11y.image.alttext.validation.empty","a11y.i2.repair.errors.duplicate":"a11y.image.alttext.validation.filenameduplicate","a11y.t1.description":"a11y.table.caption.empty","a11y.t1.repair.info":"a11y.table.caption.set",
"a11y.t1.repair.errors.empty":"a11y.table.caption.validation.empty","a11y.t1.repair.errors.duplicate":"a11y.table.caption.validation.summaryduplicate","a11y.t2.description":"a11y.table.summary.empty","a11y.t2.repair.info":"a11y.table.summary.set","a11y.t2.repair.errors.empty":"a11y.table.summary.validation.empty","a11y.t2.repair.errors.duplicate":"a11y.table.summary.validation.captionduplicate","a11y.t3.description":"a11y.table.caption.summaryduplicate","a11y.t3.repair.info":"a11y.table.caption.set",
"a11y.t3.repair.errors.empty":"a11y.table.caption.validation.empty","a11y.t3.repair.errors.duplicate":"a11y.table.caption.validation.summaryduplicate","a11y.t4a.description":"a11y.table.rowscells.none","a11y.t4b.description":"a11y.table.headers.none","a11y.t4b.repair.info":"a11y.table.headers.set","a11y.t4b.repair.row":"table.row-header","a11y.t4b.repair.column":"table.column-header","a11y.t4b.repair.errors.none":"a11y.table.headers.validation.none","a11y.t4c.description":"a11y.table.headerscope.none",
"a11y.t4c.repair.info":"a11y.table.headerscope.set","a11y.t4c.repair.scope.row":"a11y.table.headerscope.scope.row","a11y.t4c.repair.scope.col":"a11y.table.headerscope.scope.col","a11y.t4c.repair.scope.rowgroup":"a11y.table.headerscope.scope.rowgroup","a11y.t4c.repair.scope.colgroup":"a11y.table.headerscope.scope.colgroup","a11y.d1.description":"a11y.heading.paragraphmisuse","a11y.d1.repair.info":"a11y.heading.set","a11y.d1.repair.block.h1":"block.h1","a11y.d1.repair.block.h2":"block.h2","a11y.d1.repair.block.h3":"block.h3",
"a11y.d1.repair.block.h4":"block.h4","a11y.d1.repair.block.h5":"block.h5","a11y.d1.repair.block.h6":"block.h6","a11y.d2.description":"a11y.heading.nonsequential","a11y.d3.description":"a11y.link.adjacent","a11y.d4.description":"a11y.list.paragraphmisuse","a11y.d5a.description":"a11y.contrast.largetext","a11y.d5b.description":"a11y.contrast.smalltext"};return{get:function(c){return b.from(a[c])},translate:function(b){var f=c.prototype.slice.call(arguments,1);return d.translate.apply(void 0,[void 0!==
a[b]?a[b]:b].concat(f))}}});k("bx",["33"],function(b){return b.immutableBag(["rules"],[])});k("sc",["2g"],function(b){return function(){return b.getOrDie("NodeFilter")}});k("sd",["33"],function(b){return b.immutableBag(["rule","element"],[])});aa("se",Node);k("ke",["b","sc","sd","se","q"],function(b,d,c,a,e){var f=d().FILTER_ACCEPT,g=d().SHOW_ELEMENT,h=function(a){return f},l=function(a,d){return b.bind(d,function(b){return b.check()(a)?[c({rule:b,element:a})]:[]})},m=function(a,d){return b.bind(d,
function(d){return b.map(d.check()(a),function(a){return c({rule:d,element:a})})})};return{audit:function(c,d){for(var f=[],r=b.partition(d,function(a){return a.walkable()}),s=r.pass,r=r.fail,t=e.createTreeWalker(c,g,h,!1);t.nextNode();)f=f.concat(l(t.currentNode,s));s=m(c,r);f=f.concat(s);f.sort(function(b,c){var d=b.element(),e=c.element();return d===e?0:0!==(d.compareDocumentPosition(e)&a.DOCUMENT_POSITION_PRECEDING)?1:-1});return f}}});k("by",["ke"],function(b){return function(d){return{audit:function(c){return b.audit(c,
d.rules())}}}});k("xp",["33"],function(b){return b.immutableBag("id wcag severity desckey url walkable check".split(" "),[])});k("xq",["7"],function(b){return{error:b.constant("error"),warning:b.constant("warning"),info:b.constant("info")}});k("xr",[],function(){return{match:function(b,d){return b.matches?b.matches(d):b.webkitMatchesSelector?b.webkitMatchesSelector(d):b.mozMatchesSelector?b.mozMatchesSelector(d):b.msMatchesSelector?b.msMatchesSelector(d):!1}}});k("sf",["b","xp","xq","xr"],function(b,
d,c,a){var e=function(a){return b.forall(a.childNodes,function(a){return/^(b|strong)$/i.test(a.nodeName)})};return d({id:"D1",wcag:"1.3.1",severity:c.warning(),desckey:"a11y.d1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){return a.match(b,"p")?e(b):!1}})});k("sg",["b","xp","xq"],function(b,d,c){return d({id:"D2",wcag:"1.3.1",severity:c.error(),desckey:"a11y.d2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",
walkable:!1,check:function(a){a=a.querySelectorAll("h1, h2, h3, h4, h5, h6");var c,d=[];b.each(a,function(a){var b=parseInt(a.tagName.slice(1),10);c&&1<b-c&&d.push(a);c=b});return d}})});k("sh",["b","xp","xq"],function(b,d,c){return d({id:"D3",wcag:"2.4.4",severity:c.error(),desckey:"a11y.d3.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/navigation-mechanisms-refs.html",walkable:!1,check:function(a){return b.filter(a.querySelectorAll("a + a"),function(a){return a.href===a.previousSibling.href})}})});
k("xs",[],function(){var b=function(b){var c=b.nodeName;for(b=b.nextSibling;null!==b&&("#text"===b.nodeName||"BR"===b.nodeName);)b=b.nextSibling;return null!==b&&b.nodeName===c?b:!1};return{check:function(d,c){for(var a=d.querySelectorAll("p,h1,h2,h3,h4,h5,h6"),e=[],f=0;f<a.length;){var g,h=a[f];g=c;for(var l=b(h),h=g(h)?[h]:[];!1!==l&&g(l);)h.push(l),l=b(l);g=h;if(1<g.length){e.push(g[0]);g=g[g.length-1];l=-1;for(h=0;h<a.length;h++)if(a[h]===g){l=h;break}g=l;f=-1===g?f+1:g}else f++}return e}}});
k("si",["xp","xq","xs"],function(b,d,c){var a=function(a){return a.textContent.match(/^\s{0,}([a-z1-9]|i+)\s{0,}[.)-]/gmi)};return b({id:"D4o",wcag:"1.3.1",severity:d.error(),desckey:"a11y.d4.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(b){return c.check(b,a)}})});k("sj",["xp","xq","xs"],function(b,d,c){var a=function(a){return a.textContent.match(/^\s{0,}(\*|-)\s{0,}/gmi)};return b({id:"D4u",wcag:"1.3.1",severity:d.error(),
desckey:"a11y.d4.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(b){return c.check(b,a)}})});k("13t",["33"],function(b){var d=b.immutable("red","green","blue","alpha");return{rgbaColour:d,white:function(){return d(255,255,255,1)}}});k("114",["13t","1r"],function(b,d){return{calculateContrastRatio:function(b,a){var e=d.max(b,a)+0.05,f=d.min(b,a)+0.05;return e/f},calculateLuminance:function(b){var a=function(a){return 0.03928>=
a?a/12.92:d.pow((a+0.055)/1.055,2.4)},e=b.red()/255,f=b.green()/255;b=b.blue()/255;e=a(e);f=a(f);a=a(b);return 0.2126*e+0.7152*f+0.0722*a},composeColour:function(c,a){var e=c.alpha()+a.alpha()*(1-c.alpha()),f=(c.red()*c.alpha()+a.red()*a.alpha()*(1-c.alpha()))/e,g=(c.green()*c.alpha()+a.green()*a.alpha()*(1-c.alpha()))/e,h=(c.blue()*c.alpha()+a.blue()*a.alpha()*(1-c.alpha()))/e;return b.rgbaColour(d.ceil(f),d.ceil(g),d.ceil(h),e)}}});k("13u",["s","13t"],function(b,d){return{parseColour:function(c){var a=
function(a,c,e,l){a=parseInt(a,10);c=parseInt(c,10);e=parseInt(e,10);l=parseFloat(l);return b.some(d.rgbaColour(a,c,e,l))};if("transparent"===c)return a(0,0,0,0);var e=c.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(null!==e)return a(e[1],e[2],e[3],1);c=c.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/);return null!==c?a(c[1],c[2],c[3],c[4]):b.none()}}});k("113","b s 114 13t 13u 2k 1b 2l 29".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(b,c){var d=h.get(b,"opacity");return 1>d?a.rgbaColour(c.red(),
c.green(),c.blue(),c.alpha()*d):c};return{getBackgroundColor:function(n){var p=l.owner(n),q=f.getBody(p);n=[n].concat(l.parents(n,function(a){return g.eq(a,q)}));n=b.foldl(n,function(a,b){if(1===a.alpha())return a;var f=h.get(b,"background-color");return e.parseColour(f).bind(function(e){e=m(b,e);return 0<e.alpha()?d.some(c.composeColour(a,e)):d.none()}).getOr(a)},a.rgbaColour(0,0,0,0));return 1>n.alpha()?c.composeColour(n,a.white()):n},getForegroundColor:function(a,b){var f=h.get(a,"color");return e.parseColour(f).bind(function(e){e=
m(a,e);e=1>e.alpha()?c.composeColour(e,b):e;return d.some(e)})}}});k("xt",["7","113","114"],function(b,d,c){return{check:function(a,e){var f=d.getBackgroundColor(a);return d.getForegroundColor(a,f).fold(b.constant(!1),function(a){var b=c.calculateLuminance(f);a=c.calculateLuminance(a);return c.calculateContrastRatio(a,b)<e})}}});aa("o0",Number);k("xu","7 s 2k 2l 29 o0 5z".split(" "),function(b,d,c,a,e,f,g){var h=function(b){b=a.get(b,"font-weight");return"bold"===b||"bolder"===b?!0:/^[0-9]*$/.test(b)?
700<=parseInt(b,10):!1},l=function(b){var c=a.get(b,"font-size");b=(new g(".*px")).test(c);c=c.match(/(\d*\.?\d*)(.*)/);return b&&null!==c?d.some(f(c[1])):d.none()};return{isLargeFont:function(a){var d=h(a),f=e.owner(a),f=c.getBody(f),g=l(f);return l(a).fold(b.constant(!1),function(a){return g.fold(function(){return 24<=a||d&&19<=a},function(b){return a>=1.5*b||d&&a>=1.2*b})})}}});k("xv",["b","20","29"],function(b,d,c){return{hasNonEmptyTextChild:function(a){a=c.children(a);return 0<b.filter(a,function(a){return d.isText(a)&&
0<d.value(a).trim().length}).length}}});k("sk","xp xq xt xu xv l".split(" "),function(b,d,c,a,e,f){return b({id:"D5a",wcag:"1.4.3",severity:d.error(),desckey:"a11y.d5a.description",url:"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html",walkable:!0,check:function(b){b=f.fromDom(b);return e.hasNonEmptyTextChild(b)&&a.isLargeFont(b)&&c.check(b,3)}})});k("sl","xp xq xt xu xv l".split(" "),function(b,d,c,a,e,f){return b({id:"D5b",wcag:"1.4.3",severity:d.error(),desckey:"a11y.d5b.description",
url:"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html",walkable:!0,check:function(b){b=f.fromDom(b);return e.hasNonEmptyTextChild(b)&&!a.isLargeFont(b)&&c.check(b,4.5)}})});k("sm",["xp","xq","xr"],function(b,d,c){return b({id:"I1",wcag:"1.1.1",severity:d.error(),desckey:"a11y.i1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/text-equiv-all.html",walkable:!0,check:function(a){return c.match(a,"img")&&(!1===a.hasAttribute("alt")||""===a.getAttribute("alt").trim())}})});
k("sn",["xp","xq","xr"],function(b,d,c){return b({id:"I2",wcag:"1.1.1",severity:d.error(),desckey:"a11y.i2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/text-equiv-all.html",walkable:!0,check:function(a){return c.match(a,"img[alt][src]")&&a.src.split("/").pop()===a.alt.split("/").pop()}})});k("so",["xp","xq","xr"],function(b,d,c){return b({id:"T1",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",
walkable:!0,check:function(a){return c.match(a,"table")?(a=a.querySelector("caption"))?c.match(a,":empty"):!0:!1}})});k("sp",["xp","xq","xr"],function(b,d,c){return b({id:"T2",wcag:"1.3.1",severity:d.warning(),desckey:"a11y.t2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(a){return c.match(a,"table")&&(a.querySelector("[rowspan]")||a.querySelector("[colspan]"))&&!a.hasAttribute("summary")}})});k("sq",["xp","xq",
"xr"],function(b,d,c){return b({id:"T3",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t3.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(a){return c.match(a,"table")&&a.hasAttribute("summary")&&0<a.querySelectorAll("caption").length&&a.getAttribute("summary")===a.querySelector("caption").innerHTML}})});k("sr",["xp","xq"],function(b,d){return b({id:"T4b",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t4b.description",
url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){return"table"===b.nodeName.toLowerCase()&&0===b.querySelectorAll("th").length}})});k("ss",["xp","xq"],function(b,d){return b({id:"T4c",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t4c.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){var a;"th"===b.nodeName.toLowerCase()?(a=!1===b.hasAttribute("scope"),
b=!1===/row|col|rowgroup|colgroup/i.test(b.getAttribute("scope")),a=a||b):a=!1;return a}})});k("st",["xp","xq"],function(b,d){return b({id:"T4a",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t4a.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){return"table"===b.nodeName.toLowerCase()?0===b.querySelectorAll("tr").length||0===b.querySelectorAll("td").length:!1}})});k("kf","b 7 s sf sg sh si sj sk sl sm sn so sp sq sr ss st".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){var w=[a,e,f,g,h,l,m,n,p,q,r,s,u,v,t];return{get:function(a){return c.from(b.find(w,function(b){return b.name()===a}))},all:d.constant(w)}});k("bz",["kf"],function(b){return{get:function(d){return b.get(d)},all:function(){return b.all().slice()}}});k("kh",["s","4f","33","1r"],function(b,d,c,a){return function(){var e=d([]),f=d(0),g=c.immutable("index","total","detail"),h=function(a){var c=e.get();if(0===c.length)return b.none();var d,h=f.get();d=c.length-
1;a=h+a;d=a>d?0:0>a?d:a;f.set(d);return b.some(g(d,c.length,c[d]))};return{load:function(a){if(0===a.length)return b.none();f.set(0);e.set(a);return b.some(g(f.get(),a.length,a[0]))},backwards:function(){return h(-1)},current:function(){var a=e.get();return 0===a.length?b.none():b.some(g(f.get(),a.length,a[f.get()]))},resolve:function(){var c=e.get();if(0===c.length)return b.none();var c=c.slice(0,f.get()).concat(c.slice(f.get()+1)),d=a.min(c.length-1,f.get());f.set(d);e.set(c);return 0===c.length?
b.none():b.some(g(f.get(),c.length,c[f.get()]))},forwards:function(){return h(1)}}}});k("su",["48"],function(b){return{resolve:b.create("ephox-wheel").resolve}});k("ki",["v","su","9"],function(b,d,c){return{resolve:function(a,b){return d.resolve(a.prefix()+"-"+b)},translate:function(a,d){var f=[(b.startsWith(d,a.tnames())?"":a.tnames()+".")+d].concat(c.prototype.slice.call(arguments,2));return a.translate.apply(null,f)}}});k("sx",["ki"],function(b){var d=function(c,a,d,f,g){d=b.translate(g,d);f=b.translate(g,
f);return c.makeTextButton(a,d,f)};return{defaultActionButton:function(b,a,e,f,g){a=d(b,a,e,f,g);b.setDefaultAction(a.element());return a},normalButton:function(b,a,e,f,g){a=d(b,a,e,f,g);b.setNormalButton(a.element());return a},button:d,toggleButton:function(c,a,d,f,g){f=b.translate(g,f);return c.makeIconToggle(a,d,f)},field:function(c,a,d,f,g){f=b.translate(g,f);return c.makeField(a,d,f)},icon:function(c,a,d,f){d=b.translate(f,d);return c.makeIconStepperButton(a,d)}}});k("sv","b fk 85 6 7 s 4x 3z 33 1a 1x l 2d 35 2y 2z sx ki".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){var w=function(a,b,f,g,h,l){var m=p.fromTag("input");a=u.field(a,m,f,g,l);n.add(m,v.resolve(l,"input"));b=[c.input(m,d.input({execute:b}))];return{element:a.element,get:function(){var a={};a[f]=t.get(m);return a},update:function(a){a=h(a);t.set(m,a)},keylayouts:e.constant(b),destroy:e.noop}},x=function(a,d,g,h,l){var m=p.fromTag("select");a=u.field(a,m,d,g,l);h=b.map(h,function(a){var b=p.fromTag("option");t.set(b,a.value());q.set(b,v.translate(l,a.text()));
return b});r.append(m,h);h=[c.single(m,[],f.none())];return{element:a.element,get:function(){var a={};a[d]=t.get(m);return a},update:e.noop,keylayouts:e.constant(h),destroy:e.noop}},k=function(f,g,h,l,q){var t=p.fromTag("div");n.add(t,v.resolve(q,"flow"));var w=b.map(l,function(a){return u.toggleButton(f,a.value(),a.icon(),a.textkey(),q)});l=b.map(w,function(a){return a.element()});r.append(t,l);l=[c.flow(t,{item:e.constant(".ephox-pastry-statebutton")},d.flow({trigger:function(a){return s.descendant(a,
".ephox-pastry-button").map(function(a){a.dom().click();return a})}}))];return{element:u.field(f,t,g,h,q).element,get:function(){return b.foldr(w,function(b,c){var d={};d[m.get(c.element(),"data-value")]=c.selected();return a.deepMerge(b,d)},{})},update:e.noop,keylayouts:e.constant(l),destroy:function(){b.each(w,function(a){a.destroy()})}}};return{generate:function(c,d,f,m){d=d.getOr([]);var n=b.bind(d,function(a){return a.fold(function(a,b,c){return[a]},function(a,b,c){return[a]},function(a,c,d){return b.map(d,
function(a){return a.value()})})}),p=0<n.length?l.immutableBag(n,[]):e.constant({}),q=h.create({execute:g([])}),r=function(){q.trigger.execute()},s=b.map(d,function(a){return a.fold(function(a,b,d){return w(c,r,a,b,d,m)},function(a,b,d){return x(c,a,b,d,m)},function(a,b,d){return k(c,a,b,d,m)})});b.each(s,function(a){a.update(f)});d=b.map(s,function(a){return a.element()});var u=b.bind(s,function(a){return a.keylayouts()});return{elements:e.constant(d),get:function(){var c=b.foldr(s,function(b,c){return a.deepMerge(b,
c.get())},{});return p(c)},keylayouts:e.constant(u),destroy:function(){b.each(s,function(a){a.destroy()});b.each(u,function(a){a.destroy()})},events:q.registry}}}});k("kj","9m fk 85 7 s 4x 3z 1x l 2d 2m 35 2o ki sv".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t,u){var v=l.fromTag("div");h.add(v,r.resolve(u,"assistance"));var w=r.resolve(u,"assistance-invalid"),x=e.none(),k=l.fromTag("div");h.add(k,r.resolve(u,"repair-error"));n.append(v,k);var B=function(){h.remove(v,w);q.empty(k)},
z=g.create({execute:f([])});n.append(v,k);var A=c.dynamic(v,d.dynamic({})),C=[A];return{element:a.constant(v),keylayouts:a.constant(C),markInvalid:function(a){h.add(v,w);b.shout(v,a);m.set(k,a)},markValid:B,getChange:function(){return x.map(function(a){return a.get()})},destroy:function(){x.each(function(a){a.destroy()})},update:function(a){B();a=a.detail();var b=a.prompts();x.each(function(a){a.destroy()});a=s.generate(t,b,a,u);x=e.some(a);q.empty(v);p.prepend(v,a.elements());n.append(v,k);a.events.execute.bind(function(){z.trigger.execute()});
A.set(a.keylayouts())},events:z.registry}}});k("sw",["7"],function(b){return{title:b.constant("widget.title"),running:b.constant("widget.running"),previous:b.constant("widget.previous"),next:b.constant("widget.next"),issueCounter:b.constant("widget.issue.counter"),issueHelp:b.constant("widget.issue.help"),noIssue:b.constant("widget.issue.none"),severity:function(b){return"severity."+b},repairLabel:b.constant("widget.repair.label"),repairText:b.constant("widget.repair.text"),repairAvailable:b.constant("widget.repair.available"),
ignoreLabel:b.constant("widget.ignore.label"),ignoreText:b.constant("widget.ignore.text"),okLabel:b.constant("widget.ok.label"),okText:b.constant("widget.ok.text")}});k("kk","e6 9m fk 85 7 3z 40 2k 1x l 2v 2m 35 2o 9z ki sw sx".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){return function(w,x){var k=m.fromTag("div");l.add(k,t.resolve(x,"commands"));var B=m.fromTag("div");l.add(B,t.resolve(x,"commands-buttons"));var z=v.defaultActionButton(w,[t.resolve(x,"repair")],u.repairLabel(),u.repairText(),
x),A=v.normalButton(w,[t.resolve(x,"ignore")],u.ignoreLabel(),u.ignoreText(),x),C=v.defaultActionButton(w,[t.resolve(x,"ok")],u.okLabel(),u.okText(),x),D=function(){q.append(B,[A.element(),z.element()])};D();var E=c.button({execute:function(a){a.dom().click()}}),E=[a.button(A.element(),E),a.button(z.element(),E),a.button(C.element(),E)];p.append(k,B);var F=f.create({repair:g([],z.events.click),ignore:g([],A.events.click),done:g([],C.events.click)});return{element:e.constant(k),destroy:function(){z.destroy();
A.destroy();C.destroy()},keylayouts:e.constant(E),focus:function(){var a=z.disabled()?z.element():A.element();n.focus(a)},update:function(a){r.remove(C.element());a=a.detail();s.isVisible(A.element())||D();a.prompts().fold(function(){z.disable();b.disable(z.element())},function(a){z.enable();b.enable(z.element());d.speak(h.body(),t.translate(x,u.repairAvailable()))})},zero:function(a){r.empty(B);p.append(B,C.element());n.focus(C.element())},events:F.registry}}});k("kl","9m 85 7 s 1a 2k 1x 3n l 2d 2m 35 2o ki sw 31".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){return function(u,v){var w=l.fromTag("div");g.add(w,r.resolve(v,"information"));e.set(w,"data-severity","info");var x=l.fromTag("div");g.add(x,r.resolve(v,"icon"));var k=l.fromTag("div");g.add(k,r.resolve(v,"description"));n.append(k,l.fromText(""));var B=l.fromTag("a");g.add(B,r.resolve(v,"help-icon"));e.set(B,"href","javascript:void(0)");p.append(w,[x,k,B]);var z=h.bind(B,"click",function(){var a=e.get(B,"data-url");t.open(a,"","height=700,width=820,resizable=yes,scrollbars=yes")}),
x=[d.single(B,[],a.none())];return{element:c.constant(w),destroy:function(){z.unbind()},keylayouts:c.constant(x),update:function(a){a=a.detail();var c=a.severity();e.set(w,"data-severity",c);b.speak(f.body(),r.translate(v,s.severity(c)));c=r.translate(v,a.description());m.set(k,c);b.speak(f.body(),c);e.set(B,"title",r.translate(v,s.issueHelp()));e.set(B,"data-url",a.url());n.after(k,B)},zero:function(){e.set(w,"data-severity","success");var a=r.translate(v,s.noIssue());m.set(k,a);b.speak(f.body(),
a);q.remove(B)}}}});k("km",["7","1x","l","2m","ki"],function(b,d,c,a,e){return function(f,g){var h=c.fromTag("div"),l=c.fromTag("span");d.add(l,e.resolve(g,"spin"));d.add(h,e.resolve(g,"loading"));a.append(h,l);return{element:b.constant(h),destroy:b.noop}}});k("kn","b kg e6 9m fk 85 7 s 3z 40 2k 1x l 2d 2m 35 ki sw sx".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,w){var x=function(a,b,c){var d=q.fromTag("div");p.add(d,u.resolve(c,a));b.each(function(a){s.append(d,q.fromText(u.translate(c,
a)))});return d};return function(k,B){var z=x("titlebar",h.none(),B),A=x("title",h.none(),B),C=x("title-text",h.some(v.title()),B),D=x("issue",h.some(v.running()),B);t.append(A,[C,D]);var E=q.fromTag("div");p.add(E,u.resolve(B,"navigation"));var C=w.icon(k,u.resolve(B,"previous"),v.previous(),B),F=w.icon(k,u.resolve(B,"next"),v.next(),B),G=[C,F],C=l.create({previous:m([],C.events.click),next:m([],F.events.click)});t.append(E,b.map(G,function(a){return a.element()}));s.append(z,A);var I=e.button({execute:function(a){a.dom().click()}}),
F=b.map(G,function(a){return f.button(a.element(),I)}),H=function(a){a.disable();c.disable(a.element())},L=function(a){a.enable();c.enable(a.element())},J=function(){b.each(G,H)},K=function(){b.each(G,L)},M=function(){d.preserve(function(){s.after(A,E)},E)};return{element:g.constant(z),update:function(b){var c=b.index()+1;b=b.total();c=u.translate(B,v.issueCounter(),c,b);r.set(D,c);a.speak(n.body(),c);(1===b?J:K)();M()},zero:function(){r.set(D,"&nbsp;");M();J()},keylayouts:g.constant(F),destroy:function(){b.each(G,
function(a){a.destroy()})},events:C.registry}}});k("c0","b kg 7 4x 3z 4f 1x l 2m 35 2o kh ki kj kk kl km kn".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v){return function(w,x){var k=h.fromTag("div");g.add(k,q.resolve(x,"widget"));var B=q.resolve(x,"loading");g.add(k,B);var z=v(w,x),A=t(w,x),C=r(w,x),D=s(w,x),E=u(w,x);m.append(k,[z.element(),E.element()]);var F=e.create({showcase:a(["detail"]),ignored:a(["detail"]),solved:a(["detail"]),done:a([])}),G=function(a){b.each([z,A,C,D],function(b){b.update(a)});
F.trigger.showcase(a.detail());d.preserve(function(){l.after(z.element(),A.element());l.after(A.element(),C.element());l.after(C.element(),D.element())},k)},I=function(a){a.fold(function(){l.after(z.element(),A.element());l.after(A.element(),D.element());n.remove(C.element());z.zero();A.zero();D.zero()},G)},H=f(p());z.events.previous.bind(function(){H.get().backwards().each(G)});z.events.next.bind(function(){H.get().forwards().each(G)});var L=function(){var a=C.getChange().getOr({});H.get().current().each(function(b){var c=
b.detail();c.repair()(c,a).fold(function(a){C.markInvalid(a)},function(a){C.markValid();a=H.get().resolve();F.trigger.solved(c);I(a);D.focus()})})};C.events.execute.bind(L);D.events.repair.bind(L);D.events.ignore.bind(function(){H.get().current().each(function(a){var b=H.get().resolve();F.trigger.ignored(a.detail());I(b)})});D.events.done.bind(function(){F.trigger.done()});L=b.flatten([z.keylayouts(),A.keylayouts(),C.keylayouts(),D.keylayouts()]);return{element:c.constant(k),destroy:function(){b.each([z,
A,C,D],function(a){a.destroy()})},load:function(a){n.remove(E.element());g.remove(k,B);a=H.get().load(a);I(a)},open:function(){l.append(k,E.element());g.add(k,B)},skip:function(){var a=H.get().resolve();I(a)},keylayouts:c.constant(L),events:F.registry}}});k("6r","b 7 bq 6s bt bu bv bw 3z 40 bx by bz 2k c0".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t){var u=a.ignoreAttr(),v={prefix:d.constant("accessibility-check"),translate:h.translate,tnames:d.constant("a11y")},w=s(g,v),
v=q.all(),v=n({rules:v}),k=p(v),y=c(h.translate),B=a.manager(t.content()),z=function(a){a=k.audit(a.dom());a=y.convert(t,a);return b.filter(a,function(a){var c=a.element(),c=f.read(c,u);return!b.contains(c,a.id())})};w.events.showcase.bind(function(a){t.content().body().each(function(b){b=a.detail().element();r.inBody(b)?(B.moveTo(b,a.detail().severity()),e.elementIntoView(t.content(),b)):w.skip()})});w.events.ignored.bind(function(a){a=a.detail();B.ignore(a.element(),a.id(),a.severity())});w.events.solved.bind(function(a){a=
a.detail();B.solve(a.element(),a.id(),a.severity())});v=l.create({done:m([],w.events.done)});return{element:w.element,name:d.constant("a11y-check-button"),anchorName:d.constant("a11y-widget-anchor"),textkey:d.constant("action.a11ycheck"),destroy:function(){w.destroy()},keylayouts:w.keylayouts,openWidget:function(){t.content().hideInlineSelection();w.open();t.content().body().each(function(a){a=z(a);B.start(a);w.load(a)})},closeWidget:function(){B.stop()},events:v.registry}}});k("ch","6w c 4x 3z 1x 2l 3n l 2m 2o 3m".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n){return function(p,q){var r=d.detect().browser,s=r.isIE()&&10===r.version.major,t=a.create({open:c([]),close:c([])}),u=h.fromTag("div");e.add(u,b.resolve("layer-menus"));e.add(u,b.resolve("toolstrip"));l.append(p(),u);var v=!1,w=function(){v||f.remove(u,"display")},k=g.bind(u,"transitionend",w);return{element:function(){return u},destroy:function(){k.unbind();m.remove(u)},open:function(){v||(v=!0,f.set(u,"display","block"),f.reflow(u),t.trigger.open(),f.set(u,"opacity",
"1"))},close:function(){v&&(v=!1,f.remove(u,"opacity"),s&&n(w,100),t.trigger.close())},isClosed:function(){return!v},setContent:function(a){l.append(u,a)},events:t.registry}}});k("6t","6w 7i a3 85 ch 6u 30 4x 3z 43 46".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p,q,r){var s=p.content(),t=p.ui().tabstrip.element(),u=[q.element()],v="."+g.resolve(q.name())+", ."+b.resolve("more-button");r=function(){var a=n.descendants(t,v);return u.concat(a)};var w=e(p.ui().viewport,r);w.setContent(q.element());
p=w.element();m.add(p,[g.resolve(q.anchorName()),g.resolve("side-widget-anchor")]);d.dialog(p,f.translate(q.textkey()));var k=l.create({abort:h([]),open:h([]),close:h([])}),y=function(){w.isClosed()||(q.closeWidget(),w.close(),B.off(),s.focus(),k.trigger.close())},B=c(y,r);q.events.done.bind(function(){y()});var z=a.multiple(q.element(),q.keylayouts());z.events.exit.bind(function(){k.trigger.abort()});s.events.mousedown.bind(function(){y()});return{element:w.element,destroy:function(){z.destroy();
q.destroy();w.close();w.destroy();B.off()},events:k.registry,open:function(){B.on();q.openWidget();w.open();z.enter();k.trigger.open()},close:y,isClosed:w.isClosed}}});k("6v",["b","c","6","6u","1f"],function(b,d,c,a,e){var f=(d=d.detect().os.isOSX())?"\u2318":"Ctrl",g=d?"\u21e7":"Shift",h={blockquote:[f,g,"9"],bold:[f,"B"],italic:[f,"I"],underline:[f,"U"],link:[f,"K"],help:[f,"?"],fullscreen:[f,g,"F"],indent:[f,"]"],outdent:[f,"["],undo:[f,"Z"],redo:d?[f,g,"Z"]:[f,"Y"],search:[f,"F"]},l="fr nl sv ru de es it".split(" "),
m=c.merge(h,{indent:[f,"M"],outdent:[f,g,"M"]}),n=function(a){var c=e.get();return b.contains(l,c)?m[a]:h[a]};c=function(a){a=n(a);return void 0===a?"":" "+a.join("")};var f=function(a){a=n(a);return void 0===a?"":" ("+a.join(" ")+")"},p=d?c:f;return{get:function(b,c){return a.get(b)+p(c)}}});k("55","6r 6s 6t 6u 30 6l 6v 1x".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,d){var e=b(a);return c(a,e,d)};return function(b,c){var p=b.filter();d.configure(p);var q=l(b,c);h.add(q.element(),e.resolve("inverted-dialog-widget"));
q.events.close.bind(q.close);q.events.abort.bind(q.close);return{ui:f.ui({"a11ycheck.general":{toggle:!1,hasPopup:!1,value:"a11y-check",textkey:a.key("action.a11ycheck"),action:function(){(q.isClosed()?q.open:q.close)()},updateGeneral:function(a){h.add(a.element(),e.resolve("a11y-check-button"))},icon:!0,tooltip:g.get}}),destroy:function(){q.destroy()}}}});k("ko",["7","2l"],function(b,d){var c=function(a,b,c){var h=d.get(b,a);c=parseInt(h,10)+40*c;(0<c?d.set:d.remove)(b,a,c+"px")},a={change:b.curry(c,
"margin-right")};return{ltr:{change:b.curry(c,"margin-left")},rtl:a}});k("ci",["ko"],function(b){return function(d){return{change:function(c,a){return(d.directionAt(c).isRtl()?b.rtl:b.ltr).change(c,a)}}}});k("cj",["7","3m"],function(b,d){return{runTransaction:function(c,a,e,f){f=void 0!==f?f:b.noop;a.save();c.focus();e=e();d(function(){c.domChanged();c.uiChanged()},0);f();a.save();return e}}});k("ck",["b","cj"],function(b,d){return{multiple:function(c,a,e){return function(f,g){var h=c.getSelection(),
l=d.runTransaction(c,a,function(){return b.bind(g,function(a){return a.getSelection().bind(function(a){return e(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()).map(function(a){return a.all()})}).getOr([])})},c.toEditing);h.each(function(a){c.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())});return l}},single:function(b,a,e,f,g){return function(h,l){var m=f(b,h.startContainer(),h.startOffset()),n=f(b,h.endContainer(),h.endOffset()),p=d.runTransaction(b,
a,function(){return e(m.element(),m.offset(),n.element(),n.offset())},b.toEditing);return g(b,p,m,n,h)}}}});k("cl",["b","cj"],function(b,d){return{multiple:function(c,a,e){return function(f,g){return d.runTransaction(c,a,function(){return b.bind(g,function(a){return a.getSelection().bind(function(a){return e(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()).map(function(a){return a.all()})}).getOr([])})},c.toEditing)}},single:function(b,a,e,f,g){return function(h,l){var m=f(b,h.startContainer(),
h.startOffset()),n=f(b,h.endContainer(),h.endOffset()),p=d.runTransaction(b,a,function(){return e(m.element(),m.offset(),n.element(),n.offset())},b.toEditing);return g(b,p,m,n,h)}}}});k("cm",[],function(){return{update:function(b,d,c,a,e){return d.map(function(a){b.setSelection(a.start(),a.soffset(),a.finish(),a.foffset());return a.all()}).getOr([])}}});k("cn",["du"],function(b){return{spot:function(d,c,a){return b.point(c,a)}}});k("73",["s","4g"],function(b,d){var c=d.generate([{none:[]},{multiple:["elements",
"environments"]},{single:["selection","environment"]}]);return{cata:function(a,b,c,d){return a.fold(b,c,d)},none:c.none,multiple:c.multiple,single:c.single,toSelection:function(a){return a.fold(b.none,function(a,c){return b.from(c[0]).bind(function(a){return a.getSelection()})},b.some)}}});k("8w",[],function(){var b=function(b){return{fold:b}};return{on:function(d,c){return b(function(a,b,f){return b(d,c)})},before:function(d){return b(function(b,a,e){return b(d)})},after:function(d){return b(function(b,
a,e){return e(d)})}}});k("dp",["8w","33","l"],function(b,d,c){var a=d.immutable("start","soffset","finish","foffset"),e=d.immutable("start","soffset","finish","foffset"),f=d.immutable("start","finish");return{read:a,general:e,write:f,writeFromNative:function(a){var d=c.fromDom(a.startContainer),e=c.fromDom(a.endContainer);return f(b.on(d,a.startOffset),b.on(e,a.endOffset))}}});k("dq",[],function(){return{run:function(b,d){if(b.getSelection)return d(b,b.getSelection());throw"No selection model supported.";
}}});k("kq",["1b","29"],function(b,d){return{after:function(c,a,e,f){var g=d.owner(c).dom().createRange();g.setStart(c.dom(),a);g.setEnd(e.dom(),f);c=b.eq(c,e)&&a===f;return g.collapsed&&!c}}});k("kp",["dp","kq","l","29"],function(b,d,c,a){var e=function(a){return d.after(c.fromDom(a.anchorNode),a.anchorOffset,c.fromDom(a.focusNode),a.focusOffset)},f=function(a,d){var f=c.fromDom(d.startContainer),g=c.fromDom(d.endContainer);return e(a)?b.read(g,d.endOffset,f,d.startOffset):b.read(f,d.startOffset,
g,d.endOffset)},g=function(a){return e(a)},h=function(b,c,d,e){return function(f){if(f.extend)f.collapse(b.dom(),c),f.extend(d.dom(),e);else{var g=a.owner(b).dom().createRange();g.setStart(d.dom(),e);g.setEnd(b.dom(),c);f.removeAllRanges();f.addRange(g)}}},l=function(a,b,c,e){return d.after(a,b,c,e)};return{read:function(){return{flip:f,isRtl:g}},write:function(){return{flip:h,isRtl:l}}}});k("ds",["dp","kp","s","kq","l"],function(b,d,c,a,e){var f=function(a,d){if(!0===g(a,d.start(),d.finish()).collapsed){var f=
g(a,d.finish(),d.start());return!0===f.collapsed?c.none():c.some(b.general(e.fromDom(f.endContainer),f.endOffset,e.fromDom(f.startContainer),f.startOffset))}return c.none()},g=function(a,b,c){var d=m(a);b.fold(function(a){d.setStartBefore(a.dom())},function(a,b){d.setStart(a.dom(),b)},function(a){d.setStartAfter(a.dom())});c.fold(function(a){d.setEndBefore(a.dom())},function(a,b){d.setEnd(a.dom(),b)},function(a){d.setEndAfter(a.dom())});return d},h=function(a,b){return g(a,b.start(),b.finish())},
l=function(a,b){var c=h(a,b);return function(a){a.addRange(c)}},m=function(a){return a.document.createRange()};return{create:m,build:function(a,b){return f(a,b).fold(function(){return l(a,b)},function(a){return d.write().flip(a.start(),a.soffset(),a.finish(),a.foffset())})},toNative:h,forceRange:function(a,b){var c=g(a,b.start(),b.finish());return!0===c.collapsed?g(a,b.finish(),b.start()):c},toExactNative:function(b,c,d,e,f){var g=a.after(c,d,e,f);b=b.document.createRange();g?(b.setStart(e.dom(),
f),b.setEnd(c.dom(),d)):(b.setStart(c.dom(),d),b.setEnd(e.dom(),f));return b}}});k("dr","b ds l 20 46 m".split(" "),function(b,d,c,a,e,f){var g=function(a,c,d,g){var p=a.document.createRange();a=(f.is(c,g)?[c]:[]).concat(e.descendants(c,g));return b.filter(a,function(a){p.selectNodeContents(a.dom());return 1>p.compareBoundaryPoints(d.END_TO_START,d)&&-1<p.compareBoundaryPoints(d.START_TO_END,d)})};return{find:function(b,e,f){e=d.forceRange(b,e);var n=c.fromDom(e.commonAncestorContainer);return a.isElement(n)?
g(b,n,e,f):[]}}});k("kr",["b","dp","8w","20"],function(b,d,c,a){var e=function(d,e){var h=a.name(d);return"input"===h?c.after(d):b.contains(["br","img"],h)?0===e?c.before(d):c.after(d):c.on(d,e)};return{beforeSpecial:e,preprocess:function(a){var b=a.start().fold(c.before,e,c.after);a=a.finish().fold(c.before,e,c.after);return d.write(b,a)}}});k("ks",["b","l","q"],function(b,d,c){return{fromElements:function(a,e){var f=(e||c).createDocumentFragment();b.each(a,function(a){f.appendChild(a.dom())});return d.fromDom(f)}}});
k("dt","dp kp ds kr s l ks".split(" "),function(b,d,c,a,e,f,g){var h=function(a,b){var c=b.getRangeAt(0),d=b.getRangeAt(b.rangeCount-1),e=a.document.createRange();e.setStart(c.startContainer,c.startOffset);e.setEnd(d.endContainer,d.endOffset);return e},l=function(a,b){return void 0!==b&&null!==b&&0<b.rangeCount?e.from(h(a,b)):e.none()};return{get:function(a,c){return l(a,c).map(function(a){var e=f.fromDom(a.startContainer),g=f.fromDom(a.endContainer);return d.read().isRtl(c)?d.read().flip(c,a):b.read(e,
a.startOffset,g,a.endOffset)})},set:function(b){return function(d,e){var f=a.preprocess(b),f=c.build(d,f);void 0!==e&&null!==e&&(e.removeAllRanges(),f(e))}},selectElementContents:function(a){return function(b,d){var e=c.create(b);e.selectNodeContents(a.dom());d.removeAllRanges();d.addRange(e)}},replace:function(a){return function(b,c){l(b,c).each(function(c){var d=g.fromElements(a,b.document);c.deleteContents();c.insertNode(d.dom())})}},replaceRange:function(b,d){return function(e,f){var h=a.preprocess(b),
h=c.toNative(e,h),l=g.fromElements(d,e.document);h.deleteContents();h.insertNode(l.dom())}},deleteRange:function(a,b,d,e){return function(f,g){c.toExactNative(f,a,b,d,e).deleteContents()}},cloneFragment:function(a,b,d,e){return function(g,h){var l=c.toExactNative(g,a,b,d,e).cloneContents();return f.fromDom(l)}},rectangleAt:function(a,b,d,f){return function(g,h){var l=c.toExactNative(g,a,b,d,f),u=l.getClientRects(),l=0<u.length?u[0]:l.getBoundingClientRect();return 0<l.width||0<l.height?e.some(l):
e.none()}},bounds:function(a){return function(b,d){var f=c.create(b);f.selectNode(a.dom());f=f.getBoundingClientRect();return 0<f.width||0<f.height?e.some(f):e.none()}},clearSelection:function(a,b){a.getSelection().removeAllRanges()}}});k("ap","dp 8w dq dr ds dt 1b l".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,b){c.run(a,f.set(b))},m=function(b,c,d){return a.find(b,c,d)};return{get:function(a){return c.run(a,f.get)},set:l,setExact:function(a,c,e,f,g){c=b.write(d.on(c,e),d.on(f,g));l(a,
c)},selectElementContents:function(a,b){c.run(a,f.selectElementContents(b))},replace:function(a,b){c.run(a,f.replace(b))},replaceRange:function(a,b,d){c.run(a,f.replaceRange(b,d))},deleteRange:function(a,b,d,e,g){c.run(a,f.deleteRange(b,d,e,g))},isCollapsed:function(a,b,c,d){return g.eq(a,c)&&b===d},cloneFragment:function(a,b,d,e,g){return c.run(a,f.cloneFragment(b,d,e,g))},rectangleAt:function(a,b,d,e,g){return c.run(a,f.rectangleAt(b,d,e,g))},bounds:function(a,b){return c.run(a,f.bounds(b))},findWithin:m,
findWithinExact:function(a,c,e,f,g,h){c=b.write(d.on(c,e),d.on(f,g));return m(a,c,h)},deriveExact:function(a,c){var d=e.forceRange(a,c);return b.general(h.fromDom(d.startContainer),d.startOffset,h.fromDom(d.endContainer),d.endOffset)},clearAll:function(a){c.run(a,f.clearSelection)}}});k("cp","ap co 7 s 2k 1b 2y 29 1r".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(b,c){return e.inBody(b)?a.some(l.max(0,l.min(c,d.getEnd(b)))):a.none()};return{findDescendants:function(a,c,d,e,f){var g=h.defaultView(a);
return m(a,c).bind(function(c){return m(d,e).map(function(e){return b.findWithinExact(g.dom(),a,c,d,e,f)})}).getOr([])},findAncestors:function(a,b,d){return g.ancestor(a,d).fold(function(){return g.ancestor(b,d).toArray()},function(a){return g.ancestor(b,d).fold(c.constant([a]),function(b){return f.eq(a,b)?[a]:[a,b]})})}}});k("70","8w co 7 s cp 30 1b 20 2o 2y 29 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q="."+f.resolve("element-resize-container"),r=function(b){if(b.collapsed()||!g.eq(b.startContainer(),
b.endContainer()))return a.none();var d=p.min(b.startOffset(),b.endOffset());return p.max(b.startOffset(),b.endOffset())===d+1?n.child(b.startContainer(),d).filter(function(a){return"img"===h.name(a)}).map(function(a){return{image:c.constant(a),container:c.constant(b.startContainer())}}):a.none()},s=function(a){return m.closest(a,q)};return{detect:function(a){return a.getSelection().bind(function(a){return s(a.startContainer()).bind(function(b){return s(a.endContainer()).bind(function(b){return m.closest(a.startContainer(),
q).bind(function(a){return m.descendant(a,"img").map(function(b){return{image:c.constant(b),container:c.constant(a)}})})})}).orThunk(function(){return r(a)})})},findContainer:s,selectionContains:function(b){b=e.findDescendants(b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset(),"img");return 1===b.length?a.some(b[0]):a.none()},remove:function(a,c,d){c.close();a.setRelativeSelection(b.before(d),b.before(d));l.remove(d)},select:function(a,b){s(b).each(function(b){a.setSelection(b,0,b,
d.getEnd(b))})}}});k("t5",["b","7","s","33"],function(b,d,c,a){var e=a.immutable("left","right"),f=function(a,e,f){e=a.property().children(e);a=b.findIndex(e,d.curry(a.eq,f));return-1<a?c.some({before:d.constant(e.slice(0,a)),after:d.constant(e.slice(a+1))}):c.none()};return{breakToLeft:function(a,b,c){return f(a,b,c).map(function(d){var f=a.create().clone(b);a.insert().appendAll(f,d.before().concat([c]));a.insert().appendAll(b,d.after());a.insert().before(b,f);return e(f,b)})},breakToRight:function(a,
b,c){return f(a,b,c).map(function(c){var d=a.create().clone(b);a.insert().appendAll(d,c.after());a.insert().after(b,d);return e(b,d)})},breakPath:function(b,d,e,f){var n=a.immutable("first","second","splits"),p=function(a,d,h){var t=n(a,c.none(),h);return e(a)?n(a,d,h):b.property().parent(a).bind(function(d){return f(b,d,a).map(function(a){var b=[{first:a.left,second:a.right}],f=e(d)?d:a.left();return p(f,c.some(a.right()),h.concat(b))}).getOr(t)})};return p(d,c.none(),[])}}});k("t6",["b","7","s"],
function(b,d,c){var a=function(a,c,d,l){d=c(a,d);return b.foldr(l,function(b,d){var h=c(a,d);return e(a,b,h)},d)},e=function(a,b,c){return b.bind(function(b){return c.filter(d.curry(a.eq,b))})};return{oneAll:function(b,d,e){if(0<e.length){var l=e[0];e=e.slice(1);b=a(b,d,l,e)}else b=c.none();return b}}});k("t7",["b","7","s","1r"],function(b,d,c,a){var e=function(e,f,l,m){var n=e.property().children(f);if(e.eq(f,l[0]))return c.some([l[0]]);if(e.eq(f,m[0]))return c.some([m[0]]);var p=function(a){a=b.reverse(a);
var c=b.findIndex(a,d.curry(e.eq,f));return b.findIndex(n,d.curry(e.eq,c<a.length-1?a[c+1]:a[c]))};l=p(l);m=p(m);var p=a.min(l,m),q=a.max(l,m);return-1<l&&-1<m?c.some(n.slice(p,q+1)):c.none()},f=function(a,e,f,m){var n=void 0!==m?m:d.constant(!1);e=[e].concat(a.up().all(e));m=[f].concat(a.up().all(f));var p=function(a){var c=b.findIndex(a,n);return-1<c?a.slice(0,c+1):a};f=p(e);var q=p(m);e=b.find(f,function(c){return b.exists(q,d.curry(a.eq,c))});e=c.from(e);return{firstpath:d.constant(f),secondpath:d.constant(q),
shared:d.constant(e)}};return{subset:function(a,b,c){var d=f(a,b,c);return d.shared().bind(function(b){return e(a,b,d.firstpath(),d.secondpath())})},ancestors:f}});k("la",["t5","t6","t7"],function(b,d,c){return{sharedOne:function(a,b,c){return d.oneAll(a,b,c)},subset:function(a,b,d){return c.subset(a,b,d)},ancestors:function(a,b,d,g){return c.ancestors(a,b,d,g)},breakToLeft:function(a,c,d){return b.breakToLeft(a,c,d)},breakToRight:function(a,c,d){return b.breakToRight(a,c,d)},breakPath:function(a,
c,d,g){return b.breakPath(a,c,d,g)}}});k("f1",["dg","la"],function(b,d){var c=b();return{sharedOne:function(a,b){return d.sharedOne(c,function(b,c){return a(c)},b)},subset:function(a,b){return d.subset(c,a,b)},ancestors:function(a,b,f){return d.ancestors(c,a,b,f)},breakToLeft:function(a,b){return d.breakToLeft(c,a,b)},breakToRight:function(a,b){return d.breakToRight(c,a,b)},breakPath:function(a,b,f){return d.breakPath(c,a,b,function(a,b,c){return f(b,c)})}}});k("xw",["1b","l","2m","20","2o"],function(b,
d,c,a,e){return{forceAddBr:function(f,g){if("br"!==a.name(f)){var h=d.fromTag("br");a.isText(f)?(c.after(f,h),b.eq(g,f)||e.remove(f)):c.prepend(f,h)}},rootBr:function(a,b){c.before(a,d.fromTag("br"))}}});k("xx",["b","29"],function(b,d){var c=function(a,f,g){var h=[];b.each(d.children(a),function(a){f(a)&&(h=h.concat([a]));h=g(a)?h:h.concat(c(a,f,g))});return h},a=function(b,c){var g=d.children(b);return 0<g.length?(g=g[0],c(g)?b:a(g,c)):0<g.length?a(g[0]):b};return{descendants:c,plunge:a}});k("i5",
["d1","co","1b"],function(b,d,c){var a=function(a,b,d,h,l){return h(a).fold(function(){return!0},function(a){return c.eq(b,a)&&l(b,d)})};return{isLeft:function(c,f){return a(c,f.startContainer(),f.startOffset(),b.firstCursor,d.isStart)},isRight:function(c,f){return a(c,f.startContainer(),f.startOffset(),b.lastCursor,d.isEnd)}}});k("mk","a b i5 7 e4 33 1b 20 68 49 9y v".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=function(a){a=h.name(a);return"td"===a||"th"===a},r=function(a){return"li"===h.name(a)||
e.isBlock(a)},s=function(a){return"a"===h.name(a)},t=function(b,c,d){return m.closest(b,c,d).filter(a.not(d)).filter(a.not(q))};return{stopAt:function(b){return a.curry(g.eq,b)},isList:function(a){a=h.name(a);return"ol"===a||"ul"===a},isAnchor:s,isHeading:function(a,c){var e=b.isArray(c)?c:[],e="h1 h2 h3 h4 h5 h6".split(" ").concat(e),f=h.name(a);return d.contains(e,f)},isCollapsed:function(a){return g.eq(a.startContainer(),a.endContainer())&&a.startOffset()===a.endOffset()},isRightEdge:function(a,
b,d){var e=f.immutable("startContainer","startOffset");return c.isRight(a,e(b,d))},exitList:function(a){return 0===l.descendants(a,function(a){return h.isText(a)&&0<n.get(a).length&&0<p.trim(n.get(a)).length||h.isElement(a)&&d.contains(["hr","img"],h.name(a))}).length},findBlock:function(a,b){return m.closest(a,r,b)},findValidHardBreak:function(a,b){return t(a,r,b)},findAnchorBreak:function(a,b){return t(a,s,b)}}});k("xy","54 b 1a 2d 20 46 9y 29 v".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a){if(!e.isText(a))return!1;
a=g.get(a).trim();return 0===a.length||0===a.replace(b.zeroWidth(),"").length},n=function(b){if(e.isText(b))return m(b);var c=a.get(b);b=h.children(b);return""===l.trim(c)||d.forall(b,m)};return{vacant:function(a){a=f.descendants(a,"span,a");return d.filter(a,function(a){return"span"===e.name(a)?!(c.has(a,"class")&&0<c.get(a,"class").length)&&!c.has(a,"style")&&n(a):n(a)})},isEmpty:n,hasCursor:function(a,b){var c=void 0!==b?b:["hr","br","img","input"];return e.isText(a)?!1===m(a):d.contains(c,e.name(a))},
isVacantText:m,hasNoContent:n}});k("sz","b 7 s xw xx mk xy 1a 20 2o 46".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a){var b="li"===l.name(a)?f.isList:d.constant(!1);return 0<e.descendants(a,g.hasCursor,b).length?c.none():c.some(e.plunge(a,b))},q=function(a){a=g.vacant(a);b.each(a,m.remove)},r=function(a,c){var d=n.descendants(c,a),d=b.filter(d,g.isEmpty);b.each(d,m.remove);g.isEmpty(c)&&m.remove(c)};return{vacate:q,emptyStyles:function(a){!0===h.has(a,"style")&&0===h.get(a,"style").length&&
h.remove(a,"style")},needsCursor:p,postprocess:function(b,c,d){q(b);p(b).each(function(b){a.forceAddBr(b,c)})},lists:d.curry(r,"ul,ol"),blockquotes:d.curry(r,"blockquote")}});k("sy",["b","7","f1","sz","1a"],function(b,d,c,a,e){var f=function(f,h){var l=c.breakToRight(f,h);l.each(function(c){c=c.right();b.each(["id"],d.curry(e.remove,c));a.emptyStyles(c)});return l};return{breakPath:function(a,b){return c.breakPath(a,b,f)}}});k("kt","b 8w 7 sy sz mk 2m".split(" "),function(b,d,c,a,e,f,g){return{breakQuote:function(h,
l){var m=a.breakPath(l,f.stopAt(h));return m.second().map(function(a){var f=m.first();g.before(a,l);b.each([f,a],e.blockquotes);return{start:c.constant(d.on(l,0)),finish:c.constant(d.on(l,0))}})}}});k("cq",["kt"],function(b){return{breakQuote:b.breakQuote}});k("ku",["20","29"],function(b,d){var c=function(a){return b.isElement(a)?a:d.parent(a).getOr(a)};return{bothMatch:function(a,b,d){a=c(a);b=c(b);return d(a)&&d(b)}}});k("l5",["e4","m"],function(b,d){return{isRootOrCell:function(b){return function(a){return b(a)||
d.is(a,"td,th")}},isRootOrContainer:function(c){return function(a){return c(a)||b.isContainer(a)}}}});k("t0",["s"],function(b){var d=function(b,a){return 0===b.length?!0:0===a.length?!1:b[0]<a[0]?!0:a[0]<b[0]?!1:d(b.slice(1),a.slice(1))};return{head:function(c){return 0<c.length?b.some(c[0]):b.none()},tail:function(c){return 0<c.length?b.some(c.slice(1)):b.none()},toLast:function(c){return 0<c.length?b.some(c[c.length-1]):b.none()},box:function(b){return[b]},isBefore:d}});k("lt",["b","7","4g","t0"],
function(b,d,c,a){c=c.generate([{quasi:["elements"]},{block:["element"]},{container:["element","children"]},{fixture:["element"]}]);var e=function(a){return a.fold(function(a){return"@q["+b.map(a,function(a){return a.dom().outerHTML||'"'+a.dom().nodeValue+'"'}).join(",")+"]"},function(a){return"@"+a.dom().nodeName.toLowerCase()+"("+a.dom().innerHTML+")"},function(a,c){return"#"+a.dom().nodeName.toLowerCase()+"("+b.map(c,e).join(",")+")"},function(a){return a.dom().nodeName.toLowerCase()})},f=function(a){var b=
function(a){return[a]};return a.fold(d.identity,b,b,b)},g=d.constant(!0),h=d.constant(!1);return{cata:function(a,b,c,d,e){return a.fold(b,c,d,e)},quasi:c.quasi,block:c.block,container:c.container,fixture:c.fixture,isQuasi:function(a){return a.fold(g,h,h,h)},isFixture:function(a){return a.fold(h,h,h,g)},isQuasiOrFixture:function(a){return a.fold(g,h,h,g)},toTarget:f,toString:e,toLastTarget:function(b){return a.toLast(f(b))}}});k("115",["7"],function(b){var d=function(c,a){return{fold:c,label:b.constant(a)}};
return{before:function(b){return d(function(a,d,f,g,h){return a(b)},"before")},after:function(b){return d(function(a,d,f,g,h){return d(b)},"after")},rest:function(b){return d(function(a,d,f,g,h){return f(b)},"rest")},last:function(b){return d(function(a,d,f,g,h){return g(b)},"last")},invalid:function(b,a){return d(function(d,f,g,h,l){return l(b,a)},"invalid")}}});k("tk",["b","s","du","go","jd"],function(b,d,c,a,e){return{subdivide:function(f,g,h){var l=f.property().getText(g);h=b.filter(e.splits(l,
h),function(a){return 0<a.length});if(1>=h.length)return[c.range(g,0,l.length)];f.property().setText(g,h[0]);var l=a.generate(h.slice(1),function(a,b){var e=f.create().text(a),e=c.range(e,b,b+a.length);return d.some(e)},h[0].length),m=b.map(l,function(a){return a.element()});f.insert().afterAll(g,m);return[c.range(g,0,h[0].length)].concat(l)}}});k("y7",["7"],function(b){var d=function(c,a){return{fold:c,label:b.constant(a)}};return{none:function(){return d(function(b,a,d,f){return b()},"none")},start:function(b){return d(function(a,
d,f,g){return d(b)},"start")},middle:function(b,a){return d(function(d,f,g,h){return g(b,a)},"middle")},end:function(b){return d(function(a,d,f,g){return g(b)},"end")}}});k("tl",["y7"],function(b){return{determine:function(d){return d.before().fold(function(){return d.after().fold(function(){return b.none()},function(c){return b.start(c)})},function(c){return d.after().fold(function(){return b.end(c)},function(a){return b.middle(c,a)})})}}});k("119",["7","s"],function(b,d){var c=b.constant(!1),a=
b.constant(!0),e=function(e){return{isBoundary:function(){return e(a,c,c)},fold:e,toText:function(){return e(d.none,d.none,function(a,b){return d.some(a)})},is:function(a){return e(c,c,function(b,c){return c.eq(b,a)})},len:function(){return e(b.constant(0),b.constant(1),function(a,b){return b.property().getText(a).length})}}};return{text:function(a,b){return e(function(c,d,e){return e(a,b)})},boundary:function(a,b){return e(function(c,d,e){return c(a,b)})},empty:function(a,b){return e(function(c,
d,e){return d(a,b)})},cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("13v",["b","7"],function(b,d){return{boundAt:function(c,a,e,f){a=b.findIndex(c,d.curry(f,a));a=-1<a?a:0;e=b.findIndex(c,d.curry(f,e));return c.slice(a,-1<e?e+1:c.length)}}});k("13w",["b"],function(b){return{sliceby:function(d,c){var a=b.findIndex(d,c);return d.slice(0,a)}}});k("13y",["4g"],function(b){b=b.generate([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}]);return{include:b.include,excludeWith:b.excludeWith,
excludeWithout:b.excludeWithout,cata:function(b,c,a,e){return b.fold(c,a,e)}}});k("13x",["b","13y"],function(b,d){var c=function(a,c){var f=[],g=[];b.each(a,function(a){var b=c(a);d.cata(b,function(){g.push(a)},function(){0<g.length&&f.push(g);f.push([a]);g=[]},function(){0<g.length&&f.push(g);g=[]})});0<g.length&&f.push(g);return f};return{splitby:function(a,b){return c(a,function(a){return b(a)?d.excludeWithout(a):d.include(a)})},splitbyAdv:c}});k("11z",["13v","13w","13x"],function(b,d,c){return{splitby:function(a,
b){return c.splitby(a,b)},splitbyAdv:function(a,b){return c.splitbyAdv(a,b)},sliceby:function(a,b){return d.sliceby(a,b)},boundAt:function(a,c,d,g){return b.boundAt(a,c,d,g)}}});k("11a",["b","7","s","du","11z"],function(b,d,c,a,e){return{count:function(a){return b.foldr(a,function(a,b){return b.len()+a},0)},dropUntil:function(a,b){return e.sliceby(a,function(a){return a.is(b)})},gen:function(b,d){return b.fold(c.none,function(b){return c.some(a.range(b,d,d+1))},function(e){return c.some(a.range(e,
d,d+b.len()))})},justText:function(a){return b.bind(a,function(a){return a.fold(d.constant([]),d.constant([]),function(a){return[a]})})}}});k("y4",["b","du","119","11a"],function(b,d,c,a){var e=function(a,d,f){if(a.property().isText(d))return[c.text(d,a)];if(a.property().isEmptyTag(d))return[c.empty(d,a)];if(a.property().isElement(d)){var m=a.property().children(d),n=a.property().isBoundary(d)?[c.boundary(d,a)]:[];d=void 0!==f&&f(d)?[]:b.bind(m,function(b){return e(a,b,f)});return n.concat(d).concat(n)}return[]},
f=function(b,c,f,m,n){b=e(b,m,n);c=a.dropUntil(b,c);c=a.count(c);return d.point(m,c+f)};return{typed:e,items:function(a,c,d){a=e(a,c,d);var f=function(a,b){return a};return b.map(a,function(a){return a.fold(f,f,f)})},extractTo:function(a,b,c,e,n){return a.up().predicate(b,e).fold(function(){return d.point(b,c)},function(d){return f(a,b,c,d,n)})},extract:function(a,b,c,e){return a.property().parent(b).fold(function(){return d.point(b,c)},function(d){return f(a,b,c,d,e)})}}});k("y5",["b","7","y4"],
function(b,d,c){var a=function(a,b){return"img"===b.property().name(a)?" ":"\n"};return{from:function(e,f,g){f=c.typed(e,f,g);return b.map(f,function(b){return b.fold(d.constant("\n"),a,e.property().getText)}).join("")}}});k("y6",["du","y4","11a","go"],function(b,d,c,a){return{find:function(e,f,g,h){e=d.typed(e,f,h);e=a.generate(e,c.gen);return a.get(e,g).map(function(a){return b.point(a.element(),g-a.start())})}}});k("tj",["y4","y5","y6"],function(b,d,c){return{extract:function(a,c,d,g){return b.extract(a,
c,d,g)},extractTo:function(a,c,d,g,h){return b.extractTo(a,c,d,g,h)},all:function(a,c,d){return b.items(a,c,d)},from:function(a,c,d){return b.typed(a,c,d)},find:function(a,b,d,g){return c.find(a,b,d,g)},toText:function(a,b,c){return d.from(a,b,c)}}});k("116",["b","tj","119","11z","13y"],function(b,d,c,a,e){return{group:function(f,g,h){g=b.bind(g,function(a){return d.from(f,a,h)});g=a.splitbyAdv(g,function(a){return c.cata(a,function(){return e.excludeWithout(a)},function(){return e.excludeWith(a)},
function(){return e.include(a)})});return b.filter(g,function(a){return 0<a.length})}}});k("13z",["b","s"],function(b,d){return{common:function(c,a,e){a=[a].concat(c.up().all(a));var f=[e].concat(c.up().all(e));e=b.find(a,function(a){return b.exists(f,function(b){return c.eq(b,a)})});return d.from(e)}}});k("140",["b"],function(b){var d="table tbody thead tfoot tr ul ol".split(" ");return function(c){var a=c.property(),e=function(c,d){return a.parent(c).map(a.name).map(function(a){return!b.contains(d,
a)}).getOr(!1)};return{validateText:function(b){return a.isText(b)&&e(b,d)}}}});k("117",["b","7","tj","13z","140"],function(b,d,c,a,e){return{range:function(f,g,h,l,m){return f.eq(g,l)?[g]:a.common(f,g,l).fold(function(){return[]},function(a){a=[a].concat(c.all(f,a,d.constant(!1)));var p=b.findIndex(a,d.curry(f.eq,g)),q=b.findIndex(a,d.curry(f.eq,l));a=-1<p&&-1<q?p<q?a.slice(p+h,q+m):a.slice(q+m,p+h):[];p=e(f);return b.filter(a,p.validateText)})}}});k("y8",["116","117"],function(b,d){return{range:function(b,
a,e,f,g){return d.range(b,a,e,f,g)},group:function(c,a,d){return b.group(c,a,d)}}});k("y9",["33"],function(b){return b.immutable("before","after")});k("tn",["b","s","y9","jd"],function(b,d,c,a){var e=function(b,c,d){b=b.property().getText(c);return a.splits(b,d)},f=function(a,c,d,m){if(!a.property().isText(c)||d===m)return c;if(d>m)return f(a,c,m,d);var n=a.property().getText(c).length;if(0===d&&m===n)return c;m=e(a,c,[d,m]);a.property().setText(c,m[0]);m=b.map(m.slice(1),function(b){return a.create().text(b)});
n=m[0];a.insert().afterAll(c,m);return 0===d?c:n};return{split:function(a,b,f){if(!a.property().isText(b)||0>=f)return c(d.none(),d.some(b));if(f>=a.property().getText(b).length)return c(d.some(b),d.none());f=e(a,b,[f]);a.property().setText(b,f[0]);f=a.create().text(f[1]);a.insert().after(b,f);return c(d.some(b),d.some(f))},splitByPair:f}});k("tm",["du","y8","tn"],function(b,d,c){var a=function(a,e,h,l,m){h=c.split(a,e,h).after().fold(function(){return b.delta(e,1)},function(a){return b.delta(a,0)});
m=c.split(a,l,m).before().fold(function(){return b.delta(l,0)},function(a){return b.delta(a,1)});return d.range(a,h.element(),h.deltaOffset(),m.element(),m.deltaOffset())},e=function(a,b,d,e,m){return[c.splitByPair(a,b,d,m)]};return{nodes:function(b,c,d,l,m){return(b.eq(c,l)?e:a)(b,c,d,l,m)}}});k("o8",["tk","tl","tm","tn"],function(b,d,c,a){return{split:function(b,c,d){return a.split(b,c,d)},splitByPair:function(b,c,d,h){return a.splitByPair(b,c,d,h)},range:function(a,b,d,h,l){return c.nodes(a,b,
d,h,l)},subdivide:function(a,c,d){return b.subdivide(a,c,d)},position:function(a,b){return d.determine(b)}}});k("y0",["7","115","o8"],function(b,d,c){var a=function(a,b,e){var l=c.split(a,b,e);return c.position(a,l).fold(function(){return d.invalid(b,e)},d.before,d.after,d.after)},e=function(a,b,c){a=a.property().children(b);return c===a.length?d.last(b):c<a.length?d.rest(a[c]):d.invalid(b,c)};return{atStartOf:function(c,d,h,l){var m=function(a){c.insert().before(a,l)};(c.property().isText(d)?a:e)(c,
d,h).fold(m,function(a){c.insert().after(a,l)},m,function(a){c.insert().append(a,l)},b.noop)}}});k("td",["y0"],function(b){return{atStartOf:function(d,c,a,e){b.atStartOf(d,c,a,e)}}});k("t8",["6","7","4g"],function(b,d,c){c=c.generate([{none:[]},{root:["target","block"]},{created:["target","block"]},{actual:["target","block"]}]);return b.merge(c,{toString:function(a){return a.fold(function(){return["block.none"]},function(a,b){return["block.root",a,b]},function(a,b){return["block.created",a,b]},function(a,
b){return["block.actual",a,b]})},cata:function(a,b,c,d,h){return a.fold(b,c,d,h)},extract:function(a){var b=d.constant([]),c=function(a,b){return[b]};return a.fold(b,b,c,c)},extractEvenRoot:function(a){var b=d.constant([]),c=function(a,b){return[b]};return a.fold(b,c,c,c)}})});k("t4",["s","du"],function(b,d){var c=function(a,b){if(a.property().isText(b))return d.point(b,a.property().getText(b).length);var e=a.property().children(b);return 0<e.length?c(a,e[e.length-1]):d.point(b,e.length)},a=function(b,
e,f){var g=b.property().children(e);return 0<g.length&&f<g.length?a(b,g[f],0):0<g.length&&b.property().isElement(e)&&g.length===f?c(b,g[g.length-1]):d.point(e,f)},e=function(a,c,d){return!a.property().isText(c)||0<a.property().getText(c).trim().length?b.none():d(c).bind(function(c){return e(a,c,d).orThunk(function(){return b.some(c)})})},f=function(a,b){var c=e(a,b,a.query().nextSibling).getOr(b);if(a.property().isText(c))return d.point(c,0);var g=a.property().children(c);return 0<g.length?f(a,g[0]):
d.point(c,0)},g=function(a,b){return a.property().isText(b)?a.property().getText(b).length:a.property().children(b).length},h=function(a,b){var c=e(a,b,a.query().prevSibling).getOr(b);if(a.property().isText(c))return d.point(c,g(a,c));var f=a.property().children(c);return 0<f.length?h(a,f[f.length-1]):d.point(c,g(a,c))};return{toLast:c,toLeaf:a,toLower:function(a,b){var c=a.property().isText(b)?a.property().getText(b).length:a.property().children(b).length;return d.point(b,c)},freefallLtr:f,freefallRtl:h}});
k("kx",["t4"],function(b){return{toLeaf:function(d,c,a){return b.toLeaf(d,c,a)},freefallLtr:function(d,c){return b.freefallLtr(d,c)},freefallRtl:function(d,c){return b.freefallRtl(d,c)}}});k("t3","b 7 s kx hj la".split(" "),function(b,d,c,a,e,f){var g=function(a,b){return function(c){return a.eq(c,b)||a.property().parent(c).map(function(c){return a.eq(c,b)}).getOr(!1)}},h=function(a,b,d){return a.eq(b,d)?c.none():a.property().isBoundary(d)?a.query().nextSibling(d):a.property().isEmptyTag(d)?(b=g(a,
b),b(d)?a.query().nextSibling(d):f.breakPath(a,d,b,f.breakToRight).second()):c.none()},l=function(a,b,d){if(a.eq(b,d))return c.none();if(a.property().isBoundary(d))return a.query().prevSibling(d);if(a.property().isEmptyTag(d)){var e=g(a,b);return e(d)?a.query().prevSibling(d):a.query().prevSibling(d).map(function(b){return f.breakPath(a,b,e,f.breakToRight).first()})}return c.none()},m=function(a,d,e,f){return e(a,d,f).bind(function(e){var f=a.property().children(d),f=b.findIndex(f,function(b){return a.eq(b,
e)});return-1<f?c.some(f):c.none()})},n=function(a,b){return a.property().isEmptyTag(b)||a.property().isBoundary(b)};return{create:function(b,c,f){if(n(b,f)||n(b,a.toLeaf(b,f,0).element()))return[f];var g=d.curry(n,b),t=d.curry(b.eq,c),u=e.seekLeft(b,f,g,t).bind(function(a){return m(b,c,h,a)}).getOr(0),v=b.property().children(c);f=e.seekRight(b,f,g,t).bind(function(a){return m(b,c,l,a)}).getOr(v.length-1);return b.property().children(c).slice(u,f+1)}}});k("xz","b s td t8 t3 1r".split(" "),function(b,
d,c,a,e,f){var g=function(a,b,c,e){return c(b)||e(b)?d.some(b):a.up().predicate(b,c,e)},h=function(b,c,d){d=d();b.insert().wrap(c,d);return a.created(c,d)},l=function(c,d,e,f){var g=f();c.insert().before(e[0],g);b.each(e,function(a){c.insert().append(g,a)});return a.created(d,g)},m=function(b,d,g,m,s,t,u){if(t(g)){var v=b.property().children(d);if(m<v.length&&u(v[m]))return a.actual(g,v[m])}return s(d).fold(function(){return a.root(g,d)},function(s){if(t(g)){var u=s(),v=b.property().children(d),k=
v[m];void 0!==k&&(s=e.create(b,d,k,s),b.insert().appendAll(u,0<s.length?s:[k]));c.atStartOf(b,d,f.min(v.count,m),u);return a.created(d,u)}b.property().isEmptyTag(g)?s=h(b,g,s):(u=e.create(b,d,g),s=0<u.length?l(b,g,u,s):h(b,g,s));return s})};return{single:function(b,c,d,e,f,h){return g(b,d,c,h).fold(a.none,function(g){return h(g)?m(b,g,d,e,f,h,c):a.actual(d,g)})}}});k("lf",["48"],function(b){return{resolve:b.create("ephox-soldier").resolve}});k("l1","b 7 s lf 1x 20 2o 46 29".split(" "),function(b,
d,c,a,e,f,g,h,l){var m=a.resolve("quasi-block"),n=function(a){a=l.children(a);return 1===a.length&&"br"===f.name(a[0])},p=function(a){return e.has(a,m)&&!n(a)};return{condense:function(a){a=b.filter(a,function(a,b){if(!f.isElement(a))return!0;var c;e.has(a,m)&&n(a)&&(l.prevSibling(a).exists(p)||l.nextSibling(a).exists(p))?(g.remove(a),c=!1):c=!0;return c});return b.map(a,function(a){var c=f.isElement(a)?[a].concat(h.descendants(a,"."+m)):[];b.each(c,function(a){e.remove(a,m)});return a})},register:function(a){return function(b){return a(b).map(function(a){return function(){var b=
a();e.add(b,m);return b}})}},style:d.constant(m)}});k("t1",["dg","b","xz","l1","20"],function(b,d,c,a,e){var f=b();return{single:function(b,d,e,m,n){return c.single(f,b,d,e,a.register(m),n)},isBlock:function(a){return d.contains("ol p div ul table caption td th h1 h2 h3 h4 h5 h6 body blockquote pre".split(" "),e.name(a))}}});k("ls",["7"],function(b){return{tag:function(){return"p"},nu:function(d){return b.curry(d.create().nu,"p")}}});k("t2",["s","4g"],function(b,d){var c=function(a){return 0<a.length?
b.some(a[0]):b.none()},a=d.generate([{descend:["index"]},{leftOf:["rindex"]},{bounded:["lindex","rindex"]},{rightOf:["lindex"]},{all:[]}]);return{derive:function(b,d){return b.bind(c).fold(function(){return d.bind(c).fold(function(){return a.all()},function(b){return a.leftOf(b)})},function(b){return d.bind(c).fold(function(){return a.rightOf(b)},function(c){return b===c?a.descend(b):a.bounded(b,c)})})},cata:function(a,b,c,d,l,m){return a.fold(b,c,d,l,m)}}});k("l0","s hj ky t0 lt t2 t3".split(" "),
function(b,d,c,a,e,f,g){var h=function(a,c,d){return b.from(a.property().children(c)[d])},l=function(a,b,c){var d=a.property().children(c),f=h(a,c,0).bind(function(e){return h(a,c,d.length-1).map(function(d){return m(a,b,c,e,d)})}).getOr([]);return e.container(c,f)},m=function(a,c,f,g,h){var l=n(a,f,c,g);return e.toLastTarget(l).filter(function(b){return!a.eq(h,b)}).bind(function(e){return d.walk(a,e,d.sidestep,d.walkers().right()).bind(function(d){if(a.eq(f,d.item()))return b.none();d=m(a,c,f,d.item(),
h);return b.some([l].concat(d))})}).getOrThunk(function(){return[l]})},n=function(a,b,d,f){if(c.isFormatting(a,f))return e.block(f);if(c.isEmptyTag(a,f))return e.fixture(f);if(c.isBlock(a,f)||c.isContainer(a,f))return l(a,d,f);a=g.create(a,b,f);return e.quasi(0<a.length?a:[f])},p=function(a,b,c){return n(a,c,b,c)},q=function(c,d,f,g,h,l,n,p){f=f.map(function(e){return r(c,d,e,n.bind(a.tail),b.none())}).getOr([]);h=h.map(function(e){return r(c,d,e,b.none(),p.bind(a.tail))}).getOr([]);g=0===g.length?
[]:m(c,d,l,g[0],g[g.length-1]);return[e.container(l,f.concat(g).concat(h))]},r=function(c,d,e,g,h){var l=c.property().children(e);g.bind(a.head).getOr(0);h.bind(a.head).getOr(l.length-1);var m=f.derive(g,h);return f.cata(m,function(b){return r(c,d,l[b],g.bind(a.tail),h.bind(a.tail))},function(a){return q(c,d,b.none(),l.slice(0,a),b.from(l[a]),e,g,h)},function(a,f){return q(c,d,b.from(l[a]),l.slice(a+1,f),b.from(l[f]),e,g,h)},function(a){return q(c,d,b.from(l[a]),l.slice(a+1),b.none(),e,g,h)},function(){return[p(c,
d,e)]})};return{categorise:p,within:function(c,d,e,f,g){return!0===a.isBefore(f,g)?r(c,d,e,b.some(f),b.some(g)):r(c,d,e,b.some(g),b.some(f))}}});k("lu","dg b 7 s ls lt l0 l1 1x 1b l 2m 35 20 2o 9y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){var u=function(a,b){if("li"!==r.name(a))return!1;var c=d.foldl(b,function(a,b){return 1<a.quasi||0<a.nonlist?a:f.cata(b,function(){return{quasi:1+a.quasi,nonlist:a.nonlist}},function(){return{quasi:a.quasi,nonlist:1+a.nonlist}},function(b){return{quasi:a.quasi,
nonlist:(d.contains(["ul","ol"],r.name(b))?0:1)+a.nonlist}},function(){return{quasi:1+a.quasi,nonlist:a.nonlist}})},{quasi:0,nonlist:0});return 1>=c.quasi&&0===c.nonlist},v=function(a,b,c){return 0>=c.length?!0:d.contains(a,r.name(b))?2<c.length?!1:1===c.length?f.isQuasiOrFixture(c[0]):f.isQuasiOrFixture(c[0])&&f.isQuasiOrFixture(c[1])&&!d.forall(c,f.isFixture):!1};return{wrap:function(a){if(0===a.length||1===a.length&&r.isText(a[0])&&0===t.get(a[0]).trim().length)return[];var b=n.fromTag(e.tag());
l.add(b,h.style());p.before(a[0],b);q.append(b,a);return[b]},handleContainer:function(a,b,c,e){if(v(a,b,c))return[b];var f=u(b,c)?[b]:[];return f.concat(d.bind(c,function(a){return e(a,0<f.length)}))},hasSimpleContent:v,isNestedList:u,handleRoot:function(d,h){var l=g.categorise(b(),c.curry(m.eq,h),h,h,h),n=function(){return a.some(e.nu(b()))},p=a.none;return f.cata(l,n,p,function(a,b){return v(d,a,b)||u(a,b)?p():n()},n)}}});k("kv","b 7 e4 l5 lt t1 lu 20".split(" "),function(b,d,c,a,e,f,g,h){var l=
["li","td","th","caption"],m=function(a,b){return e.cata(a,function(a){return!0===b?[]:g.wrap(a)},function(a){return[a]},function(a,b){return g.handleContainer(l,a,b,m)},function(a){return!0===b?[]:g.wrap([a])})};return{isRootContainer:a.isRootOrContainer,extract:function(a){return m(a,!1)},isCapable:function(a){return f.isBlock(a)||b.contains(l,h.name(a))},canUse:function(a){return c.isFormatting(a)||b.contains(l,h.name(a))},quasi:d.curry(g.handleRoot,l),ascend:d.identity}});k("i7",["dg","kx"],function(b,
d){var c=b();return{toLeaf:function(a,b){return d.toLeaf(c,a,b)},freefallLtr:function(a){return d.freefallLtr(c,a)},freefallRtl:function(a){return d.freefallRtl(c,a)}}});k("d2",["co","s","33"],function(b,d,c){var a=c.immutableBag(["start","soffset","finish","foffset","all"],[]),e=c.immutableBag(["start","soffset","finish","foffset"],[]);return{block:a,inline:e,blockFrom:function(c){return 0<c.length?d.some(a({start:c[0],soffset:0,finish:c[c.length-1],foffset:b.getEnd(c[c.length-1]),all:c})):d.none()},
inlineFrom:function(a){return a.map(function(a){return e({start:a.start(),soffset:a.soffset(),finish:a.finish(),foffset:a.foffset()})})}}});k("m8",["7","s","1b","29"],function(b,d,c,a){var e=function(b,c){return c(b)?d.some([]):a.parent(b).bind(function(d){return a.findIndex(b).bind(function(a){return e(d,c).map(function(b){return b.concat([a])})})})},f=function(b,c){return 0===c.length?d.some(b):a.child(b,c[0]).bind(function(a){return f(a,c.slice(1))})};return{path:function(a,f){var l=b.curry(c.eq,
a);return c.eq(a,f)?d.some([]):e(f,l)},follow:f}});k("kz","co s du i7 f1 33 t8 t1 1b l m8 2m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=f.immutable("ancestor","startPath","finishPath"),r=function(a,b,c){return e.ancestors(b,c,a).shared().bind(function(a){return n.path(a,b).bind(function(b){return n.path(a,c).map(function(c){return q(a,b,c)})})})},s=function(a,b,c,e){var f=b.isRootContainer(a);c=h.single(b.isCapable,c,e,b.quasi,f);c=g.extractEvenRoot(c);return 1===c.length?d.some(c[0]).map(function(c){return b.ascend(c,
a)}):d.none()},t=function(d,e,f,g){return d.isRootContainer(e)(f)?(g<b.getEnd(f)||d.isCapable(f)&&d.canUse(f)?f=a.toLeaf(f,g):(d=m.fromTag("br"),p.append(f,d),f=c.point(d,0)),f):c.point(f,g)};return{branch:function(a,b,c,e,f,g){var h=t(b,a,c,e),m=t(b,a,f,g);return s(a,b,h.element(),h.offset()).bind(function(c){return(l.eq(h.element(),m.element())&&h.offset()===m.offset()?d.some(c):s(a,b,m.element(),m.offset())).bind(function(b){return l.eq(c,b)?d.some(q(c,[],[])):r(a,c,b)})})}}});k("dj","dg b co s du i7 e4 d2 kz l0 l1 2k kq l 2m 20 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){var v=function(b,g,h,l,m,n,q){b=g.isRootContainer(b)(h);g=!b&&p.inBody(h)?e.point(h,l):b||!g.isCapable(h)||p.inBody(h)?p.inBody(m.element())&&d.contains(["td","th"],t.name(h))?m:!p.inBody(h)&&p.inBody(n.element())&&"br"==t.name(n.element())?n:f.toLeaf(q,0):e.point(q,l);c.getEnd(g.element());return g.offset()<=c.getEnd(g.element())?a.some(g):a.none()};return{applyOn:function(c,p,t,k,z,A,C){var D=q.after(t,k,z,A),E=p.isRootContainer(c)(t)?f.toLeaf(t,k):e.point(t,
k),F=p.isRootContainer(c)(z)?f.toLeaf(z,A):e.point(z,A),G=f.toLeaf(t,k),I=f.toLeaf(z,A),H=l.branch(c,p,t,k,z,A).map(function(a){return m.within(b(),c,a.ancestor(),a.startPath(),a.finishPath())}).getOr([]),H=d.bind(H,p.extract);d.each(H,function(a){0===u.children(a).length&&g.isFormatting(a)&&s.append(a,r.fromTag("br"))});var H=n.condense(H),L=C(H);return 0===L.length?a.none():v(c,p,t,k,E,G,L[D?L.length-1:0]).bind(function(a){return v(c,p,z,A,F,I,L[D?0:L.length-1]).map(function(b){return h.block({start:a.element(),
soffset:a.offset(),finish:b.element(),foffset:b.offset(),all:L})})})}}});k("l2",["2l","b3","20"],function(b,d,c){var a=function(a){return function(b){return a}},e={start:d.onDirection("left","right"),end:d.onDirection("right","left"),justify:a("justify"),center:a("center"),"match-parent":a("match-parent")};return{hasAlignment:function(a,d,h){c.isText(a)?a=!1:(d=b.get(a,d),a=(void 0!==e[d]?e[d](a):d)===h);return a}}});k("l3",["2l"],function(b){return function(d,c){return{is:function(a){return b.get(a,
d)===c},remove:function(a){b.remove(a,d)},set:function(a){b.set(a,d,c)}}}});k("cr","b 7 ku kv dj l2 l3".split(" "),function(b,d,c,a,e,f,g){var h=function(a,b,c){return f.hasAlignment(c,a,b)},l=function(f,l,m){var n=g(l,m);return{run:function(c,d,f,g,h){return e.applyOn(c,a,d,f,g,h,function(a){var c=b.forall(a,n.is)?n.remove:n.set;b.each(a,c);return a})},query:function(a,b){var e=d.curry(h,l,m);return c.bothMatch(a,b,e)},name:d.constant(f)}},m=l("JustifyLeft","text-align","left"),n=l("JustifyCenter",
"text-align","center"),p=l("JustifyRight","text-align","right"),l=l("JustifyFull","text-align","justify");return{justifyleft:d.constant(m),justifycentre:d.constant(n),justifyright:d.constant(p),justifyfull:d.constant(l)}});k("cx",["s","2l"],function(b,d){var c=function(a){var b=a.dom().style.marginRight;a=a.dom().style.marginLeft;return"auto"===b&&"auto"===a};return{isCentered:c,divine:function(a){if(c(a))return b.some("center");var e=d.getRaw(a,"float").getOrThunk(function(){return d.get(a,"float")});
return void 0!==e&&null!==e&&0<e.length?b.some(e):b.none()},getRaw:function(a){a=a.dom().style.getPropertyValue("float");return""===a?null:a},setCentered:function(a){d.setAll(a,{"margin-left":"auto","margin-right":"auto"})}}});k("cs",["7","s","2l","cx","20"],function(b,d,c,a,e){var f={left:{"float":"left",margin:""},right:{"float":"right",margin:""},none:{"float":"none",margin:""},center:{"float":"",margin:"0 auto"}},g={none:{display:""},left:{display:""},right:{display:""},center:{display:"block"}},
h=function(b,c){return a.divine(b).is(c)},l=function(a,b){var h="img"===e.name(a)&&void 0!==g[b]?g[b]:{};d.from(f[b]).each(function(b){c.setAll(a,b);c.setAll(a,h)})},m=function(a,c){return{run:function(a){l(a,c);return d.none()},query:function(a){return h(a,c)},name:b.constant(a)}},n=m("JustifyLeft","left"),p=m("JustifyCenter","center"),q=m("JustifyRight","right"),m=m("FloatNone","none");return{floatnone:b.constant(m),floatleft:b.constant(n),floatcentre:b.constant(p),floatright:b.constant(q),queryIsFloat:h,
runFloat:l}});k("t9",["33"],function(b){return b.immutable("level","content","cruft","list","item")});k("l4",["t9"],function(b){return{level:function(d,c){return b(d.level()+c,d.content(),d.cruft(),d.list(),d.item())},list:function(d,c){return b(d.level(),d.content(),d.cruft(),c,d.item())}}});k("l6","dg b 7 s e4 ls l5 lt t1 lu 20".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a){return h.cata(a,function(a){return m.wrap(a)},function(a){return[a]},function(a,b){return d.bind(b,p)},function(a){return m.wrap([a])})};
return{isRootContainer:g.isRootOrContainer,extract:p,isCapable:function(a){return l.isBlock(a)||"li"===n.name(a)},canUse:function(a){return e.isFormatting(a)},quasi:function(c){return a.some(f.nu(b()))},ascend:c.identity}});k("tb",["b","ky","33"],function(b,d,c){var a=c.immutable("elements","elementsTransformed"),e=c.immutable("original","replaced"),f=c.immutable("result","items");return{answer:a,write:function(c,h){var l=[],m=function(a){var b=c.create().nu("p");c.insert().appendAll(b,a);return b},
n=function(a){if(0===a.length)throw"Cannot get tail of an empty array";return a.slice(1)},p=function(a,d){for(var e=c.create().clone(d[0].list()),h=[];0<d.length&&d[0].level()>=a;){var l;if(d[0].level()===a){var m=a;l=d;var q=l[0],k;k=q;var B=k.item(),z=B,z=c.property().children(z);b.each(z,c.remove().remove);c.insert().appendAll(B,k.content());k=B;q=q.cruft();l=n(l);0<l.length&&l[0].level()>m&&(m=p(m+1,l),l=m.items(),c.insert().append(k,m.result()));c.insert().appendAll(k,q);l=f(k,l);l=f([l.result()],
l.items())}else l=p(a+1,d),m=c.create().nu("li"),c.styles().set(m,"list-style-type","none"),c.attrs().remove(e,"id"),c.insert().append(m,l.result()),l=f([m],l.items());d=l.items();h=h.concat(l.result())}c.insert().appendAll(e,h);return f(e,d)},q=function(a){for(var b=[];0<a.length;){var h=a[0];if(0===h.level()){var q;q=a[0];var v=q.content(),v=1===v.length&&d.isBlock(c,v[0])?v[0]:m(v);l.push(e(q.item(),v));q=f([v],n(a));a=q.items();b=b.concat(q.result());for(q=[];0<a.length&&0<a[0].level();)v=p(1,
a),a=v.items(),q=q.concat([v.result()]);q=f(q,a);a=q.items();b=b.concat(q.result());0<h.cruft().length&&(b=b.concat([m(h.cruft())]))}else h=p(1,a),a=h.items(),b=b.concat([h.result()])}return f(b,a)}(h);if(0!==q.items().length)throw"Error - there should not be any remaining items to parse";return a(q.result(),l)}}});k("ta",["b","tb"],function(b,d){var c=function(a){return b.foldl(a,function(a,b){var c=a.elements().concat(b.elements()),h=a.elementsTransformed().concat(b.elementsTransformed());return d.answer(c,
h)},d.answer([],[]))};return{combine:c,write:function(a,e){var f=b.groupBy(e,function(b){return a.property().name(b.list())+"-"+a.styles().getRaw(b.list(),"list-style-type").getOr("default")}),f=b.map(f,function(b){return d.write(a,b)});return c(f)}}});k("lv",["dg","ta","tb"],function(b,d,c){var a=b();return{groupWrite:function(b){return d.write(a,b)},write:function(b){return c.write(a,b)}}});k("lw","b 7 s e4 1b 20 68 46 2y 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a,b,c){return l.closest(a,
"li",c).bind(function(a){return b(a,c).map(function(b){return{item:d.constant(a),outerlist:d.constant(b)}})})},p=function(a,c){return b.findIndex(a,function(a){return e.eq(a,c)})};return{context:function(a,b,f,g,l){return n(a,f,l).bind(function(v){return n(b,f,l).bind(function(f){if(e.eq(v.outerlist(),f.outerlist())){var l;if(e.eq(a,b))l=[v.item()];else{l=v.outerlist();var n=v.item(),s=f.item();l=h.descendants(l,"li");var n=p(l,n),u=p(l,s),s=m.min(n,u),n=m.max(n,u);l=(-1<s&&-1<n?c.some(l.slice(s,
n+1)):c.none()).getOr([])}f=c.some({outerlist:v.outerlist,startItem:v.item,finishItem:f.item,writer:d.constant(g),selected:d.constant(l)})}else f=c.none();return f})})},immediate:function(a,b){return l.closest(a,"ul,ol",b)},topmost:function(d,e){var h=g.ancestors(d,function(b){return a.isList(b)||a.isContainer(b)},e),l=b.findIndex(h,function(a){return!b.contains(["li","ol","ul"],f.name(a))});return 0<l&&l-1<h.length?c.some(h[l-1]):0<h.length?c.some(h[h.length-1]):c.none()}}});k("l7",["l4","lv","lw"],
function(b,d,c){return{context:function(a,b,f){return c.context(a,b,c.topmost,d.write,f)},indent:function(a){return b.level(a,1)},outdent:function(a){return b.level(a,-1)}}});k("l8",["b","1b"],function(b,d){var c=function(a,c){var f=b.find(a,function(a){return d.eq(c,a)});return null!==f&&void 0!==f};return{operate:function(a,d,f){return b.map(d,function(b){return c(f,b.item())?a(b):b})}}});k("tc",["b","s","33"],function(b,d,c){var a=c.immutable("before","on","after");return{refine:function(c,f){var g=
b.findIndex(c,f),h=a(c,d.none(),[]);if(-1===g)g=h;else var h=d.from(c[g]),l=c.slice(0,g),g=c.slice(g+1),g=a(l,h,g);return g}}});k("l9","b t9 tc 2l 20 46 m 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,c){var d=f.children(a,"li,ol,ul");return b.bind(d,function(b){return"li"===e.name(b)?m(a,b,c):l(b,c+1)})},m=function(b,c,e){var f=p(c),g="none"===a.get(c,"list-style-type")?[]:[d(e,f.before(),f.after(),b,c)];return f.on().fold(function(){return g},function(a){a=l(a,e+1);return g.concat(a)})},
n=function(a){return g.is(a,"ol,ul")},p=function(a){a=h.children(a);return c.refine(a,n)};return{read:function(a){return l(a,1)}}});k("dl","b l8 l9 7 s d2 1a 1b 2l 35 2o 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=function(a){a=a.elementsTransformed();b.each(a,function(a){l.transfer(a.original(),a.replaced(),["text-align"]);g.transfer(a.original(),a.replaced(),["dir"])})},r=function(a,c){var d=b.find(c,function(b){return h.eq(b.original(),a)});return void 0!==d&&null!==d?d.replaced():a},
s=function(a,b,g,h,l,p){if(0===a.selected().length)return e.none();var s=a.writer(),k=a.outerlist();a=a.selected();var A=c.read(k);p=p(a);p=d.operate(p,A,a);s=s(p);q(s);m.before(k,s.elements());n.remove(k);k=s.elementsTransformed();b=r(b,k);h=r(h,k);return e.some(f.block({start:b,soffset:g,finish:h,foffset:l,all:s.elements()}))};return{execute:function(b,c,d,e,f,g){return s(b,c,d,e,f,a.constant(g))},executeUsing:s}});k("ct","dg b l4 l5 dj l6 l7 dl".split(" "),function(b,d,c,a,e,f,g,h){b();var l=function(a,
b,c,g,h,l,m){return e.applyOn(a,f,b,c,g,h,function(a){d.each(a,function(a){m.change(a,l)});return a})},m=function(b,c){return function(d,e,f,m,u,v){var w=a.isRootOrCell(d);return g.context(e,m,d).fold(function(){return l(w,e,f,m,u,b,v)},function(a){return h.execute(a,e,f,m,u,c)})}};return{indent:function(a,b,c,d,e,f){return m(1,g.indent)(a,b,c,d,e,f)},outdent:function(a,b,c,d,e,f){return m(-1,g.outdent)(a,b,c,d,e,f)}}});k("lb","dg b 7 s e4 ls lt 20".split(" "),function(b,d,c,a,e,f,g,h){return{isRootContainer:function(a){return function(b){return a(b)||
d.contains(["td","th","caption"],h.name(b))}},extract:function(a){return g.cata(a,function(a){return[a]},function(a){return[a]},function(a,b){return d.contains(["ol","ul"],h.name(a))?[a]:d.bind(b,g.toTarget)},function(a){return[a]})},isCapable:function(a){return e.isBlock(a)},canUse:c.constant(!1),quasi:function(c){return a.some(f.nu(b()))},ascend:c.identity}});k("cu","b s f1 d2 lb dj 1b l 2m 35 2o 46 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=function(a){return q.closest(a,"blockquote")},
s=function(a){return c.sharedOne(r,a)},t=function(a,c,d,g,q){return f.applyOn(a,e,c,d,g,q,function(a){var c=h.fromTag("blockquote");0<a.length&&(l.before(a[0],c),m.append(c,a),c=p.descendants(c,"blockquote"),b.map(c,n.unwrap));return a})};return{toggle:function(b,c,e,f,h){return(g.eq(c,f)?r(c):s([c,f])).fold(function(){return t(b,c,e,f,h)},function(b){n.unwrap(b);return d.some(a.block({start:c,soffset:e,finish:f,foffset:h,all:[]}))})},queryPoint:r,queryAll:s}});k("6x","7 ci cj ck cl cm cn 73 70 cq cr cs ct cu 3m".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){var t=function(c,d,e,f){var g=c.content(),l=c.undo();h.cata(c.selections().get(),b.noop,a.multiple(g,c.undo(),f),a.single(g,l,f,d,e))};s=function(a){return function(b){var c=0<a?q.indent:q.outdent,e=d(b.region()),h=b.content();t(b,g.spot,f.update,function(a,b,d,f){return c(h.isRoot,a,b,d,f,e)})}};var u=function(a){return function(c){var d=c.content(),l=function(b,c,e,f){return a.run(d.isRoot,b,c,e,f)};h.cata(c.selections().get(),b.noop,e.multiple(d,c.undo(),
l),e.single(d,c.undo(),l,g.spot,f.update))}},v=function(a){return function(b,d){l.detect(d.content()).each(function(e){c.runTransaction(d.content(),d.undo(),function(){(a.query(e.image())?p.floatnone():a).run(e.image());b.fireChanged(e.image())},d.content().toEditing)})}};return{indent:s(1),outdent:s(-1),blockquote:function(a){var b=a.content();t(a,g.spot,f.update,function(a,c,d,e){return r.toggle(b.isRoot,a,c,d,e)})},justifyLeft:u(n.justifyleft()),justifyCentre:u(n.justifycentre()),justifyRight:u(n.justifyright()),
justifyFull:u(n.justifyfull()),imageNone:v(p.floatnone()),imageLeft:v(p.floatleft()),imageCentre:v(p.floatcentre()),imageRight:v(p.floatright()),breakQuote:function(a,b,c){m.breakQuote(b,c).each(function(b){a.content().setRelativeSelection(b.start(),b.finish());a.content().uiChanged()})}}});k("6y",["a","b","7","s"],function(b,d,c,a){var e=function(b,c){var e=d.find(b,function(a){return a.value()===c});return a.from(e)};return{updateMenu:function(d,g,h,l,m){g.fold(d.clear,c.noop,function(c){(b.isString(c)?
e(l,c):a.some(c)).each(d.select);m.each(function(a){a=a(c);d.selectElement(a)})});h.fold(d.disable,c.noop,d.enable);g.fold(d.untick,c.noop,function(a){a=b.isString(a)?a:a.value();d.tick(a)})}}});k("cv",["7","1a","2l"],function(b,d,c){return{attr:function(a,c,f){var g=b.curry(d.set,a,c,f);a=b.curry(d.remove,a,c);0<f.length?g():a()},css:function(a,d,f){var g=b.curry(c.set,a,d,f);a=b.curry(c.remove,a,d);0<f.length?g():a()}}});k("iw",["48"],function(b){return{resolve:b.create("ephox-salmon").resolve}});
k("cw",["7","iw","1a","2o","2y"],function(b,d,c,a,e){var f=d.resolve("upload-image-container");d="data-"+d.resolve("image-blob");var g=function(a){c.remove(a,"class")};return{uploadContainer:b.constant(f),blobId:b.constant(d),cleanup:function(b){e.child(b,"img").each(g);a.unwrap(b)}}});k("8z","cv cw 33 cs 1a 2l cx 64 2p cy".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=c.immutableBag("url alt width height isLocal align".split(" "),["computedWidth","computedHeight"]),p=function(a,b){var c=e.get(a,
b);return void 0!==c?c:""};return{divine:function(a){var b=f.getRaw(a,"width").getOr(""),c=f.getRaw(a,"height").getOr(""),m=f.getRaw(a,"width").getOrThunk(function(){return l.get(a)+"px"}),u=f.getRaw(a,"height").getOrThunk(function(){return h.get(a)+"px"}),v=g.divine(a);return n({url:p(a,"src"),alt:p(a,"alt"),width:b,height:c,computedWidth:m,computedHeight:u,isLocal:e.has(a,d.blobId()),align:v})},properties:n,apply:function(c,d){e.get(c,"src")===d.url()||d.isLocal()||e.set(c,"src",d.url());b.attr(c,
"alt",d.alt());b.css(c,"width",d.width());b.css(c,"height",d.height());d.align().each(function(b){a.runFloat(c,b)})}}});k("cz",["20","29"],function(b,d){return{hasNoContent:function(c){var a=d.children(c);return b.isElement(c)&&(0===a.length||1===a.length&&"br"===b.name(a[0]))}}});k("71",["7"],function(b){var d=function(){return e(function(a,b,c){return a()},"off")},c=function(){return e(function(a,b,c){return b()},"unchanged")},a=function(a){return e(function(b,c,d){return d(a)},"on")},e=function(e,
g){return{fold:e,map:function(b){return e(d,c,function(c){return a(b(c))})},label:b.constant(g)}};return{off:d,unchanged:c,on:a}});k("6z","b 7 s 8z cz 70 71 33 cr cu 1b 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=h.immutable("alignment","quoted"),r=function(a){return a.getSelection().fold(function(){return!1},function(a){var b=a.startContainer();a=a.endContainer();return n.eq(b,a)?m.queryPoint(b).isSome():m.queryAll([b,a]).isSome()})},s=[l.justifyleft(),l.justifycentre(),l.justifyright(),
l.justifyfull()],t=function(d){return f.detect(d).fold(function(){return d.getSelection().bind(function(a){var d=b.find(s,function(b){return b.query(a.startContainer(),a.endContainer())});return null!==d&&void 0!==d?c.some(d.name()):c.none()}).fold(g.off,g.on)},function(b){return a.divine(b.image()).align().fold(g.off,function(a){return"center"===a?g.on(l.justifycentre().name()):"right"===a?g.on(l.justifyright().name()):g.on(l.justifyleft().name())})})};return{read:function(a){var b=t(a);a=r(a)?g.on({}):
g.off();return q(b,a)},alignment:t,inQuote:r,atQuoteBreak:function(a){return a.getSelection().bind(function(a){var b=a.startContainer();return a.collapsed()?p.closest(b,"blockquote").bind(function(a){return e.hasNoContent(b)?c.some({quote:d.constant(a),element:d.constant(b)}):c.none()}):c.none()})}}});k("56","6w 7 s 6x 6y 6u 6z 70 6l 6v 71 4x 3z 33 q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(s,u){var v=s.content(),w=s.shortcuts(),k=s.context(),y=q.create({analytics:p(["message",
"properties"])}),B=d.curry(a.indent,s),z=d.curry(a.outdent,s),A=d.curry(a.blockquote,s);w.events.indent.bind(B);w.events.outdent.bind(z);w.events.blockquote.bind(A);k.events.preLinebreak.bind(function(b){g.atQuoteBreak(s.content()).each(function(c){a.breakQuote(s,c.quote(),c.element());b.handler().handle()})});var C=r.immutable("value","icon","textkey"),w=C("justifyleft",c.some(b.resolve("justifyleft")),f.key("alignment.left")),k=C("justifycenter",c.some(b.resolve("justifycenter")),f.key("alignment.center")),
D=C("justifyright",c.some(b.resolve("justifyright")),f.key("alignment.right")),E=C("justifyfull",c.some(b.resolve("justifyfull")),f.key("alignment.justify")),F=C("justifyleft",c.some(b.resolve("justifyleft")),f.key("alignment.left")),G=C("justifycenter",c.some(b.resolve("justifycenter")),f.key("alignment.center")),C=C("justifyright",c.some(b.resolve("justifyright")),f.key("alignment.right")),I=[w,k,D,E],H=[F,G,C],L=function(){return h.detect(v).fold(function(){return I},function(a){return H})},J=
{justifyleft:d.curry(a.imageLeft,u),justifycenter:d.curry(a.imageCentre,u),justifyright:d.curry(a.imageRight,u)},K={justifyleft:a.justifyLeft,justifycenter:a.justifyCentre,justifyright:a.justifyRight,justifyfull:a.justifyFull},M=function(a){return a.toLowerCase()},Q=c.none();return{ui:l.ui({"indent.general":{value:"indent",textkey:f.key("action.indent"),action:B,updateGeneral:d.identity,tooltip:m.get,toggle:!1},"outdent.general":{value:"outdent",textkey:f.key("action.outdent"),action:z,updateGeneral:d.identity,
tooltip:m.get,toggle:!1},"blockquote.general":{value:"blockquote",textkey:f.key("action.blockquote"),action:A,updateGeneral:function(a){g.read(v).quoted().fold(a.deselect,d.noop,a.select)},tooltip:m.get,toggle:!0},"alignment.dropdown":{name:"alignment",textkey:f.key("alignment.menu"),action:function(a){var b=h.detect(v).fold(d.constant(K),d.constant(J));(void 0!==b[a]?b[a]:d.noop)(s)},updateDropdown:function(a){var b=L(),f=g.read(v).alignment().fold(function(){return 0<b.length?n.on(b[0].value()):
n.off()},n.unchanged,n.on);a.populate([{label:c.none,items:d.constant(b)}]);e.updateMenu(a,f.map(M),n.on(),b,Q)},values:I,render:Q,tooltip:m.get,toggle:!1,describe:function(a){return f.translate("alignment.describe",f.get(a.textkey()))}}}),events:y.registry,destroy:d.noop}}});k("72",["b","cj"],function(b,d){return{multiple:function(c,a,e){return function(f,g){d.runTransaction(c,a,function(){b.each(g,e)},c.toEditing)}},single:function(b,a,e){return function(f,g){d.runTransaction(b,a,function(){e(g).each(function(a){b.setSelection(a.start(),
a.soffset(),a.finish(),a.foffset())});b.backupSelection()},b.toEditing)}}}});k("lh",["dg","td"],function(b,d){var c=b();return{atStartOf:function(a,b,f){d.atStartOf(c,a,b,f)}}});k("d3",["7","l1","lf"],function(b,d,c){c=c.resolve("style-marker");return{styleSpan:b.constant(c),overrideSpan:b.constant("data-ephox-override"),quasiBlock:d.style}});k("d5",["co","s","33","29"],function(b,d,c,a){var e=c.immutable("startContainer","startOffset","endContainer","endOffset"),f=c.immutable("start","soffset","finish",
"foffset");return{hare:e,fussy:f,fromHare:function(a){return f(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())},fromFussy:function(a){return e(a.start(),a.soffset(),a.finish(),a.foffset())},fussyFromElements:function(c){if(0===c.length)return d.none();var e=c[0];c=c[c.length-1];e=a.firstChild(e).getOr(e);c=a.lastChild(c).getOr(c);return d.some(f(e,0,c,b.getEnd(c)))}}});k("te",["ap","4g"],function(b,d){var c=d.generate([{none:[]},{tempIn:["selection"]},{tempOut:["selection"]},{rangedIn:["selection"]},
{rangedOut:["selection"]}]);return{detect:function(a,d){return a.getSelection().fold(function(){return c.none()},function(a){var g=d(a);return b.isCollapsed(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())?g?c.tempIn(a):c.tempOut(a):g?c.rangedIn(a):c.rangedOut(a)})}}});k("tf",["1a","2l","l"],function(b,d,c){var a=function(a,b){return c.fromTag(a,b.dom())},e=function(a,b,e){e=c.fromTag("span",e.dom());d.set(e,a,b);return e};return{nu:function(b,c,d,l){return"span"===d?e(b,c,l):a(d,
l)},nuTag:a,nuAttr:function(a,d,e){e=c.fromTag("span",e.dom());b.set(e,a,d);return e},nuStyle:e}});k("gk",["b","s","2l","20","29"],function(b,d,c,a,e){var f={"font-weight":{700:"bold",400:"normal"}},g=function(a,c){if(a===c&&""!==c&&void 0!==c)return!0;var d=a.toLowerCase(),e=c.toLowerCase().split(" ");return b.contains(e,d)},h=function(a,b){if(void 0!==f[a]){var c=f[a][b];return void 0!==c?c:b}return b},l=function(a,b){var c=m(a,b);return h(b,c)},m=function(b,f){return(a.isText(b)?e.parent(b):d.some(b)).map(function(a){return c.get(a,
f)}).getOr(void 0)};return{state:function(a,b,c){a=l(a,b);return"text-decoration"===b?g(c,a):c===a&&""!==a&&void 0!==a},rawState:function(a,b,d){a=h(b,c.getRaw(a,b).getOr(void 0));return"text-decoration"===b?g(d,a):d===a&&""!==a&&void 0!==a},value:l}});k("y1",["b","s","2l","20","49"],function(b,d,c,a,e){var f={"text-decoration":function(d,f,l,m){var n=function(f){return e.closest(f,function(e){return a.isElement(e)&&(b.contains(l,a.name(e))||c.getRaw(e,d).isSome())}).toArray()};m=n(m.startContainer()).concat(n(m.endContainer()));
return b.exists(m,function(e){return b.contains(l,a.name(e))?!0:c.getRaw(e,d).exists(function(a){return f===a})})}};return{handle:function(a,b,c){return void 0!==f[a]?d.some(f[a]):d.none()}}});k("tg","b 7 s gk y1 1a 20 6e 2y".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a,b){return b.getSelection().map(function(b){return a(b)}).getOr(!1)},n=function(b,c,d,f){return e.handle(b,c).fold(function(){var d=a.state(f.startContainer(),b,c),e=a.state(f.endContainer(),b,c);return d||e},function(a){return a(b,
c,d,f)})},p=function(a,b,c,e){return m(d.curry(n,a,b,c),e)},q=function(a,b){var c=h.closest(b.startContainer(),a),d=h.closest(b.endContainer(),a);return c||d},r=function(a,b){return m(d.curry(q,a),b)},s=function(a,c){return b.contains(a,g.name(c))},t=function(a,b){var d="["+a+"]";return l.closest(b.startContainer(),d).bind(function(e){return l.closest(b.endContainer(),d).bind(function(b){var d=f.get(e,a);b=f.get(b,a);d=d.toLowerCase();b=b.toLowerCase();return d===b?c.some(d):c.none()})})};return{queriesStyle:function(a,
b,c){return{queryOn:d.curry(n,a,b,c),query:d.curry(p,a,b,c)}},queryStyleOn:n,queriesTag:function(a){return{queryOn:d.curry(q,a),query:d.curry(r,a)}},relatedStyle:function(b,c,d,e){(d=s(d,e))||(d="span"===g.name(e)&&a.state(e,b,c));return d},relatedTags:s,queryAttrSame:function(a,b){return b.getSelection().bind(function(b){return t(a,b)})},queryAttrIs:function(a,b,c){var d=b.toLowerCase(),e=function(b){return f.get(b,a).toLowerCase()===d};return l.closest(c.startContainer(),"["+a+"]").filter(e).orThunk(function(){return l.closest(c.endContainer(),
"["+a+"]").filter(e)}).isSome()}}});k("141","b s du kx hj ky 4g 33".split(" "),function(b,d,c,a,e,f,g,h){var l=g.generate([{none:["last","mode"]},{running:["next","mode"]},{split:["boundary","last","mode"]},{finished:["element","mode"]}]),m=h.immutable("start","soffset","finish","foffset"),n=function(b,d,e){e=a.toLeaf(b,e,0);return r(b,e.element())?q(b,d,e.element()).map(function(a){return c.point(a,0)}).getOr(e):e},p=function(a,c){return f.isFrame(a,c)||f.isBlock(a,c)||b.contains(["li"],a.property().name(c))},
q=function(a,b,c){return e.seekRight(a,c,function(b){return!r(a,b)&&!p(a,b)},b)},r=function(a,c){return a.property().isText(c)?a.property().parent(c).exists(function(c){return b.contains("table tbody thead tfoot tr ul ol".split(" "),a.property().name(c))}):!1},s=function(a,b,c,d,f){return e.walk(a,d,c,e.walkers().right()).fold(function(){return l.none(d,e.sidestep)},function(b){return a.eq(b.item(),f)?l.finished(f,b.mode()):p(a,b.item())?l.split(b.item(),d,b.mode()):l.running(b.item(),b.mode())})},
t=function(a,b,c,e){return q(a,b,c).fold(function(){return d.none()},function(f){return a.eq(f,e)?d.some(e):u(a,c,f)?t(a,b,f,e):p(a,f)?(f=n(a,b,f),d.some(f.element())):d.some(f)})},u=function(a,b,c){return a.property().parent(b).exists(function(b){return a.eq(b,c)})},v=function(a,b,c,f,g,h){return s(a,b,c,g,h).fold(function(a,b){return[{start:f,finish:a}]},function(c,d){return v(a,b,d,f,c,h)},function(c,l,m){var p={start:f,finish:l};return(u(a,g,c)?t(a,b,c,h):function(){var f=n(a,b,c);return a.eq(f.element(),
c)?e.walk(a,c,e.advance,e.walkers().right()).map(function(a){return a.item()}):d.some(f.element())}()).fold(function(){return[p]},function(c){return a.eq(c,h)?[p].concat({start:h,finish:h}):[p].concat(v(a,b,e.advance,c,c,h))})},function(a,b){return[{start:f,finish:a}]})},k=function(a,b,c){if(p(a,b)){var d=a.property().children(b);return 0<=c&&c<d.length?k(a,d[c],0):c===d.length?k(a,d[d.length-1],0):b}return b},x=function(a,b,c,d){c=k(a,c,d);return r(a,c)?q(a,b,c).getOr(c):c},y=function(a,c,d,f,g,
h){var l=x(a,c,d,f),n=x(a,c,g,h);c=v(a,c,e.sidestep,l,l,n);return b.map(c,function(b,c){var e=a.eq(b.start,d)?f:0,l;a.eq(b.finish,g)?l=h:(l=b.finish,l=a.property().isText(l)?a.property().getText(l).length:a.property().children(l).length);return m(b.start,e,b.finish,l)})},B=function(b,c,d,e,f,g){b.eq(d,f)?p(b,d)?(e=a.toLeaf(b,d,e),g=a.toLeaf(b,d,g),b=b.eq(e.element(),d)&&b.eq(g.element(),d)?[m(e.element(),e.offset(),g.element(),g.offset())]:B(b,c,e.element(),e.offset(),g.element(),g.offset())):b=[m(d,
e,d,g)]:b=y(b,c,d,e,f,g);return b};return{collect:B}});k("142",["hj","o8","4g"],function(b,d,c){var a=c.generate([{leftEdge:["element"]},{between:["before","after"]},{rightEdge:["element"]}]),e=function(b,c,e){e=d.split(b,c,e);var f=function(){return a.rightEdge(c)};return d.position(b,e).fold(f,function(){return a.leftEdge(c)},a.between,f)},f=function(b,c,d,f){if(b.property().isText(c))return e(b,c,d);if(b.property().isEmptyTag(c))return f(c);b=b.property().children(c);c=0===d?a.leftEdge(c):d===
b.length?a.rightEdge(c):0<d&&d<b.length?a.between(b[d-1],b[d]):a.rightEdge(c);return c};return{toLeft:function(c,d,e,m){return f(c,e,m,a.leftEdge).fold(function(a){return a},function(a,b){return b},function(a){return b.after(c,a,d).getOr(a)})},toRight:function(c,d,e,m){return f(c,e,m,a.rightEdge).fold(function(a){return b.before(c,a,d).getOr(a)},function(a,b){return a},function(a){return a})}}});k("143","b 7 s la t5 t7".split(" "),function(b,d,c,a,e,f){var g=function(a,e,f,g){var h=a.property().children(e);
e=function(e){e=b.findIndex(h,d.curry(a.eq,e));return-1<e?c.some(e):c.none()};f=f.bind(e).getOr(0);g=g.bind(e).getOr(h.length-1);return-1<f&&-1<g?c.some(h.slice(f,g+1)):c.none()},h=function(b,c,e,f){return a.breakPath(b,c,function(a){return b.property().parent(a).fold(d.constant(!0),d.curry(b.eq,e))},f)},l=function(a,b,d,f){a.eq(b,f)?f=c.none():(f=h(a,f,b,e.breakToRight),f=c.some(f.first()));if(a.eq(b,d))d=c.none();else{var l=h(a,d,b,e.breakToLeft);0<l.splits().length&&a.insert().prepend(l.splits()[0].second(),
d);d=c.some(l.second().getOr(d))}return g(a,b,d,f)},m=function(b,d,e,g,h){return f.ancestors(b,e,g,d).shared().orThunk(function(){return a.sharedOne(b,function(a,e){return d(e)?c.some(e):b.up().predicate(e,d)},[e,g])}).map(h)},n=function(a,b,c,d,e){return m(a,b,c,d,e).bind(function(b){return l(a,b,c,d)})};return{fracture:function(a,b,e,f,g){g=void 0!==g?g:d.identity;a.eq(e,f)?(b=g(e),a=a.eq(b,e)?c.some([e]):l(a,b,e,e)):a=n(a,b,e,f,g);return a}}});k("118","b s o8 141 142 143".split(" "),function(b,
d,c,a,e,f){var g=function(a,b,d,g,p,q,r){a.property().isText(d)&&a.eq(d,p)?(d=c.splitByPair(a,d,g,q),a=f.fracture(a,b,d,d,r)):(p=e.toRight(a,b,p,q),d=e.toLeft(a,b,d,g),a=f.fracture(a,b,d,p,r));return a};return{fractures:function(c,d,e,f,p,q,r){e=a.collect(c,d,e,f,p,q);return b.bind(e,function(a,b){return g(c,d,a.start(),a.soffset(),a.finish(),a.foffset(),r).toArray()})},fracture:g}});k("y2",["dg","118"],function(b,d){var c=b();return{fractures:function(a,b,f,g,h,l){return d.fractures(c,a,b,f,g,h,
l)},fracture:function(a,b,f,g,h,l){return d.fracture(c,a,b,f,g,h,l)}}});k("tp",["du","kq","29"],function(b,d,c){return{makeTo:function(a,b,d){var g=c.owner(a).dom().createRange();g.setStart(a.dom(),b);g.setEndBefore(d.dom());return g},makeFrom:function(a,b,d){var g=c.owner(b).dom().createRange();g.setStartAfter(a.dom());g.setEnd(b.dom(),d);return g},leftEdge:function(a,c,f,g){return d.after(a,c,f,g)?b.point(f,g):b.point(a,c)},rightEdge:function(a,c,f,g){return d.after(a,c,f,g)?b.point(a,c):b.point(f,
g)}}});k("lj","b 1n 7 20 46 m".split(" "),function(b,d,c,a,e,f){var g=function(a,b){var c=d.keys(b).join(",");return(f.is(a,c)?[a]:[]).concat(e.descendants(a,c))};return{cleanse:function(d,e){var f=g(d,e);b.each(f,function(b){var d=a.name(b);(void 0!==e[d]?e[d]:c.noop)(b)})}}});k("ti",["b","v"],function(b,d){return{onlyEphox:function(c){return void 0!==c&&null!==c&&0<c.trim().length?(c=c.split(/\s+/),b.filter(c,function(a){return d.startsWith(a,"ephox-")}).join(" ")):""}}});k("lk","b 6 ti 1a 2l 2o".split(" "),
function(b,d,c,a,e,f){var g=function(a){f.unwrap(a)},h=function(b,c){e.remove(b,c);a.hasNone(b)&&g(b)},l=function(a){var c={};b.each(a,function(a){c[a]=m(g)});return c},m=function(b){return function(c){a.has(c,"data-ignore")||b.apply(null,arguments)}};return{cssAndTag:function(a,b,c){a=l(a);c=function(a){h(a,b)};return d.merge(a,{span:m(c),font:m(c)})},tagList:l,removeStyle:m(h),removeAttribute:m(function(b,c){a.remove(b,c);a.hasNone(b)&&g(b)}),unwrap:m(g),unstyle:m(function(b){var d=a.get(b,"class");
a.remove(b,"class");d=c.onlyEphox(d);0<d.length&&a.set(b,"class",d);a.remove(b,"style");a.hasNone(b)&&g(b)}),normal:function(b){a.remove(b,"data-ignore")},ignore:function(b){a.set(b,"data-ignore","true")}}});k("y3","54 b e4 2d 20 2o 29".split(" "),function(b,d,c,a,e,f,g){var h=function(a,b){var c=g.children(a);d.each(c,function(a){h(a,b)});b(a)},l=function(d){return e.isElement(d)&&!c.isEmptyTag(d)&&!c.isFrame(d)&&0===a.get(d).replace(b.zeroWidth(),"").length};return{wipeout:h,onEmpty:function(b){h(b,
function(b){!e.isElement(b)||c.isFrame(b)||c.isEmptyTag(b)||0!==a.get(b).length?l(b)&&f.unwrap(b):f.remove(b)})},onQuasiEmpty:function(a){h(a,function(a){l(a)&&f.remove(a)})}}});k("th","b 7 s y2 e4 tp d5 lj lk y3 2k 2m 35 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a){return r.parent(a).fold(d.constant([]),function(a){return e.isBlock(a)?[a]:[a].concat(s(a))})},t=function(a,c){var d=[c].concat(s(c)),d=b.reverse(d),e=b.findIndex(d,a);return-1===e?c:0===e?d[0]:d[e-1]},u=function(a,
c){b.each(c,function(b){h.cleanse(b,a);m.onQuasiEmpty(b)})};return{run:function(e,h,s,k){var B=f.leftEdge(s.startContainer(),s.startOffset(),s.endContainer(),s.endOffset());s=f.rightEdge(s.startContainer(),s.startOffset(),s.endContainer(),s.endOffset());var z=d.curry(t,k.matches);h=a.fractures(h,B.element(),B.offset(),s.element(),s.offset(),z);h=b.bind(h,function(a){var d;if(0<a.length){d=k.purifiers();var f=(0,k.nu)(e);l.ignore(f);c.from(a[0]).bind(r.prevSibling).each(m.onQuasiEmpty);c.from(a[a.length-
1]).bind(r.nextSibling).each(m.onQuasiEmpty);b.each(a,m.onQuasiEmpty);a=b.filter(a,n.inBody);0<a.length?(p.before(a[0],f),q.append(f,a),u(d,a),d=[f]):d=[]}else d=[];return d});b.each(h,l.normal);return g.fussyFromElements(h)}}});k("li",["b","1b","29"],function(b,d,c){var a=function(b,e){return d.eq(b,e)?[]:c.parent(b).fold(function(){return[]},function(d){d=a(d,e);var f=c.findIndex(b).toArray();return d.concat(f)})},e=function(a,b){return a.slice(b+1)},f=function(a,b){return a.slice(0,b)},g=function(a,
d,e,f){if(0===f.length)d(e);else{var p=f[0],q=f.slice(1);c.child(e,p).each(function(b){g(a,d,b,q)});e=c.children(e);p=a(e,p);b.each(p,d)}};return{one:function(a,b){a(b)},across:function(d,l,m,n){m=a(m,l);n=a(n,l);l=c.children(l);var p=l.slice(0<m.length?m[0]+1:0,0<n.length?n[0]:l.length-1);b.each(p,d);0<m.length&&g(e,d,l[m[0]],m.slice(1));0<n.length&&g(f,d,l[n[0]],n.slice(1))}}});k("m4",["dg","tj"],function(b,d){var c=b();return{extract:function(a,b,f){return d.extract(c,a,b,f)},extractTo:function(a,
b,f,g){return d.extractTo(c,a,b,f,g)},all:function(a,b){return d.all(c,a,b)},from:function(a,b){return d.from(c,a,b)},find:function(a,b,f){return d.find(c,a,b,f)},toText:function(a,b){return d.toText(c,a,b)}}});k("gm",["dg","o8"],function(b,d){var c=b();return{split:function(a,b){return d.split(c,a,b)},splitByPair:function(a,b,f){return d.splitByPair(c,a,b,f)},range:function(a,b,f,g){return d.range(c,a,b,f,g)},subdivide:function(a,b){return d.subdivide(c,a,b)},position:function(a){return d.position(c,
a)}}});k("to","b gm tp 20 29 9".split(" "),function(b,d,c,a,e,f){var g=function(c,d,f){var g=e.children(d),h=0===f,l=f===g.length,m=0<g.length;return void 0!==c.empty&&b.contains(["br","hr","img"],a.name(d))?c.empty:void 0!==c.hasPrevious&&m&&0<f&&f<g.length?c.hasPrevious:void 0!==c.hasNext&&m&&f<g.length-1?c.hasNext:void 0!==c.rightEdge&&m&&l?c.rightEdge:void 0!==c.first&&h?c.first:c.otherwise},h=function(a,b,c){return g(a.before.element,b,c)(b,c)},l=function(a,b,c){return g(a.after.element,b,c)(b,
c)},m=function(a,b,c){c=d.split(b,c);var e=function(a){return function(){var c=f.prototype.slice.call(arguments,0),c=[b].concat(c);return a.apply(null,c)}};return d.position(c).fold(e(a.none),e(a.start),e(a.middle),e(a.end))},n=function(a,b,c){return m(a.before.text,b,c)},p=function(a,b,c){return m(a.after.text,b,c)};return{prefix:function(b,c,d){return(a.isText(c)?n:h)(b,c,d)},postfix:function(b,d,e,f,g){d=c.rightEdge(d,e,f,g);return(a.isText(d.element())?p:l)(b,d.element(),d.offset())}}});k("pi",
"7 gm to tp 1b 20 29 9".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,c){return a.bind(function(a){return c.map(function(c){return{left:b.constant(a),right:b.constant(c)}})})},m=function(a,b,c,e){b=d.splitByPair(b,c,e);return l(a.general.insertBefore(b),a.general.insertAfter(b))},n=function(a,b,c,d){c=g.child(b,c);var e=d<g.children(b).length?g.child(b,d):g.lastChild(b);return c.bind(function(b){return e.bind(function(c){return l(a.general.insertBefore(b),a.general.insertAfter(c))})})};return{both:function(b,
d,g,h,t){if(e.eq(d,h)){var u=f.isText(d)?m:n;return g>t?u(b,d,t,g):u(b,d,g,t)}u=a.leftEdge(d,g,h,t);d=c.postfix(b,d,g,h,t);b=c.prefix(b,u.element(),u.offset());return l(b,d)}}});k("tq","dg b 7 s e4 33 sy y3 1b 49 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=f.immutable("inside","outside"),q=function(a){return n.parent(a).fold(c.constant(!0),function(a){return e.isBlock(a)||e.isContainer(a)})},r=function(e,f){var g=b(),h=[e].concat(g.up().all(e)),m=[f].concat(g.up().all(f)),g=d.find(h,function(a){return d.exists(m,
c.curry(l.eq,a))});return a.from(g)},s=function(b){return p(b.second(),a.some(b.first()))},t=function(b){return p(a.some(b.first()),b.second())},u=function(b,d){var e=q(b)?b:m.ancestor(b,q).getOr(b);l.eq(b,e)?e=p(a.some(b),a.none()):(e=g.breakPath(b,c.curry(l.eq,e)),e=d(e));return e};return{bridge:function(a,b){var d=u(a,s),e=u(b,t);return d.inside().bind(function(a){return e.inside().bind(function(b){return r(a,b).map(function(f){return{common:c.constant(f),left:c.constant(a),right:c.constant(b),
wipeout:function(){d.outside().each(h.onEmpty);e.outside().each(h.onEmpty)}}})})})}}});k("tr",["7","s","l","2m","2o"],function(b,d,c,a,e){return function(f,g){var h=function(a,f,g){var h=c.fromText(f);a(g,h);return d.some({element:b.constant(h),cleanup:function(){e.remove(h)},splits:b.constant([])})},l=function(c){return{none:d.none,start:b.curry(h,a.before,c),end:b.curry(h,a.after,c),middle:function(b,d,e){return h(a.after,c,d)}}},m=function(c){var d=function(b){return function(c,d){a.appendAt(c,
d,b)}};return{prepend:b.curry(h,a.prepend,c),before:b.curry(h,a.before,c),after:b.curry(h,a.after,c),insertAt:function(a,b){return h(d(b),c,a)},append:b.curry(h,a.append,c)}};return{before:{text:l(f),element:{hasPrevious:m(f).insertAt,first:m(f).prepend,empty:m(f).before,otherwise:m(f).append}},after:{text:l(g),element:{hasNext:m(g).insertAt,rightEdge:m(g).append,empty:m(g).after,otherwise:m(g).append}},general:{insertBefore:m(f).before,insertAfter:m(g).after}}}});k("ll","54 ap co 7 du i7 m4 i8 e4 33 pi tq tr".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=m.immutable("start","soffset","finish","foffset"),s=a.constant(!1),t=function(a){return l.isBlock(a)||l.isContainer(a)},u=function(a,b,l,m,n){var p=d.isCollapsed(b,l,m,n);b=f.toLeaf(b,l);m=f.toLeaf(m,n);var q=g.extractTo(b.element(),b.offset(),t,s),u=g.extractTo(m.element(),m.offset(),t,s),k=function(b){return p||b.offset()!==c.getEnd(b.element())?b:h.after(b.element(),a).map(function(a){return e.point(a,0)}).getOr(b)},E=function(b){return p||0!==b.offset()?
b:h.before(b.element(),a).map(function(a){return e.point(a,c.getEnd(a))}).getOr(b)};return function(){return g.find(q.element(),q.offset(),s).map(k).bind(function(a){return g.find(u.element(),u.offset(),s).map(E).map(function(b){return r(a.element(),a.offset(),b.element(),b.offset())})})}};return{applyTo:function(a,c,d,e,f,g){var h=u(a,d,e,f,g);a=q(b.zeroWidth(),b.zeroWidth());return n.both(a,d,e,f,g).bind(function(a){return p.bridge(a.left().element(),a.right().element()).bind(function(b){c(b.common(),
b.left(),b.right());a.left().cleanup();a.right().cleanup();b.wipeout();return h()})})}}});k("d8","7 li lj lk ll 1b".split(" "),function(b,d,c,a,e,f){return{doRemove:function(a,b,l){var m=function(a){c.cleanse(a,b)};return e.applyTo(a,function(a,b,c){if(f.eq(b,c))d.one(m,b);else d.across(m,a,b,c)},l.startContainer(),l.startOffset(),l.endContainer(),l.endOffset())},allRules:b.constant({b:a.unwrap,strong:a.unwrap,i:a.unwrap,em:a.unwrap,u:a.unwrap,strike:a.unwrap,del:a.unwrap,s:a.unwrap,sup:a.unwrap,
sub:a.unwrap,small:b.noop,span:a.unstyle,font:a.unstyle})}});k("lc","54 b 1n co 7 s du i8 lh d3 d5 te tf tg th lk d8 1x l 2m 20 9y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,v,k,x,y,B){return function(z,A,C,D){C=[A].concat(C);var E=e.curry(q.nuTag,A),F=e.curry(r.relatedTags,C),G=t.tagList(C),I=r.queriesTag(A),H={nu:E,matches:F,purifiers:e.constant(G)},L=function(a){var c=k.fromText(b.zeroWidth());l.atStartOf(a.startContainer(),a.startOffset(),c);return n.hare(c,0,c,1)},J=function(a,b,
c){return y.isText(b)&&c===B.get(b).length?h.after(b,a).fold(function(){return g.point(b,c)},function(a){return g.point(a,0)}):g.point(b,c)},K=function(b,c,d){return y.isText(c)&&0===d?h.before(c,b).fold(function(){return g.point(c,d)},function(b){return g.point(b,a.getEnd(b))}):g.point(c,d)},M=function(a,b){return b.map(function(b){var c=J(a,b.start(),b.soffset());b=K(a,b.finish(),b.foffset());return n.fussy(c.element(),c.offset(),b.element(),b.offset())})};C={nu:E,purifiers:e.constant(G),isStyled:e.constant(!0)};
var Q=["font-size"],R=function(a){return a.getSelection().map(function(a){var b=c.keys(D),b=d.difference(b,Q);return d.forall(b,function(b){return r.queryStyleOn(b,D[b],[A],a)})}).getOr(!1)};return{run:function(a,b){var c=b.doc();return p.detect(b,I.queryOn).fold(function(){return f.none()},function(b){b=L(b);u.doRemove(a,G,b);return f.some(n.fromHare(b))},function(a){a=L(a);var b=k.fromTag(A,c.dom());v.add(b,m.styleSpan());x.wrap(a.startContainer(),b);return f.some(n.fussy(a.startContainer(),1,a.startContainer(),
1))},function(b){b=u.doRemove(a,G,b);return M(a,b)},function(c){return s.run(b.doc(),a,c,H)})},query:function(a){return I.query(a)||R(a)},deferred:e.constant(C),name:e.constant(z)}}});k("ya",["b","s"],function(b,d){var c=function(a,b,c){return{groups:0<a.current.length?a.groups.concat({parent:a.parent,children:a.current}):a.groups,current:[c],parent:b}},a=function(a,b,c){return{groups:a.groups,current:a.current.concat([c]),parent:b}},e=function(b,e,h){return d.from(e.current[e.current.length-1]).bind(b.query().nextSibling).bind(function(c){return b.eq(c,
h)?d.some(a):d.none()}).getOr(c)};return{textnodes:function(a,c){var d=b.foldl(c,function(b,c){return a.property().parent(c).fold(function(){return b},function(d){return e(a,b,c)(b,d,c)})},{groups:[],current:[],parent:null});return 0<d.current.length?d.groups.concat({parent:d.parent,children:d.current}):d.groups}}});k("tt","b s du o8 ya t4".split(" "),function(b,d,c,a,e,f){var g=function(b,c,d,e,f,g){c=a.range(b,c,d,e,f);return h(b,c,g)},h=function(a,c,d){if(0===c.length)return c;c=b.filter(c,function(b){return a.property().isText(b)&&
0<a.property().getText(b).length});return b.map(c,function(b){var c=d();a.insert().before(b,c.element());c.wrap(b);return c.element()})},l=function(a,b){return d.from(b[0]).map(function(d){var e=f.toLower(a,b[b.length-1]);return c.points(c.point(d,0),c.point(e.element(),e.offset()))})};return{wrapWith:g,wrapper:h,leaves:function(a,b,c,d,e,h){b=f.toLeaf(a,b,c);d=f.toLeaf(a,d,e);h=g(a,b.element(),b.offset(),d.element(),d.offset(),h);return l(a,h)},reuse:function(c,d,g,h,l,s,t){d=f.toLeaf(c,d,g);h=f.toLeaf(c,
h,l);h=a.range(c,d.element(),d.offset(),h.element(),h.offset());h=e.textnodes(c,h);var u=function(a){return a.parent},k=function(a){var d=t();c.insert().before(a.children[0],d.element());b.each(a.children,d.wrap);return d.element()};return b.map(h,function(a){return(c.property().children(a.parent).length===a.children.length&&s(a.parent)?u:k)(a)})}}});k("tu",["7"],function(b){return function(d,c){return{element:b.constant(c),wrap:function(a){d.insert().append(c,a)}}}});k("ts","54 7 s du td tt tu 33".split(" "),
function(b,d,c,a,e,f,g,h){var l=function(b,e,f,g,h,l){b=m(b,e,f,g,h,l);e=b.cursor();e=a.points(a.point(e.element(),e.offset()),a.point(e.element(),e.offset()));return c.some({range:d.constant(e),temporary:b.temporary,wrappers:b.wrappers})};h.immutable("span","cursor");var m=function(f,g,h,l,m,p){return f.property().parent(g).bind(function(e){var l=a.point(g,h),m;if(m=n(f,p,e))if(m=1===f.property().children(e).length)m=f.property().isText(g)&&f.property().getText(g)===b.zeroWidth();return m?c.some({cursor:d.constant(l),
temporary:d.constant(!1),wrappers:d.constant([e])}):c.none()}).getOrThunk(function(){var c=g.dom().ownerDocument,l=f.create().nu("span",c),c=f.create().text(b.zeroWidth(),c);f.insert().append(l,c);e.atStartOf(f,g,h,l);return{cursor:d.constant(a.point(c,1)),wrappers:d.constant([l]),temporary:d.constant(!0)}})},n=function(a,b,c){return"span"===a.property().name(c)&&!1===b(c)},p=function(b,e,h,l,m,p){var k=e.dom().ownerDocument,x=f.reuse(b,e,h,l,m,d.curry(n,b,p),function(){return g(b,b.create().nu("span",
k))});return c.from(x[x.length-1]).map(function(c){var e=b.property().children(c).length;c=a.points(a.point(x[0],0),a.point(c,e));return{wrappers:d.constant(x),temporary:d.constant(!1),range:d.constant(c)}})};return{spans:function(a,b,c,e,f,g){g=void 0!==g?g:d.constant(!1);return(a.eq(b,e)&&c===f?l:p)(a,b,c,e,f,g)}}});k("o9",["ts","tt","tu"],function(b,d,c){return{nu:function(a,b){return c(a,b)},wrapWith:function(a,b,c,g,h,l){return d.wrapWith(a,b,c,g,h,l)},wrapper:function(a,b,c){return d.wrapper(a,
b,c)},leaves:function(a,b,c,g,h,l){return d.leaves(a,b,c,g,h,l)},reuse:function(a,b,c,g,h,l,m){return d.reuse(a,b,c,g,h,l,m)},spans:function(a,c,d,g,h,l){return b.spans(a,c,d,g,h,l)}}});k("gn",["dg","o9"],function(b,d){var c=b();return{nu:function(a){return d.nu(c,a)},wrapWith:function(a,b,f,g,h){return d.wrapWith(c,a,b,f,g,h)},wrapper:function(a,b){return d.wrapper(c,a,b)},leaves:function(a,b,f,g,h){return d.leaves(c,a,b,f,g,h)},reuse:function(a,b,f,g,h,l){return d.reuse(c,a,b,f,g,h,l)},spans:function(a,
b,f,g,h){return d.spans(c,a,b,f,g,h)}}});k("lo",["b","gn","d3","43","2l"],function(b,d,c,a,e){var f=function(e,f,g){e.getSelection().each(function(n){d.spans(n.startContainer(),n.startOffset(),n.endContainer(),n.endOffset(),g).each(function(d){var g=d.temporary()?[c.styleSpan()]:[],m=d.range();b.each(d.wrappers(),function(b){a.add(b,g);f(b)});d=m.begin();m=m.end();e.setSelection(d.element(),d.offset(),m.element(),m.offset())})})},g=function(a,b,c,d){b(a);f(a,d,c)};return{style:function(a,b,c,d){return g(a,
c,d,function(a){e.setAll(a,b)})},generic:g}});k("ld","7 s d3 gk lo te tf tg th lk d8 1a 1x 1b 2l 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){return function(k,w,x,y,B,z){var A=b.curry(g.nu,y,B,w),C=b.curry(h.relatedStyle,y,B,x),D=m.cssAndTag(x,y,B),E=h.queriesStyle(y,B,x),F=b.constant(!0),G=function(a,f){e.generic(a,b.noop,F,function(a){q.add(a,c.styleSpan());s.set(a,y,f);p.set(a,c.overrideSpan(),k);s.reflow(a)});return d.none()};w={nu:A,purifiers:b.constant(D),isStyled:function(b){return"span"===
t.name(b)&&a.rawState(b,y,B)}};return{run:function(a,c){return f.detect(c,E.queryOn).fold(function(){return d.none()},function(a){return G(c,z)},function(a){return G(c,B)},function(b){return n.doRemove(a,D,b)},function(d){return l.run(c.doc(),a,d,{nu:A,matches:C,purifiers:b.constant(D)})})},query:function(a){var b="["+c.overrideSpan()+'="'+k+'"]';return a.getSelection().bind(function(a){return u.closest(a.startContainer(),b).bind(function(c){return u.closest(a.endContainer(),b).bind(function(a){return r.eq(c,
a)?s.getRaw(c,y).map(function(a){return a===B}):d.none()})})}).getOrThunk(function(){return E.query(a)})},deferred:b.constant(w),name:b.constant(k)}}});k("le","7 s d3 lo te tf tg th lk d8 1a 1x 20 2o 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t,u){var k=function(a,b){return f.nuAttr(u,a,b)},w=function(a){return"span"===q.name(a)&&n.has(a,u)},x={span:function(a){l.removeAttribute(a,u)}},y=function(a,b){return g.queryAttrIs(u,a,b)},B=function(e,f){a.generic(f,b.noop,void 0,
function(a){p.add(a,c.styleSpan());n.set(a,u,e)});return d.none()};return{run:function(a,c,f){return e.detect(c,b.curry(y,f)).fold(function(){return d.none()},function(a){var b=["[",u,'="',f,'"]'].join("");s.closest(a.startContainer(),b).each(r.unwrap);return d.none()},function(a){return B(f,c)},function(b){return m.doRemove(a,x,b)},function(d){return h.run(c.doc(),a,d,{nu:b.curry(k,f),matches:w,purifiers:b.constant(x)})})},queryValue:function(a){return g.queryAttrSame(u,a)},name:b.constant(t)}}});
k("d0",["7","s","lc","ld","le"],function(b,d,c,a,e){var f=a("bold","strong",["strong","b"],"font-weight","bold","normal"),g=a("italic","em",["em","i"],"font-style","italic","normal"),h=a("underline","span",["u"],"text-decoration","underline","none");a=a("strikethrough","span",["s","strike","del"],"text-decoration","line-through","none");e=e("language","lang");var l=c("superscript","sup",["sup","sub"],{"font-size":"smaller","vertical-align":"super"});c=c("subscript","sub",["sub","sup"],{"font-size":"smaller",
"vertical-align":"sub"});var m={bold:f,italic:g,underline:h,strikethrough:a,language:e,superscript:l,subscript:c};return{bold:b.constant(f),italic:b.constant(g),underline:b.constant(h),strikethrough:b.constant(a),language:b.constant(e),superscript:b.constant(l),subscript:b.constant(c),search:function(a){return void 0!==m[a]?d.some(m[a]):d.none()}}});k("a1",["7","d0"],function(b,d){var c=function(a,b){return a.query(b)};return{bold:b.curry(c,d.bold()),italic:b.curry(c,d.italic()),underline:b.curry(c,
d.underline()),strikethrough:b.curry(c,d.strikethrough()),superscript:b.curry(c,d.superscript()),subscript:b.curry(c,d.subscript()),language:b.curry(function(a,b){return a.queryValue(b)},d.language())}});k("74",["71","33","a1"],function(b,d,c){var a=d.immutable("bold","italic","underline","strikethrough","superscript","subscript"),e=function(a,c){return a.on(function(a){return c(a)?b.on(!0):b.off()}).getOrThunk(b.off)};return{read:function(b){return a(e(b,c.bold),e(b,c.italic),e(b,c.underline),e(b,
c.strikethrough),e(b,c.superscript),e(b,c.subscript))}}});k("144",["33"],function(b){return b.immutable("startContainer","startOffset","endContainer","endOffset")});k("145",["33"],function(b){var d=b.immutable("item","start","finish","text"),c=b.immutable("items","abort"),a=function(a,b,d){return c([],!0)},e=function(a,b,d){return c([],!1)},f=function(a,b,e){var f=a.property().getText(b);return e(f).fold(function(){return c([d(b,0,f.length,f)],!1)},function(a){a=a[0]===a[1]?[]:[d(b,a[0],a[1],f.substring(a[0],
a[1]))];return c(a,!0)})};return{detail:function(a,b){var c=a.property().getText(b);return d(b,0,c.length,c)},decide:function(b,c,d){return(b.property().isBoundary(c)?a:b.property().isEmptyTag(c)?a:b.property().isText(c)?f:e)(b,c,d)}}});k("oe",["7"],function(b){return{all:function(d,c){for(var a=c.term(),e=[],f=a.exec(d);f;){var g=f.index+c.prefix(f),f=f[0].length-c.prefix(f)-c.suffix(f);e.push({start:b.constant(g),finish:b.constant(g+f)});a.lastIndex=g+f;f=a.exec(d)}return e}}});k("of",["b","6",
"oe","9"],function(b,d,c,a){var e=function(b){b=a.prototype.slice.call(b,0);b.sort(function(a,b){return a.start()<b.start()?-1:b.start()<a.start()?1:0});return b};return{search:function(a,g){var h=b.bind(g,function(e){var g=c.all(a,e.pattern());return b.map(g,function(a){return d.merge(e,{start:a.start,finish:a.finish})})});return e(h)}}});k("gp",["oe","of"],function(b,d){return{findall:function(c,a){return b.all(c,a)},findmany:function(b,a){return d.search(b,a)}}});k("yr",["7","s","6b","gp","5z"],
function(b,d,c,a,e){var f=new e(c.wordbreak()+"+","g"),g=b.constant(0),h=function(b){b=a.findall(b,c.custom(c.wordbreak(),g,g,d.none()));return d.from(b[b.length-1]).map(function(a){return a.start()})},l=function(a){a=a.search(f);return-1<a?d.some(a):d.none()};return{firstWord:function(a){return l(a).map(function(b){return a.substring(0,b+1)})},lastWord:function(a){return h(a).map(function(b){return a.substring(b)})},leftBreak:h,rightBreak:l,hasBreak:function(a){return l(a).isSome()}}});k("146",["hj",
"yr"],function(b,d){var c=b.walkers(),a=c.left(),c=c.right();return{left:{sibling:a.sibling,first:a.first,slicer:function(a){return d.leftBreak(a).map(function(b){return[b+1,a.length]})}},right:{sibling:c.sibling,first:c.first,slicer:function(a){return d.rightBreak(a).map(function(a){return[0,a]})}}}});k("121","54 b 7 tj hj 145 146".split(" "),function(b,d,c,a,e,f,g){var h=function(a,c,g,l){c=e.walk(a,c,g,l).map(function(b){var c=f.decide(a,b.item(),l.slicer);b=c.abort()?[]:h(a,b.item(),b.mode(),
l);return c.items().concat(b)}).getOr([]);return d.filter(c,function(a){return""!==a.text().replace(b.zeroWidth(),"")})},l=function(b,c,e){if(b.property().isText(c))return[f.detail(b,c)];c=a.all(b,c,e);return d.bind(c,function(a){return b.property().isText(a)?[f.detail(b,a)]:[]})};return{words:function(a,b,f){var q=h(a,b,e.sidestep,g.left);f=l(a,b,f);a=h(a,b,e.sidestep,g.right);return{all:c.constant(d.reverse(q).concat(f).concat(a)),left:c.constant(q),middle:c.constant(f),right:c.constant(a)}}}});
k("11b","54 b 7 s 144 121".split(" "),function(b,d,c,a,e,f){var g=function(a,e,g,n){var p=a.property().getText(e),q=d.filter(p.substring(0,g),function(a){return a!==b.zeroWidth()}).length,r=d.filter(p.substring(g,p.length),function(a){return a===b.zeroWidth()}).length;a=f.words(a,e,n);q=0===q&&0===a.left().length;g=g+r===p.length&&0===a.right().length;return{all:a.all,leftEdge:c.constant(q),rightEdge:c.constant(g),text:c.constant(p)}};return{before:function(b,c,d,f,p){b=g(b,c,d,p);b.rightEdge()?c=
a.none():(b=b.all(),0===b.length?c=a.none():(b=b[b.length-1],c=a.some(e(c,f,b.item(),b.finish()))));return c},after:function(b,c,d,f,p){b=g(b,c,d,p);b.leftEdge()?c=a.none():(b=b.all(),0===b.length?c=a.none():(b=b[0],c=a.some(e(b.item(),b.start(),c,f))));return c},both:function(b,c,d,f,g,q){return f===g?a.none():a.some(e(c,f,c,g))},neither:function(b,c,d,f){b=g(b,c,d,f);b.leftEdge()||b.rightEdge()?b=a.none():(c=b.all(),0===c.length?b=a.none():(b=c[0],c=c[c.length-1],b=a.some(e(b.item(),b.start(),c.item(),
c.finish()))));return b}}});k("147",["33"],function(b){return b.immutable("before","after")});k("11c",["s","147","yr"],function(b,d,c){return{around:function(a,e){var f=a.substring(0,e),g=c.leftBreak(f).map(function(a){return a+1}),f=a.substring(e),f=c.rightBreak(f).map(function(a){return e+a}),h=d(g,f),l=d(b.some(e),b.some(e));return f.bind(function(a){return e===a?b.some(l):b.none()}).getOrThunk(function(){return g.bind(function(a){return e===a?b.some(l):b.none()}).getOr(h)})}}});k("yb",["s","11b",
"11c"],function(b,d,c){return{word:function(a,e,f,g){if(!a.property().isText(e))return b.none();var h=a.property().getText(e),l=c.around(h,f);return l.before().fold(function(){return l.after().fold(function(){return d.neither(a,e,f,g)},function(b){return d.after(a,e,f,b,g)})},function(b){return l.after().fold(function(){return d.before(a,e,f,b,g)},function(c){return d.both(a,e,f,b,c,g)})})}}});k("tv",["yb"],function(b){return{word:function(d,c,a,e){return b.word(d,c,a,e)}}});k("lg",["dg","tv"],function(b,
d){var c=b();return{word:function(a,b,f){return d.word(c,a,b,f)}}});k("d4",["ap","7","lg"],function(b,d,c){var a=function(a,b,g){c.word(b,g,d.constant(!1)).each(function(b){a.setSelection(b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())})};return{expand:function(c){c.getSelection().each(function(d){b.isCollapsed(d.startContainer(),d.startOffset(),d.endContainer(),d.endOffset())&&a(c,d.startContainer(),d.startOffset())})},expandWord:a}});k("d7","54 co s d3 d5 d0 d8 1a 2k 1x 1b 2m 35 20 2o 2y m 9y 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,k,w){var x=function(a){a=w.children(a);return 1===a.length&&r.isText(a[0])&&k.get(a[0])===b.zeroWidth()},y=function(b,c){return t.closest(b,"."+a.styleSpan()).bind(function(b){return t.closest(c,"."+a.styleSpan()).filter(function(a){return n.eq(b,a)})})},B=function(b,d,e){m.remove(d,a.styleSpan());return h.has(d,a.overrideSpan())?z(b,d,e):c.some(e)},z=function(a,b,d){return A(b).bind(function(f){if(f.isStyled(b)){var g=D(f.nu,b);f=n.eq(b,d.start())?g:d.start();
g=n.eq(b,d.finish())?g:d.finish();f=c.some(e.fussy(f,d.soffset(),g,d.foffset()))}else f=E(a,b,f.purifiers(),d);return f})},A=function(b){b=h.get(b,a.overrideSpan());return f.search(b).map(function(a){return a.deferred()})},C=function(a){w.prevSibling(a).each(function(a){r.isText(a)&&k.get(a)===b.zeroWidth()&&s.remove(a)})},D=function(a,b){var c=w.owner(b),c=a(c);p.before(b,c);q.append(c,w.children(b));s.remove(b);return c},E=function(b,d,f,h){d=w.owner(d);var m=e.fromFussy(h);g.doRemove(b,f,m);b=
"["+a.overrideSpan()+"]";return u.one(b,d).bind(function(a){s.unwrap(a);return l.inBody(h.start())&&l.inBody(h.finish())?c.some(h):c.none()})};return{clean:function(a,b){if(x(b))s.unwrap(b);else{var c=e.fussy(b,0,b,w.children(b).length-1);B(a,b,c)}},isTransient:x,withinTransient:y,handleOverride:z,forceConvert:function(a){x(a)&&(C(a),A(a).bind(function(b){D(b.nu,a)}))},apply:function(a,b,f,g,h){var l=e.fussy(b,f,g,h);return y(b,g).bind(function(b){if(x(b)){var f=w.children(b),f=n.eq(b,l.start())?
e.fussy(f[0],0,f[0],d.getEnd(f[0])):l;s.unwrap(b);b=c.some(f)}else b=B(a,b,l);return b})}}});k("d6","co s lh d4 d5 d7 d8 2m 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a,b){return a.action().run(a.isRoot(),a.environment())};return{override:function(a,c){var g=a.temp();f.handleOverride(a.isRoot(),g,e.fussy(g,0,g,b.getEnd(g)));return d.some(c)},insertAfter:function(a,b){h.after(a.temp(),a.cursor());return d.some(b)},insertBefore:function(a,b){h.before(a.temp(),a.cursor());return d.some(b)},
insertAt:function(a,b){var e=a.original();c.atStartOf(e.startContainer(),e.startOffset(),a.cursor());return d.some(b)},apply:n,applyIfOffCursor:function(a,b){var c=a.action().deferred().isStyled(a.temp()),f=a.cursor(),g=d.some(e.fussy(f,1,f,1));c?c=g:(a.environment().setSelection(f,0,f,0),c=n(a,b));return c},clearCursor:function(a,b){var c=a.cursor(),f=a.action().deferred();g.doRemove(a.isRoot(),f.purifiers(),e.hare(c,0,c,1));return d.some(e.fussy(c,1,c,1))},applyOverCursor:function(a,b){var c=a.cursor();
a.environment().setSelection(c,0,c,1);n(a,b);return d.some(e.fussy(c,1,c,1))},regrab:function(b,c){var d=b.environment(),f=b.original();d.setSelection(f.startContainer(),f.startOffset(),f.endContainer(),f.endOffset());a.expand(d);return d.getSelection().map(e.fromHare)},clearSelection:function(a,b){var c=a.action().deferred();return g.doRemove(a.isRoot(),c.purifiers(),e.fromFussy(b))},applyIfOffRange:function(a,b){var c;a.action().deferred().isStyled(a.temp())?c=d.some(b):(a.environment().setSelection(b.start(),
b.soffset(),b.finish(),b.foffset()),c=n(a,b));return c},unwrap:function(a,c){var f=a.temp(),g=m.children(f);l.unwrap(f);return 0===g.length?d.none():d.some(e.fussy(g[0],0,g[g.length-1],b.getEnd(g[g.length-1])))}}});k("75","54 b d1 co 7 s 33 d2 d3 d4 d5 d0 d6 d7 d8 1a 1b l".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,k){var w=g.immutable("environment","isRoot","cursor","temp","action","original"),x=function(b,d){return c.lastCursor(b).fold(e.constant(!0),function(b){return u.eq(b,d.startContainer())&&
a.getEnd(b)===d.startOffset()})},y=function(a,b){return c.firstCursor(a).fold(e.constant(!0),function(a){return u.eq(a,b.startContainer())&&0===b.startOffset()})},B=function(a,c,e,g,h){var m=t.get(g,l.overrideSpan()),p=h.collapsed(),s=k.fromText(b.zeroWidth()),u=x(g,h),B=y(g,h),m=a.name()===m,J=w(e,c,s,g,a,h);a=m&&r.isTransient(g)?[q.unwrap]:p&&m&&u?[q.insertAfter,q.override,q.applyIfOffCursor]:p&&m&&B?[q.insertBefore,q.override,q.applyIfOffCursor]:p&&m?[q.insertAt,q.override,q.clearCursor]:p&&u?
[q.insertAt,q.override,q.applyOverCursor]:p&&B?[q.insertBefore,q.override,q.applyOverCursor]:p?[q.insertAt,q.override,q.applyOverCursor]:m?[q.override,q.regrab,q.clearSelection,q.applyIfOffRange]:[q.override,q.regrab,q.apply];return d.foldl(a,function(a,b){return a.bind(function(a){return b(J,a)})},f.some(n.fromHare(h)))};g=function(a,b,c){m.expand(c);var d=c.getSelection().bind(function(d){return r.withinTransient(d.startContainer(),d.endContainer()).filter(function(a){return t.has(a,l.overrideSpan())}).fold(function(){return a.run(b,
c)},function(e){return B(a,b,c,e,d)})});return h.inlineFrom(d)};return{bold:e.curry(g,p.bold()),italic:e.curry(g,p.italic()),underline:e.curry(g,p.underline()),strikethrough:e.curry(g,p.strikethrough()),superscript:e.curry(g,p.superscript()),subscript:e.curry(g,p.subscript()),removeformat:function(a,b){m.expand(b);var c=b.getSelection().bind(function(b){var c=s.allRules();return s.doRemove(a,c,b)});return h.inlineFrom(c)},language:e.curry(function(a,b,c,d){c.getSelection().each(function(a){r.apply(b,
a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()).each(function(a){c.setSelection(a.start(),a.soffset(),a.finish(),a.foffset())})});m.expand(c);a=a.run(b,c,d);return h.inlineFrom(a)},p.language()),cleanup:r.clean,isTransient:r.isTransient,withinTransient:r.withinTransient,coalesce:r.forceConvert}});k("57","7 72 73 6u 74 6l 6v 71 4x 3z 75".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p){var q=p.content(),r=p.shortcuts(),s=p.undo(),t=m.create({analytics:l(["message","properties"])}),
u=function(a,c){var d=e.read(q);(void 0!==d[a]?d[a]():h.unchanged()).fold(c.deselect,b.noop,c.select)},k=function(a){var e=function(b){return a(q.isRoot,b)};return function(){c.cata(p.selections().get(),b.noop,d.multiple(q,s,e),d.single(q,s,e));q.uiChanged()}},w=k(n.bold),x=k(n.italic),y=k(n.underline),B=k(n.strikethrough),z=k(n.subscript),A=k(n.superscript),k=k(n.removeformat);r.events.bold.bind(w);r.events.italic.bind(x);r.events.underline.bind(y);return{ui:f.ui({"bold.general":{toggle:!0,value:"bold",
textkey:a.key("action.bold"),action:w,updateGeneral:b.curry(u,"bold"),icon:!0,tooltip:g.get},"italic.general":{toggle:!0,value:"italic",textkey:a.key("action.italic"),action:x,updateGeneral:b.curry(u,"italic"),icon:!0,tooltip:g.get},"underline.general":{toggle:!0,value:"underline",textkey:a.key("action.underline"),action:y,updateGeneral:b.curry(u,"underline"),icon:!0,tooltip:g.get},"strikethrough.general":{toggle:!0,value:"strikethrough",textkey:a.key("action.strikethrough"),action:B,updateGeneral:b.curry(u,
"strikethrough"),icon:!0,tooltip:g.get},"removeformat.general":{toggle:!1,value:"removeformat",textkey:a.key("action.removeformat"),action:k,updateGeneral:b.identity,icon:!0,tooltip:g.get},"subscript.general":{toggle:!0,value:"subscript",textkey:a.key("action.subscript"),action:z,updateGeneral:b.curry(u,"subscript"),icon:!0,tooltip:g.get},"superscript.general":{toggle:!0,value:"superscript",textkey:a.key("action.superscript"),action:A,updateGeneral:b.curry(u,"superscript"),icon:!0,tooltip:g.get}}),
events:t.registry,destroy:b.noop}}});k("d9",["b","cj"],function(b,d){return{multiple:function(c,a,e,f){return function(g,h){d.runTransaction(c,a,function(){b.each(h,e)},f)}},single:function(b,a,e,f){return function(g,h){d.runTransaction(b,a,function(){e(h)},f)}}}});k("7e",["71","33","1x"],function(b,d,c){var a=d.immutable("content");return{hasSelection:function(c){return c.getSelection().fold(function(){return a(b.off())},function(){return a(b.on(!0))})},isAnnotation:function(a){return c.has(a,"ephox-cram-annotation-wrap")}}});
k("lm",["ky"],function(b){var d=function(a,b,c){c=a.create().nu(c);var d=a.property().children(b);a.insert().append(b,c);a.insert().appendAll(c,d);return c},c=function(a,b,c){c=a.create().nu(c);var d=a.property().children(b);a.attrs().copyTo(b,c);a.insert().before(b,c);a.insert().appendAll(c,d);a.remove().remove(b);return c};return{blockTransform:function(a,e,f){return(b.isFormatting(a,e)?c:d)(a,e,f)},nest:d,replace:c}});k("ln",["7"],function(b){return{tags:b.constant("address article aside audio blockquote canvas dd div dl fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr li noscript ol output p pre section table tbody td tfoot th thead tr ul video".split(" "))}});
k("dm",["b","7","s","ln"],function(b,d,c,a){return function(e){var f=function(a,f,l,m){var n=l.join(",");a=e.up().closest(a,n,m);f=e.up().closest(f,n,m);return a.isSome()&&f.isSome()?(m=a.getOrDie("Just checked it was some."),f=f.getOrDie("Just checked it was some."),e.eq(m,f)?(l=b.find(l,d.curry(e.is,m)),l=void 0!==l&&null!==l?c.some(l):c.none()):l=c.none(),l):c.none()};return{query:function(b,c,d){c=c.concat(a.tags());return f(b.startContainer(),b.endContainer(),c,d)},queryAll:f}}});k("da","dg b lm dj l6 dm".split(" "),
function(b,d,c,a,e,f){var g=b(),h=f(g);return{query:function(a,b,c){return h.query(a,b,c)},apply:function(f,g,h,p,q,r){return a.applyOn(f,e,g,h,p,q,function(a){return d.map(a,function(a){return c.blockTransform(b(),a,r)})})}}});k("db",["lo","d4","1a","1x"],function(b,d,c,a){return{background:function(a,c,g){b.style(a,{"background-color":c},d.expand,g)},addClass:function(c,f,g){b.generic(c,d.expand,g,function(b){a.add(b,f)})},foreground:function(a,c,g){b.style(a,{color:c},d.expand,g)},addAttribute:function(a){return function(f,
g,h){b.generic(f,d.expand,h,function(b){c.set(b,a,g)})}},face:function(a,c,g){b.style(a,{"font-family":c},d.expand,g)},size:function(a,c,g){b.style(a,{"font-size":c},d.expand,g)}}});k("76","b 7 s cj ck d9 cm cn 73 7e da db 1a 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a,b,d,f,m){b=function(b,c,e,f){return a(d.isRoot,b,c,e,f)};var n=e.multiple(d,f,b),p=e.single(d,f,b,h.spot,g.update);return l.cata(m.get(),c.none,function(a,b){return c.some(n(a,b))},function(a,b){return c.some(p(a,
b))})};return{transform:function(a,b,c,d,e){return s(function(a,b,c,d,f){return n.apply(a,b,c,d,f,e)},a,b,c,d)},setClass:function(c,e,f,g,h,m){var n=function(b){r.closest(b,h).each(function(b){a.runTransaction(e,f,function(){q.set(b,"class",m)},e.toEditing)})};l.cata(g.get(),d.noop,function(a,c){b.each(a,n)},function(a,b){n(a.startContainer())})},inline:function(a,b,c,e,g){a=function(a){p.addClass(a,g,m.isAnnotation)};l.cata(e.get(),d.noop,f.multiple(b,c,a,b.toEditing),f.single(b,c,a,b.toEditing))},
list:function(a,b,c,d,e){return s(a,b,c,d,e)}}});k("77","b 6 s 6u 33 6e".split(" "),function(b,d,c,a,e,f){var g=e.immutable("label","items"),h=function(b,d){return 0<d.length?[g(c.some(a.key(b)),d)]:[]};return{groups:function(a,e,n){var p=a.divisions(),q=b.map(p.blocks().concat(p.classblocks()),a.toCandidate),r=b.map(p.inlines(),a.toCandidate);a=b.map(p.objects(),a.toCandidate);a=b.foldr(a,function(a,c){var g;f.closest(e,c.base(),n)?(g=c.base(),g=b.contains(["a"],g)?d.merge(a,{link:a.link.concat([c])}):
b.contains(["embed","img","object"],g)?d.merge(a,{media:a.media.concat([c])}):b.contains(["hr"],g)?d.merge(a,{line:a.line.concat([c])}):b.contains(["li","ol","ul"],g)?d.merge(a,{list:a.list.concat([c])}):b.contains(["table","tr","td","th"],g)?d.merge(a,{table:a.table.concat([c])}):a):g=a;return g},{link:[],media:[],line:[],list:[],table:[]});return b.flatten([[g(c.none(),q)],h("block.label.inline",r),h("block.label.link",a.link),h("block.label.media",a.media),h("block.label.line",a.line),h("block.label.list",
a.list),h("block.label.table",a.table)])}}});k("79",[],function(){var b=function(b,c){return{fold:c}};return{inline:function(d,c,a){return b("inline",function(b,f,g,h){return b(d,c,a)})},object:function(d,c,a,e){return b("object",function(b,g,h,l){return g(d,c,a,e)})},block:function(d,c,a){return b("block",function(b,f,g,h){return g(d,c,a)})},classblock:function(d,c,a,e){return b("classed block",function(b,g,h,l){return l(d,c,a,e)})},cata:function(b,c,a,e,f){return b.fold(c,a,e,f)}}});k("dc","b 7 s p 79 6u".split(" "),
function(b,d,c,a,e,f){var g="h1 h2 h3 h4 h5 h6 div p pre".split(" "),h="a embed hr img li object ol table td tr ul th".split(" "),l=function(a){var b=a.indexOf("."),e;-1<b?(e=a.substring(0,b),a=a.substring(b+1),e=-1===a.indexOf(".")?c.some({tag:d.constant(e),clazz:d.constant(a)}):c.none()):e=c.none();return e},m=function(c,d){var f=c.tag(),l=c.clazz(),m=b.contains(g,f),n=b.contains(h,f);return(m?a.value(e.classblock):n?a.value(e.object):a.error("Rule must have object tag or block tag.")).map(function(a){var b=
q(d,c,m);return a(f,l,b,d.style)})},n=function(a){return a.text.getOrThunk(function(){return f.key("block."+a.name)})},p=function(a,b){return a.text.getOrThunk(function(){return f.pkey("tag.inline.class",[b])})},q=function(a,b,c){return a.text.getOrThunk(function(){var a=(c?"block":"tag")+"."+b.tag(),a=(f.has(a)?f.translate(a):b.tag())+" ("+b.clazz()+")";return f.raw(a)})};return{decipher:function(c){return l(c.name).fold(function(){return b.contains(g,c.name)?a.value(e.block(c.name,n(c),c.style)):
a.error("Invalid style name: "+c.name)},function(b){return 0<b.tag().length?m(b,c):a.value(e.inline(b.clazz(),p(c,b.clazz()),c.style))})}}});k("78","b 1n 7 s dc 79 6u 33".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var m=h.immutable("base","value","textkey","icon","styles","tag");l=b.map(l.styles,function(b){return{name:b.rule,text:a.from(b.text).map(g.raw),style:void 0===b.style?{}:b.style}});var n={};b.each(l,function(a){e.decipher(a).each(function(b){n[a.name]=b})});l=c.constant(!0);
var p=c.constant(!1),q=function(a,b,c,d){return function(e){return f.cata(e,a,b,c,d)}},r=d.values(n),s=b.filter(r,q(p,p,p,l)),t=b.filter(r,q(p,p,l,p)),u=b.filter(r,q(p,l,p,p)),k=b.filter(r,q(l,p,p,p));l=function(){var a=s.concat(u).concat(t).concat(k);return b.map(a,function(a){return f.cata(a,function(a,b,c){return"."+a},function(a,b,c,d){return a+"."+b},function(a,b,c){return a},function(a,b,c,d){return a+"."+b})})}();var w=function(b){return void 0!==n[b]?a.some(n[b]):a.none()},x=function(b){return f.cata(b,
function(b,c,d){return m("span","."+b,c,a.none(),d,"span")},function(b,c,d,e){return m(b,b+"."+c,d,a.none(),e,"span")},function(b,c,d){return m(b,b,c,a.none(),d,b)},function(b,c,d,e){return m(b,b+"."+c,d,a.none(),e,b)})},p=function(){var a=d.values(n);return b.map(a,x)}();return{candidateByName:function(a){return w(a).map(x)},toCandidate:x,ruleByName:w,divisions:function(){return{classblocks:c.constant(s),blocks:c.constant(t),objects:c.constant(u),inlines:c.constant(k)}},backup:function(b){return m(b,
b,g.key("block."+b),a.none(),{},"span")},selectors:c.constant(l),everything:c.constant(p)}}});k("de",["7","6u"],function(b,d){return{text:function(c){var a=d.get(c.textkey()),e=d.cata(c.textkey(),b.constant(!0),b.constant(!1),b.constant(!1));c=e&&void 0===a?c.value():a;return{text:b.constant(c),unknown:b.constant(e)}}}});k("7a","dd de 6u 30 1x 43 2l l 2m".split(" "),function(b,d,c,a,e,f,g,h,l){return{format:function(b){var d=h.fromText(c.get(b.textkey())),f=h.fromTag("div");e.add(f,a.resolve("format-element-"+
b.tag()));g.setAll(f,b.styles());b=h.fromTag("div");e.add(b,a.resolve("format-element-container"));l.append(f,d);l.append(b,f);return b},face:function(c){var e=d.text(c),h=e.text(),h=b(h).element();g.setAll(h,{"font-family":c.value()});c=e.unknown()?[a.resolve("font-face-unknown")]:[];f.add(h,c);return h}}});k("lp","7i e6 9m 7 s 6u 30 71 4x 3z 1a 1x 3n l 2m 2o v".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){var k=function(a,b){var c={type:a,style:b,contentStyle:g.resolve("list-style-content")};
return r.fromHtml(u.supplant('<${type} style="list-style-type: ${style}"><li><span class="${contentStyle}"></span></li><li><span class="${contentStyle}"></span></li><li><span class="${contentStyle}"></span></li></${type}>',c))},w=function(a,b){var c=f.translate(b),d=r.fromText(c),e=r.fromTag("span");p.add(e,g.resolve("list-style-default"));n.set(a,"data-"+g.resolve("list-style"),"default");n.set(a,"title",c);s.append(e,d);return e};return function(u,y,B){var z=B(void 0===y||"default"===y?e.none():
e.some(y)),A=r.fromTag("div");p.add(A,g.resolve("list-style-option"));B=void 0===y||"default"===y?w(A,"ul"===u?"list.unordered.default":"list.ordered.default"):k(u,y);s.append(A,B);u=f.translate(("ul"===u?"list.unordered.":"list.ordered.")+y);n.set(A,"title",u);b.menuItemCheckbox(A,u);var C=c.describe(A,f.translate("aria.widget.navigation"));s.append(A,C);var D=m.create({action:l(["type","element"])}),E=function(){d.checked(A,!0);p.add(A,g.resolve("list-style-selected"))},F=function(){d.checked(A,
!1);p.remove(A,g.resolve("list-style-selected"))},G=q.bind(A,"click",function(a){D.trigger.action(z,e.some(A))});return{element:a.constant(A),instance:z,style:y,update:function(b){(z.query(b)&&z.queryStyle(b)?h.on(!0):h.off()).fold(F,a.noop,E)},select:E,deselect:F,events:D.registry,destroy:function(){G.unbind();t.remove(A);t.remove(C)}}}});k("df","b fk 85 7 s lp 30 4x 3z 1a 1x l 2m 2o 2y 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){var u="data-"+g.resolve("list-style");return function(k,
w,x){var y=l.create({action:h(["type"])}),B=p.fromTag("div");n.add(B,g.resolve("list-style-palette"));var z=b.map(k,function(a){return f("bullist"===w?"ul":"ol",a,x)});b.each(z,function(a){a.events.action.bind(function(a){a.element().each(D);y.trigger.action(a.type())});q.append(B,a.element())});var A=function(){var b=t.floor(z.length/4)+(0<z.length%4?1:0);return c.grid(B,{cell:a.constant("."+g.resolve("list-style-option"))},b,4,d.grid({trigger:function(a){a.dom().click();return e.some(a)}}))}(),
C=function(a){a=b.find(z,a);return e.from(a)},D=function(a){s.sibling(a,"["+u+'="default"]').filter(function(b){return b!==a}).bind(function(b){m.remove(b,u);m.set(a,u,"default")})};return{enter:A.enter,element:a.constant(B),update:function(a){b.each(z,function(b){b.update(a)})},events:y.registry,destroy:function(a){A.isFocused()&&A.exit();A.destroy();b.each(z,function(a){a.destroy()});r.remove(B)},findDefault:function(){return C(function(a){return m.has(a.element(),u)}).map(function(a){return a.instance})}}}});
k("7b","c 9n 7 ci 76 df 6v 71 4x 3z 2v 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(q){var r=q.region(),s=q.content(),t=q.undo(),u=q.keyboard(),k=q.listConstructor(),w=q.type(),x=q.styles(),y=q.textkey(),B=k("default"),z=b.detect(),A=u.all();A.swallowKeys([d.ESCAPE()]);var C=m.create({abort:l([]),done:l([]),close:l([]),analytics:l(["message"])});A.events.escape.bind(function(a){C.trigger.abort()});var D=function(b){var c=e.list(function(c,d,e,f,g){return b.apply(c,d,e,f,g,a(r))},
r,s,t,q.selections());C.trigger.done();s.focus();return c},E=function(){p.descendant(F.element(),'[data-ephox-polish-list-style="default"]').each(function(a){n.focus(a)})},F=f(x,w,k);F.events.action.bind(function(a){D(a.type())});return{action:function(){var a=F.findDefault().getOr(B);D(a)},element:F.element,shortcut:!1,textkey:c.constant(y),label:c.constant(!1),name:c.constant(w),tooltip:g.get,toggle:!0,value:w,updateWidget:function(a){s.getSelection().each(function(b){var d=B.query(b)?h.on(!0):
h.off();d.fold(a.deselect,c.noop,a.select);d.fold(a.release,c.noop,a.press);F.update(b)})},open:function(){z.deviceType.isTouch()||E();A.on()},close:function(){A.off();C.trigger.close()},icon:!0,events:C.registry,enter:F.enter,destroy:function(){A.off();A.destroy();F.destroy()}}}});k("lq",["6","4g"],function(b,d){var c=d.generate([{mine:["element"]},{other:["element"]},{paragraphs:["elements"]}]);return b.merge(c,{cata:function(a,b,c,d){return a.fold(b,c,d)}})});k("lr","b s e4 lq 2l 20 29".split(" "),
function(b,d,c,a,e,f,g){var h=function(a,b,c){var d=f.name(a);return e.getRaw(a,"list-style-type").fold(function(){return d===b&&c.isNone()},function(a){return c.exists(function(c){return d===b&&a===c})})};return{categorise:function(d,e,f){d=b.groupBy(d,function(a){return c.isList(a)?!0:g.parent(a).map(function(a){return a.dom()}).getOr(!1)});return b.bind(d,function(d){return b.forall(d,c.isList)?b.map(d,function(b){return h(b,e,f)?a.mine(b):a.other(b)}):[a.paragraphs(d)]})}}});k("dh","b d1 co 7 s ct lm lq lr 1a 2l l 2m 35 20 ei 46".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u){return function(k,w,x){var y=function(a){if("p"===s.name(a))return g.replace(k,a,"li");var b=p.fromTag("li");q.before(a,b);q.append(b,a);return b},B=function(a){var b=p.fromTag(w);x.each(function(a){n.set(b,"list-style-type",a)});q.before(a[0],b);r.append(b,a);e.from(m.get(a[0],"dir")).each(function(a){m.set(b,"dir",a)});return b},z=function(a){var b=t.mutate(a,w);x.fold(function(){n.remove(b,"list-style-type")},function(a){n.set(b,"list-style-type",a)});
return b},A=function(b){var c=a.constant(!0),d=a.constant(!1);return b.fold(c,d,d)},C=function(a,b){return function(g){return h.cata(g,function(g){var h=u.descendants(g,"li");return 0<h.length?(g=h[0],h=h[h.length-1],g=d.firstCursor(g).getOr(g),h=d.lastCursor(h).getOr(h),f.outdent(a,g,0,h,c.getEnd(h),b).map(function(a){return a.all()})):e.none()},e.none,e.none).getOr([])}},D=function(a){return h.cata(a,function(a){return[a]},function(a){return[z(a)]},function(a){a=b.map(a,y);B(a);return a})};return{apply:function(a,
c,d){d=l.categorise(d,w,x);a=b.forall(d,A)?C(a,c):D;return b.bind(d,a)}}}});k("di","dg b 7 s e4 ls lt lu 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a){return g.cata(a,function(a){return h.wrap(a)},function(a){return[a]},function(a,b){return e.isList(a)?[a]:d.bind(b,n)},function(a){return h.wrap([a])})};return{isRootContainer:function(a){return function(b){return a(b)||e.isContainer(b)&&"li"!==l.name(b)}},extract:n,isCapable:e.isBlock,canUse:c.constant(!1),quasi:function(){return a.some(f.nu(b()))},
ascend:function(a,b){return m.closest(a,"ol,ul",b).getOr(a)}}});k("dk","l4 lv lw 2l l 20".split(" "),function(b,d,c,a,e,f){var g=function(c,d,f){var g=e.fromTag(d);f.each(function(b){a.set(g,"list-style-type",b)});return b.list(c,g)},h=function(b,c){var d=a.getRaw(b,"list-style-type");return c.fold(function(){return d.isNone()},function(a){return d.is(a)})},l=function(a,b,c){return f.name(a)===b&&h(a,c)};return{isAlready:l,convertOr:function(a,b,c){return function(d){return l(d.list(),a,b)?c(d):g(d,
a,b)}},topContext:function(a,b,e){return c.context(a,b,c.topmost,d.groupWrite,e)},context:function(a,b,e){return c.context(a,b,c.immediate,d.groupWrite,e)},unapply:function(a){return b.level(a,-1*a.level())}}});k("7f","dg b 7 s dh di dj dk dl dm 2l 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=b(),s=m(r),t=function(b){b=d.map(b,function(a){return q.ancestor(a,"ul,ol")});var c=d.map(b,function(a){return a.fold(function(){return"-"},function(a){return p.name(a)+"-"+n.get(a,"list-style-type")})}),
e=c[0];return d.forall(c.slice(1),function(a){return a===e})?b[0]:a.none()};b=function(a,b,d){var m=e(r,a,d),n=function(a,b,c,d,e,h){return g.applyOn(a,f,b,c,d,e,function(b){return m.apply(a,h,b)})},p=function(b){b=b.selected();return 0<b.length&&t(b).map(function(b){return h.isAlready(b,a,d)}).getOr(!1)};return{query:function(c){return s.queryAll(c.startContainer(),c.endContainer(),["ul","ol"],b).exists(function(b){return b===a})},queryStyle:function(a){var c=d.fold(function(){return":not([style])"},
function(a){return'[style*="list-style-type: '+a+';"]'});return r.up().closest(a.startContainer(),"ol, ul",b).exists(function(d){return r.up().closest(a.endContainer(),"ol, ul",b).exists(function(a){return d.dom()===a.dom()?r.is(d,c):!1})})},apply:function(b,e,f,g,m,q){var r=function(){return n(b,e,f,g,m,q)},s=function(b,c){return l.executeUsing(b,e,f,g,m,function(){return h.convertOr(a,d,c)})},t=function(){return h.topContext(e,g,b).fold(r,function(a){return s(a,h.unapply)})};return h.context(e,
g,b).fold(r,function(a){return p(a)?t():s(a,c.identity)})}}};return{unordered:c.curry(b,"ul"),ordered:c.curry(b,"ol")}});k("7c","7 s ci 76 6u 6v 71 7f".split(" "),function(b,d,c,a,e,f,g,h){var l=function(h,l,m,r){return function(m){var q=r(m.content().isRoot,d.none());return{toggle:!0,value:h,textkey:e.key(l),icon:!0,tooltip:f.get,updateGeneral:function(a){m.content().getSelection().each(function(c){(q.query(c)?g.on(!0):g.off()).fold(a.deselect,b.noop,a.select)})},action:function(){a.list(function(a,
b,d,e,f){return q.apply(a,b,d,e,f,c(m.region()))},m.region(),m.content(),m.undo(),m.selections());m.content().focus()}}}},m=l("bullist","action.bullist","ul",h.unordered);return{ol:l("numlist","action.numlist","ol",h.ordered),ul:m}});k("7d",["b","71","33","da"],function(b,d,c,a){var e=c.immutable("tag"),f=function(a,c){return b.contains(["label","li","td","th","normal"],c)?d.on(a.backup(c)):d.off()},g=function(b,c,e){return a.query(b,c.selectors(),e).fold(function(){return b.collapsed()?f(c,"normal"):
d.off()},function(a){return c.candidateByName(a).map(d.on).getOrThunk(function(){return f(c,a)})})};return{read:function(a,b){var c=a.getSelection().fold(function(){return d.off()},function(c){return g(c,b,a.isRoot)});return e(c)}}});k("58","b c 7 s 76 73 77 78 79 6y 7a 7b 7c 6u 7d 7e 6l 6v 4x 3z 33 7f 1a 2l 2y q 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,k,w,x,y,B,z,A,C,D,E){var F=d.detect();return function(d,D){var H=x.create({analytics:w(["message"])}),L=h(D),J=d.region(),K=d.content(),
M=d.undo(),Q=a.some(n.format),R=K.isRoot,P=function(a){F.deviceType.isiOS()&&b.each(b.groupBy(b.filter(b.map(a,function(a){return C.ancestor(a,"ul,ol",R).getOr(!1)}),c.identity),function(a){return a.dom()}),function(a){var b=A.get(a[0],"list-style-type");A.set(a[0],"list-style-type","none");E(function(){A.set(a[0],"list-style-type",b)},0)})},O=function(){return f.cata(d.selections().get(),c.constant([]),function(a){return 0<a.length?g.groups(L,a[0]):[]},function(a,b){return g.groups(L,a.startContainer(),
R)})},V=function(b){var c=t.hasSelection(K),d=s.read(K,L),e=O();b.populate(e);m.updateMenu(b,d.tag(),c.content(),L.everything(),a.none())},U=function(a){L.ruleByName(a).each(function(a){l.cata(a,function(a,b,c){e.inline(J,K,M,d.selections(),a)},function(a,b,c,f){e.setClass(J,K,M,d.selections(),a,b)},function(a,c,f){e.transform(J,K,M,d.selections(),a).each(function(a){b.each(a,function(a){z.remove(a,"class")});P(a)})},function(a,c,f,g){e.transform(J,K,M,d.selections(),a).each(function(a){b.each(a,
function(a){z.set(a,"class",c)});P(a)})});K.uiChanged()})},N=y.immutableBag("region content undo selections keyboard listConstructor type styles textkey".split(" "),[]),X=N({region:J,content:K,undo:M,selections:d.selections(),keyboard:d.keyboard(),listConstructor:c.curry(B.unordered,R),type:"bullist",styles:["default","disc","circle","square"],textkey:r.key("action.bullist")}),N=N({region:J,content:K,undo:M,selections:d.selections(),keyboard:d.keyboard(),listConstructor:c.curry(B.ordered,R),type:"numlist",
styles:"default decimal upper-alpha lower-alpha upper-roman lower-roman lower-greek".split(" "),textkey:r.key("action.numlist")}),T=function(a){return r.translate("block.describe",r.get(a.textkey()))},X=c.curry(p,X),N=c.curry(p,N);return{ui:u.ui({"blocktag.dropdown":function(){return{name:"blocktag",textkey:r.key("block.styles"),updateDropdown:V,action:U,values:L.everything(),render:Q,tooltip:k.get,toggle:!1,describe:T}},"bullist.widget":X,"numlist.widget":N,"bullist.general":c.constant(q.ul(d)),
"numlist.general":c.constant(q.ol(d))},c.identity),events:H.registry,destroy:c.noop}}});k("lx","b 7 e4 l5 lt t1 lu 20".split(" "),function(b,d,c,a,e,f,g,h){var l=["li"],m=function(a,b){return e.cata(a,function(a){return!0===b?[]:g.wrap(a)},function(a){return[a]},function(a,b){return"table"===h.name(a)?[a]:g.handleContainer(l,a,b,m)},function(a){return!0===b?[]:g.wrap([a])})};return{isRootContainer:a.isRootOrContainer,extract:function(a){return m(a,!1)},isCapable:function(a){return f.isBlock(a)||b.contains(l,
h.name(a))},canUse:function(a){return c.isFormatting(a)||b.contains(l,h.name(a))},quasi:d.curry(g.handleRoot,l),ascend:d.identity}});k("ly",["1a"],function(b){return function(d,c){return{is:function(a){return b.get(a,d)===c},remove:function(a){b.remove(a,d)},set:function(a){b.set(a,d,c)}}}});k("dn","b 7 ku lx dj ly 2l b3 2y".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a,b){return l.closest(b,'[dir="rtl"],[dir="ltr"]').filter(a).isSome()},n=function(l,n,p){var t=f(n,p),u=function(a){t.set(a);
g.reflow(a)},k=function(a){return h.getDirection(a)===p};return{run:function(c,d,f,g,h){return e.applyOn(c,a,d,f,g,h,function(a){b.each(a,u);return a})},query:function(a,b){return c.bothMatch(a,b,d.curry(m,k))},name:d.constant(l)}},p=n("DirRtl","dir","rtl"),n=n("DirLtr","dir","ltr");return{dirLtr:d.constant(n),dirRtl:d.constant(p)}});k("7g","7 cl cm cn 73 dn 3m".split(" "),function(b,d,c,a,e,f,g){var h=function(f){return function(h){var n=function(a,b,c,d){return f.run(h.content().isRoot,a,b,c,d)};
e.cata(h.selections().get(),b.noop,d.multiple(h.content(),h.undo(),n),d.single(h.content(),h.undo(),n,a.spot,c.update));g(function(){h.content().uiChanged()},0)}};return{dirRtl:h(f.dirRtl()),dirLtr:h(f.dirLtr())}});k("7h",["71","33","dn"],function(b,d,c){var a=d.immutable("ltrdir","rtldir"),e=function(a,c){return c.query(a.startContainer(),a.endContainer())?b.on(!0):b.off()};return{readDir:function(b){return b.getSelection().map(function(b){return a(e(b,c.dirLtr()),e(b,c.dirRtl()))})}}});k("59","7 7g 6u 7h 6l 71 4x 3z".split(" "),
function(b,d,c,a,e,f,g,h){return function(l){var m=l.content(),n=h.create({analytics:g(["message","properties"])}),p=function(c,d){a.readDir(m).map(function(a){return a[c]}).fold(f.unchanged,b.apply).fold(d.deselect,b.noop,d.select)};return{ui:e.ui({"ltrdir.general":{value:"ltrdir",textkey:c.key("directionality.ltrdir"),action:b.curry(d.dirLtr,l),updateGeneral:b.curry(p,"ltrdir"),toggle:!0},"rtldir.general":{value:"rtldir",textkey:c.key("directionality.rtldir"),action:b.curry(d.dirRtl,l),updateGeneral:b.curry(p,
"rtldir"),toggle:!0}}),events:n.registry,destroy:b.noop}}});k("7j",["7","6u"],function(b,d){var c=b.curry(d.translate,"aria.label.editor");return{editor:function(a){return a.fold(b.identity,c)}}});k("61",["6","7","s"],function(b,d,c){return function(a){var e=function(a){var b=a+(-1===a.indexOf("?")?"?":"&")+"url=";return function(a){return c.some(b+encodeURIComponent(a))}};return{headers:function(){return b.merge(null===a.project.apiKey?{}:{headers:{"textbox-api-key":a.project.apiKey}},{xhrFields:{withCredentials:!0}})},
proxy:void 0===a.imageEdit.proxy?c.none:e(a.imageEdit.proxy),destroy:d.noop}}});k("lz",["48"],function(b){return{resolve:b.create("ephox-arcade").resolve}});k("do",["lz","b","1a","20"],function(b,d,c,a){var e="data-"+b.resolve("no-merge"),f="data-"+b.resolve("atomic");return{doNotMerge:function(b){a.isElement(b)&&c.set(b,e,"true")},shouldMerge:function(b){return a.isElement(b)&&!1===c.has(b,e)},setAtomic:function(b){a.isElement(b)&&c.set(b,f,"true")},isAtomic:function(b){return a.isElement(b)&&"true"===
c.get(b,f)},clear:function(b){a.isElement(b)&&d.each([e,f],function(a){c.remove(b,a)})}}});k("tw",["7","s","l","2m","29"],function(b,d,c,a,e){return{addAfter:function(f){return function(g,h){var l=h.all(),m=f(g,h);d.from(l[l.length-1]).each(function(d){e.nextSibling(d).fold(function(){var b=c.fromTag("p");a.append(b,c.fromTag("br"));a.after(d,b)},b.noop)});return m}}}});k("pj",["7"],function(b){return function(d,c,a,e){return{context:d,profile:c,action:a,label:b.constant(e)}}});k("11d","b xw sz l 2m 20 2o 46 29".split(" "),
function(b,d,c,a,e,f,g,h,l){var m=function(d){var f=l.owner(d);d=h.descendants(d,"td,th");b.each(d,function(b){c.needsCursor(b).each(function(c){e.append(b,a.fromTag("br",f.dom()))})})},n=function(a){c.vacate(a);c.needsCursor(a).each(function(b){g.remove(a)})};return{populate:function(b){c.vacate(b);c.needsCursor(b).each(function(b){var c=a.fromTag("span");d.forceAddBr(b,c)})},purge:function(a){("table"===f.name(a)?m:n)(a)}}});k("yc",["b","e4","11d","29"],function(b,d,c,a){var e=function(a,d){var e=
f(a),e=b.filter(e,d);b.each(e,c.purge)},f=function(b){var c=function(a){return[a]},d=a.prevSibling(b).map(c).getOr([]),c=a.nextSibling(b).map(c).getOr([]);return d.concat([b]).concat(c)};return{purge:function(a){e(a,d.isBlock)},purgeBy:e}});k("u3","yc b e4 2l 20 68 46 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a){b.purgeBy(a,function(a){var b=c.isBlock(a)||"li"===e.name(a)||"ol"===e.name(a)||"ul"===e.name(a);if("li"===e.name(a)){var d;if(!(d=0===g.descendants(a,"ul,ol").length)){d=
g.descendants(a,"ul,ol,li");var h=g.descendants(a,"*");a=f.descendants(a,e.isText);d=d.length===h.length&&0===a.length}a=d}else a=!0;return b&&a})};return{purge:m,purgeAll:function(a){var b=g.descendants(a,"ol,ul,li");d.each([a].concat(b),m)},nesting:function(b){b=("li"===e.name(b)?[b]:[]).concat(g.descendants(b,"li"));d.each(b,function(b){var c=l.children(b);d.exists(c,function(a){return e.isText(a)?0<h.get(a).length:!d.contains(["ol","ul"],e.name(a))})||a.set(b,"list-style-type","none")})}}});k("ye",
"54 7 s l 2m 2o 29".split(" "),function(b,d,c,a,e,f,g){var h=function(e,g){var h=a.fromText(b.zeroWidth());e(g,h);return c.some({element:d.constant(h),cleanup:function(){f.remove(h)},splits:d.constant([])})},l=function(a,b){return a.map(function(a){return{element:d.constant(a),cleanup:d.noop,splits:d.constant(void 0!==b?b:[])}})},m=function(a,b){return h(e.before,a)},n=function(a,b){return h(e.after,a)},p=function(a,b){return h(e.append,a)},q=function(a,b){return h(e.prepend,a)},r=function(a,b){return function(d,
e){return a(d,e).fold(function(){return b(d,e)},c.some)}},s=function(a,b,d){return l(c.some(b),void 0!==b&&void 0!==d?[{first:b.dom(),second:d.dom()}]:[])};return{before:{text:{none:c.none,start:r(function(a,b){return l(g.prevSibling(a))},m),middle:s,end:s},element:{hasPrevious:function(a,b){return l(g.child(a,b-1))},rightEdge:p,first:q,empty:m,otherwise:q}},after:{text:{none:c.none,start:s,middle:function(a,b,d){return l(c.some(d),void 0!==b&&void 0!==d?[{first:b.dom(),second:d.dom()}]:[])},end:r(function(a,
b){return l(g.nextSibling(a))},n)},element:{hasNext:function(a,b){return l(g.child(a,b+1))},rightEdge:p,first:q,empty:n,otherwise:p}}}});k("uf",["7","to","ye","9"],function(b,d,c,a){return{prefix:b.curry(d.prefix,c),postfix:b.curry(d.postfix,c)}});k("yu","7 s mk xy 2m 32 2o ei".split(" "),function(b,d,c,a,e,f,g,h){var l=function(b){return!f.descendant(b,function(b){return a.hasCursor(b,["hr","img"])})},m=function(a){var b=h.shallowAs(a,"p");e.before(a,b);g.remove(a);return d.some(b)};return{cleanup:function(a){var e=
a.second(),e=(c.isHeading(e)&&l(e)?m(e):d.none()).getOr(a.second());return{first:a.first,second:b.constant(e),mark:a.mark,splits:a.splits}}}});k("ud","54 b 8w d1 co 7 s lh e4 xw uf sy sz yu xx mk 1b l 2m 20 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,k,w,x,y,B){var z=function(a){return x.isElement(a)&&l.isInline(a)&&0===B.children(a).length},A=function(a){var c=k.fromText(b.zeroWidth());w.append(a,c);return c},C=function(a,b,c){return n.prefix(b,c).bind(function(b){var c=p.breakPath(b.element(),
t.stopAt(a));return c.second().map(function(d){return{first:f.constant(a),second:f.constant(d),mark:f.constant(b),splits:f.constant(c.splits().concat(b.splits()))}})})};return{soft:function(b,d,m){var n=function(a){var c;x.isText(a)?(c=y.get(a),c=-1===c.indexOf("\u00a0")&&0===c.trim().length):c=!1;return c?B.nextSibling(a).forall(n):!e.isStart(b,d)&&l.isBlock(a)},p=k.fromTag("br");h.atStartOf(b,d,p);B.nextSibling(p).fold(function(){return e.getEnd(b)===d&&t.findBlock(b,m).bind(a.lastCursor).fold(f.constant(!1),
function(a){var c="br"===x.name(a)?p:b;return u.eq(c,a)})},n)&&w.after(p,k.fromTag("br"));return g.some({start:f.constant(c.after(p)),finish:f.constant(c.after(p))})},hard:function(a,b,e,g,h){return C(a,b,e).map(r.cleanup).map(function(a){d.each([g.getOr(a.first()),a.second()],function(b){q.postprocess(b,a.mark().element(),h)});t.findValidHardBreak(a.second(),h).orThunk(function(){m.rootBr(a.second(),a.mark().element())});var b=s.plunge(a.second(),f.constant(!1)),b=z(b)?A(b):b;a.mark().cleanup();
return{start:f.constant(c.on(b,0)),finish:f.constant(c.on(b,0))}})},rupture:C}});k("uc",["8w","7","s","l","2m"],function(b,d,c,a,e){var f=function(a,b,e){return c.some({start:d.constant(a(b,e)),finish:d.constant(a(b,e))})};return{doubleBr:function(c){e.after(c,a.fromTag("br"));var d=a.fromTag("br");e.after(c,d);return f(b.after,d,0)},emptyParagraph:function(c){var d=a.fromTag("p"),l=a.fromTag("br");e.append(d,l);e.after(c,d);return f(b.on,l,0)}}});k("11e",[],function(){return{box:function(b){return[b]}}});
k("yv",["7","11e","mk"],function(b,d,c){return{processes:function(a){return{stopper:c.stopAt(a),wrapper:d.box,post:b.noop}}}});k("yw","b s 11e mk 35 20 2o 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,b,c){d.from(c[c.length-1]).each(function(a){e.append(a,m(h.children(b)));g.empty(b)})},m=function(c){return b.filter(c,function(b){return!(f.isElement(b)&&a.isList(b)&&0===h.children(b).length)})};return{processes:function(b){return{stopper:a.stopAt(b),wrapper:c.box,post:l}}}});k("yx","b 7 e4 xw sz mk 1a 2l l 2m 35 20 32 2o 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){var t=function(a,b){r.remove(a);return b},u=function(b,c){var d=l.fromTag("p");n.append(d,c);m.before(b,d);r.remove(b);e.needsCursor(d).each(function(b){a.forceAddBr(b,l.fromTag("span"))});return[d]},k=function(a){var d=s.children(a),d=(q.descendant(a,c.isFormatting)?t:u)(a,d);b.each(d,function(b){p.isElement(b)&&(g.transfer(a,b,["dir"]),h.transfer(a,b,["text-align"]))});return d};return{processes:function(a){return{stopper:f.stopAt(a),wrapper:k,post:d.noop}}}});
k("ue","b 8w 7 sy sz yv yw yx 35 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return{exit:function(p,q){return n.ancestor(p,"ol,ul",q).bind(function(r){var s=n.ancestor(r,"li,ol,ul",q).fold(function(){return h.processes(r)},function(a){return"li"===m.name(a)?g.processes(a):f.processes(r)}),t=a.breakPath(p,s.stopper);return t.second().map(function(a){var f=t.first(),g=s.wrapper(p);l.before(a,g);s.post(f,a,g);b.each([f,a],e.lists);return{start:c.constant(d.on(g[0],0)),finish:c.constant(d.on(g[0],
0))}})})}}});k("mj","s uc ud ue mk 2y".split(" "),function(b,d,c,a,e,f){var g=function(d,g,m,n){return f.closest(g,"li",n).fold(function(){return c.hard(d,g,m,b.none(),n)},function(d){d=e.exitList(d)?a.exit(d,n):c.hard(d,g,m,b.some(d),n);return d})};return{hard:function(a,f,m){return e.findValidHardBreak(a,m).fold(function(){return e.findAnchorBreak(a,m).fold(function(){return c.soft(a,f,m)},function(g){return!0===e.isRightEdge(g,a,f)?d.doubleBr(g):c.hard(g,a,f,b.none(),m)})},function(b){return g(b,
a,f,m)})},soft:c.soft,rupture:c.rupture}});k("ug",["33"],function(b){return b.immutable("cursor","blocks")});k("ml","b 8w 7 s uf sz ud mk ug tp 1b".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a,b,f,g){return e.postfix(a,b,f,g).map(function(e){var h=m.leftEdge(a,b,f,g);m.makeTo(h.element(),h.offset(),e.element()).deleteContents();return{start:c.constant(d.before(e.element())),finish:c.constant(d.before(e.element())),mark:e.element}})},q=function(a,b,c,d){return p(a,b,c,d).bind(function(a){return g.soft(a.mark(),
0)})},r=function(b,c,d,e,f){return p(b,c,d,e).bind(function(b){return h.findValidHardBreak(b.mark(),f).bind(function(c){return g.hard(c,b.mark(),0,a.none(),f)})})},s=function(a,c){b.each(a,function(a){f.postprocess(a,c)})};return{soft:q,hard:function(a,b,d,e,f){var g=h.findValidHardBreak(a,f),m=h.findValidHardBreak(d,f),k=g.fold(function(){var c=q(a,b,d,e);return l(c,[])},function(c){return m.fold(function(){var f=q(a,b,d,e);return l(f,[c])},function(g){var h=n.eq(c,g)?r(a,b,d,e,f):p(a,b,d,e);return l(h,
[c,g])})});return k.cursor().map(function(a){var b=k.blocks(),d;d=a.start().fold(c.identity,c.identity,c.identity);s(b,d);return a})},rupture:function(a,b,c,d,e){return p(a,b,c,d).bind(function(a){return h.findValidHardBreak(a.mark(),e).bind(function(b){return g.rupture(b,a.mark(),0)})})}}});k("yd","uf ud mj mk ml q".split(" "),function(b,d,c,a,e,f){return{point:function(a,b,d){return c.rupture(a,b,d)},range:function(a,b,c,d,f){return e.rupture(a,b,c,d,f)},ruptureUntil:function(c,e,l,m,n,p){var q=
b.postfix(c,e,l,m);return function(b,c){return a.findValidHardBreak(b,n).map(p).bind(function(a){return d.rupture(a,b,c)})}(c,e).bind(function(a){return q.map(function(b){var c=f.createRange();c.setStartAfter(a.first().dom());c.setEndBefore(b.element().dom());c.deleteContents();b.cleanup();a.mark().cleanup();return a.first()})})}}});k("tx","yc u3 b s lh yd 35 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(b,c,d){if(0<b.length){var f=b[0],h=b.slice(1);e.atStartOf(c,d,f);g.after(f,h);return a.some(b[b.length-
1])}return a.none()};return{split:function(e,l,p){var q=void 0===p?b.purge:p;return f.point(e.block(),e.element(),e.offset()).bind(function(b){var e=l.all();g.before(b.second(),e);b.mark().cleanup();q(b.first());q(b.second());c.each([b.first(),b.second()],d.nesting);b=c.reverse(e);b=c.find(b,function(a){return h.parent(a).isSome()});return a.from(b)})},merge:function(a,b){var c=h.children(b.single());return l(c,a.element(),a.offset())},nest:function(a,b){return l(b.all(),a.element(),a.offset())},
insertMany:l,insertChildren:function(a,b){var c=h.children(a);return l(c,b.element(),b.offset())},fallback:function(a,b,c){return l(c,b.startContainer(),b.startOffset())}}});k("tz",["b","7","s","2y"],function(b,d,c,a){return{lists:function(e){return b.foldr(e,function(b,c){return b.bind(function(b){return a.closest(c,"ol,ul").map(function(a){return[a].concat(b)})})},c.some([])).map(function(a){return{all:d.constant(a)}})},from:function(a){return{all:d.constant(a)}}}});k("u0","6 d1 7 s e4 33 1b 20 49 2y 9y 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p){var q=f.immutable("left","right"),r=function(a){return e.isFormatting(a)||e.isContainer(a)},s=function(a,b,c,d){return l.closest(c,a,b)},t=function(a){return function(b,c,d){return a(b,c.element(),c.offset()).bind(function(c){return a(b,d.element(),d.offset()).map(function(a){return q(c,a)})})}},u=function(a){var b=t(a);return function(a,c,d){return b(a,c,d).filter(function(a){return g.eq(a.left(),a.right())})}};return{inline:function(b,c,d){return l.closest(c,r,
b).fold(function(){return a.some(c)},function(d){return b(d)?a.some(c):a.none()})},formatter:c.curry(s,e.isFormatting),container:function(a,b,d){return l.closest(b,e.isContainer,a).filter(c.not(a))},inListItem:function(a,b,c){return m.closest(b,"li",a)},inList:function(a,b,c){return m.closest(b,"ol,ul",a)},inTableCell:function(a,b,c){return m.closest(b,"td,th",a)},setBlock:function(a,d){return b.deepMerge(a,{block:c.constant(d)})},both:t,shared:u,sharedPredicate:function(a){a=c.curry(s,a);return u(a)},
entireRoot:function(a,b,c){return l.closest(b.element(),a).filter(function(c){var e=function(a){return g.eq(a,b.element())};return a(b.element())&&0===b.offset()||h.isText(b.element())&&0===b.offset()&&d.firstCursor(c).map(e).getOr(!1)}).filter(function(b){var e=function(a){return g.eq(a,c.element())};return a(c.element())&&c.offset()>=p.children(b).length-1||h.isText(c.element())&&c.offset()>=n.get(c.element()).length&&d.lastCursor(b).map(e).getOr(!1)}).map(function(a){return q(a,a)})}}});k("ty",
"u3 tx tz u0 6e 46 2y".split(" "),function(b,d,c,a,e,f,g){return{insertOne:function(a,g){var m=f.children(g.single(),"li");return 1!==m.length||e.descendant(m[0],"ol,ul")?d.split(a,c.from(m),b.purge):d.insertChildren(m[0],a)},insertMany:function(c,e){return g.ancestor(c.block(),"ol,ul").bind(function(f){f=a.setBlock(c,f);return d.split(f,e,b.purgeAll)})}}});k("u1",["b","7","s","20"],function(b,d,c,a){var e=function(a){return function(b){return(1===b.length?c.some(b[0]):c.none()).filter(a).map(function(a){return{single:d.constant(a)}})}},
f=function(a){return function(e){var f=b.find(e,a);return(void 0!==f&&null!==f?c.some(e):c.none()).map(function(a){return{all:d.constant(a)}})}};return{oneOf:e,anyOf:f,noneOf:function(a){return function(e){var f=b.find(e,a);return(void 0===f||null===f?c.some(e):c.none()).map(function(a){return{all:d.constant(a)}})}},allOf:function(a){return function(e){return b.forall(e,a)?c.some({all:d.constant(e)}):c.none()}},any:c.some,oneOfTag:function(b){return e(function(c){return a.name(c)===b})},anyOfTag:function(b){return f(function(c){return a.name(c)===
b})},single:function(a){return c.some({single:d.constant(a)})},all:function(a){return c.some({all:d.constant(a)})}}});k("u2","b 7 s e4 20 46 2y".split(" "),function(b,d,c,a,e,f,g){var h=function(a){return 1===a.length?g.closest(a[0],"ol,ul").map(function(a){return{single:d.constant(a)}}):c.none()};return{list:h,listItem:function(a){return h(a).bind(function(a){a=f.descendants(a.single(),"li");return 1===a.length?c.some({single:d.constant(a[0])}):c.none()})},partialList:function(f){if(2!==f.length)return c.none();
var g=f[0],h=f[1];if(a.isFormatting(g)||a.isContainer(g)||b.contains(["ol","ul","li"],e.name(g))||!b.contains(["ol","ul"],e.name(h)))return c.none();e.name(h);return c.some({all:d.constant(f),list:d.constant(h),inline:d.constant(g)})}}});k("m2","tw pj do tx ty tz u0 u1 u2 7 e4".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=g.formatter,q=g.inline,r=g.container,s=function(a){return n.isFormatting(a)&&!1===c.shouldMerge(a)};b=[d(g.inListItem,l.list,e.insertOne,"List"),d(g.inListItem,f.lists,e.insertMany,
"Many lists"),d(q,h.anyOf(s),a.nest,"Copying formatting (NO MERGE) into root"),d(q,h.oneOf(n.isFormatting),a.merge,"Copying formatting into root"),d(p,h.anyOfTag("hr"),a.split,"insert hr into formatter"),d(p,h.anyOf(s),a.split,"Copying one formatting block (NO MERGE) into formatting"),d(p,h.oneOf(n.isFormatting),a.merge,"Copying one formatting block into formatting"),d(p,h.anyOf(n.isFormatting),a.split,"Copying many formatting blocks into formatting"),d(p,h.anyOfTag("table"),b.addAfter(a.split),"Copying tables into formatting"),
d(p,h.anyOf(n.isContainer),a.split,"Copying container blocks into formatting"),d(r,h.all,a.nest,"Fallback pasting into container.")];return{context:function(a,b,c){return b.context(a.isRoot,c.startContainer(),c.startOffset()).map(function(a){return{block:m.constant(a),element:c.startContainer,offset:c.startOffset}})},rules:m.constant(b),fallback:a.fallback}});k("u4",["7","du","kq"],function(b,d,c){return{force:function(a){var e=c.after(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()),
f=e?d.point(a.endContainer(),a.endOffset()):d.point(a.startContainer(),a.startOffset());a=e?d.point(a.startContainer(),a.startOffset()):d.point(a.endContainer(),a.endOffset());return{left:b.constant(f),right:b.constant(a)}}}});k("u5","yc b d1 7 s e4 yd uf tp 1b l 2m 35 20 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){var u=function(a,b){var c=a.original(),d=h.postfix(c.left().element(),c.left().offset(),c.right().element(),c.right().offset()),f=b.all();return d.bind(function(b){l.makeTo(c.left().element(),
c.left().offset(),b.element()).deleteContents();b.cleanup();q.append(a.left(),f);b=t.children(a.right());q.append(a.left(),b);s.remove(a.right());return e.from(f[f.length-1])})},k=function(a,b){if(!m.eq(a.left(),a.right()))throw"replaceContents used in the wrong context";var d=a.left();s.empty(d);var f=b.all();q.append(d,f);return c.lastCursor(d).or(e.from(f[f.length-1]))};return{replace:function(a,b){if(m.eq(a.left(),a.right())){var c=b.all();a.canvas().replaceSelection(c);return e.from(c[c.length-
1])}return u(a,b)},replaceContents:k,replaceContentsWrapP:function(b,c){var d=n.fromTag("p");q.append(d,c.all());return k(b,{all:a.constant([d])})},replaceWhole:function(a,b){var c=b.all();q.after(a.left(),c);s.remove(a.left());return e.from(c[c.length-1])},merge:function(a,b){var c=t.children(b.single());a.canvas().replaceSelection(c);return e.from(c[c.length-1])},split:function(a,c,f){var h=void 0===f?b.purge:f;f=a.original().left();var l=a.original().right();return g.range(f.element(),f.offset(),
l.element(),l.offset(),a.canvas().isRoot).bind(function(a){var b=c.all();q.before(a.second(),b);a.mark().cleanup();d.each([a.first(),a.second()],h);return e.from(b[b.length-1])})},fallback:function(a,c,d){a.replaceSelection(d);e.from(d[0]).each(b.purge);e.from(d[d.length-1]).each(b.purge);return e.from(d[d.length-1])}}});k("u6","s l 2m 35 20 2y 29".split(" "),function(b,d,c,a,e,f,g){return{insertAll:function(c,d){var e=d.all();a.after(c,e);return b.from(e[e.length-1])},insertChildren:function(c,d){var e=
g.children(d.single());a.after(c,e);return b.some(e[e.length-1])},insertSingle:function(a,d){c.after(a,d.single());return b.some(d.single())},insertFlat:function(e,f){var g=d.fromTag("li");a.append(g,[f.inline(),f.list()]);c.after(e,g);return b.some(f.list())},insertNested:function(g,l){var m=d.fromTag("li");a.append(m,[l.inline(),l.list()]);var n=f.ancestor(g,"ol,ul").fold(function(){var a=d.fromTag(e.name(l.list()));c.append(a,m);return a},function(){return m});c.after(g,n);return b.some(l.list())}}});
k("u7","u3 b 7 yd 46 29".split(" "),function(b,d,c,a,e,f){var g=function(b,d,e,f){f=void 0!==f?f:c.identity;var g=d.original(),r=g.left(),g=g.right();return a.ruptureUntil(r.element(),r.offset(),g.element(),g.offset(),d.canvas().isRoot,f).bind(function(a){var c=b(a,e);h(a);return c},void 0!==f?f:c.identity)},h=function(a){var c=e.ancestors(a,"ol,ul");0<c.length&&d.each([b.purgeAll,b.nesting],function(a){a(c[c.length-1])})};return{postprocess:h,onList:function(a,b,c){return g(a,b,c,function(a){return f.parent(a).getOr(a)})},
onItem:function(a,b,d){return g(a,b,d,c.identity)}}});k("m3","pj do u3 u0 u1 u4 u2 u5 u6 u7 7 e4 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=a.formatter,s=n.curry(m.onItem,l.insertSingle),t=n.curry(m.onList,l.insertAll),u=n.curry(m.onItem,l.insertChildren),k=n.curry(m.onItem,l.insertFlat);l=n.curry(m.onItem,l.insertNested);b=[b(a.sharedPredicate(d.isAtomic),e.all,h.replaceWhole,"selection: inside something atomic, so just replace the whole thing"),b(a.shared(a.inListItem),g.listItem,
function(a,b){return h.merge(a,b)},"selection: same item, paste: singleton"),b(a.shared(a.inListItem),g.list,function(a,b){return h.split(a,{all:n.constant(q.children(b.single()))},c.purgeAll)},"selection: same item, paste: single list"),b(a.shared(a.inListItem),g.partialList,l,"selection: same item, paste: partial"),b(a.shared(a.inListItem),e.noneOf(p.isBlock),h.replace,"selection: same item, paste: no blocks"),b(a.shared(a.inListItem),e.all,t,"selection: same item, paste: any"),b(a.both(a.inListItem),
g.listItem,s,"selection: diff items, paste: singleton"),b(a.both(a.inListItem),g.list,u,"selection: diff items, paste: single list"),b(a.both(a.inListItem),g.partialList,k,"selection: diff items, paste: partial"),b(a.both(a.inListItem),e.all,t,"selection: diff items, paste: any"),b(a.both(r),e.anyOfTag("hr"),h.split,"selection: inside formatter, paste: split"),b(a.both(r),e.noneOf(p.isBlock),h.replace,"range no blocks"),b(a.both(r),e.anyOf(function(a){return p.isFormatting(a)&&!1===d.shouldMerge(a)}),
h.split,"range 1 formatting block"),b(a.both(r),e.oneOf(p.isFormatting),h.merge,"range 1 formatting block"),b(a.both(r),e.all,h.split,"range anything > formatters"),b(a.entireRoot,e.noneOf(p.isBlock),h.replaceContentsWrapP,"complete body, not inserting a block: wrap in P and replace the contents"),b(a.entireRoot,e.all,h.replaceContents,"complete body: replace the contents")];return{context:function(a,b,c){var d=f.force(c);return b.context(a.isRoot,d.left(),d.right()).map(function(b){return{left:b.left,
right:b.right,original:n.constant(d),canvas:n.constant(a)}})},rules:n.constant(b),fallback:h.fallback}});k("dw","m2 m3 b co 7 s du".split(" "),function(b,d,c,a,e,f,g){var h=function(a,b,d,g,h){return c.foldl(a,function(a,c){return a.orThunk(function(){return g(b,c,d).bind(function(a){return c.profile(h).map(function(b){return{action:c.action,target:e.constant(b),ctx:e.constant(a)}})})})},f.none())},l=function(b){var c=a.getEnd(b);return g.point(b,c)},m=function(a,c,e,f,g,m){var u={getSelection:a,
replaceSelection:c,isRoot:e};return u.getSelection().bind(function(a){var c=a.collapsed()?b:d,e=a.collapsed()?g.concat(c.rules()):m.concat(c.rules());return h(e,u,a,c.context,f).fold(function(){return c.fallback(u,a,f)},function(a){return a.action(a.ctx(),a.target())}).map(l)})};return{insertAtCursor:function(a,b,c,d){return m(a,b,c,d,[],[])},insertAtCursorWith:m}});k("8x","do dw b dp 8w ap s k 1a 20 49".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a){return m.isElement(a)&&"false"===
l.get(a,"contenteditable")},q=function(a){return a().map(function(a){a=c.map([a.startContainer(),a.endContainer()],function(a){return n.closest(a,p)});return h.cat(a)}).getOr([])},r=function(a,d,e){c.each(a,d);d=e();c.each(a,b.clear);return d},s=function(a,c){return r(a,b.setAtomic,c)},t=function(a,b,c,e,f,g){var h=q(a);return s(h,function(){return d.insertAtCursorWith(a,b,c,e,f,g)})},u=function(a,b,c,d){b=t(a.getSelection,a.replaceSelection,a.isRoot,b,c,d);a.domChanged();a.undoChanged();return b},
k=function(a,b){return u(a,b,[],[])};return{insertAtCursorWith:u,insertAtCursor:k,insertAtCursorWithInstructions:function(a,b,c){return r(c,a,function(){return k(b,c)})},insertAt:function(b,c,d){d=t(function(){return g.some(c)},function(d){b.win().each(function(b){var g=a.write(e.on(c.startContainer(),c.startOffset()),e.on(c.endContainer(),c.endOffset()));f.replaceRange(b,g,d)})},b.isRoot,d,[],[]);b.domChanged();b.undoChanged();return d}}});k("dx",["b","7","m4","2d"],function(b,d,c,a){return{toText:function(a){return b.map(a,
function(a){return c.toText(a,d.constant(!1))}).join("").trim()},toHtml:function(c){return b.map(c,a.getOuter).join("")}}});k("42",["7"],function(b){return{styleSpan:b.constant("ephox-hare-style-span"),base:b.constant("ephox-candy-mountain"),active:b.constant("ephox-candy-mountain-active")}});k("yf","b c 42 7 4x 3z 1a 1x 1b 3n l 2v 2d 49 q 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t){var u=d.detect();return function(d){var k="true"===g.get(d,"contenteditable");g.set(d,"contenteditable",
"true");var x=m.bind(d,"keydown",function(a){M.trigger.keydown(a)}),y=m.bind(d,"keyup",function(a){M.trigger.keyup(a)}),B=m.bind(d,"keypress",function(a){M.trigger.keypress(a)}),z=m.bind(d,"mousedown",function(a){M.trigger.mousedown(a)}),A=m.bind(d,"mouseout",function(a){M.trigger.mouseout(a)}),C=m.bind(d,"mouseup",function(a){M.trigger.mouseup(a)}),D=m.bind(d,"contextmenu",function(a){M.trigger.contextmenu(a)}),E=m.bind(d,"cut",function(a){M.trigger.cut(a)}),F=m.bind(d,"copy",function(a){M.trigger.copy(a)}),
G=m.bind(d,"paste",function(a){M.trigger.paste(a)}),I=u.browser.isFirefox()?"focus":"focusin",H=m.bind(d,I,function(a){M.trigger.focus(a)}),L=m.bind(d,"focusout",function(a){M.trigger.focusOut(a)}),J=m.bind(d,"dblclick",function(a){M.trigger.dblclick(a)}),K=function(a){return l.eq(d,a)},M=f.create({keydown:e(["original"]),keyup:e(["original"]),keypress:e(["original"]),mousedown:e(["original"]),mouseup:e(["original"]),mouseout:e(["original"]),contextmenu:e(["original"]),cut:e(["original"]),copy:e(["original"]),
paste:e(["original"]),focus:e(["original"]),dblclick:e(["original"]),focusOut:e(["original"])});return{win:a.constant(t),doc:a.constant(n.fromDom(s)),body:a.constant(d),get:function(){return q.get(d)},set:function(a){d.dom().innerHTML=a},focus:function(){u.browser.isIE()||u.browser.isSpartan()?d.dom().setActive(!0):p.focus(d)},focused:function(){return s.activeElement===d.dom()},blur:function(){d.dom().blur()},destroy:function(){k||g.remove(d,"contenteditable");b.each([x,y,B,z,C,A,D,E,F,G,H,L,J],
function(a){a.unbind()})},events:M.registry,background:a.noop,foreground:a.noop,hasRange:function(a){return r.closest(a.startContainer(),K).isSome()&&r.closest(a.endContainer(),K).isSome()},isActive:function(){return h.has(d,c.active())}}}});k("zb",["d1","s","29"],function(b,d,c){var a=function(a,b,c){a=a.createRange();a.selectNode(b.dom());a.collapse(c);return a},e=function(c,d,e){var f=c.createRange();f.selectNode(d.dom());var f=f.getBoundingClientRect(),n=e-f.left<f.right-e;return(n?b.firstCursor:
b.lastCursor)(d).map(function(b){return a(c,b,n)})},f=function(b,c,e){var f=c.dom().getBoundingClientRect();return d.some(a(b,c,e-f.left<f.right-e))};return{search:function(a,b,d){return(0===c.children(b).length?f:e)(a,b,d)}}});k("12e",["1r"],function(b){return{inRect:function(b,c,a){return c>=b.left&&c<=b.right&&a>=b.top&&a<=b.bottom},searchForPoint:function(d,c,a,e,f){if(0===f)return 0;if(c===e)return f-1;for(var g=1;g<f;g++){var h=d(g),l=b.abs(c-h.left);if(!(a>h.bottom)){if(a<h.top||l>e)return g-
1;e=l}}return 0}}});k("zc","12e s k 33 20 9y 29 1r".split(" "),function(b,d,c,a,e,f,g,h){var l=a.immutable("node","doc","x","y","fullrect"),m=function(a){var c=function(b){var c=a.doc().createRange();c.setStart(a.node().dom(),b);c.collapse(!0);return c},d=f.get(a.node()).length,e=a.x(),g=a.y(),h=a.fullrect().right,d=b.searchForPoint(function(a){return c(a).getBoundingClientRect()},e,g,h,d);return c(d)},n=function(a,e,f,g){var h=a.createRange();h.selectNode(e.dom());h=h.getClientRects();return c.findMap(h,
function(a){return b.inRect(a,f,g)?d.some(a):d.none()}).map(function(b){return l(e,a,f,g,b)})},p=function(a,f,h,l){if(e.isText(f))return n(a,f,h,l);var m=a.createRange();f=g.children(f);return c.findMap(f,function(c){m.selectNode(c.dom());return b.inRect(m.getBoundingClientRect(),h,l)?p(a,c,h,l):d.none()})};return{search:function(a,b,c,d){var e=a.createRange();e.selectNode(b.dom());e=e.getBoundingClientRect();c=h.max(e.left,h.min(e.right,c));d=h.max(e.top,h.min(e.bottom,d));return p(a,b,c,d).map(m)}}});
k("uw",["zb","zc","s","l","29"],function(b,d,c,a,e){return{searchForRange:function(f,g,h){return c.from(f.elementFromPoint(g,h)).map(a.fromDom).bind(function(a){var c=function(){return b.search(f,a,g)};return 0===e.children(a).length?c():d.search(f,a,g,h).orThunk(c)})}}});k("nn",["dp","uw","s","q"],function(b,d,c,a){var e=function(a,b,d){return c.from(a.caretPositionFromPoint(b,d)).bind(function(b){if(null===b.offsetNode)return c.none();var d=a.createRange();d.setStart(b.offsetNode,b.offset);d.collapse();
return c.some(d)})},f=function(a,b,d){return c.from(a.caretRangeFromPoint(b,d))},g=a.caretPositionFromPoint?e:a.caretRangeFromPoint?f:d.searchForRange;return{find:function(a,c,d){return g(a.document,c,d).map(b.writeFromNative)}}});k("fv",["nn"],function(b){return{find:b.find}});k("11f","c fv dp 8w ap 7 i7 4g l 2v 2m 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=f.constant(!1);b=b.detect();var s=b.browser.isIE()||b.browser.isSpartan(),t=s?2:5,u=h.generate([{above:["element"]},{below:["element"]}]),
k=function(a,b,c){return function(b){return e.bounds(a,b).fold(r,c)}},w=function(a,b){return k(a,b,function(a){return b>a.top+a.height-t})},x=function(a,b){return k(a,b,function(a){return b<a.top+t})};return function(b,h){var r=function(a){var c=g.freefallRtl(h).element();return q.ancestor(c,"table").filter(w(b,a)).map(u.above)},t=function(a,c){a.kill();e.set(b,c)};return function(e){var k=s?function(){if("html"===p.name(e.target())){var a=e.x(),c=e.y();d.find(b,a,c).each(function(a){m.focus(h);t(e,
a)})}}:f.noop,v=e.y();r(v).orThunk(function(){var a=g.freefallLtr(h).element();return q.ancestor(a,"table").filter(x(b,v)).map(u.below)}).fold(k,function(b){var d=l.fromHtml("<p><br/></p>");b.fold(function(a){n.after(a,d)},function(a){n.before(a,d)});t(e,c.write(a.on(d,0),a.on(d,0)))})}}});k("11l",["dp","ap","il"],function(b,d,c){return{clearAll:function(a){d.clearAll(a)},get:function(a){return d.get(a).map(function(a){return c(a.start(),a.soffset(),a.finish(),a.foffset())})},set:function(a,b){d.setExact(a,
b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())},setExact:function(a,b,c,g,h){d.setExact(a,b,c,g,h)},setRelative:function(a,c,f){c=b.write(c,f);d.set(a,c)},replace:function(a,b){d.replace(a,b)}}});k("11g",["11l","4x","3z","65","3m"],function(b,d,c,a,e){return function(f){var g=null,h=function(){g=null;b.get(f.win()).each(function(a){a.collapsed()&&f.focused()&&l.trigger.loiter(a.startContainer(),a.startOffset())})},l=c.create({loiter:d(["node","offset"])});return{reset:function(){null!==
g&&(a(g),g=null);g=e(h,1E3)},destroy:function(){null!==g&&(a(g),g=null)},events:l.registry}}});k("11h","s dv 4x 3z 1b 20".split(" "),function(b,d,c,a,e,f){return function(g){var h=b.none(),l=d.tap(function(){l.control.block();var a=g();a.each(function(a){var b=function(){m.trigger.nodeChanged(a.startContainer(),a.startOffset(),h.map(function(a){return a.startContainer()}))};h.fold(b,function(c){var d=e.eq,g=a.startContainer(),h=a.endContainer(),l=c.startContainer(),m=c.endContainer(),n=c.startOffset()!==
a.startOffset();c=c.endOffset()!==a.endOffset();(!d(l,g)||!d(m,h)||!f.isText(g)&&n||!f.isText(h)&&c)&&b()})});h=a;l.control.unblock()}),m=a.create({nodeChanged:c(["node","offset","prev"])});return{update:function(){l.instance()},clear:function(){h=b.none()},events:m.registry}}});k("11i",["7","1b","l","2v"],function(b,d,c,a){var e=function(c,e){return{toEditor:c,toOld:b.curry(a.focus,e),isSet:function(){return a.active().exists(function(a){return d.eq(a,e)})}}},f=function(a,d,f,m){m=m.dom().activeElement;
return a()?{toEditor:d,toOld:b.noop,isSet:b.constant(!0)}:void 0===m||null===m?{toEditor:f,toOld:b.noop,isSet:b.constant(!1)}:e(f,c.fromDom(m))};return{build:f,toEditor:function(a,b,c,d){f(a,b,c,d).toEditor()}}});k("11j",["s"],function(b){return function(){var d=b.none();return{get:function(){return d},restore:function(b){d.each(b)},update:function(b){d=b.or(d)},clear:function(){d=b.none()}}}});k("11k",["8w","11l","6e","2y"],function(b,d,c,a){var e=function(a){return c.closest(a.startContainer(),
'[contenteditable="false"]')&&c.closest(a.endContainer(),'[contenteditable="false"]')};return{focus:function(c,g,h){g=g().filter(e);g.each(function(e){a.closest(e.endContainer(),'[contenteditable="false"]').each(function(a){d.setRelative(c.win(),b.after(a),b.after(a))})});c.focus();g.each(function(a){h(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})}}});k("yg","c 11f 11g 11h 11i 11j 11k 11l i7 4x 3z 40 3d 3n l 28 o q 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,k,
w){var x=b.detect();return function(b){var t=function(){return J().orThunk(C.get)},z=r.bind(b.body(),"click",d(b.win(),b.body())),A=a(t),C=f(),D=function(){A.update();L()},E=function(){C.restore(function(a){K(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})};A.events.nodeChanged.bind(function(a){N.trigger.nodeChanged(a.node(),a.offset(),a.prev());N.trigger.uiStale()});b.events.keyup.bind(function(a){N.trigger.keyup(a.original());D();F.reset();N.trigger.interaction()});b.events.mouseout.bind(function(a){L()});
b.events.mouseup.bind(function(a){N.trigger.mouseup(a.original());D();F.reset();N.trigger.interaction()});var F=c(b);F.events.loiter.bind(function(a){N.trigger.loiter(a.node(),a.offset())});var G=function(){J().isNone()?E():L()},I=function(){b.isActive()&&(G(),g.focus(b,t,Q))},H=function(){N.trigger.domChanged()},L=function(){var a=J();C.update(a)},J=function(){return h.get(w).filter(b.hasRange)},K=function(a,b,c,d){try{h.setExact(w,a,b,c,d)}catch(e){u.log("Skipping restoring invalid cursor position")}},
M=function(a){P(function(c){b.isActive()&&a();D()},e.build(b.focused,G,I,s.fromDom(k)))},Q=function(a,b,c,d){M(function(){K(a,b,c,d)})},R=function(a,b){var c=h.get(w);E();var d=a(b);b.toOld();c.each(function(a){K(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset());x.browser.isSpartan()&&(b.isSet()||b.toOld())});return d},P=function(a,b){var c=a(b);b.toOld();return c},O=function(a){var c=e.build(b.focused,G,I,s.fromDom(k));return(J().isSome()?P:R)(a,c)},V=function(a){return function(){var b=
arguments;return O(function(c){c.toEditor();return a(b)})}}(function(a){k.execCommand.apply(k,a);L()}),U=function(a,b){return q(a,b)},N=n.create({nodeChanged:m(["node","offset","prev"]),loiter:m(["node","offset"]),uiStale:m([]),domChanged:m([]),interaction:m([]),keyup:m(["original"]),mouseup:m(["original"]),keydown:p(["original"],b.events.keydown),keypress:p(["original"],b.events.keypress),mousedown:p(["original"],b.events.mousedown),contextmenu:p(["original"],b.events.contextmenu),cut:p(["original"],
b.events.cut),copy:p(["original"],b.events.copy),paste:p(["original"],b.events.paste),focus:p(["original"],b.events.focus),focusOut:p(["original"],b.events.focusOut),dblclick:p(["original"],b.events.dblclick)});return{win:b.win,doc:b.doc,body:b.body,canvas:b.body,getContent:b.get,setContent:b.set,resetContent:function(a){b.set(a);C.clear();A.clear();a=l.freefallLtr(b.body());Q(a.element(),a.offset(),a.element(),a.offset());H()},blur:b.blur,focus:function(){e.toEditor(b.focused,G,I,s.fromDom(k))},
uiChanged:function(){O(function(){N.trigger.uiStale()})},domChanged:H,clearSelection:function(){h.clearAll(w)},getSelection:t,setSelection:Q,setRelativeSelection:function(a,b){M(function(){h.setRelative(w,a,b)})},backupSelection:L,replaceSelection:function(a){J().fold(function(){E();J().each(function(){h.replace(w,a);D()})},function(b){h.replace(w,a);D()})},execCommand:V,destroy:function(){b.destroy();F.destroy();z.unbind()},events:N.registry,background:b.background,foreground:b.foreground,translateScreen:U,
translateLocation:U}}});k("11m",["2m"],function(b){return{setCss:function(d,c,a){d.dom().styleSheet?d.dom().styleSheet.cssText=c:b.append(d,a)}}});k("148",[],function(){return{escape:function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}});k("11n",["1n","148","5z"],function(b,d,c){var a=function(a,b,g){b=new c("url\\(\\s*['\"]?"+d.escape(b)+"(.*?)['\"]?\\s*\\)","g");return a.replace(b,'url("'+g+'$1")')};return{replace:a,replaceMany:function(c,d){var g=c;b.each(d,function(b,c){g=a(g,c,b)});
return g}}});k("yl","1a l 2m 2y 11m 11n 9".split(" "),function(b,d,c,a,e,f,g){return{stylesheets:function(a){a=a.dom().styleSheets;return g.prototype.slice.call(a)},inject:function(g,l,m){var n=d.fromTag("style",m.dom());b.set(n,"type","text/css");g=void 0===l?g:f.replaceMany(g,l);e.setCss(n,g,d.fromText(g,m.dom()));m=a.descendant(m,"head").getOrDie();c.append(m,n)}}});k("yh",["b","33","1b","4s","yl"],function(b,d,c,a,e){var f=d.immutable("doc","css"),g=d.immutable("doc","href");return function(){var d=
[],l=[],m=function(a,b){return function(d){return c.eq(a,d.doc())&&b===d.css()}},n=function(a,b){return function(d){return c.eq(a,d.doc())&&b===d.href()}};return{addCssIfMissing:function(a,c){b.find(d,m(a,c))||(d.push(f(a,c)),e.inject(c,{},a))},addLinkIfMissing:function(c,d){b.find(l,n(c,d))||(l.push(g(c,d)),a.addStylesheet(d,c))}}}});k("yi",["b","9"],function(b,d){return function(){var c=null,a=[],e=function(){return null!==c},f=function(){b.each(a,function(a){g(a)})},g=function(a){setTimeout(function(){a.apply(null,
c)},0)};return{get:function(b){e()?g(b):a.push(b)},set:function(){c=d.prototype.slice.call(arguments);f();a=[]},isSet:e}}});k("u8","b yf yg yh yi 7 1a 2l l 2d 20 2o 29 5z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=a();return function(a){var u=l.fromTag("div");h.set(u,"display","none");var k=m.get(a),w=f.die("content base URL not supported for inline editing"),x=e(),y=d(a),B=c(y);x.set(B);return{element:function(){return a},onCanvas:function(a){a(B.canvas())},initial:f.constant(k),placeholder:function(){return u},
tabindex:function(b){g.set(a,"tabindex",b)},teardown:function(b){m.set(a,b)},injectCss:function(b){var c=q.owner(a);s.addCssIfMissing(c,b)},injectLinks:function(c){var d=q.owner(a);b.each(c,function(a){s.addLinkIfMissing(d,a)})},destroy:function(){p.remove(u);B.destroy()},loaded:x.get,extract:function(b){var c=n.name(a),d=new r("^<"+c+" .*?>",""),c=new r("<\\/"+c+">$","");return b.replace(d,"").replace(c,"")},isInline:f.constant(!0),setContentBase:w}}});k("11o",["7"],function(b){return function(d,
c){var a=d.doc();return{execCommand:function(d){var f=arguments,g=d.toLowerCase(),h=b.die("This should not be in hare."),h={fontsize:h,forecolor:h,fontname:h,bgcolor:h,inserthtml:h,blockquote:h};(void 0!==h[g]?h[g]:function(){a.dom().execCommand.apply(a.dom(),f)})();c.update()}}}});k("11p",["11k","il","11l","7","6e"],function(b,d,c,a,e){return function(e){var g=function(){return c.get(e.win())},h=function(a,b,g,h){a=d(a,b,g,h);c.set(e.win(),a)};return{clearSelection:function(){c.clearAll(e.win())},
getSelection:g,replaceSelection:function(a){c.replace(e.win(),a)},setSelection:h,setRelativeSelection:function(a,b){c.setRelative(e.win(),a,b)},restore:a.noop,backup:a.noop,nativeCall:a.apply,focus:function(){b.focus(e,g,h)},destroy:a.noop,clear:a.noop}}});k("11q","il 11l 7 s 3n 2v o q".split(" "),function(b,d,c,a,e,f,g,h){var l=function(){g.log("The previous selection could not be restored. Defaulting to the current selection.")};return function(g,n){var p=a.none(),q=e.bind(n,"blur",function(a){r()}),
r=function(){d.get(g.win()).fold(c.noop,function(b){p=a.some(b)})},s=function(b,c){try{c(g.win(),b),p=a.some(b)}catch(d){l()}},t=function(a){s(a,d.set)},u=function(){p.each(t)},k=function(a){var b=h.activeElement;a=a();null!==b&&void 0!==b&&b!==h.activeElement&&void 0!==b.focus&&b.focus();return a};return{clearSelection:function(){f.hasFocus(n)&&d.clearAll(g.win())},getSelection:function(){return f.hasFocus(n)?d.get(g.win()):p},replaceSelection:function(a){f.hasFocus(n)||u();d.replace(g.win(),a)},
setSelection:function(a,d,e,g){k(function(){var h=b(a,d,e,g);f.hasFocus(n)?t(h):s(h,c.noop)})},setRelativeSelection:function(a,b){k(function(){try{d.setRelative(g.win(),a,b)}catch(c){l()}r()})},restore:u,backup:r,nativeCall:function(a){return k(function(){f.hasFocus(n)||u();return a()})},focus:function(){if(h.activeElement!==n.dom()){var a=p;g.focus();a.each(t)}else d.get(g.win()).fold(u,c.noop)},destroy:function(){q.unbind()},clear:function(){p=a.none()}}}});k("yj","c 11f 11g 11h 11o 11p 11q gy i7 4x 3z 40 3n 3e 28".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t,u){var k=b.detect(),w=k.browser.isIE()||k.browser.isSpartan()?g(t,u):f(t),x=q.bind(t.doc(),"click",d(t.win(),t.body())),y=function(){return w.getSelection()},B=a(y),z=e(t,B);(k.browser.isChrome()||k.browser.isSafari())&&z.execCommand("defaultParagraphSeparator",!1,"p");B.events.nodeChanged.bind(function(a){G.trigger.nodeChanged(a.node(),a.offset(),a.prev());G.trigger.uiStale()});t.events.keyup.bind(function(a){w.backup();B.update(a)});var A=
h(B.update,300);t.events.mouseup.bind(function(a){w.backup();A.throttle(a)});var C=c(t);C.events.loiter.bind(function(a){G.trigger.loiter(a.node(),a.offset())});k=function(){C.reset();G.trigger.interaction()};t.events.keyup.bind(k);t.events.mouseup.bind(k);var D=function(){G.trigger.domChanged()},E=function(a,b,c,d){w.setSelection(a,b,c,d);B.update()},F=function(a,b){return r.absolute(u).translate(a,b)},G=n.create({nodeChanged:m(["node","offset","prev"]),loiter:m(["node","offset"]),uiStale:m([]),
domChanged:m([]),interaction:m([]),keydown:p(["original"],t.events.keydown),keyup:p(["original"],t.events.keyup),keypress:p(["original"],t.events.keypress),mousedown:p(["original"],t.events.mousedown),mouseup:p(["original"],t.events.mouseup),contextmenu:p(["original"],t.events.contextmenu),cut:p(["original"],t.events.cut),copy:p(["original"],t.events.copy),paste:p(["original"],t.events.paste),focus:p(["original"],t.events.focus),focusOut:p(["original"],t.events.focusOut),dblclick:p(["original"],t.events.dblclick)});
return{win:t.win,doc:t.doc,body:t.body,canvas:t.doc,getContent:t.get,setContent:t.set,resetContent:function(a){t.set(a);w.clear();B.clear();a=l.freefallLtr(t.body());E(a.element(),a.offset(),a.element(),a.offset());D()},blur:t.blur,focus:function(){w.focus()},uiChanged:function(){G.trigger.uiStale()},domChanged:D,clearSelection:function(){w.clearSelection()},getSelection:y,setSelection:E,setRelativeSelection:function(a,b){w.setRelativeSelection(a,b);B.update()},backupSelection:function(){w.backup()},
replaceSelection:function(a){w.replaceSelection(a);B.update()},execCommand:function(){var a=arguments;w.nativeCall(function(){z.execCommand.apply(null,a);G.trigger.uiStale()})},destroy:function(){w.destroy();t.destroy();C.destroy();x.unbind()},events:G.registry,background:t.background,foreground:t.foreground,translateScreen:F,translateLocation:function(a,b){var c=s.get(t.doc());return F(a,b).translate(-c.left(),-c.top())}}}});k("14v",["7","gy","s","3n"],function(b,d,c,a){return function(e){return{background:b.noop,
foreground:b.noop,focus:b.noop,keydown:b.noop,mousedown:c.some,mouseup:c.some,contextmenu:c.some,selectionchange:function(b,c){var e=d(b,300);return a.bind(c,"selectionchange",e.throttle)}}}});k("15b",["7","28"],function(b,d){return{unbound:function(){return{unbind:b.noop}},saveScroll:function(b,a){var e=d.get(b);a();var f=d.get(b);e.top()===f.top()&&e.left()===f.left()||b.dom().defaultView.scrollTo(e.left(),e.top())}}});k("14w","15b 7 s l 29 q 31".split(" "),function(b,d,c,a,e,f,g){return function(g){return{background:d.noop,
foreground:d.noop,focus:function(c,d,g){b.saveScroll(a.fromDom(f),function(){b.saveScroll(e.owner(g),function(){g.dom().focus()})})},keydown:d.noop,mousedown:c.some,mouseup:c.some,contextmenu:c.some,selectionchange:b.unbound}}});k("14x",["15b","7","s","20","29"],function(b,d,c,a,e){return function(f){var g=function(b){return"body"===a.name(b.target())||"html"===a.name(b.target())?c.none():c.some(b)};return{background:function(a,b,c){e.owner(b).dom().defaultView.focus()},foreground:function(a,b,c){void 0!==
a.focus&&a.focus()},focus:d.noop,keydown:function(a){void 0!==a.focus&&a.focus()},mousedown:function(a){return g(a)},mouseup:function(a){return g(a)},contextmenu:c.some,selectionchange:b.unbound}}});k("14y","15b 7 s 3n l 29 q 31".split(" "),function(b,d,c,a,e,f,g,h){return function(l){return{background:d.noop,foreground:d.noop,focus:function(a,c,d){b.saveScroll(e.fromDom(g),function(){b.saveScroll(f.owner(d),function(){h.getSelection().removeAllRanges();d.dom().focus()})})},keydown:d.noop,mousedown:c.some,
mouseup:function(b){if(3===b.raw().which){var d=a.capture(b.target(),"contextmenu",function(a){l.trigger.contextmenu(a);l.trigger.mouseup(b);d.unbind()});return c.none()}return c.some(b)},contextmenu:function(a){return 3===a.raw().which&&!0===a.raw().isTrusted?c.none():c.some(a)},selectionchange:b.unbound}}});k("149",["c","14v","14w","14x","14y"],function(b,d,c,a,e){b=b.detect();var f=b.deviceType.isiOS()?a:b.deviceType.isAndroid()?d:b.browser.isSpartan()?e:c;return{get:function(a){return f(a)}}});
k("14a",["s","l"],function(b,d){var c=function(a){a=a.dom();try{var c=a.contentWindow?a.contentWindow.document:a.contentDocument;return void 0!==c&&null!==c?b.some(d.fromDom(c)):b.none()}catch(f){return console.log("Error reading iframe: ",a),console.log("Error was: "+f),b.none()}};return{doc:function(a){return c(a).fold(function(){return a},function(a){return a})}}});k("13g",["14a","2k"],function(b,d){return{write:function(c,a){if(!d.inBody(c))throw"Internal error: attempted to write to an iframe that is not in the DOM";
var e=b.doc(c).dom();e.open();e.writeln(a);e.close()}}});k("11r","b c 42 149 7 14a 13g 4x 3z 43 3n 2d 2y q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){return function(s){var t=d.detect(),u=t.browser.isChrome()||t.browser.isSafari()?' style="height: 100%; min-height: 100%;"':"";g.write(s,"<!doctype html><html"+u+'><head></head><body contenteditable="true" spellcheck="false"></body></html>');var k=s.dom().contentWindow,u=f.doc(s),w=q.descendant(u,"body").getOrDie();m.add(w,[c.base(),c.active()]);
var t=t.browser.isFirefox(),x=l.create({keydown:h(["original"]),keyup:h(["original"]),keypress:h(["original"]),mousedown:h(["original"]),mouseup:h(["original"]),contextmenu:h(["original"]),cut:h(["original"]),copy:h(["original"]),paste:h(["original"]),focus:h(["original"]),dblclick:h(["original"]),focusOut:h(["original"])}),y=a.get(x),B=n.bind(u,"keydown",function(a){y.keydown(k);x.trigger.keydown(a)}),z=n.bind(u,"keyup",function(a){x.trigger.keyup(a)}),A=n.bind(u,"keypress",function(a){x.trigger.keypress(a)}),
C=n.bind(u,"mousedown",function(a){y.mousedown(a).fold(function(){a.kill()},x.trigger.mousedown)}),D=n.bind(u,"mouseup",function(a){y.mouseup(a).fold(function(){a.kill()},x.trigger.mouseup)}),E=n.bind(u,"contextmenu",function(a){y.contextmenu(a).fold(function(){a.kill()},x.trigger.contextmenu)}),F=n.bind(u,"cut",function(a){x.trigger.cut(a)}),G=n.bind(u,"copy",function(a){x.trigger.copy(a)}),I=n.bind(u,"paste",function(a){x.trigger.paste(a)}),H=n.bind(u,t?"focus":"focusin",function(a){x.trigger.focus(a)}),
L=n.bind(u,"focusout",function(a){x.trigger.focusOut(a)}),J=n.bind(u,"dblclick",function(a){x.trigger.dblclick(a)}),K=y.selectionchange(function(a){x.trigger.mouseup(a)},u),M=n.bind(u,"touchstart",function(a){x.trigger.mousedown(a)}),Q=n.bind(u,"touchend",function(a){x.trigger.mouseup(a);R()}),R=function(){y.foreground(k,s,w)};return{win:e.constant(k),doc:e.constant(u),body:e.constant(w),get:function(){return p.get(w)},set:function(a){w.dom().innerHTML=a},focus:function(){y.focus(k,s,w)},focused:function(){return r.activeElement===
s.dom()},blur:function(){w.dom().blur()},destroy:function(){b.each([B,z,A,C,D,E,F,G,I,H,L,K,J,M,Q],function(a){a.unbind()})},events:x.registry,background:function(){y.background(k,s,w)},foreground:R}}});k("11s",["48"],function(b){return{resolve:b.create("ephox-hare").resolve}});k("yk","c 11r 11s yi 7 s 1a 1x 3n l 2o ry".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(){var b=m.fromTag("iframe");h.add(b,c.resolve("content-iframe"));var r=f.none(),s=a(),t=l.bind(b,"load",function(){t.unbind();
var a=p.onShow(b,function(){r.each(e.apply);r=f.none();s.set(d(b))});r=f.some(a)});return{element:function(){return b},tabindex:function(a){g.set(b,"tabindex",a)},destroy:function(){n.remove(b);t.unbind();r.each(e.apply)},loaded:s.get}}});k("u9","b yj yk yi 7 s 1a l 2m 4s yl 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(){var q=c(),r=a(),s=e.noop;q.loaded(function(a){var b=d(a,q.element());t.each(function(a){var c=b.doc().dom(),d=h.fromTag("base",c);g.set(d,"href",a);a=h.fromDom(c.head);
l.append(a,d)});p(function(){r.set(b);s=b.destroy},0)});var t=f.none();return{element:q.element,onCanvas:function(a){r.get(function(b){a(b.canvas())})},initial:e.constant(""),placeholder:q.element,tabindex:q.tabindex,teardown:e.noop,injectCss:function(a){r.get(function(b){b=b.doc();n.inject(a,{},b)})},injectLinks:function(a){r.get(function(c){var d=c.doc();b.each(a,function(a){m.addStylesheet(a,d)})})},extract:e.identity,destroy:function(){s();q.destroy()},loaded:r.get,isInline:e.constant(!1),setContentBase:function(a){t=
f.some(a)}}}});k("m5","u8 u9 7 s dv 4x 3z 3d".split(" "),function(b,d,c,a,e,f,g,h){var l=function(b){var d=a.none(),l=e.tap(function(a,b,c){y.trigger.nodeChanged(a,b,c)});b.loaded(function(b){d=a.some(b);b.events.nodeChanged.bind(function(a){l.instance(a.node(),a.offset(),a.prev())});b.events.loiter.bind(function(a){y.trigger.loiter(a.node(),a.offset())});b.events.uiStale.bind(function(){y.trigger.uiStale()});b.events.domChanged.bind(function(){y.trigger.domChanged()});b.events.interaction.bind(function(){y.trigger.interaction()});
b.events.keyup.bind(function(a){y.trigger.keyup(a.original())});b.events.keydown.bind(function(a){y.trigger.keydown(a.original())});b.events.keypress.bind(function(a){y.trigger.keypress(a.original())});b.events.mousedown.bind(function(a){y.trigger.mousedown(a.original())});b.events.mouseup.bind(function(a){y.trigger.mouseup(a.original())});b.events.contextmenu.bind(function(a){y.trigger.contextmenu(a.original())});b.events.cut.bind(function(a){y.trigger.cut(a.original())});b.events.copy.bind(function(a){y.trigger.copy(a.original())});
b.events.paste.bind(function(a){y.trigger.paste(a.original())});b.events.focus.bind(function(a){y.trigger.focus(a.original())});b.events.focusOut.bind(function(a){y.trigger.focusOut(a.original())});b.events.dblclick.bind(function(a){y.trigger.dblclick(a.original())});b.resetContent(s);y.trigger.ready(b);y.trigger.loaded();b.uiChanged()});var q=function(){return d.map(function(a){return a.win()})},r=function(){return d.map(function(a){return a.doc()})},s=b.initial(),t=function(){d.each(function(a){a.focus()})},
u=function(){return d.bind(function(a){return a.getSelection()})},k=function(a,b,c,e){d.each(function(d){d.setSelection(a,b,c,e)})},w=function(a,b){d.each(function(c){c.setRelativeSelection(a,b)})},x=function(){var a=arguments;d.each(function(b){b.execCommand.apply(null,a)})},y=g.create({nodeChanged:f(["node","offset","prev"]),loiter:f(["node","offset"]),uiStale:f([]),domChanged:f([]),interaction:f([]),keydown:f(["original"]),keyup:f(["original"]),keypress:f(["original"]),mousedown:f(["original"]),
mouseup:f(["original"]),contextmenu:f(["original"]),cut:f(["original"]),copy:f(["original"]),paste:f(["original"]),focus:f(["original"]),focusOut:f(["original"]),dblclick:f(["original"]),ready:f(["api"]),loaded:f([])});return{element:b.element,tabindex:b.tabindex,onCanvas:b.onCanvas,win:q,doc:r,body:function(){return d.map(function(a){return a.body()})},getContent:function(){return d.fold(function(){return s},function(a){return a.getContent()})},setContent:function(a){d.fold(function(){s=a},function(b){b.setContent(a)})},
resetContent:function(a){d.fold(function(){s=a},function(b){b.resetContent(a)})},blur:function(){d.each(function(a){a.blur()})},focus:t,uiChanged:function(){d.each(function(a){a.uiChanged()})},domChanged:function(){d.each(function(a){a.domChanged()})},clearSelection:function(){d.each(function(a){a.clearSelection()})},getSelection:u,setSelection:k,setRelativeSelection:w,backupSelection:function(){d.each(function(a){a.backupSelection()})},replaceSelection:function(a){d.each(function(b){b.replaceSelection(a)})},
execCommand:x,lockdown:function(a){var b=l.control.isBlocked();l.control.block();a();b||l.control.unblock()},destroy:function(){b.destroy()},events:y.registry,background:function(){d.fold(c.identity,function(a){a.background()})},foreground:function(){d.fold(c.identity,function(a){a.foreground()})},on:function(a){return q().bind(function(b){return r().map(function(d){return a({win:c.constant(b),doc:c.constant(d),execCommand:x,getSelection:u,setSelection:k,setRelativeSelection:w,focus:t})})})},translateScreen:function(a,
b){return d.fold(function(){return h(a,b)},function(c){return c.translateScreen(a,b)})},translateLocation:function(a,b){return d.fold(function(){return h(a,b)},function(c){return c.translateLocation(a,b)})},placeholder:b.placeholder,teardown:b.teardown,extract:b.extract,injectCss:b.injectCss,injectLinks:b.injectLinks,isInline:b.isInline,setContentBase:b.setContentBase}};return{frame:function(){var a=d();return l(a)},detached:function(a){a=b(a);return l(a)}}});k("dy","m5 7 30 43 2l 2m 2y o".split(" "),
function(b,d,c,a,e,f,g,h){var l=function(a,b,c,e,f){return{editable:d.constant(a),connect:b,addStylesheets:c,addDocumentStyles:e,setContentBase:f}},m=function(a,c){var d=b.frame();d.events.ready.bind(function(b){b=b.api().body();a.updateUi(b)});return l(d,function(a){f.append(a,d.element())},d.injectLinks,function(a){0!==a.length&&d.injectCss(a)},function(a){d.setContentBase(a)})},n=function(d,m){var n=b.detached(m.inline);return l(n,function(b){f.append(b,n.placeholder());b=g.ancestor(b,".ephox-polish-editor-container").getOr(b);
e.set(n.placeholder(),"display","none");a.add(b,[c.resolve("inline-editor-container"),c.resolve("layer-editor")])},function(a){0!==a.length&&h.log("You have attempted to declare the following stylesheets for use in textbox.io: ["+a.join(", ")+"]. User stylesheets are not used in inline editing mode and have been ignored.")},function(a){0!==a.length&&h.log('You have attempted to declare the following document styles for use in textbox.io: "'+a+'". Document styles are not used in inline editing mode and have been ignored.')},
function(a){h.log('You have attempted to declare the following content base URL for use in textbox.io: "'+a+'". Content base URL is not used in inline editing mode and has been ignored.')})};return{build:function(a,b){return(void 0!==b.inline?n:m)(a,b)}}});k("dz",["s","28"],function(b,d){return function(c){var a=b.none(),e=b.none(),f=function(){a.each(function(a){c.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())});e.each(function(a){c.win().each(function(b){b.scrollTo(a.left(),
a.top())})})},g=function(){a=b.none();e=b.none()};return{restore:function(){f();g()},save:function(){a=c.getSelection();e=c.doc().map(d.get)},get:function(){return a},clear:g,attempt:function(b){a=b.or(a)}}}});k("m6","54 b c l 2m 29".split(" "),function(b,d,c,a,e,f){var g=c.detect().browser.isFirefox(),h=function(c){d.each(c,function(c){f.nextSibling(c).isNone()&&e.after(c,a.fromText(b.zeroWidth()))})};return{configure:function(a){g&&a.addSelector(a.input(),"a",h)}}});k("e0","b 7 m6 30 bs d3 75 1a 1x 2o".split(" "),
function(b,d,c,a,e,f,g,h,l,m){var n=a.resolve("content-eph-wrapper"),p=a.resolve("content-eph-extra"),q=a.resolve("content-eph-general"),r=function(a){b.each(a,function(a){l.remove(a,f.styleSpan());h.remove(a,f.overrideSpan());(h.hasNone(a)||g.isTransient(a))&&m.unwrap(a)})},s=function(a){b.each(a,function(a){l.remove(a,f.quasiBlocks)})},t=function(a){b.each(a,function(a){var b=h.get(a,"style");h.set(a,"style",b.replace(/"/g,"'"))})};return{configure:function(a){a.add(a.internal(),n,e.unwrap);a.add(a.internal(),
p,e.remove);a.add(a.internal(),q,e.remove);a.add(a.internal(),f.quasiBlocks,s);a.add(a.output(),n,e.unwrap);a.add(a.output(),p,e.remove);a.add(a.output(),q,e.remove);a.add(a.output(),f.styleSpan(),r);a.add(a.output(),f.quasiBlocks,s);a.addSelector(a.internal(),"noscript",e.remove);a.addSelector(a.input(),"[style]",t);a.addSelector(a.paste(),"[style]",t);c.configure(a)},markerWrapper:d.constant(n),markerExtra:d.constant(p),markerGeneral:d.constant(q)}});k("11t",["48"],function(b){return{resolve:b.create("ephox-cereal").resolve}});
k("ym","11t b 7 1a 1x 43 2y cy".split(" "),function(b,d,c,a,e,f,g,h){var l=b.resolve("start-cursor"),m=b.resolve("finish-cursor"),n="data-"+b.resolve("start-offset"),p="data-"+b.resolve("finish-offset"),q=function(b){a.remove(b,n);a.remove(b,p);f.remove(b,[l,m]);""===a.get(b,"class")&&a.remove(b,"class")},r=function(b,c){var d=a.get(b,c);return h(d,10)};return{setInfo:function(b,c,f,g){d.each([b,c],q);e.add(b,l);e.add(c,m);a.set(b,n,f);a.set(c,p,g)},clearInfo:q,findStart:function(a){return g.descendant(a,
"."+l).map(function(a){return{token:c.constant(a),offset:c.constant(r(a,n))}})},findFinish:function(a){return g.descendant(a,"."+m).map(function(a){return{token:c.constant(a),offset:c.constant(r(a,p))}})}}});k("11u",["33"],function(b){return b.immutable("token","remove","extra")});k("yn",["ym","11u","7"],function(b,d,c){return{use:function(a,b){return d(b,c.noop,[])},extract:function(a){return{remove:c.curry(b.clearInfo,a),element:c.constant(a)}}}});k("yo","11u 11t 7 s 1x 2l l 2m 2o 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m){var n=d.resolve("pre-cursor-token"),p=d.resolve("post-cursor-token"),q=d.resolve("first-cursor-token"),r=function(){var a=g.fromTag("span");f.set(a,"display","none");return a},s=function(a){var d=c.curry(l.remove,a);return b(a,d,[a])},t=function(b){return e.has(b,n)?m.nextSibling(b):e.has(b,p)?m.prevSibling(b):e.has(b,q)?m.parent(b):a.none()};return{pre:function(a,b){var c=r();h.before(b,c);e.add(c,n);return s(c)},post:function(a,b){var c=r();h.after(b,c);e.add(c,p);
return s(c)},first:function(a,b){var c=r();h.prepend(a,c);e.add(c,q);return s(c)},extract:function(a){return t(a).map(function(b){return{remove:c.curry(l.remove,a),element:c.constant(b)}})}}});k("11v",["33"],function(b){var d=b.immutable("element","offset");b=b.immutable("startContainer","startOffset","endContainer","endOffset");return{point:d,range:b}});k("11w","11t 7 1x l 2m 46 29".split(" "),function(b,d,c,a,e,f,g){var h=b.resolve("text-node-wrapper"),l=function(a){return c.has(a,h)};return{create:function(){var b=
a.fromTag("span");c.add(b,h);return b},findIn:function(a){return f.children(a,"."+h)},isWrap:l,inWrap:function(a){return g.parent(a).fold(d.constant(!1),function(a){return l(a)})},child:function(b){return g.child(b,0).fold(function(){var c=a.fromText("");e.append(b,c);return c},d.identity)}}});k("11x","11w b l 2m 2o 29".split(" "),function(b,d,c,a,e,f){var g=function(g){g=b.findIn(g);d.each(g,function(b){0===f.children(b).length&&a.before(b,c.fromText(""));e.unwrap(b)})},h=function(a){f.parent(a).each(e.unwrap)};
return{unwrap:function(a){(b.inWrap(a)?h:g)(a)}}});k("yp","ym 11v 11w 11x yn yo 7 1b kq 20 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=function(a,b,c,d){return h.eq(a,b)?f.first(a,b):m.isElement(b)&&!d(b)?e.use(a,b):c(a,b)};return{extractFrom:function(b,e){b.remove();e.remove();var f=function(b){var d=c.isWrap(b)?n.unwrap:a.unwrap,e=c.isWrap(b)?c.child(b):b;return{target:g.constant(e),unwrap:g.curry(d,b)}},h=f(b.element()),l=f(e.element()),m=d.range(h.target(),b.offset(),l.target(),e.offset());
return{remove:function(){h.unwrap();l.unwrap()},getSelection:function(){return m}}},same:function(a,c,d,e,g){a=p(a,c,f.pre,g);b.setInfo(a.token(),a.token(),d,e);return[a]},diff:function(a,c,d,e,g,h){var m=l.after(c,d,e,g),n=m?f.pre:f.post;c=p(a,c,m?f.post:f.pre,h);a=p(a,e,n,h);b.setInfo(c.token(),a.token(),d,g);return[c,a]}}});k("11y","11w b 7 2m 20 29".split(" "),function(b,d,c,a,e,f){var g=function(a){return f.parent(a).fold(c.constant(!1),function(a){return b.isWrap(a)})},h=function(c){return d.foldr(c,
function(c,d){if(e.isText(d)&&!g(d)){var f=b.create();a.wrap(d,f);return[f].concat(c)}return c},[])};return{wrap:function(a){var c=f.children(a),c=0<c.length?c:[a];return b.isWrap(a)?[]:h(c)}}});k("yq",["ym","11x","11y","b","7"],function(b,d,c,a,e){var f=function(a){a.remove()};return{combine:function(g,h){var l=a.bind(g,c.wrap),m=a.bind(h,function(a){return a.extra()});return{extra:e.constant(m),wrappers:e.constant(l),remove:function(){a.each(h,function(a){b.clearInfo(a.token())});a.each(g,d.unwrap);
a.each(h,f)}}}}});k("ua","ym yn yo yp yq 7 1b".split(" "),function(b,d,c,a,e,f,g){var h=function(b,c,d,f,g,h){var l=[c,f];b=a.diff(b,c,d,f,g,h);return e.combine(l,b)},l=function(b,c,d,f,g,h){f=[c];b=a.same(b,c,d,g,h);return e.combine(f,b)},m=function(a,b){return b(a).map(function(a){var b=c.extract(a.token()).getOrThunk(function(){return d.extract(a.token())});return{remove:b.remove,offset:a.offset,element:b.element}})},n=function(a){return m(a,b.findStart).bind(function(c){return m(a,b.findFinish).map(function(a){return{startMarker:f.constant(c),
finishMarker:f.constant(a)}})})};return{insertAt:function(a,b,c,d,e,f){return(g.eq(b,d)?l:h)(a,b,c,d,e,f)},extract:function(b){return n(b).map(function(b){return a.extractFrom(b.startMarker(),b.finishMarker())})}}});k("m7",["ua"],function(b){return{insert:function(d,c,a){d=b.insertAt(d,c.startContainer(),c.startOffset(),c.endContainer(),c.endOffset(),a);return{extra:d.extra,wrappers:d.wrappers,remove:d.remove}},extract:function(d){return b.extract(d).map(function(b){return{remove:b.remove,getSelection:b.getSelection}})}}});
k("e1","m7 b dp 8w co 7 e0 1a 1x m8 2d ei 29 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var s=function(a,b){d.each(a,function(a){l.add(a,b)})},t=function(a){var b=function(){return q.parent(a).map(function(a){return"false"===h.get(a,"contenteditable")}).getOr(!1)};return"false"===h.get(a,"contenteditable")||b()};return{extract:function(a){return b.extract(a)},getSelection:function(b){var d=b.getSelection();b=d.startContainer();var f=d.startOffset(),g=d.endContainer(),d=d.endOffset(),h=e.getEnd(b),
l=e.getEnd(g);return 0<=f&&f<=h&&0<=d&&d<=l?c.write(a.on(b,f),a.on(g,d)):c.write(a.before(b),a.before(b))},remove:function(a){a.remove()},serialise:function(a,c){return m.path(a,c.startContainer()).bind(function(d){return m.path(a,c.endContainer()).bind(function(e){var h=p.deep(a);return m.follow(h,d).bind(function(a){return m.follow(h,e).map(function(d){d={startContainer:f.constant(a),startOffset:f.constant(c.startOffset()),endContainer:f.constant(d),endOffset:f.constant(c.endOffset())};d=b.insert(h,
d,t);s(d.wrappers(),g.markerWrapper());s(d.extra(),g.markerExtra());return n.get(h)})})})})}}});k("120",["7"],function(b){var d=function(c){return{elements:b.constant(c)}};return{constant:d,empty:function(){return d([])}}});k("122",["33"],function(b){return b.immutable("word","left","right")});k("123",["b","s","122"],function(b,d,c){var a=["'","\u2018","\u2019"],e=b.bind(a,function(a){return b.map(["twas"],function(b){return a+b})}),f=function(a){var b=a.word();return c(b.substring(1),d.some(b.charAt(0)),
a.right())},g=function(c){return b.contains(a,c)},h=function(a){var c=a.word(),d=b.exists(e,function(a){return-1<c.indexOf(a)})?2:1,h=c.substring(0,d);return b.forall(h,g)&&!g(c.charAt(d))?f(a):a},l=function(a){var b=a.word();2<=b.length&&g(b.charAt(b.length-1))&&!g(b.charAt(b.length-2))&&(b=a.word(),a=c(b.substring(0,b.length-1),a.left(),d.some(b.charAt(b.length-1))));return h(a)};return{scope:l,text:function(a){a=c(a,d.none(),d.none());return l(a).word()}}});k("yt","b s 6b gp 122 123 5z".split(" "),
function(b,d,c,a,e,f,g){return{words:function(g){var l=c.unsafetoken(c.wordchar()+"+"),l=a.findall(g,l),m=g.length;return b.map(l,function(a){var b=a.start(),c=a.finish();a=g.substring(b,c);b=0<b?d.some(g.charAt(b-1)):d.none();c=c<m?d.some(g.charAt(c)):d.none();a=e(a,b,c);return f.scope(a)})}}});k("ys","b 7 11z 120 121 yt".split(" "),function(b,d,c,a,e,f){var g=function(a,d){var e=c.splitby(d,function(b){b=b.item();return a.property().isBoundary(b)||a.property().isEmptyTag(b)});return b.bind(e,function(a){a=
b.map(a,function(a){return a.text()}).join("");return f.words(a)})};return{generate:function(c,f,m){f=e.words(c,f,m).all();m=b.map(f,function(a){return a.item()});m=a.constant(m);c=g(c,f);return{zone:d.constant(m),words:d.constant(c)}},empty:function(){return{zone:a.empty,words:d.constant([])}}}});k("ub",["yr","ys","yt"],function(b,d,c){return{identify:function(a){return c.words(a)},cluster:function(a,b,c){return a.property().isBoundary(b)?d.empty():d.generate(a,b,c)},isWord:function(a,c){return!b.hasBreak(c)}}});
k("m9",["dg","ub"],function(b,d){var c=b();return{identify:function(a){return d.identify(a)},cluster:function(a,b){return d.cluster(c,a,b)},isWord:function(a){return d.isWord(c,a)}}});k("e2","c s du m9 d4 20 29".split(" "),function(b,d,c,a,e,f,g){var h=b.detect(),l=function(a,b){return f.isText(a)?d.some(c.point(a,b)):0===g.children(a).length?d.none():g.child(a,b).bind(function(a){return l(a,0)})},m=function(a,b,c){a.on(function(a){e.expandWord(a,b,c)})},n=function(b,c){var d=b.dom().createRange();
d.setStart(c.startContainer().dom(),c.startOffset());d.setEnd(c.endContainer().dom(),c.endOffset());return a.isWord(d.cloneContents().textContent)};return{correct:function(a){a.getSelection().each(function(b){a.doc().each(function(c){n(c,b)&&l(b.startContainer(),b.startOffset()).each(function(c){(!b.collapsed()||a.isInline()&&h.browser.isIE())&&m(a,c.element(),c.offset())})})})},expand:function(a){a.on(e.expand);a.backupSelection()}}});aa("mb",Image);k("ma","4x 3z 1a 3n l mb".split(" "),function(b,
d,c,a,e,f){return function(){var a=d.create({fail:b(["url","image"]),success:b(["url","image"]),start:b(["url"])}),h=function(a,b,c){var d=a.dom();d.addEventListener(b,c,!1);return{unbind:function(){d.removeEventListener(b,c,!1)}}},l=function(b){var d=c.get(b,"src"),e=h(b,"load",function(){e.unbind();f.unbind();(!0===b.dom().complete?a.trigger.success:a.trigger.fail)(d,b)}),f=h(b,"error",function(){e.unbind();f.unbind();a.trigger.fail(d,b)})};return{go:function(b){a.trigger.start(b);var c=new f;c.src=
b;l(e.fromDom(c))},monitor:l,events:a.registry}}});k("fz",["b","3l","7","p"],function(b,d,c,a){var e=function(a,b){return a.bind(function(a){return a.fold(function(){return d.pure(a)},function(a){return b(a)})})},f=function(b){return d.pure(a.value(b))},g=function(b){return d.nu(function(c){b.then(function(b){c(a.value(b))},function(b){c(a.error(b))})})},h=function(b){return b.map(a.value)};return{fromPromise:g,error:function(b){return d.pure(a.error(b))},map:function(a,b){return a.map(function(a){return a.map(b)})},
bind:e,pure:f,fromChain:function(a){return function(c){return b.foldl(a,function(a,b){return e(a,function(a){return b(a)})},f(c))}},fromFuture:h,pToFR:function(a){return c.compose(g,a)},fToFR:function(a){return c.compose(h,a)},effect:function(a){return function(b){b.each(function(){a()});return b}}}});k("e3","ma 3l p fz 1a mb".split(" "),function(b,d,c,a,e,f){var g=function(a){return d.nu(function(d){if(!0===a.dom().complete)d(c.value(a));else{var e=b();h(e,d);e.monitor(a)}})},h=function(a,b){a.events.success.bind(function(a){b(c.value(a.image()))});
a.events.fail.bind(function(a){b(c.error("Unable to download image "+a.url()))})};return{load:function(a){return d.nu(function(c){var d=b();h(d,c);d.go(a)})},loadIfNeeded:function(b){return!0===b.dom().complete||void 0===e.get(b,"src")?a.pure(b):g(b)}}});k("7k","do 54 c 8w ap 3l 7 s du dv 8x dx dy dz e0 e1 e2 e3 bk 4x 3z 40 e4 1x 1b 3n l 4j 2m 20 46 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,u,k,w,x,y,B,z,A,C,D,E,F,G,I,H,L,J){var K=c.detect();return function(c,Q,R,P,O){s.configure(c);
var V=h.none(),U=q.build(P,R),N=U.editable();null!==R.tabindex&&N.tabindex(R.tabindex);void 0!==R.base&&U.setContentBase(R.base);void 0!==O.clean&&N.setContent(O.clean);N.events.loaded.bind(function(){var a=N.getContent();void 0!==O.clean&&O.clean===a&&T(O.marked,!1);a=N.body().getOrDie();V=h.some(D.bind(a,"dblclick",function(a){u.correct(N)}))});N.events.ready.bind(function(a){w.addClasses(a.api().body());N.injectLinks([R.css+"/content.css"]);U.addStylesheets(R.stylesheets);U.addDocumentStyles(R.documentStyles)});
var X=function(){return N.getSelection().bind(function(a){var b=N.body().getOrDie("content should not return a selection if body is not yet available");return t.serialise(b,a)}).getOr(N.getContent())},T=function(a,b){N.body().each(function(c){N.setContent(a);t.extract(c).fold(function(){N.setSelection(c,0,c,0)},function(a){var b=t.getSelection(a);t.remove(a);N.setRelativeSelection(b.start(),b.finish())});if(!K.deviceType.isiOS()){var d=H.descendants(c,"img");b?f.mapM(d,k.loadIfNeeded).get(function(){ha()}):
ha()}})},W=y.create({nodeChanged:x(["node","offset","prev"]),undoChanged:x([]),loiter:B(["node","offset"],N.events.loiter),uiStale:B([],N.events.uiStale),domChanged:B([],N.events.domChanged),interaction:B([],N.events.interaction),keydown:B(["original"],N.events.keydown),keyup:B(["original"],N.events.keyup),keypress:B(["original"],N.events.keypress),mousedown:B(["original"],N.events.mousedown),mouseup:B(["original"],N.events.mouseup),contextmenu:B(["original"],N.events.contextmenu),copy:B(["original"],
N.events.copy),paste:B(["original"],N.events.paste),focus:B(["original"],N.events.focus),focusOut:B(["original"],N.events.focusOut),dblclick:B(["original"],N.events.dblclick),ready:B(["api"],N.events.ready),loaded:B([],N.events.loaded),background:x([]),foreground:x([]),scrollToCursor:x([]),scrollToElement:x(["element"]),toEditing:x([]),toReading:x([])});N.events.nodeChanged.bind(function(a){W.trigger.nodeChanged(a.node(),a.offset(),a.prev());ba()});var Z=m.tap(function(){W.trigger.undoChanged()}),
ba=function(){Z.instance()},$=function(a){Z.instance();var b=Z.control.isBlocked();Z.control.block();a=a();b||Z.control.unblock();Z.instance();return a},ha=function(){W.trigger.scrollToCursor()},ga=m.tap(function(){N.focus()});c=function(a){return function(){var b=arguments;J.parent(N.element()).fold(function(){a.apply(null,b)},function(c){var d=c.dom().scrollTop;a.apply(null,b);c.dom().scrollTop=d})}}(N.execCommand);var ea=function(a){return I.isText(a)&&(K.browser.isSafari()||0===L.get(a).length)||
I.isElement(a)&&!z.isEmptyTag(a)&&!z.isBlock(a)},da=function(a){var b=E.fromText(d.zeroWidth());G.after(a,b);return b},Y=function(a,b){var c=J.children(a);if(b>=c.length)return l.point(a,b);var d=c[b];return I.isElement(d)&&!z.isEmptyTag(d)?Y(c[b],0):l.point(a,b)},S={onCanvas:N.onCanvas,element:N.element,isInline:N.isInline,win:N.win,doc:N.doc,body:N.body,getContent:N.getContent,setContent:N.setContent,resetContent:N.resetContent,focus:function(){ga.instance()},blur:N.blur,uiChanged:N.uiChanged,domChanged:N.domChanged,
undoChanged:ba,clearSelection:N.clearSelection,getSelection:N.getSelection,getSelectionStart:function(){return N.getSelection().map(function(a){return a.startContainer()})},setSelection:N.setSelection,setRelativeSelection:N.setRelativeSelection,backupSelection:N.backupSelection,replaceSelection:N.replaceSelection,execCommand:c,insertHtmlAtCursor:function(c){var d=F.fromHtml(c);$(function(){n.insertAtCursorWithInstructions(b.doNotMerge,S,d).each(function(b){var c=b.element();J.parent(c).each(function(b){b=
ea(c)?da(c):c;N.setRelativeSelection(a.after(b),a.after(b));N.getSelection().each(function(a){a=Y(a.startContainer(),a.startOffset());N.setSelection(a.element(),a.offset(),a.element(),a.offset())});Q.input(d)})})})},on:N.on,destroy:function(){V.each(function(a){a.unbind()});N.destroy()},events:W.registry,state:function(){return{clean:N.getContent(),marked:X()}},serialize:X,deserialize:function(a){T(a,!0)},background:function(){N.background();W.trigger.background()},foreground:function(){N.foreground();
W.trigger.foreground()},isRoot:function(a){return N.body().fold(g.constant(!1),function(b){return C.eq(b,a)})},selectWord:function(){u.expand(N)},cursor:function(){return r(N)},activate:function(){ga.control.unblock()},deactivate:function(){ga.control.block()},cursorIntoView:ha,elementIntoView:function(a){W.trigger.scrollToElement(a)},placeholder:N.placeholder,connect:U.connect,translateScreen:N.translateScreen,translateLocation:N.translateLocation,teardown:N.teardown,extract:N.extract,runOrOnLoaded:function(a){N.body().fold(function(){N.events.ready.bind(function(b){a(b.api().body())})},
function(b){a(b)})},getSelectedText:function(){return N.getSelection().bind(function(a){if(a.collapsed())return h.none();a=e.cloneFragment(N.win().getOrDie(),a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset());a=J.children(a);return h.some(p.toText(a))})},toEditing:function(){W.trigger.toEditing()},toReading:function(){W.trigger.toReading()},undoOperation:$,markAsEphemeral:function(a){A.add(a,s.markerGeneral())},hideInlineSelection:function(){N.isInline()&&(N.backupSelection(),N.clearSelection())}};
return S}});k("e8",["7"],function(b){return{get:b.constant({onShortcut:function(b,c){b.bind(c)}})}});k("mc",["fi","30","1a"],function(b,d,c){var a="data-"+d.resolve("context-type");return{nu:function(d,f,g){d=b.item(d,g.value(),g.text());c.set(d,a,f);c.setAll(d,g.attrs());return d},type:function(b){return c.get(b,a)}}});k("md","6w b 7i fi jc mc 43".split(" "),function(b,d,c,a,e,f,g){return{derive:function(h,l,m){l=d.map(l,function(a){var e=m[a],l=e.primary(),r=e.submenus();return d.map(l,function(d){var e=
f.nu(h,a,d),l=r.hasOwnProperty(d.value())&&void 0!==r[d.value()]?[b.resolve("menu-more")]:[],m=void 0!==r[d.value()];c.menuItem(e,d.text(),m);g.add(e,l);return e})});l=d.filter(l,function(a){return 0<a.length});return d.flatten(e.intersperseThunk(l,function(){return[a.separator(h)]}))}}});k("me","b 7i fi mc 6u 35".split(" "),function(b,d,c,a,e,f){return{derive:function(g,h,l){return b.bind(h,function(h){var n=l[h].secondary();return b.map(n,function(l){var n=c.submenu(g,l.value(),[]);d.menu(n,e.get(l.textkey()));
l=b.map(l.items(),function(b){var c=a.nu(g,h,b);d.menuItem(c,b.text());return c});f.append(n,l);return n})})}}});k("e9","b 1n 7i fi 6 s mc md me 6u 30 4f 1x 35 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s){return function(t){var u=p({}),k=p([]),w={},x=f.none();return{structure:u.get,all:k.get,main:function(){return k.get()[0]},update:function(g){b.each(k.get(),function(a){s.remove(a)});x=f.some(g);var p=d.keys(w);d.each(w,function(a){a.assign(x)});var z=d.tupleMap(w,function(a,b){return{k:b,
v:a.situation(g)}}),A=h.derive(t,p,z),C=l.derive(t,p,z),p=b.foldr(p,function(a,b){return e.merge(a,z[b].submenus())},{});if(0===A.length)k.set([]);else{var D=a.mainmenu(t,n.resolve("main-context-menu"),[]);r.append(D,A);c.menu(D,m.translate("aria.context.menu.generic"));A=[D].concat(C);b.each(A,function(a){q.add(a,n.resolve("layer-menus"))});k.set(A);u.set(p)}},handle:function(a){var b=g.type(a),b=w[b];void 0!==b&&b.handle(a)},register:function(a,b){w[a]=b}}}});k("mf",["jg"],function(b){return{mainmenu:function(d,
c,a,e,f,g){return b.main(d,c,a,e,f,g)},submenu:function(d,c,a,e,f){return b.submenu(d,c,a,e,f)}}});k("ea","mf 7 s 6p mg mh mi 3d l q 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return{makeshift:function(b,q,r,s,t,u){return{recalculate:d.noop,isAnchored:d.constant(!1),place:function(d){var k=g.fixed(0,0,n.innerWidth,n.innerHeight),x=b.doc().getOr(l.fromDom(m)),x=b.isInline()?h(r,s):g.translate(k,x,r,s),x=a(x.left(),x.top(),0,0),y={bounds:g.viewport(k,c.some(q.bounds)),origin:k,preference:t.isRtl()?
f.allRtl():f.all()},B=e.layout(x,d,u,y);e.position(d,t,B,k);e.setClasses(d,B);e.setHeight(x,d,B,y,u)}}},mainmenu:function(a,c,d,e,f){return b.mainmenu(a.uiContainer,a.bounds,c,d,e,f)},submenu:function(a,c,d,e){return b.submenu(a.uiContainer,a.bounds,c,d,e)}}});k("7l","9k 9l b e6 c 7 s e7 e8 e9 70 ea eb 33 3d 2l l 3e 20 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,t,k,v,w,x){var y=r.immutable("target","x","y"),B=e.detect().browser,z=function(e,r,z,E,F,G){z=r.doc().getOrDie();var I=m(z),H=
s(0,0);z=l.get();var L=h.fromUnsafe(r),J=b.menuSystem(F.uiContainer,f.constant("context"),d.menu({focusActive:!0})),K=b.popup(J.sandbox,F.bounds,e,[]);G=k.fromTag("div");var M=K.initMenu(G),Q=function(a){I.update(a.target());var b=U(),c=[J.sandbox()];if(0<b.all.length){var d=a.x(),e=a.y();H=s(d,e);M.setContent(b.main);O(M);M.open();J.open(c,b.main);return g.some(a)}return g.none()},R=function(a){return r.getSelection().bind(function(a){return function(){return n.selectionContains(a).fold(function(){return w.isText(a.startContainer())?
x.parent(a.startContainer()):g.some(a.startContainer())},function(a){return g.some(a)})}().map(function(a){var b=v.viewport(a),b=r.translateScreen(b.left(),b.top());return y(a,b.left(),b.top())})})},P=function(a){var b;b=a.original();b=B.isIE()&&10>=B.version.major?s(b.raw().clientX,b.raw().clientY):s(b.x(),b.y());b=r.translateScreen(b.left(),b.top());return y(a.original().target(),b.left(),b.top())},O=function(a){var b;b=q(14,10);b=p.makeshift(r,F,H.left(),H.top(),e.uiDirection(),b);F.show(a,b)},
V=function(){M.close();var a=U();c.each(a.all,function(a){t.set(a,"display","none")});L.end()};M.events.close.bind(function(){J.close()});var U=function(){var a=I.all();return{all:a,main:a[0],submenus:a.slice(1)}};r.events.contextmenu.bind(function(a){var b=P(a);Q(b).orThunk(function(){return R().bind(Q)}).each(function(b){a.original().raw().preventDefault()})});z.onShortcut(E.events.context,function(){R().each(Q)});J.events.open.bind(function(){var a=I.structure(),b=U();J.update(a);K.registerMenus(b.submenus);
O(M);J.setActiveMenu(b.main)});J.events.itemAction.bind(function(a){I.handle(a.item())});J.events.itemHover.bind(function(a){L.begin()});J.events.reveal.bind(function(b){a.expanded(b.trigger());K.expandMenu(b.menu(),b.trigger(),M);O(M)});J.events.collapse.bind(function(b){K.hideMenu(b.menu());b.item().each(a.collapsed)});J.events.itemAction.bind(V);J.events.escaped.bind(function(){V();r.focus()});r.events.mousedown.bind(V);return{register:I.register,destroy:function(){M.destroy();J.destroy()}}};return function(a,
b,d,e,g){var h=[],l={register:function(a,b){h=h.concat([{name:a,feature:b}])},destroy:f.noop};b.events.loaded.bind(function(f){l=z(a,b,d,e,g);c.each(h,function(a){l.register(a.name,a.feature)})});return{register:function(a,b){l.register(a,b)},destroy:function(){l.destroy()}}}});k("ec","c 7 s 1a l 2m 20 2o 29 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=b.detect().browser,p=function(a){var b=e.fromHtml("<p><br></p>");f.append(a,b);return c.some(b)},q=function(a){var b=l.children(a);return 0===
b.length?p(a):1===b.length&&"br"===g.name(b[0])?(h.empty(a),p(a)):c.none()},r=function(b){return 1===b.dom().childNodes.length?l.firstChild(b).fold(d.constant(!1),function(b){return"br"===g.name(b)&&a.has(b,"_moz_editor_bogus_node")}):!1},s=function(a){return q(a).orThunk(function(){var b;n.isFirefox()&&r(a)?(h.empty(a),b=p(a)):b=c.none();return b})};return{listen:function(a){a.events.nodeChanged.bind(function(b){b=b.node();a.isRoot(b)&&s(b).each(function(b){a.setSelection(b,0,b,0)})})}}});k("ed",
[],function(){return function(){var b=!0;return{isHandled:function(){return b},handle:function(){b=!1}}}});k("7t",["7","75","29"],function(b,d,c){return{onNodeChange:function(a,c){a.events.nodeChanged.bind(function(b){b.prev().each(function(b){d.withinTransient(b,b).each(function(b){c.atomic(function(){d.cleanup(a.isRoot,b)})})})});return{destroy:b.noop}},onLinebreak:function(a){a.getSelection().each(function(b){c.parent(b.startContainer()).each(function(c){d.coalesce(c);a.setSelection(b.startContainer(),
b.startOffset(),b.endContainer(),b.endOffset())})})}}});k("9g",["b","9n","7"],function(b,d,c){var a=function(a,c){var d=c.original(),d=d.raw().which||d.raw().keycode;return b.contains(a,d)},e=c.curry(a,d.ENTER()),f=c.curry(a,d.SPACE()),g=c.curry(a,d.BACKSPACE()),h=c.curry(a,d.DEL()),l=c.curry(a,d.LEFT().concat(d.UP())),m=c.curry(a,d.RIGHT().concat(d.DOWN())),n=c.curry(a,d.TAB());d=c.curry(a,d.ESCAPE());return{isEnter:e,isSpace:f,isBackspace:g,isDel:h,isTab:n,isLeftOrUp:l,isRightOrDown:m,isEscape:d}});
k("ee",["mj","mk","ml"],function(b,d,c){var a=function(a,b,c,h){return d.isCollapsed(a)?b(a.startContainer(),a.startOffset(),h):c(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset(),h)};return{soft:function(d,f){return a(d,b.soft,c.soft,f)},hard:function(d,f){return a(d,b.hard,c.hard,f)}}});k("7m","7 ec ed 7t 9g 4x 3z ee".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){var n=g.create({preLinebreak:f(["handler"]),postLinebreak:f([])});d.listen(l);var p=function(b){m.save();
l.getSelection().each(function(d){var e=c();n.trigger.preLinebreak(e);l.getSelection().each(function(c){e.isHandled()&&(b?h.soft:h.hard)(c,l.isRoot).each(function(b){l.setRelativeSelection(b.start(),b.finish());a.onLinebreak(l);l.domChanged();l.cursorIntoView()});n.trigger.postLinebreak()})})};l.events.keydown.bind(function(a){e.isEnter(a)&&(a.original().raw().preventDefault(),p(a.original().raw().shiftKey))});return{linebreak:p,destroy:b.noop,events:n.registry}}});k("ef",["46"],function(b){return function(d,
c){return{find:function(a){return b.descendants(a,d)},cleaner:c}}});k("gq",["b","l","2d"],function(b,d,c){var a=function(a,c){b.each(c,function(b){var c=b.find(a);b.cleaner(c)})};return{filterHtml:function(b,f){var g=d.fromTag("div");g.dom().innerHTML=b;a(g,f);return c.get(g)},filterDom:a}});k("mm",[],function(){return function(){var b=[];return{add:function(d){b.push(d)},get:function(){return b.slice(0)}}}});k("eg",["s","gq","mm"],function(b,d,c){return function(){var a={},e=function(c){return b.from(a[c])};
return{get:e,getOrInit:function(b){var d=a[b];void 0===d&&(a[b]=c(),d=a[b]);return d},filterDom:function(a,b){e(a).each(function(a){d.filterDom(b,a.get())})},filterHtml:function(a,b){return e(a).fold(function(){return b},function(a){return d.filterHtml(b,a.get())})}}}});k("eh",["68"],function(b){return function(d,c){return{find:function(a){return b.descendants(a,d)},cleaner:c}}});k("7n",["7","6h","ef","eg","eh"],function(b,d,c,a,e){return function(f){var g=a(),h=b.constant("internal"),l=b.constant("output"),
m=b.constant("input"),n=b.constant("history"),p=b.constant("paste"),q=b.constant("inputDom"),r=function(a,b,d){a=g.getOrInit(a);b=c(b,d);a.add(b)},s=function(a,b,c){a=g.getOrInit(a);b=e(b,c);a.add(b)};f=d(f,r,s);return{add:function(a,b,c){r(a,"."+b,c)},addSelector:r,addPredicate:s,filterHtml:g.filterHtml,filterDom:g.filterDom,internal:h,inputDom:q,output:l,input:m,paste:p,history:n,customFilters:b.constant(f),state:f.state,destroy:b.noop}}});k("7o","7 6u 6l 6v 4x 3z".split(" "),function(b,d,c,a,e,
f){return function(g,h,l){var m=!1,n=f.create({maximize:e(["layout"]),restore:e(["layout"]),analytics:e(["message"]),select:e([]),deselect:e([])}),p=function(){n.trigger.maximize(l.alternate)},q=function(){n.trigger.restore(l.alternate)},r=function(a){m?a.select():a.deselect()},s=function(){n.trigger.analytics("fullscreen_"+(m?"off":"on"));g.focus();(m?q:p)()},k=function(b,c){var e=d.key(m?"action.toggle.fullscreen":"action.fullscreen");return a.get(e,c)};h.events.fullscreen.bind(s);h=c.ui({"fullscreen.general":function(){return{toggle:!0,
value:"fullscreen",textkey:d.key("action.fullscreen"),tooltip:k,action:s,updateGeneral:r,icon:!0,shortcut:!0,selected:m}}},b.identity);var u=c.actions({maximize:p,restore:q});return{ui:h,actions:u,select:function(){m=!0},deselect:function(){m=!1},destroy:b.noop,events:n.registry}}});k("7p","b 7 s 4x 3z 1a l 35 ei 46".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(){var n=e.create({internal:a(["command","data"])}),p=function(a){b.each(a,function(a){c.from(f.get(a,"href")).each(function(a){n.trigger.internal("insertLink",
a)})})};return{input:function(a){var c;c=g.fromTag("div");a=b.map(a,l.deep);h.append(c,a);c=m.descendants(c,"a");p(c)},destroy:d.noop,events:n.registry}}});k("ej",["mn","3n","q"],function(b,d,c){return function(a,c){var f=b(),g=d.bind(c,"keydown",f.keydown),h=d.bind(c,"keypress",f.keypress),l=function(a){f.keydown(a.original())},m=function(a){f.keypress(a.original())};a.events.keydown.bind(l);a.events.keypress.bind(m);return{off:f.off,on:f.on,swallowShortcuts:f.swallowShortcuts,yieldShortcuts:f.yieldShortcuts,
swallowChars:f.swallowChars,yieldChars:f.yieldChars,swallowKeys:f.swallowKeys,yieldKeys:f.yieldKeys,destroy:function(){g.unbind();h.unbind();a.events.keydown.unbind(l);a.events.keypress.unbind(m)},events:f.events}}});k("ek",["mn"],function(b){return function(d){var c=b(),a=function(a){c.keydown(a.original())},e=function(a){c.keypress(a.original())};d.events.keydown.bind(a);d.events.keypress.bind(e);return{off:c.off,on:c.on,swallowShortcuts:c.swallowShortcuts,yieldShortcuts:c.yieldShortcuts,swallowChars:c.swallowChars,
yieldChars:c.yieldChars,swallowKeys:c.swallowKeys,yieldKeys:c.yieldKeys,events:c.events,destroy:function(){d.events.keydown.unbind(a);d.events.keypress.unbind(e)}}}});k("el",["mn","3n"],function(b,d){return function(c){var a=b(),e=d.bind(c,"keydown",a.keydown),f=d.bind(c,"keypress",a.keypress);return{off:a.off,on:a.on,swallowShortcuts:a.swallowShortcuts,yieldShortcuts:a.yieldShortcuts,swallowChars:a.swallowChars,yieldChars:a.yieldChars,swallowKeys:a.swallowKeys,yieldKeys:a.yieldKeys,destroy:function(){e.unbind();
f.unbind()},events:a.events}}});k("7q",["7","ej","ek","el"],function(b,d,c,a){return function(e,f){return{all:function(){return d(e,f.element())},container:function(b){return a(b)},editor:function(){return c(e)},destroy:b.noop}}});k("7r","7 s em 30 4x 3z 1x 3n l 2m".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n,p){var q=f.create({login:e([]),logout:e([])}),r=d.none(),s=!1;p.events.login.bind(function(){s=!0;q.trigger.login();r.each(function(a){n.hideBanner(a)});r=d.none()});p.events.logout.bind(function(){s=
!1;q.trigger.logout()});var k=function(){var c=l.fromTag("span");m.append(c,l.fromText("Log in"));g.add(c,a.resolve("banner-login-action"));h.bind(c,"click",function(){p.actions().showLogin()});return{element:b.constant(c)}};return{init:b.noop,authorised:function(a,b){if(s)b();else{r.each(function(a){n.hideBanner(a)});var e=c(a,"info");e.events.close.bind(function(){r=d.none()});var f=k();e.action(f);n.displayBanner(e);r=d.some(e)}},destroy:b.noop,events:q.registry}}});k("124",["co","4g","20","29"],
function(b,d,c,a){var e=d.generate([{onText:["element","offset"]},{firstText:["parent","child","offset"]},{beforeText:["parent","child","offset"]},{afterText:["parent","child"," offset"]},{lastText:["parent","child","offset"]},{onElement:["element","offset"]}]);return{detect:function(d,g){if(c.isText(d))return e.onText(d,g);var h=a.children(d);return 0===h.length?e.onElement(d,g):0===g&&c.isText(h[0])?(0,e.firstText)(d,h[0],0):g===h.length&&c.isText(h[h.length-1])?(h=h[g-1],(0,e.lastText)(d,h,b.getEnd(h))):
g<h.length&&c.isText(h[g])?(0,e.beforeText)(d,h[g],0):0<g&&c.isText(h[g-1])?(h=h[g],(0,e.afterText)(d,h,b.getEnd(h))):e.onElement(d,g)},cata:function(a,b,c,d,e,n,p){return a.fold(b,c,d,e,n,p)}}});k("14b",["7","s"],function(b,d){return function(c){return{backup:b.identity,restore:b.constant(d.none()),element:b.constant(c)}}});k("14c",["33"],function(b){return b.immutable("startContainer","startOffset","endContainer","endOffset")});k("128",["48"],function(b){return{resolve:b.create("ephox-newt").resolve}});
k("yz",["128","1x","2l","l"],function(b,d,c,a){var e=b.resolve("cursor-marker");return{generator:function(b){var g=null;return{getOrInit:function(){var h;null===g?(h=a.fromTag("span",b.dom()),d.add(h,e),c.set(h,"display","none")):h=g;return g=h}}},isCursor:function(a){return d.has(a,e)}}});k("125","b 14b 14c yz 7 s 1b 2m 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a,b){return{element:e.constant(b),backup:e.identity,restore:function(){var b=c(a,0,a,0);return f.some(b)}}},p=function(c){c=
m.children(c);return b.filter(c,e.not(a.isCursor))},q=function(a,b){return{element:e.constant(b),backup:e.identity,restore:function(){var b=p(a).length,b=c(a,b,a,b);return f.some(b)}}},r=function(a){return m.parent(a).bind(function(d){var e=p(d),e=b.findIndex(e,function(b){return g.eq(a,b)});return-1<e?f.some(c(d,e,d,e)):f.none()})},s=function(a,b){return{backup:function(){h.before(a,b)},restore:function(){var a=m.nextSibling(b);l.remove(b);return a.map(function(a){return r(a).getOrThunk(function(){return c(a,
0,a,0)})})},element:e.constant(b)}};return{place:function(a,b,c){var e=m.children(a);return 0===e.length?n(a,c):e.length===b?q(a,c):0===b?n(a,c):b>e.length?d(c):s(e[b],c)}}});k("126",["14c","yz","7","s"],function(b,d,c,a){var e=function(a,b){return b().fold(function(){return d.generator(a).getOrInit()},function(a){return a.element()})},f=function(b){b=b();b.backup();return a.some(b)},g=function(a,c){var d=a.or(c),e=c.or(a);return d.bind(function(a){return e.map(function(c){return b(a.startContainer(),
a.startOffset(),c.startContainer(),c.startOffset())})})};return{ltr:function(b,d,m){var n=a.none(),p=a.none();return{backup:function(){p=f(d);n=f(m)},restore:function(){return n.bind(function(a){return p.bind(function(b){var c=a.restore();b=b.restore();return g(c,b)})})},element:c.curry(e,b,function(){return p})}},rtl:function(b,d,m){var n=a.none(),p=a.none();return{backup:function(){n=f(m);p=f(d)},restore:function(){return p.bind(function(a){return n.bind(function(b){var c=a.restore();b=b.restore();
return g(b,c)})})},element:c.curry(e,b,function(){return n})}}}});k("127","14b 14c co 7 i8 gm 2m 2o".split(" "),function(b,d,c,a,e,f,g,h){var l=function(b,c,f){return{backup:function(){g.before(c,f)},restore:function(){var a=e.after(f,b).map(function(a){return d(a,0,a,0)});h.remove(f);return a},element:a.constant(f)}},m=function(b,f,l){return{backup:function(){g.after(f,l)},restore:function(){var a=e.before(l,b).map(function(a){var b=c.getEnd(a);return d(a,b,a,b)});h.remove(l);return a},element:a.constant(l)}};
return{place:function(a,c,d,e){c=f.split(c,d);return f.position(c).fold(function(){return b(e)},function(b){return l(a,b,e)},function(b,c){return m(a,b,e)},function(b){return m(a,b,e)})}}});k("ot",["33"],function(b){return b.immutable("result","cursor")});k("yy","124 125 126 127 ot yz kq 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(c,e,f){var g=function(b,d,e){return a.place(c,d,e,f)};return b.cata(e,function(b,d){return a.place(c,b,d,f)},g,g,g,g,function(a,b){return d.place(a,b,f)})},
m=function(a,c,d,e){e=e.getOrInit();c=b.detect(c,d);return l(a,c,e)},n=function(a,b){a.backup();var c=b(a.element());return e(c,a.restore())};return{inspect:m,runOnRange:function(a,b,d,e,l,k){var v=h.owner(b),w=(g.after(b,d,e,l)?c.rtl:c.ltr)(v,function(){return m(a,e,l,f.generator(v))},function(){return m(a,b,d,f.generator(v))});return n(w,k)},runOnCursor:n}});k("um",["yy","yz","1b","29"],function(b,d,c,a){var e=function(a,c,d,e,f,p){return b.runOnRange(a,c,f>d?d:f,c,f>d?f:d,p)},f=b.runOnRange;return{point:function(c,
e,f,m){var n=a.owner(e),n=d.generator(n);c=b.inspect(c,e,f,n);return b.runOnCursor(c,m)},range:function(a,b,d){return(c.eq(b.startContainer(),b.endContainer())?e:f)(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset(),d)}}});k("mo","um ot s 2k 1x 2v 29".split(" "),function(b,d,c,a,e,f,g){var h=function(a,b){return function(a,e){var f=e(b);return d(f,c.none())}},l=function(a,c){return function(d,e){return b.point(a,c.startContainer(),c.startOffset(),n(d,e))}},m=function(a,c){return function(d,
e){return b.range(a,c,n(d,e))}},n=function(a,b){return function(c){e.add(c,a);return b(c)}};return{diagnose:function(b,c){var d=c.startContainer(),e=c.endContainer(),n=g.owner(d);return a.inBody(d)&&a.inBody(e)&&f.active(n).forall(a.inBody)?c.collapsed()?l(b,c):m(b,c):h(b,c.startContainer())}}});k("eo",["7","mo","30","bs","2k"],function(b,d,c,a,e){return function(f,g){var h=c.resolve("ops-eph-cursor");f.add(f.internal(),h,a.remove);f.add(f.output(),h,a.remove);var l=function(a){var b=function(b){b=
d.diagnose(g.isRoot,b)(h,a);b.cursor().each(function(a){e.inBody(a.startContainer())&&e.inBody(a.endContainer())&&g.getSelection().each(function(b){g.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})});return b.result()};return function(){return g.getSelection().fold(a,b)}};return{destroy:b.noop,run:function(a){return l(a)()}}}});k("7s",["en","eo"],function(b,d){return function(c,a){var e=d(c,a);return{destroy:function(){},run:e.run,preserve:function(c){a.getSelection().each(function(d){var e=
b.descend(d.startContainer(),d.startOffset());d=b.descend(d.endContainer(),d.endOffset());c(e.element(),d.element());a.setSelection(e.element(),e.offset(),d.element(),d.offset())})},adapt:function(b){a.getSelection().each(function(a){e.run(function(){b(a.startContainer(),a.endContainer())})})},pure:function(b){a.getSelection().each(function(a){b(a.startContainer(),a.endContainer())})},atomic:function(a){return e.run(a)}}}});k("mp",["7","6u","6l","4x","3z"],function(b,d,c,a,e){return function(){var f=
e.create({back:a([]),abort:a([])});return{ui:c.ui({"back.general":{toggle:!1,value:"mobile-back",textkey:d.key("toolbar.backbutton"),action:function(){f.trigger.back()},updateGeneral:b.noop,icon:!0,label:!0}}),events:f.registry,destroy:b.noop}}});k("z0",["7","p"],function(b,d){return function(c,a){return d.error({small:b.constant(c),big:b.constant(a)})}});k("z1",["b","p"],function(b,d){return{fold:function(c,a){return b.foldr(c,function(b,c){return b.bind(function(b){return a(c).map(function(a){return[a].concat(b)})})},
d.value([]))}}});k("z2",["a","1n","z0","z1","p"],function(b,d,c,a,e){var f=function(a,b){var f=b.groups(),g=f[a];return void 0===g?c("Unknown group: "+a,["No binding for group: "+a+". Known groups: "+d.keys(f)]):e.value(g)},g=function(a,c){var d=b.isArray(a)?{label:"",items:a}:a;return e.value(d)},h=function(b,c,d,e,f){return a.fold(c,function(a){return f.item(a,d,e,f)}).map(function(a){return{category:b,items:a}})};return{build:function(a,c,d,e){return(b.isString(a)?f:g)(a,c).bind(function(a){return h(a.label,
a.items,c,d,e)})}}});k("z3",["a","1n","z0","p"],function(b,d,c,a){var e=function(b,e,f,g){e=e.commands();f=e[b];return void 0===f?c("Unknown command: "+b,["No binding for command: "+b+". Known commands: "+d.keys(e)]):a.value(f)},f=function(a,b,c,d){return(void 0===a.items?g:d.menu)(a,b,c,d)},g=function(a,b,d,e){return void 0===d?c("You need a custom action factory to use this",[]):d(a)};return{build:function(a,c,d,g){return(b.isString(a)?e:f)(a,c,d,g)}}});k("v6",["2g"],function(b){return{parse:function(d){return b.getOrDie("JSON").parse(d)},
stringify:function(d){return b.getOrDie("JSON").stringify(d)}}});k("z4","a b z0 z1 v6 p".split(" "),function(b,d,c,a,e,f){var g=function(a){return d.forall(a,b.isArray)?f.value(a):d.exists(a,b.isArray)?c("Menu items must be a single array or an array where every element is an array",["Menu items must be a single array or an array where every element is an array.","Contents of menu: "+e.stringify(a)]):f.value([a])};return{build:function(b,d,f,n){return void 0===b.label||void 0===b.items||0===b.items.length?
c("Invalid toolbar configuration for menu",["Invalid menu. Must be an object containing label and items.","Contents of menu: "+e.stringify(b)]):g(b.items).bind(function(b){return a.fold(b,function(a){return n.group(a,d,f,n)})}).map(function(a){return{name:b.id,textkey:b.label,type:"submenu",contentFocus:!1,enabled:!0,icon:b.icon,commands:a}})}}});k("un","a b 1n z0 z1 z2 z3 z4 v6 p".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=c.map({group:f.build,item:g.build,menu:h.build},function(a,b){return function(){if(4!==
arguments.length)throw"Incorrect usage of builder ["+b+"]. Only given: "+arguments.length;return a.apply(null,arguments)}}),p=function(c){if(void 0===c.items)return a("Invalid group, no items specified",["Invalid group, no items specified: "+c.label]);var e=c.items;return b.isArray(e)?(c=d.bind(e,function(a,c){return b.isString(a)||b.isArray(a)||void 0!==a.label&&b.isArray(a.items)?[]:["Invalid group at index: "+c+". Must be either a string, an array or an object containing label and items. Was: "+
l.stringify(a)]}),0===c.length?m.value(e):a("Invalid toolbar configuration for groups",c)):a("Invalid toolbar, items is not an array",["Invalid toolbar, items is not an array: "+l.stringify(c)])};return{build:function(a,b,c){return p(a).bind(function(a){return e.fold(a,function(a){return n.group(a,b,c,n)})})}}});k("ur",["b","7","hg"],function(b,d,c){var a=function(){return c.isSmallTouch()},e=function(a,b){return{feature:a.feature,command:a.command,type:"pre_flatmenu",items:b}};return{shouldFlatten:a,
streamline:function(a){var c=function(a){return b.bind(a,function(a){return"submenu"===a.type?b.bind(a.commands,function(a){return c(a.items)}):"pre_flatmenu"===a.type?b.map(a.items,function(b){return{feature:a.feature,type:"general",command:b}}):[a]})};return b.map(a,function(a){var b=c(a.items);return{category:a.category,items:b}})},setup:function(b,g){var h=e(b,g);return c.choice([{predicate:a,value:d.constant(h)}],b)},make:e}});k("uo",["7","s","6u","ur","hg"],function(b,d,c,a,e){var f=function(a,
c){return{predicate:a,value:b.constant(c)}};return function(b,h,l,m,n,p){var q=function(a,b){return a()?b:{feature:d.none()}};l=q(function(){return!b&&e.isLargeDesktop()},{feature:l.ui(),command:"fullscreen",type:"general",unsupported:"Fullscreen is not supported in inline mode"});p=e.choice([f(e.isLargeDesktop,{feature:n.fileupload().ui(),command:"fileupload",type:"general"}),f(e.isLargeTouch,{feature:n.fileupload().ui(),command:"fileupload",type:"menu"})],a.make({feature:n.fileupload().ui(),command:"fileupload"},
p.allowLocalImages?["camera"]:[]));var r=q(e.isLargeDesktop,{feature:n.accessibility().ui(),command:"a11ycheck",type:"general"}),q=q(e.isLarge,{feature:n.specialchar().ui(),command:"specialchar",type:"general"}),s=e.choice([f(e.isLarge,{feature:n.blocktag().ui(),command:"bullist",type:"split-widget"})],{feature:n.blocktag().ui(),command:"bullist",type:"general"}),k=e.choice([f(e.isLarge,{feature:n.blocktag().ui(),command:"numlist",type:"split-widget"})],{feature:n.blocktag().ui(),command:"numlist",
type:"general"}),u={feature:n.formatting().ui(),command:"superscript",type:"general"},v={feature:n.formatting().ui(),command:"subscript",type:"general"},w={feature:n.formatting().ui(),command:"strikethrough",type:"general"},x={feature:n.font().ui(),command:"fontface",type:"dropdown"},y=e.choice([f(e.isTouch,{feature:n.font().ui(),command:"fontsize",type:"general"})],{feature:n.font().ui(),command:"fontsize",type:"inline-widget"}),B={feature:n.font().ui(),command:"fontcolor",type:"widget"};return{link:{feature:n.link().ui(),
command:"link",type:"general"},wordcount:{feature:n.wordcount().ui(),command:"wordcount",type:"general"},media:{feature:n.media().ui(),command:"media",type:"general"},hr:{feature:n.horizontalrule().ui(),command:"horizontalrule",type:"general"},specialchar:q,fileupload:p,table:{feature:n.table().ui(),command:"table",type:"widget"},undo:{feature:h.ui(),command:"undo",type:"general"},redo:{feature:h.ui(),command:"redo",type:"general"},styles:{feature:n.blocktag().ui(),command:"blocktag",type:"dropdown"},
language:{feature:n.parlance().ui(),command:"parlance",type:"dropdown"},ltrdir:{feature:n.directionality().ui(),command:"ltrdir",type:"general"},rtldir:{feature:n.directionality().ui(),command:"rtldir",type:"general"},bold:{feature:n.formatting().ui(),command:"bold",type:"general"},italic:{feature:n.formatting().ui(),command:"italic",type:"general"},underline:{feature:n.formatting().ui(),command:"underline",type:"general"},strikethrough:w,superscript:u,subscript:v,ul:s,ol:k,removeformat:{feature:n.formatting().ui(),
command:"removeformat",type:"general"},alignment:{feature:n.alignindent().ui(),command:"alignment",type:"dropdown"},outdent:{feature:n.alignindent().ui(),command:"outdent",type:"general"},indent:{feature:n.alignindent().ui(),command:"indent",type:"general"},blockquote:{feature:n.alignindent().ui(),command:"blockquote",type:"general"},"font-menu":{name:"font",textkey:c.key("font.menu"),type:"submenu",contentFocus:!0,commands:[{category:"Font-menu",items:[x,y,B,u,v,w]}]},"font-face":x,"font-size":y,
"font-color":B,fullscreen:l,usersettings:e.isSmallTouch()?{feature:d.none()}:{feature:m.ui(),command:"cog",type:"menu"},find:{feature:n.findreplace().ui(),command:"find",type:"general"},accessibility:r}}});k("up","a 1n z0 v6 7 s p jd 6u".split(" "),function(b,d,c,a,e,f,g,h,l){return function(){return{make:function(m){var n=function(b){return c(l.translate("errors.toolbar.missing.custom.string",b),['The required property "'+b+'" for a custom command must be a string. It was: '+a.stringify(m[b]),"Properties specified in custom command: "+
d.keys(m).join(", "),"Definition specified for custom command: "+a.stringify(m)])};if(!b.isString(m.id))return n("id");if(!b.isString(m.text))return n("text");n={};n[m.id]=e.constant({general:function(){return{toggle:!1,value:h.cssSanitise(m.id),textkey:l.raw(m.text),action:m.action,updateGeneral:e.identity,icon:void 0!==m.icon?m.icon:!1}}});return g.value({feature:f.some(n),command:m.id,type:"general"})}}}});k("uq",["6u"],function(b){return function(){var d={id:"insert",label:b.key("insert.menu"),
items:[["link","fileupload","media","table"],["specialchar","hr"]]};return{undo:{label:b.key("category.undo"),items:["undo","redo"]},insert:{label:b.key("category.insert"),items:[d]},style:{label:b.key("category.style"),items:["styles"]},language:{label:b.key("category.language"),items:["language","ltrdir","rtldir"]},emphasis:{label:b.key("category.emphasis"),items:["bold","italic","underline"]},align:{label:b.key("category.align"),items:["alignment"]},listindent:{label:b.key("category.listindent"),
items:["ul","ol","outdent","indent","blockquote"]},format:{label:b.key("category.format"),items:["font-menu","removeformat"]},tools:{label:b.key("category.tools"),items:["find","accessibility","fullscreen","usersettings"]},"table-tools":{label:b.key("category.table"),items:["table-tools"]},"image-tools":{label:b.key("category.image"),items:["image-tools","crop-tools"]}}}});k("mq","un c 6 7 uo up uq ur".split(" "),function(b,d,c,a,e,f,g,h){var l=f(),m=function(a,b){return a.bind(function(a){return b.map(function(b){return a.concat(b)})})};
return{config:function(f,p,q){return function(r,s,k,u,v){r=e(r,s,k,u,v,q);r=c.deepMerge(r,p);v={"table-tools":{feature:v.table().ui(),command:"cell",type:"palette"},"image-tools":{feature:v.imageEdit().ui(),command:"edit",type:"palette"},"crop-tools":{feature:v.imageEdit().ui(),command:"crop",type:"palette"}};r={forItems:a.constant({commands:a.constant(r),groups:g}),forContextual:a.constant({commands:a.constant(v),groups:g})};v=b.build({items:f.items},r.forItems(),l.make);r=b.build({items:f.contextual},
r.forContextual(),l.make);s=d.detect().deviceType.isTouch()?h.streamline:a.identity;return m(v,r).map(s)}}}});k("129","b 7 l 2v 20 3m".split(" "),function(b,d,c,a,e,f){var g=function(a){return function(a){f(function(){a()},0)}};return{resume:function(f){f.focus();var l=c.fromDom(f.document.body);(a.active().exists(function(a){return b.contains(["input","textarea"],e.name(a))})?g(l):d.apply)(function(){a.active().each(a.blur);a.focus(l)})}}});k("12a",["1a","1t","cy"],function(b,d,c){return{safeParse:function(a,
e){var f=c(b.get(a,e),10);return d(f)?0:f}}});k("12b",["b","ap","co","l","29"],function(b,d,c,a,e){var f=function(a){return{left:a.left,top:a.top,width:2,height:a.height}},g=function(g){if(g.collapsed){var l=a.fromDom(g.startContainer);return e.parent(l).bind(function(a){return d.rectangleAt(g.startContainer.ownerDocument.defaultView,l,g.startOffset,a,c.getEnd(a)).map(f).map(b.pure)}).getOr([])}return g.getClientRects()};return{getRectangles:function(a){a=a.getSelection();return void 0!==a&&0<a.rangeCount?
g(a.getRangeAt(0)):[]}}});k("12c",["48"],function(b){return{resolve:b.create("ephox-nomad").resolve}});k("z5","129 12a 12b 12c 7 s 1a 3n l 1r 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p="data-"+a.resolve("last-outer-height"),q=function(a){return{top:e.constant(a.top),bottom:e.constant(a.top+a.height)}},r=function(a){a=c.getRectangles(a);return 0<a.length?f.some(a[0]).map(q):f.none()},s=function(a){a=d.safeParse(a,p);var b=n.innerHeight;return a>b?f.some(a-b):f.none()};return{setup:function(a,
c){var d=l.fromDom(c.document.body),e=h.bind(l.fromDom(a),"resize",function(){s(d).each(function(a){r(c).each(function(b){b=b.top()>c.innerHeight||b.bottom()>c.innerHeight?m.min(a,b.bottom()-c.innerHeight+50):0;0!==b&&c.scrollTo(c.pageXOffset,c.pageYOffset+b)})});g.set(d,p,n.innerHeight)});g.set(d,p,n.innerHeight);return{toEditing:function(){b.resume(c)},destroy:function(){e.unbind()}}}}});k("ng",["2g"],function(b){return function(d){return new (b.getOrDie("Event"))(d)}});k("fj",["ng"],function(b){var d=
function(c){var a=b("Event");a.initEvent(c,!0,!0);return a};return{event:function(b,a){var e=d(a);b.target().dom().dispatchEvent(e)},target:function(b,a){var e=d(a);b.dom().dispatchEvent(e)}}});k("gi",["fj"],function(b){return function(d){return{closeMenus:function(c){c=c?c.target():d;b.target(c,"mousedown")}}}});k("z6","7 s 4x 3z 3n l 1r 2q 2r 31".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(){var a=m.matchMedia("(orientation: portrait)").matches;return{isPortrait:b.constant(a)}};return{get:n,
onChange:function(){var b=a.create({ready:c(["orientation"]),change:c(["orientation"])}),g=f.fromDom(m),r=null,s=e.bind(g,"orientationchange",function(){h(r);var a=n();b.trigger.change(a);k(function(){b.trigger.ready(a)})}),k=function(a){h(r);var b=m.innerHeight,c=0;r=l(function(){b!==m.innerHeight?(h(r),a(d.some(m.innerHeight))):20<c&&(h(r),a(d.none()));c++},50)};return{onAdjustment:k,events:b.registry,destroy:function(){s.unbind()}}}}});k("z7",["1a","l","2m","2y"],function(b,d,c,a){return{tag:function(){var e=
a.first("head").getOrDie(),f=a.first('meta[name="viewport"]').getOrThunk(function(){var a=d.fromTag("meta");b.set(a,"name","viewport");c.append(e,a);return a}),g=b.get(f,"content");return{maximize:function(){b.set(f,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){void 0!==g&&null!==g&&0<g.length?b.set(f,"content",g):b.remove(f,"content")}}}}});k("8q",["s","4f"],function(b,d){var c=function(a){var c=d(b.none());return{clear:function(){c.get().each(a);
c.set(b.none())},isSet:function(){return c.get().isSome()},set:function(d){c.get().each(a);c.set(b.some(d))}}};return{destroyable:function(){return c(function(a){a.destroy()})},unbindable:function(){return c(function(a){a.unbind()})},api:function(){var a=d(b.none()),c=function(){a.get().each(function(a){a.destroy()})};return{clear:function(){c();a.set(b.none())},isSet:function(){return a.get().isSome()},set:function(d){c();a.set(b.some(d))},run:function(b){a.get().each(b)}}},value:function(){var a=
d(b.none());return{clear:function(){a.set(b.none())},set:function(c){a.set(b.some(c))},isSet:function(){return a.get().isSome()},on:function(b){a.get().each(b)}}}}});k("z8",["7","3n"],function(b,d){return function(c){return function(a,e){var f=d.bind(c,"touchmove",a.move),g=d.bind(c,"touchend",a.drop);return{element:b.constant(c),start:b.noop,stop:b.noop,destroy:function(){f.unbind();g.unbind()}}}}});k("12d","7 s 2l 2y 2p 1r".split(" "),function(b,d,c,a,e,f){var g=function(a,b){var c=e.get(a);return f.floor(b/
100*c)},h=function(b,c){return a.ancestor(c,"td,th").fold(function(){return g(b,98)},function(a){return g(a,94)})},l=function(a,b,c){var d=b.dom().width;a=h(a,b);return f.max(0,f.min(a,d+c))},m=function(a,b,c){return b.dom().height+c};return{compare:function(a,c){var d=c.deltaX()-a.deltaX(),e=c.deltaY()-a.deltaY(),f=c.deltaDistance()-a.deltaDistance();return{deltaX:b.constant(d),deltaY:b.constant(e),deltaDistance:b.constant(f)}},extract:function(a){var c=a.raw().touches;if(2>c.length)return d.none();
a=f.abs(c[0].clientX-c[1].clientX);var c=f.abs(c[0].clientY-c[1].clientY),e=f.sqrt(f.pow(a,2)+f.pow(c,2));return d.some({deltaX:b.constant(a),deltaY:b.constant(c),deltaDistance:b.constant(e)})},resize:function(a,b,d){var g=c.getRaw(b,"height"),s=c.getRaw(b,"width"),k=0<d.deltaDistance()?1:-1,u=k*f.abs(d.deltaX()),v=k*f.abs(d.deltaY());d=l(a,b,u);k=m(a,b,v);u=f.abs(u)>f.abs(v);c.setAll(b,{height:u?"auto":k+"px",width:u?d+"px":"auto",transform:"translate3d(0, 0, 0)"});e.get(b)>h(a,b)&&(g.each(function(a){c.set(b,
"height",a)}),s.each(function(a){c.set(b,"width",a)}))}}});k("z9","vy ho s 12d 4f 2l 3n 20".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m,n,p){var q=e(c.none());n=b.mode({compare:a.compare,extract:a.extract,sink:n,mutate:function(b,c){q.get().each(function(b){a.resize(m,b,c)})}});var r=d.transform({},{mode:n}),s=g.bind(l,"touchstart",function(a){"img"===h.name(a.target())&&2===a.raw().touches.length&&(q.set(c.some(a.target())),r.on(),r.go(m))});r.events.stop.bind(function(){q.get().each(function(a){f.remove(a,
"transform")});p()});return{destroy:function(){s.unbind();r.destroy()}}}});k("us","b c z5 gi z6 z7 7 s 8q z8 z9 1x 2l 3n l 2v q 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,s,k,u,v){var w=6<=d.detect().os.version.major;return function(d,y,B){var z=B.toolbar.element(),A=f.tag(),C=[],D=s.fromDom(u),E=a(z),F=null,G=l.api(),I=h.none(),H=function(){G.run(function(a){a.toEditing()})},L=function(){E.closeMenus()},J=function(){d.getSelection().each(function(a){a=a.collapsed()?"0px":"23px";q.set(z,
"margin-top",a)})},K=function(a){q.set(z,"margin-top","0px")},M=function(){var a=[r.bind(z,"touchmove",E.closeMenus)];C=d.doc().map(function(a){return y||!0===w?[]:[r.bind(a,"selectionchange",J),r.bind(D,"focusin",K)]}).getOr([]).concat(a)},Q=function(){b.each(C,function(a){a.unbind()})};return{enter:function(){d.body().each(function(a){d.doc().each(function(b){d.win().each(function(f){k.focus(a);F=e.onChange();var l=m(b),l=n(b,a,l,g.noop);I=h.some(l);f=c.setup(v,f);G.set(f);d.events.toEditing.bind(H);
F.events.change.bind(L)})})});p.add(z,"ephox-polish-mobile-show");B.toolbar.refresh();A.maximize();M()},exit:function(){G.clear();d.events.toEditing.unbind(H);F.events.change.unbind(L);null!==F&&F.destroy();A.restore();Q()},destroy:function(){I.each(function(a){a.destroy()});Q()}}}});k("ut","b 7 6u 30 4x 3z 1x 2l 3n l 2m 2o 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){return function(){var q=m.fromTag("div");g.add(q,a.resolve("disabled-mask"));var s=!1,k=m.fromTag("div");g.add(k,a.resolve("content-container"));
var u=m.fromTag("div");g.add(u,a.resolve("tap-icon"));n.append(k,u);var v=m.fromTag("div");g.add(v,a.resolve("disclosure"));n.append(v,m.fromText(c.translate("taptoedit")));n.append(k,v);n.append(q,k);var w=f.create({fullscreen:e([])}),x=function(a){var c=q.dom().getClientRects()[0];return b.forall(a,function(a){return a.pageY>=c.top&&a.pageY<=c.top+c.height&&a.pageX>=c.left&&a.pageX<=c.left+c.width})},y=[l.bind(q,"touchmove",function(a){s=!0}),l.bind(q,"touchend",function(a){var b=a.raw().changedTouches;
x(b)&&!s&&(a.kill(),w.trigger.fullscreen())}),l.bind(q,"touchstart",function(a){s=!1}),l.bind(q,"click",function(a){a.kill();w.trigger.fullscreen()})];return{element:d.constant(q),events:w.registry,destroy:function(){b.each(y,function(a){a.unbind()});p.remove(u);p.remove(v);p.remove(k);p.remove(q)},show:function(){h.remove(q,"display")},hide:function(){h.set(q,"display","none")}}}});k("mr","bt 30 us ut 1x 2v 2m".split(" "),function(b,d,c,a,e,f,g){return function(h,l,m,n,p,q){var r=q.element(),s=c(h,
p.fillscreen,q),k=function(){s.enter();n.actions().maximize()},u=function(){var b=a();g.append(q.element(),b.element());b.events.fullscreen.bind(function(a){n.actions().maximize()})};return{init:function(){q.socket(h);h.events.scrollToCursor.bind(function(){b.cursorIntoView(h)})},loaded:function(){var a=!0===p.fillscreen;(e.has(r,d.resolve("fullscreen-maximized"))||a?k:u)()},restoreEditor:function(){n.actions().restore();s.exit()},destroy:function(){h.body().each(f.blur)}}}});k("ep",["7","mp","mq",
"mr"],function(b,d,c,a){return function(e,f,g,h,l){var m=h.toolbar.items,n=function(b){var n=a(e,f,g,l,h,b),r=d();b=c.config({items:[["back"]].concat(m),contextual:[]},{back:{feature:r.ui(),command:"back",type:"general"}},{allowLocalImages:h.allowLocalImages});r.events.back.bind(function(){n.restoreEditor()});return{init:n.init,loaded:n.loaded,config:b,destroy:function(){n.destroy();r.destroy()}}};return{tabbed:n,full:n,destroy:b.noop}}});k("eq",["7","mq","mr"],function(b,d,c){return function(a,e,
f,g,h){var l=g.toolbar.items,m=function(b){var m=c(a,e,f,h,g,b);b=d.config({items:l,contextual:[]},{},{allowLocalImages:g.allowLocalImages});return{init:m.init,loaded:m.loaded,config:b,destroy:function(){m.destroy()}}};return{tabbed:m,full:m,destroy:b.noop}}});k("er",["7","bt","mq"],function(b,d,c){return function(a,e,f,g){e=function(e){return{init:function(){e.socket(a);a.events.scrollToCursor.bind(function(){d.cursorIntoView(a)});a.events.toEditing.bind(a.focus)},loaded:b.noop,config:c.config(g.toolbar,
{},{allowLocalImages:g.allowLocalImages}),destroy:b.noop}};return{tabbed:e,full:e,destroy:b.noop}}});k("za",["b","1a","2l","20","46"],function(b,d,c,a,e){var f=function(a){return a.body().map(function(a){a=c.get(a,"background-color");return void 0!==a&&""!==a?"background-color:"+a+"!important":"background-color:rgb(255,255,255)!important"}).getOr("background-color:rgb(255,255,255)!important")};return{clobberStyles:function(c,h){var l=e.ancestors(c,"*"),l=b.bind(l,function(a){return e.siblings(a,"*").concat(a)});
b.each(l,function(b){var c=d.get(b,"style"),c=void 0===c?"no-styles":c.trim(),e=a.name(b);e="body"===e||"html"===e?"position:absolute!important;top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;"+f(h):"position:static!important;z-index:0!important;background-color:rgb(255,255,255)!important;";c!==e&&(d.set(b,"data-ephox-mobile-fullscreen-style",c),d.set(b,"style",e))})},restoreStyles:function(){var a=e.all("[data-ephox-mobile-fullscreen-style]");b.each(a,
function(a){var b=d.get(a,"data-ephox-mobile-fullscreen-style");"no-styles"!==b?d.set(a,"style",b):d.remove(a,"style");d.remove(a,"data-ephox-mobile-fullscreen-style")})}}});k("uu","z7 7 s 30 ut za 1x 2l q".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,n){var p=b.tag(),q=c.none(),r=e();return{maximize:function(){q=c.some(l.body.scrollTop);h.set(r.element(),"display","none");g.add(m,a.resolve("fullscreen-maximized"));f.clobberStyles(m,n);p.maximize()},restore:function(){f.restoreStyles();
g.remove(m,a.resolve("fullscreen-maximized"));p.restore();h.remove(r.element(),"display");q=q.bind(function(a){l.body.scrollTop=a;return c.none()})},destroy:function(){r.destroy()},mask:d.constant(r)}}});k("12f",["2l","l","2v","2m","2o"],function(b,d,c,a,e){return{input:function(f,g){var h=d.fromTag("input");b.setAll(h,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"});a.append(f,h);c.focus(h);g(h);e.remove(h)}}});k("g8",["2v","3m"],function(b,d){return{refreshInput:function(c){var a=
c.dom().selectionStart,e=c.dom().selectionEnd,f=c.dom().selectionDirection;d(function(){c.dom().setSelectionRange(a,e,f);b.focus(c)},50)},refresh:function(b){var a=b.getSelection();if(0<a.rangeCount){var d=a.getRangeAt(0);b=b.document.createRange();b.setStart(d.startContainer,d.startOffset);b.setEnd(d.endContainer,d.endOffset);a.removeAllRanges();a.addRange(b)}}}});k("12g",["g8","1b","l","2v"],function(b,d,c,a){return{resume:function(e,f){a.active().each(function(b){d.eq(b,f)||a.blur(b)});e.focus();
a.focus(c.fromDom(e.document.body));b.refresh(e)}}});k("zd","b gi 12f 12g 7 gy 2k 2l 3n 2v 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var q=function(a,b){var c={unbind:e.noop};return h.getRaw(a,"overflow-x").is("auto")?p.descendant(a,".ephox-chameleon-toolbar").map(function(a){var c=f(function(){b()},500);return l.bind(a,"scroll",c.throttle)}).getOr(c):c};return{stubborn:function(e,f,h,p){var k=d(p),w=function(){a.resume(e,h)},x=q(p,w),y=l.bind(f,"keydown",function(a){b.contains(["input",
"textarea"],n.name(a.target()))||(k.closeMenus(void 0),w())});return{toReading:function(){c.input(g.body(),m.blur)},toEditing:w,onToolbarTouch:function(a){},destroy:function(){y.unbind();x.unbind()}}},timid:function(b,c,d,f){return{toReading:function(){m.blur(d)},toEditing:function(){a.resume(b,d)},onToolbarTouch:function(){m.blur(d)},destroy:e.noop}}}});k("12h",["s","4x","3z","3n"],function(b,d,c,a){return{touch:function(e){var f=c.create({touchstart:d(["raw"]),touchend:d(["raw"])}),g=!1,h=b.none(),
l=a.capture(e,"touchstart",function(c){g=!0;h=b.some(a.capture(e,"touchend",function(a){g=!1;f.trigger.touchend(a.raw());m()}));f.trigger.touchstart(c.raw())}),m=function(){h.each(function(a){a.unbind()})};return{isTouching:function(){return g},events:f.registry,destroy:function(){l.unbind();m()}}}}});k("14d","ap 12f 12c 7 2k 3e 2y 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a){return a.body().map(function(a){a=h.documentElement(a);var b=c.resolve("unfocused-selection");return g.descendant(a,
"."+b).bind(function(a){return f.absolute(a).top})})};return{switchSelection:function(a,c){var f=c.isActive,g=a.cursor(),h=!1,l=function(){a.win().each(function(a){h=!1;c.update();g.save();b.clearAll(a)})};return{on:function(){f()||l()},off:function(){f()&&!h&&(c.clear(),g.restore())},fakeOut:function(){h=!0;d.input(e.body(),g.restore)}}},inView:function(a,b,c){return function(){return l(b).map(function(b){var c=a.dom().scrollTop;return 0<b()-c})}}}});k("14e",[],function(){return{onScroll:function(b,
d,c,a){var e=function(){b()||f()},f=function(){a.events.touchend.unbind(e);a.isTouching()?a.events.touchend.bind(e):(c().getOr(!0)?d.off:d.fakeOut)()};return{start:function(){a.events.touchend.unbind(e);d.on()},stop:f,destroy:function(){a.events.touchend.unbind(e)}}}}});k("12i",["14d","14e"],function(b,d){return{toFake:b.switchSelection,inView:b.inView,onScroll:d.onScroll}});k("14z",["s","k"],function(b,d){return{findDevice:function(c,a){return d.findMap([{width:320,height:480,keyboard:{portrait:300,
landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(d){return c<=d.width&&a<=d.height?b.some(d.keyboard):b.none()}).getOr({portrait:a/5,landscape:c/4})}}});k("14f",["z6","14z","2l","64","31"],function(b,d,c,a,e){var f=d.findDevice(e.screen.width,
e.screen.height),g=function(c){c=a.get(c);var d=b.get().isPortrait(),g=d?f.portrait:f.landscape;return c-((d?e.screen.height:e.screen.width)-e.innerHeight>g?0:g)};return{getGreenzone:g,updatePadding:function(b,d){var e=g(d),e=a.get(d)-e;c.set(b,"padding-bottom",e+"px")}}});k("12m","b 3f 12a 14f 12c 7 4g 1a 2l 64 46 1t cy 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r){var k=g.generate([{fixed:["element","offsetY"]},{scroller:["element","offsetY"]}]),t="data-"+e.resolve("position-y-fixed"),u=
"data-"+e.resolve("scrolling"),v="data-"+e.resolve("last-window-height"),w=function(a){return c.safeParse(a,t)},x=function(a){var b=w(a);return("true"===h.get(a,u)?k.scroller:k.fixed)(a,b)},y=function(a){var b=h.get(a,"style");l.setAll(a,{position:"absolute",top:"0px"});h.set(a,t,"0px");return{restore:function(){h.set(a,"style",b||"");h.remove(a,t)}}},B=function(a,b,c){var e=h.get(c,"style");d.register(c);l.setAll(c,{position:"absolute",height:b+"px",width:"100%",top:a+"px"});h.set(c,t,a+"px");h.set(c,
u,"true");return{restore:function(){d.deregister(c);h.set(c,"style",e||"");h.remove(c,t);h.remove(c,u)}}},z=function(a,b){var c=r.innerHeight;h.set(a,v,c+"px");return c-b};return{findFixtures:function(a){a=n.descendants(a,"["+t+"]");return b.map(a,x)},takeover:function(b,d,e){var g=y(e),n=m.get(e),p=z(b,n),q=B(n,p,b),n=function(){var a=r.innerHeight,d=c.safeParse(b,v);return a>d},k=function(){var c=m.get(e),f=z(b,c);h.set(b,t,c+"px");l.set(b,"height",f+"px");a.updatePadding(d,b)};a.updatePadding(d,
b);return{setViewportOffset:function(a){h.set(b,t,a+"px");k()},isExpanding:n,isShrinking:f.not(n),refresh:k,restore:function(){g.restore();q.restore()}}},getYFixedData:w}});k("14g",["s","1r","2q","2r"],function(b,d,c,a){var e=function(a,c,e){return d.abs(a-c)<=e?b.none():a<c?b.some(a+e):b.some(a-e)};return{create:function(){var b=null;return{animate:function(g,h,l,m,n,p){c(b);var q=function(a){c(b);n(a)};b=a(function(){var a=g();e(a,h,l).fold(function(){c(b);n(h)},function(e){m(e,q);var l=g();if(l!==
e||d.abs(l-h)>d.abs(a-h))c(b),n(h)})},p)}}},adjust:e}});k("12k","3l 12a 12m 14g 12c 7 1a 2l 1r cy 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=a.create(),q="data-"+e.resolve("last-scroll-top"),r=function(a){a=h.getRaw(a,"top").getOr(0);return m(a,10)},k=function(a){return m(a.dom().scrollTop,10)},t=function(a,b){var d=b+c.getYFixedData(a)+"px";h.set(a,"top",d)};return{moveScrollAndTop:function(a,c,d){return b.nu(function(b){var e=f.curry(k,a);p.animate(e,c,15,function(b){a.dom().scrollTop=
b;h.set(a,"top",r(a)+15+"px")},function(e){a.dom().scrollTop=c;h.set(a,"top",d+"px");b(c)},10)})},moveOnlyScroll:function(a,c){return b.nu(function(b){var e=f.curry(k,a);g.set(a,q,e());var h=l.abs(c-e()),h=l.ceil(h/10);p.animate(e,c,h,function(b,c){d.safeParse(a,q)!==a.dom().scrollTop?c(a.dom().scrollTop):(a.dom().scrollTop=b,g.set(a,q,b))},function(d){a.dom().scrollTop=c;g.set(a,q,c);b(c)},10)})},moveOnlyTop:function(a,c){return b.nu(function(b){var d=f.curry(r,a),e=function(b){h.set(a,"top",b+"px")},
g=l.abs(c-d()),g=l.ceil(g/10);p.animate(d,c,g,e,function(a){e(c);b(c)},10)})},moveWindowScroll:function(a,c,d){return b.nu(function(b){var e=function(b){t(a,b);t(c,b);n.scrollTo(0,b)};p.animate(function(){return n.pageYOffset},d,15,e,function(a){e(a);b(a)},10)})}}});k("12j",["g8","14f","12k","7","cy"],function(b,d,c,a,e){return{scrollIntoView:function(e,g,h,l){var m=d.getGreenzone(g);e=a.curry(b.refresh,e);h>m||l>m?c.moveOnlyScroll(g,g.dom().scrollTop-m+l).get(e):0>h&&c.moveOnlyScroll(g,g.dom().scrollTop+
h).get(e)}}});k("12l","b 3l 12k 12m 2l cy".split(" "),function(b,d,c,a,e,f){var g=function(a,b){return a.fold(function(a,c){e.set(a,"top",b+c+"px");return d.pure(c)},function(a,d){var g=b+d,h=e.getRaw(a,"top").getOr(d),h=g-f(h,10),h=a.dom().scrollTop+h;return c.moveScrollAndTop(a,h,g)})};return{updatePositions:function(c,e){var f=a.findFixtures(c),f=b.map(f,function(a){return g(a,e)});return d.par(f)}}});k("12n","b 12b 12g 12c 1x 43 2l 3n l 2m 35 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,
q){return function(r,k){var t=r.document,u=l.fromTag("div");e.add(u,a.resolve("unfocused-selections"));m.append(l.fromDom(t.documentElement),u);var v=h.bind(u,"touchstart",function(a){a.prevent();c.resume(r,k);x()}),w=function(b){var c=l.fromTag("span");f.add(c,[a.resolve("layer-editor"),a.resolve("unfocused-selection")]);g.setAll(c,{left:b.left+"px",top:b.top+"px",width:b.width+"px",height:b.height+"px"});return c},x=function(){p.empty(u)};return{update:function(){x();var a=d.getRectangles(r),a=
b.map(a,w);n.append(u,a)},isActive:function(){return 0<q.children(u).length},destroy:function(){v.unbind();p.remove(u)},clear:x}}});k("12o",["2j","7","4f"],function(b,d,c){return function(a){var e=c(b.pure({}));return{start:function(c){var g=b.nu(function(b){return a(c).get(b)});g.get(d.identity);e.set(g)},idle:function(a){e.get().get(function(){a()})}}}});k("ze","12h z6 12i 12b 12j 12k 12l 12m 12n 12o 7 gy s 2k 2l 3n l 1r 2q 65 o cy 2r 3m 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,k,t,u,
v,w,x,y,B,z,A,C){var D=function(b,c,d,e,h){var l=m(function(a){return f.moveWindowScroll(b.toolbar.element(),b.viewport(),a)}),r=function(){var c=a.getRectangles(h);return q.from(c[0]).bind(function(a){var c=a.top-b.viewport().dom().scrollTop;return c>C.innerHeight+5||-5>c?q.some({top:n.constant(c),bottom:n.constant(c+a.height)}):q.none()})},k=p(function(){l.idle(function(){g.updatePositions(c,d.pageYOffset).get(function(a){r().each(function(a){b.viewport().dom().scrollTop=b.viewport().dom().scrollTop+
a.top()});l.start(0);e.refresh()})})},1E3),s=t.bind(u.fromDom(d),"scroll",function(){0>d.pageYOffset||k.throttle()});g.updatePositions(c,d.pageYOffset).get(n.identity);return{unbind:s.unbind}};return{setup:function(a){var g=a.cWin(),m=a.ceBody(),p=a.socket(),q=a.toolbar(),w=a.gui(),v=a.content(),x=a.keyboardType();a=a.isScrolling();var y=h.takeover(w.viewport(),m,w.toolbar.element()),B=x(g,r.body(),v.element(),w.toolbar.element()),z=d.onChange();z.events.ready.bind(y.refresh);z.onAdjustment(function(){y.refresh()});
var A=t.bind(u.fromDom(C),"resize",function(){y.isExpanding()&&y.refresh()}),O=D(w,r.body(),C,y,g),V=l(g,v.element()),U=function(){V.clear()},m=c.toFake(v,V),p=c.inView(p,v,q),N=b.touch(u.fromDom(g)),X=c.onScroll(a,m,p,N);return{toEditing:function(){B.toEditing();U()},toReading:function(){B.toReading()},onToolbarTouch:function(a){B.onToolbarTouch(a)},refreshSelection:function(){V.isActive()&&V.update()},clearSelection:U,highlightSelection:function(){V.update()},scrollIntoView:function(a,b){e.scrollIntoView(g,
w.viewport(),a,b)},updateToolbarPadding:n.noop,setViewportOffset:function(a){y.setViewportOffset(a);f.moveOnlyTop(w.viewport(),a).get(n.identity)},syncHeight:function(){k.set(v.element(),"height",v.element().dom().contentWindow.document.body.scrollHeight+"px")},selectionScrollStarted:function(){X.start()},selectionScrollStopped:function(){X.stop()},destroy:function(){y.restore();z.destroy();O.unbind();A.unbind();B.destroy();X.destroy();N.destroy();V.destroy()}}}}});k("12p",["12c","1a"],function(b,
d){var c="data-"+b.resolve("horizontal-scroll"),a=function(a){var b;(b=0<a.dom().scrollTop)||(a.dom().scrollTop=1,b=0!==a.dom().scrollTop,a.dom().scrollTop=0);return b},e=function(a){var b;(b=0<a.dom().scrollLeft)||(a.dom().scrollLeft=1,b=0!==a.dom().scrollLeft,a.dom().scrollLeft=0);return b};return{markAsHorizontal:function(a){d.set(a,c,"true")},hasScroll:function(b){return"true"===d.get(b,c)?e:a}}});k("zf",["12p","7","s","3n","2y"],function(b,d,c,a,e){var f=function(a){var b=a.dom().scrollTop,d=
a.dom().scrollHeight;a=a.dom().offsetHeight;return 0>=b?c.some(1):b+a>=d?c.some(d-a-1):c.none()},g=function(a){f(a).each(function(b){a.dom().scrollTop=b})},h=function(b,c){return a.bind(b,"touchstart",function(a){c(a.target()).each(g)})};return{fixEdges:g,exclusive:function(c,f){return a.bind(c,"touchmove",function(a){e.closest(a.target(),f).filter(b.hasScroll).fold(function(){a.raw().preventDefault()},d.noop)})},link:function(a,b){return h(a,d.constant(b))},ancestor:function(a,b){return h(a,function(a){return e.closest(a,
b)})},indirect:h,markAsHorizontal:function(a){b.markAsHorizontal(a)}}});k("ou",["54","l","2m","2o","29"],function(b,d,c,a,e){var f=function(a){return d.fromText(b.zeroWidth(),a.dom())};return{runAndRemove:function(b,h){var l=e.owner(b),m=d.fromTag("span",l.dom());c.append(m,f(l));c.prepend(b,m);l=h(m);a.remove(m);return l},enrichAndRemove:function(b,d){var l=f(e.owner(b));c.append(b,l);var m=d(b);a.remove(l);return m}}});k("h5","ot 7 s bp ou mo 33 3d 2k 2l 64 3e 20 29 9z cy".split(" "),function(b,
d,c,a,e,f,g,h,l,m,n,p,q,r,k,t){var u=g.immutable("left","top","height","direction","absolute"),v=function(a){var b=m.get(a,"display");return{backup:function(){m.set(a,"display","inline-block")},restore:function(){m.set(a,"display",b)}}},w={backup:d.noop,restore:d.noop},x=function(b,c){var f=e.enrichAndRemove(c,function(b){return{position:d.constant(a.find(b)),height:d.constant(n.getOuter(b))}}),g=p.absolute(c);return u(f.position().left(),f.position().top(),f.height(),b.directionAt(c),g)},y=function(a){return q.isElement(a.startContainer())?
c.some(a.startContainer()):q.isElement(a.endContainer())?c.some(a.endContainer()):r.parent(a.startContainer()).filter(q.isElement).orThunk(function(){return r.parent(a.endContainer()).filter(q.isElement)})},B=function(b,c){return y(c).fold(function(){return u(0,0,0,b.uiDirection(),h(0,0))},function(c){var d=a.find(c),e=n.get(c),f=p.absolute(c);return u(d.left(),d.top(),e,b.directionAt(c),f)})},z=function(a,b,c,d){return f.diagnose(a,c)(d,function(a){var d=k.isVisible(a)||"br"===q.name(a)?w:v(a);d.backup();
a=l.inBody(a)?x(b,a):B(b,c);d.restore();return a})},A=function(d,f,g,h){var l=g.startContainer(),r=g.startOffset();if("body"===q.name(l)&&0===r){var k=g.startContainer();d=a.find(k);h=p.absolute(k);var l=t(m.get(k,"padding-top"),10),r=t(m.get(k,"padding-left"),10),s=e.runAndRemove(k,n.getOuter);f=f.directionAt(k);g=b(u(d.left()+r,d.top()+l,s,f,h),c.some(g))}else g=z(d,f,g,h);return g},C=function(a,b,c,d,e){b.focus();a=A(b.isRoot,a,c,e);a.cursor().each(function(a){b.setSelection(a.startContainer(),
a.startOffset(),a.endContainer(),a.endOffset())});a=a.result();d(a)};return{insertAt:C,insertAtCursor:function(a,b,c,d){b.getSelection().each(function(e){C(a,b,e,c,d)})}}});k("zg",["7","3n","20"],function(b,d,c){return function(a){return function(e,f){var g=d.bind(a,"touchmove",e.move),h=d.bind(a,"touchend",e.drop),l=d.bind(a,"gesturestart",function(a){"img"===c.name(a.target())&&a.prevent()});return{element:b.constant(a),start:b.noop,stop:b.noop,destroy:function(){g.unbind();h.unbind();l.unbind()}}}}});
k("uv","b 3f fv ap zd ze gi z6 zf gy s 8q h5 30 z9 zg 33 1x 1b 2l 3n l 2v 64 3e 2y 2q 65 q 2r 3m 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,k,t,u,v,w,x,y,B,z,A,C,D,E,F,G,I,H,L){return function(H,F,M,Q,R,P,O,V){var U=[],N=P.toolbar.element(),X=P.banners(),T=P.viewport(),W=n.none(),Z=g(N),ba=null,$=p.api(),ha=n.none(),ga=d.event(T),ea=u.immutableBag("cWin ceBody socket toolbar gui content keyboardType isScrolling".split(" "),[]),da=function(){$.run(function(a){a.highlightSelection()})},Y=function(){$.run(function(a){a.refreshSelection()})},
S=function(a){var b=C.absolute(a).top()-T.dom().scrollTop;$.run(function(c){c.scrollIntoView(b,b+A.get(a))})},aa=function(){q.insertAtCursor(Q,H,function(a){var b=a.absolute().top()-T.dom().scrollTop;$.run(function(c){c.scrollIntoView(b,b+a.height())})})},ca=function(a){aa();$.run(function(a){a.syncHeight()})},ia=function(a){var b=A.get(P.toolbar.element());$.run(function(a){a.setViewportOffset(b)});Y();ca()},Ca=function(a){S(a.element())},ja=m(ca,300),la=function(){Z.closeMenus()},sa=function(){ma();
var a=I(function(){0===L.pageYOffset&&(E(a),ca())},100)},ka=function(){$.run(function(a){a.clearSelection()})},pa=function(){ka();ja.throttle()},qa=function(){$.run(function(a){a.toEditing()})},ra=function(){$.run(function(a){a.toReading()})},fa=function(a){$.run(function(b){b.onToolbarTouch(a)})},ma=function(){(h.get().isPortrait()?v.remove:v.add)(P.element(),r.resolve("mobile-landscape"))},za=function(a){var b=x.get(a,"background-color");void 0!==b&&""!==b&&x.set(a,"-webkit-tap-highlight-color",
b)},Aa=function(b){var d=H.win().getOrDie(),e=function(e){z.focus(b);e=e.raw().changedTouches[0];c.find(d,e.pageX,e.pageY).each(function(b){a.set(d,b)})},f=H.doc().map(function(a){var c=t(a),c=k(a,b,c,ca);ha=n.some(c);var d=B.fromDom(a.dom().documentElement);return[y.bind(a,"touchend",function(a){w.eq(d,a.target())&&e(a)})]}).getOr([]),g=[y.capture(N,"touchstart",function(a){da();fa(a)}),y.bind(b,"click",na),y.bind(N,"touchmove",Z.closeMenus)];U=f.concat(g)},na=function(a){a.kill()};return{exit:function(){H.body().each(function(a){x.remove(X,
"display");x.set(P.viewport(),"overflow","hidden");W=W.bind(function(a){a.unbind();return n.none()});v.remove(P.toolbar.element(),r.resolve("mobile-show"));$.clear();z.blur(a);x.remove(a,"padding-top");b.each(U,function(a){a.unbind()});O.restore();H.events.keyup.unbind(pa);H.events.domChanged.unbind(ja.throttle);H.events.scrollToCursor.unbind(ja.throttle);H.events.scrollToElement.unbind(Ca);H.events.domChanged.unbind(Y);H.events.nodeChanged.unbind(Y);H.events.toEditing.unbind(qa);H.events.toReading.unbind(ra);
ba.events.change.unbind(la);ba.events.ready.unbind(sa);P.toolbar.events.transitionend.unbind(ia);null!==ba&&ba.destroy()})},enter:function(a){H.body().each(function(a){H.win().each(function(b){ba=h.onChange();O.maximize();Aa(a);z.focus(a);W=n.some(l.exclusive(M,"."+d.scrollable()));x.getRaw(P.toolbar.element(),"overflow-x").is("auto")&&D.descendant(P.toolbar.element(),".ephox-chameleon-toolbar").each(function(a){l.markAsHorizontal(a);d.register(a)});za(a);ma();G.body.scrollTop=0;v.add(P.toolbar.element(),
r.resolve("mobile-show"));P.toolbar.refresh();x.set(X,"display","block");$.set(f.setup(ea({cWin:b,ceBody:a,socket:T,toolbar:N,gui:P,content:H,keyboardType:e.stubborn,isScrolling:ga.isScrolling})));H.events.keyup.bind(pa);H.events.domChanged.bind(ja.throttle);H.events.scrollToCursor.bind(ja.throttle);H.events.scrollToElement.bind(Ca);H.events.domChanged.bind(Y);H.events.nodeChanged.bind(Y);H.events.toEditing.bind(qa);H.events.toReading.bind(ra);ba.events.change.bind(la);ba.events.ready.bind(sa);P.toolbar.events.transitionend.bind(ia);
ca()})})},destroy:function(){ha.each(function(a){a.destroy()});W.each(function(a){a.unbind()});ga.destroy()}}}});k("ms","7 uu uv l 2v 2d 2m 29 q".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,n,p,q,r){var k=d(r.element(),m),t=a.fromDom(l),u=m.element(),v=b.constant(!0===q.fillscreen),w=c(m,n,t,p,u,r,k,v),x=function(b){var c=h.children(b),d;if(!(d=0===c.length)){if(c=1===c.length)c=f.get(b),c=10===c.charCodeAt(0)&&10===c.charCodeAt(1);d=c}d&&(c=a.fromHtml("<p><br></p>"),g.append(b,c));w.enter()},
y=function(a){g.append(r.element(),k.mask().element());k.mask().events.fullscreen.bind(function(a){w.enter()})},B=function(a){(v()?x:y)(a)};return{init:function(){r.socket(m)},loaded:function(){m.body().each(B)},restoreEditor:function(){m.body().each(e.blur);m.element().dom().focus();m.element().dom().blur();w.exit()},destroy:function(){m.body().each(e.blur);w.destroy();k.destroy()}}}});k("es",["7","mp","mq","ms"],function(b,d,c,a){return function(e,f,g,h){var l=h.toolbar.items;return{tabbed:function(b){var n=
a(e,f,g,h,b),p=d();b=c.config({items:[["back"]].concat(l),contextual:[]},{back:{feature:p.ui(),command:"back",type:"general"}},{allowLocalImages:h.allowLocalImages});p.events.back.bind(function(){n.restoreEditor()});return{init:n.init,loaded:n.loaded,config:b,destroy:function(){n.destroy();p.destroy()}}},full:b.die("mobile does not support fullscreen layout"),destroy:b.noop}}});k("et",["7","mq","ms"],function(b,d,c){return function(a,e,f,g){var h=g.toolbar.items;return{tabbed:function(b){var m=c(a,
e,f,g,b);b=d.config({items:h,contextual:[]},{},{allowLocalImages:g.allowLocalImages});return{init:m.init,loaded:m.loaded,config:b,destroy:function(){m.restoreEditor();m.destroy()}}},full:b.die("mobile does not support fullscreen layout"),destroy:b.noop}}});k("7u","c ep eq er es et".split(" "),function(b,d,c,a,e,f){var g=b.detect();return function(b,l,m,n,p){return(g.deviceType.isiOS()?!0===p.fillscreen?f:e:g.deviceType.isAndroid()?!0===p.fillscreen?c:d:a)(b,l,m,p,n)}});k("7v",["7","4x","3z","4f"],
function(b,d,c,a){return function(e){var f=c.create({spelling:d(["value"]),autocorrect:d(["value"]),linkpreviews:d(["value"]),capitalisation:d(["value"]),analytics:d(["message"])}),g=a(e.spelling),h=a(e.autocorrect),l=a(e.linkpreviews),m=a(e.capitalisation);e=function(a,b,c){return function(){return{get:c.get,set:function(d){f.trigger.analytics(b+"_"+(d?"on":"off"));f.trigger[a](d);c.set(d)}}}};return{spelling:e("spelling","spellcheck",g),autocorrect:e("autocorrect","autocorrect",h),linkpreviews:e("linkpreviews",
"linkpreviews",l),capitalisation:e("capitalisation","capitalisation",m),state:function(){return{spelling:g.get(),autocorrect:h.get(),linkpreviews:l.get(),capitalisation:m.get()}},events:f.registry,destroy:b.noop}}});k("eu",["54","8w","7","l","2m"],function(b,d,c,a,e){var f=function(c,d,e){d.body().each(function(f){e.save();var n=a.fromHtml(b.zeroWidth());c(f,n);d.setSelection(n,0,n,0)})};return{upOrLeft:function(a,b,l){a.setRelativeSelection(d.before(l),d.before(l));a.getSelection().fold(function(){f(e.prepend,
a,b)},c.noop)},right:function(a,b,l){a.setRelativeSelection(d.after(l),d.after(l));a.getSelection().fold(function(){f(e.append,a,b)},c.noop)}}});k("ev","co s i8 1b 6e 29".split(" "),function(b,d,c,a,e,f){return{left:function(a,h,l){return a(h)&&b.isStart(h,l)?d.none():b.isStart(h,l)?c.before(h,a).filter(function(a){return!e.ancestor(a,"head")}):a(h)&&0<l?f.child(h,l-1):d.none()},right:function(a,h,l){return a(h)&&b.isEnd(h,l)?d.none():b.isEnd(h,l)?c.after(h,a).filter(function(b){return a(b)||e.ancestor(b,
"body")}):a(h)&&l<b.getEnd(h)?f.child(h,l+1):d.none()},isFirstInContent:function(b,c){return b.body().map(function(b){b=f.children(b);return a.eq(b[0],c)}).getOr(!1)},isLastInContent:function(b,c){return b.body().map(function(b){b=f.children(b);return 0<b.length&&a.eq(b[b.length-1],c)}).getOr(!1)}}});k("ew",["b","s"],function(b,d){var c=function(a,b){return a.getSelection().bind(function(c){return c.collapsed()?b(a.isRoot,c.startContainer(),c.startOffset()):d.none()})},a=function(a,c){return b.foldr(a,
function(a,b){return b(c).or(a)},d.none())};return{get:function(b,d,g){return c(b,g).bind(function(b){return a(d,b)})}}});k("7w",["eu","ev","ew","2o"],function(b,d,c,a){return function(e,f,g){var h=f.all();h.on();var l=[];h.events.backspace.bind(function(){c.get(e,l,d.left).each(a.remove)});f=function(a){var f=a.stopper();c.get(e,l,d.left).each(function(a){f();b.upOrLeft(e,g,a)})};h.events.right.bind(function(a){var f=a.stopper();c.get(e,l,d.right).each(function(a){f();b.right(e,g,a)})});h.events.left.bind(f);
h.events.up.bind(f);return{registerSkip:function(a){l.push(a)},destroy:function(){h.destroy()}}}});k("7x",["7","s","ba","be"],function(b,d,c,a){return function(e,f){(f.error?d.some(f.error):d.none()).map(function(b){return c(a.get(b.name,[b]))}).each(e.displayBanner);return{destroy:b.noop}}});k("mw",["33"],function(b){return{response:b.immutable("selection","kill")}});k("ey",[],function(){var b=function(a){return function(b){return b===a}},d=b(38),c=b(40);return{ltr:{isBackward:b(37),isForward:b(39)},
rtl:{isBackward:b(39),isForward:b(37)},isUp:d,isDown:c,isNavigation:function(a){return 37<=a&&40>=a}}});k("mx",["fv","dp","ap"],function(b,d,c){return function(a){return{getRect:function(a){return a.dom().getBoundingClientRect()},getRangedRect:function(b,d,g,h){return c.rectangleAt(a,b,d,g,h)},getSelection:function(){return c.get(a)},fromSitus:function(b){return c.deriveExact(a,b)},situsFromPoint:function(c,d){return b.find(a,c,d)},clearSelection:function(){c.clearAll(a)},setSelection:function(b){c.setExact(a,
b.start(),b.soffset(),b.finish(),b.foffset())},setRelativeSelection:function(b,f){c.set(a,d.write(b,f))},selectContents:function(b){c.selectElementContents(a,b)},getInnerHeight:function(){return a.innerHeight},getScrollY:function(){return a.scrollY},scrollBy:function(b,c){a.scrollBy(b,c)}}}});k("n4",["48"],function(b){return{resolve:b.create("ephox-darwin").resolve}});k("hr",["n4","7"],function(b,d){var c=b.resolve("selected"),a=b.resolve("last-selected"),e=b.resolve("first-selected");return{selectedClass:d.constant(c),
lastSelectedClass:d.constant(a),firstSelectedClass:d.constant(e)}});k("zh",["7","s","pf"],function(b,d,c){var a=function(a,b){return b.column()>=a.startCol()&&b.column()+b.colspan()-1<=a.finishCol()&&b.row()>=a.startRow()&&b.row()+b.rowspan()-1<=a.finishRow()};return{inSelection:function(a,b){var c=b.column(),d=b.column()+b.colspan()-1,l=b.row(),m=b.row()+b.rowspan()-1;return c<=a.finishCol()&&d>=a.startCol()&&l<=a.finishRow()&&m>=a.startRow()},isWithin:a,isRectangular:function(e,f){for(var g=!0,
h=b.curry(a,f),l=f.startRow();l<=f.finishRow();l++)for(var m=f.startCol();m<=f.finishCol();m++)g=g&&c.getAt(e,l,m).exists(h);return g?d.some(f):d.none()}}});k("uy",["f2","pf","zh","1b","1r"],function(b,d,c,a,e){var f=function(c,f,l){f=d.findItem(c,f,a.eq);var m=d.findItem(c,l,a.eq);return f.bind(function(a){return m.map(function(c){return b.bounds({startCol:e.min(a.column(),c.column()),finishCol:e.max(a.column()+a.colspan()-1,c.column()+c.colspan()-1),startRow:e.min(a.row(),c.row()),finishRow:e.max(a.row()+
a.rowspan()-1,c.row()+c.rowspan()-1)})})})};return{getAnyBox:f,getBox:function(a,b,d){return f(a,b,d).bind(function(b){return c.isRectangular(a,b)})}}});k("ux","b 7 pf zh uy 1b".split(" "),function(b,d,c,a,e,f){return{moveBy:function(a,b,d,e){return c.findItem(a,b,f.eq).bind(function(b){var f=0<d?b.row()+b.rowspan()-1:b.row();b=0<e?b.column()+b.colspan()-1:b.column();return c.getAt(a,f+d,b+e).map(function(a){return a.element()})})},intercepts:function(f,h,l){return e.getAnyBox(f,h,l).map(function(e){e=
c.filterItems(f,d.curry(a.inSelection,e));return b.map(e,function(a){return a.element()})})}}});k("n3",["am","pe","pf","ux","uy"],function(b,d,c,a,e){var f=function(a){a=d.fromTable(a);return c.generate(a)};return{moveBy:function(c,d,e){return b.table(c).bind(function(b){b=f(b);return a.moveBy(b,c,d,e)})},intercepts:function(b,c,d){b=f(b);return a.intercepts(b,c,d)},getBox:function(a,b,c){a=f(a);return e.getBox(a,b,c)}}});k("n2","b hr 7 s f1 n3 1x 1b 6c 46 2y".split(" "),function(b,d,c,a,e,f,g,h,
l,m,n){var p="."+d.selectedClass(),q=l.addClass(d.selectedClass()),r=l.removeClasses([d.selectedClass(),d.lastSelectedClass(),d.firstSelectedClass()]),k=function(a){a=m.descendants(a,p);b.each(a,r)},t=function(a){return n.ancestor(a,"table")},u=function(b,c){return h.eq(b,c)?a.some([b]):e.sharedOne(t,[b,c]).bind(function(a){return f.intercepts(a,b,c)})},v=function(c){c=b.find(c,l.hasClass(d.lastSelectedClass()));return a.from(c)},w=function(a){return n.ancestor(a,"table").bind(function(b){return n.descendant(b,
"."+d.firstSelectedClass()).bind(function(b){return u(b,a).map(function(d){return{boxes:c.constant(d),start:c.constant(b),finish:c.constant(a)}})})})};return{clear:k,identify:u,retrieve:function(b){b=m.descendants(b,p);return 0<b.length?a.some(b):a.none()},shiftSelection:function(a,b,c){return v(a).bind(function(a){return f.moveBy(a,b,c).bind(w)})},isSelected:function(a){return g.has(a,d.selectedClass())},selectRange:function(a,c,e,f){k(a);b.each(c,q);g.add(e,d.firstSelectedClass());g.add(f,d.lastSelectedClass())},
getEdges:function(a){return n.descendant(a,"."+d.firstSelectedClass()).bind(function(b){return n.descendant(a,"."+d.lastSelectedClass()).bind(function(a){return e.sharedOne(t,[b,a]).map(function(d){return{first:c.constant(b),last:c.constant(a),table:c.constant(d)}})})})}}});k("my","mw n2 dp 8w ap co s 1b 2y".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(e,l,m,r){return!h.eq(m,r)&&(l=d.identify(m,r).getOr([]),0<l.length)?(d.selectRange(e,l,m,r),g.some(b.response(g.some(c.write(a.on(m,0),a.on(m,
f.getEnd(m)))),!0))):g.none()};return{sync:function(a,b,c,d,f,h){return e.isCollapsed(c,d,f,h)?g.none():l.closest(c,"td,th").bind(function(c){return l.closest(f,"td,th").bind(function(d){return m(a,b,c,d)})})},detect:m,update:function(a,b,c,e){return d.shiftSelection(e,a,b).map(function(a){d.clear(c);d.selectRange(c,a.boxes(),a.start(),a.finish());return a.boxes()})}}});k("zi",["33"],function(b){var d=b.immutableBag(["left","top","right","bottom"],[]);return{nu:d,moveUp:function(b,a){return d({left:b.left(),
top:b.top()-a,right:b.right(),bottom:b.bottom()-a})},moveDown:function(b,a){return d({left:b.left(),top:b.top()+a,right:b.right(),bottom:b.bottom()+a})},moveBottomTo:function(b,a){var e=b.bottom()-b.top();return d({left:b.left(),top:a-e,right:b.right(),bottom:a})},moveTopTo:function(b,a){var e=b.bottom()-b.top();return d({left:b.left(),top:a,right:b.right(),bottom:a+e})},getTop:function(b){return b.top()},getBottom:function(b){return b.bottom()},translate:function(b,a,e){return d({left:b.left()+a,
top:b.top()+e,right:b.right()+a,bottom:b.bottom()+e})},toString:function(b){return"("+b.left()+", "+b.top()+") -> ("+b.right()+", "+b.bottom()+")"}}});k("zj",["zi","co","s","20"],function(b,d,c,a){var e=function(a){return b.nu({left:a.left,top:a.top,right:a.right,bottom:a.bottom})};return{getBoxAt:function(b,g,h){return a.isElement(g)?c.some(b.getRect(g)).map(e):a.isText(g)?(b=0<=h&&h<d.getEnd(g)?b.getRangedRect(g,h,g,h+1):0<h?b.getRangedRect(g,h-1,g,h):c.none(),b.map(e)):c.none()},getEntireBox:function(b,
g){return a.isElement(g)?c.some(b.getRect(g)).map(e):a.isText(g)?b.getRangedRect(g,0,g,d.getEnd(g)).map(e):c.none()}}});k("v0","zi zj 7 s i8 e4 4g 49 1r".split(" "),function(b,d,c,a,e,f,g,h,l){var m=g.generate([{none:[]},{retry:["caret"]}]),n=function(a,b,e){return h.closest(b,f.isBlock).fold(c.constant(!1),function(b){return d.getEntireBox(a,b).exists(function(a){return e.left()<a.left()||1>l.abs(a.right()-e.left())||e.left()>a.right()})})};g={point:b.getBottom,adjuster:function(a,c,d,e,f){var g=
b.moveDown(f,5);return 1>l.abs(d.bottom()-e.bottom())?m.retry(g):d.top()>f.bottom()?m.retry(g):d.top()===f.bottom()?m.retry(b.moveDown(f,1)):n(a,c,f)?m.retry(b.translate(g,5,0)):m.none()},move:b.moveDown,gather:e.after};var p=function(b,c,e,f,g){return 0===g?a.some(f):b.situsFromPoint(f.left(),c.point(f)).bind(function(h){return h.start().fold(a.none,function(h,l){return d.getEntireBox(b,h,l).bind(function(d){return c.adjuster(b,h,d,e,f).fold(a.none,function(a){return p(b,c,e,a,g-1)})}).orThunk(function(){return a.some(f)})},
a.none)})},q=function(b,c,d){return b.point(c)>d.getInnerHeight()?a.some(b.point(c)-d.getInnerHeight()):0>b.point(c)?a.some(-b.point(c)):a.none()},r=function(a,b,c){var d=a.move(c,5),e=p(b,a,c,d,100).getOr(d);return q(a,e,b).fold(function(){return b.situsFromPoint(e.left(),a.point(e))},function(c){b.scrollBy(0,c);return b.situsFromPoint(e.left(),a.point(e)-c)})};return{tryUp:c.curry(r,{point:b.getTop,adjuster:function(a,c,d,e,f){var g=b.moveUp(f,5);return 1>l.abs(d.top()-e.top())?m.retry(g):d.bottom()<
f.top()?m.retry(g):d.bottom()===f.top()?m.retry(b.moveUp(f,1)):n(a,c,f)?m.retry(b.translate(g,5,0)):m.none()},move:b.moveUp,gather:e.before}),tryDown:c.curry(r,g),ieTryUp:function(a,b){return a.situsFromPoint(b.left(),b.top()-5)},ieTryDown:function(a,b){return a.situsFromPoint(b.left(),b.bottom()+5)},getJumpSize:c.constant(5)}});k("v1",["co","f1","4g","1b","2y"],function(b,d,c,a,e){var f=c.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),g=function(a){return e.closest(a,
"tr")};return{verify:function(c,l,m,n,p,q){return e.closest(n,"td,th").bind(function(m){return e.closest(l,"td,th").map(function(e){return a.eq(m,e)?a.eq(n,m)&&b.getEnd(m)===p?q(e):f.none("in same cell"):d.sharedOne(g,[m,e]).fold(function(){var a=c.getRect(e),b=c.getRect(m);return b.right>a.left&&b.left<a.right?f.success():q(e)},function(a){return q(e)})})}).getOr(f.none("default"))},cata:function(a,b,c,d,e){return a.fold(b,c,d,e)},adt:f}});k("12q","b 7 s 33 1b 49 46 2y 29".split(" "),function(b,
d,c,a,e,f,g,h,l){var m=a.immutable("ancestor","descendants","element","index"),n=a.immutable("parent","children","element","index"),p=function(a,f){var g=b.findIndex(a,d.curry(e.eq,f));return-1<g?c.some(g):c.none()};return{childOf:function(a,b){return f.closest(a,function(a){return l.parent(a).exists(function(a){return e.eq(a,b)})})},indexOf:p,indexInParent:function(a){return l.parent(a).bind(function(b){var c=l.children(b);return p(c,a).map(function(d){return n(b,c,a,d)})})},selectorsInParent:function(a,
b){return l.parent(a).bind(function(c){var d=g.children(c,b);return p(d,a).map(function(b){return n(c,d,a,b)})})},descendantsInAncestor:function(a,b,c){return h.closest(a,b).bind(function(b){var d=g.descendants(b,c);return p(d,a).map(function(c){return m(b,d,a,c)})})}}});k("zk","v1 dp 8w co s du 12q 20 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(a){return"br"===h.name(a)},p=function(a,b,c){return b(a,c).bind(function(a){return h.isText(a)&&0===l.get(a).trim().length?p(a,b,c):e.some(a)})},
q=function(a,b,c){return c.traverse(b).orThunk(function(){return p(b,c.gather,a)}).map(c.relative)},r=function(a,b){return m.child(a,b).filter(n).orThunk(function(){return m.child(a,b-1).filter(n)})},k=function(a,b,d,e){return r(b,d).bind(function(b){return e.traverse(b).fold(function(){return p(b,e.gather,a).map(e.relative)},function(a){return g.indexInParent(a).map(function(a){return c.on(a.parent(),a.index())})})})};return{tryBr:function(a,b,c,e){return(n(b)?q(a,b,e):k(a,b,c,e)).map(function(a){return d.write(a,
a)})},process:function(c){return b.cata(c,function(a){return e.none("BR ADT: none")},function(){return e.none()},function(a){return e.some(f.point(a,0))},function(b){return e.some(f.point(b,a.getEnd(b)))})}}});k("uz","zi zj v0 v1 zk c co s du 1b 20".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var p=f.detect(),q=function(b,c,d){return b.getSelection().bind(function(f){return e.tryBr(c,f.finish(),f.foffset(),d).fold(function(){return h.some(l.point(f.finish(),f.foffset()))},function(c){c=b.fromSitus(c);
c=a.verify(b,f.finish(),f.foffset(),c.finish(),c.foffset(),d.failure);return e.process(c)})})},r=function(c,d,e,f,l,n){return 0===n?h.none():u(c,d,e,f,l).bind(function(p){var q=c.fromSitus(p),q=a.verify(c,e,f,q.finish(),q.foffset(),l.failure);return a.cata(q,function(){return h.none()},function(){return h.some(p)},function(a){return m.eq(e,a)&&0===f?k(c,e,f,b.moveUp,l):r(c,d,a,0,l,n-1)},function(a){return m.eq(e,a)&&f===g.getEnd(a)?k(c,e,f,b.moveDown,l):r(c,d,a,g.getEnd(a),l,n-1)})})},k=function(a,
b,e,f,g){return d.getBoxAt(a,b,e).bind(function(b){return t(a,g,f(b,c.getJumpSize()))})},t=function(a,b,c){return p.browser.isChrome()||p.browser.isSafari()||p.browser.isFirefox()||p.browser.isSpartan()?b.otherRetry(a,c):p.browser.isIE()?b.ieRetry(a,c):h.none()},u=function(a,b,c,e,f){return d.getBoxAt(a,c,e).bind(function(b){return t(a,f,b)})};return{handle:function(a,b,c){return q(a,b,c).bind(function(d){return r(a,b,d.element(),d.offset(),c,20).map(a.fromSitus)})}}});k("mz","mw my uz c dp 8w 7 s 1b 32 2y 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p){var q=a.detect(),r=function(a,b){return m.ancestor(a,function(a){return p.parent(a).exists(function(a){return l.eq(a,b)})})},k=function(a,b,d,e,f){return n.closest(e,"td,th").bind(function(e){return n.closest(e,"table").bind(function(l){return r(f,l)?c.handle(a,b,d).bind(function(a){return n.closest(a.finish(),"td,th").map(function(b){return{start:g.constant(e),finish:g.constant(b),range:g.constant(a)}})}):h.none()})})};return{navigate:function(a,c,d,g,l){return q.browser.isFirefox()||
q.browser.isIE()?h.none():k(a,c,d,g,l).map(function(a){a=a.range();return b.response(h.some(e.write(f.on(a.start(),a.soffset()),f.on(a.finish(),a.foffset()))),!0)})},select:function(a,b,c,e,f,g){return k(a,c,e,f,g).bind(function(a){return d.detect(b,c,a.start(),a.finish())})}}});k("n0",["n2","7","s","1b","2y"],function(b,d,c,a,e){var f=function(a){return e.closest(a,"td,th")};return function(a,d){var e=c.none(),m=function(){e=c.none()};return{mousedown:function(a){b.clear(d);e=f(a.target())},mouseover:function(c){e.each(function(e){b.clear(d);
f(c.target()).each(function(c){var f=b.identify(e,c).getOr([]);1<f.length&&(b.selectRange(d,f,e,c),a.selectContents(c))})})},mouseup:function(){e.each(m)}}}});k("n1",["v0","v1","8w","i8","29"],function(b,d,c,a,e){return{down:{traverse:e.nextSibling,gather:a.after,relative:c.before,otherRetry:b.tryDown,ieRetry:b.ieTryDown,failure:d.adt.failedDown},up:{traverse:e.prevSibling,gather:a.before,relative:c.before,otherRetry:b.tryUp,ieRetry:b.ieTryUp,failure:d.adt.failedUp}}});k("ex","mw ey mx my mz n0 n1 n2 8w 7 s k 33".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,q){var r=q.immutable("rows","cols");return{mouse:function(a,b){var d=c(a),d=f(d,b);return{mousedown:d.mousedown,mouseover:d.mouseover,mouseup:d.mouseup}},keyboard:function(f,q,k){var v=c(f),w=function(){h.clear(q);return n.none()};return{keydown:function(c,f,s,z,A,C){var D=c.raw().which,E=!0===c.raw().shiftKey;return h.retrieve(q).fold(function(){return d.isDown(D)&&E?m.curry(e.select,v,q,k,g.down,z,f):d.isUp(D)&&E?m.curry(e.select,v,q,k,g.up,z,f):d.isDown(D)?m.curry(e.navigate,
v,k,g.down,z,f):d.isUp(D)?m.curry(e.navigate,v,k,g.up,z,f):n.none},function(c){var e=function(e){return function(){return p.findMap(e,function(b){return a.update(b.rows(),b.cols(),q,c)}).fold(function(){return h.getEdges(q).map(function(a){var c=d.isDown(D)||C.isForward(D)?l.after:l.before;v.setRelativeSelection(l.on(a.first(),0),c(a.table()));h.clear(q);return b.response(n.none(),!0)})},function(a){return n.some(b.response(n.none(),!0))})}};return d.isDown(D)&&E?e([r(1,0)]):d.isUp(D)&&E?e([r(-1,
0)]):C.isBackward(D)&&E?e([r(0,-1),r(-1,0)]):C.isForward(D)&&E?e([r(0,1),r(1,0)]):d.isNavigation(D)&&!1===E?w:n.none})()},keyup:function(b,c,e,f,g){return h.retrieve(q).fold(function(){var h=b.raw().which;return!0===b.raw().shiftKey===!1?n.none():d.isNavigation(h)?a.sync(q,k,c,e,f,g):n.none()},n.none)}}}}});k("ez",["n2","n3"],function(b,d){return{retrieve:function(c){return b.retrieve(c)},retrieveBox:function(c){return b.getEdges(c).bind(function(a){return d.getBox(a.table(),a.first(),a.last())})},
clear:function(c){b.clear(c)}}});k("f0",["b","hr","43","6c"],function(b,d,c,a){return{configure:function(c){b.each([c.output(),c.internal()],function(f){var g=[d.lastSelectedClass(),d.firstSelectedClass(),d.selectedClass()],h=b.map(g,function(a){return"."+a}).join(",");c.addSelector(f,h,function(c){b.each(c,a.removeClasses(g))})})}}});k("f3",["4r"],function(b){var d=function(a){return 0===a.button},c=function(a,c){return{bind:function(d,g){return b.bind(d,a,c,g)}}};return{realClick:c("click",function(a){return 6===
a.mozInputSource||0===a.mozInputSource?!1:void 0!==a.isTrusted&&!0!==a.isTrusted?!1:!0}),leftDown:c("mousedown",d),leftPressedOver:c("mouseover",function(a){return void 0===a.buttons?!0:0!==(a.buttons&1)}),leftUp:c("mouseup",d)}});k("7y","b ex ey ez c d1 co 7 s 73 f0 4x 3z f1 4f am 3n f3 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,r,k,t,u,v,w){var x=e.detect();return function(e,B,z){n.configure(B);var A=q.create({beforeScan:p([]),afterScan:p([])});B=function(){z.body().each(function(b){z.getSelection().each(function(c){r.sharedOne(t.table,
[c.startContainer(),c.endContainer()]).fold(function(){a.clear(b)},h.noop)})})};(x.browser.isChrome()||x.browser.isSafari())&&z.events.contextmenu.bind(B);z.events.nodeChanged.bind(B);var C=k([]);z.runOrOnLoaded(function(a){var b=w.defaultView(a).dom(),f=d.mouse(b,a),g=d.keyboard(b,a,z.isRoot);C.set([v.leftDown.bind(a,f.mousedown),v.leftPressedOver.bind(a,f.mouseover),v.leftUp.bind(a,f.mouseup),u.bind(a,"keyup",function(a){a.raw().shiftKey&&c.isNavigation(a.raw().which)&&z.getSelection().each(function(b){g.keyup(a,
b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset()).each(function(b){l(a,b)})},h.noop)}),u.bind(a,"keydown",function(a){z.getSelection().each(function(b){A.trigger.beforeScan();var d=e.directionAt(b.endContainer()).isRtl()?c.rtl:c.ltr;g.keydown(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset(),d).each(function(b){l(a,b)});A.trigger.afterScan()})})]);var l=function(a,b){b.kill()&&a.kill();b.selection().each(function(a){z.setRelativeSelection(a.start(),a.finish())})}});
var D=function(a,b){return{doc:b.doc,win:b.win,execCommand:b.execCommand,focus:b.focus,setSelection:h.noop,setRelativeSelection:h.noop,getSelection:function(){return l.some(E(a))}}},E=function(a){var b=f.firstCursor(a).getOr(a);a=f.lastCursor(a).getOr(a);return{startContainer:h.constant(b),startOffset:h.constant(0),endContainer:h.constant(a),endOffset:h.constant(g.getEnd(a))}};return{get:function(){return z.on(function(c){return z.body().fold(m.none,function(d){return a.retrieve(d).fold(function(){return z.getSelection().fold(m.none,
function(a){return m.single(a,c)})},function(a){var d=b.map(a,function(a){return D(a,c)});return m.multiple(a,d)})})}).getOrThunk(m.none)},surround:E,events:A.registry,destroy:function(){var a=C.get();b.each(a,function(a){a.unbind()})}}}});k("f4","b 6 mn 7 3n l".split(" "),function(b,d,c,a,e,f){return function(g){g=d.merge({scopes:[f.fromDom(document)],shortcuts:[],swallow:!1},g);var h=c(g),l=[],m=[];b.each(g.scopes,function(a){l.push(e.bind(a,"keydown",h.keydown).unbind);m.push(e.bind(a,"keypress",
h.keypress).unbind)});return{off:h.off,on:h.on,destroy:function(){b.each(l,a.apply);b.each(m,a.apply)},events:h.events,swallowShortcuts:h.swallowShortcuts,yieldShortcuts:h.yieldShortcuts,swallowChars:h.swallowChars,yieldChars:h.yieldChars,swallowKeys:h.swallowKeys,yieldKeys:h.yieldKeys}}});k("7z","b c f4 9n 7 s k 4x 3z".split(" "),function(b,d,c,a,e,f,g,h,l){var m=d.detect();d=m.os.isOSX();var m=m.os.isLinux(),n=d?[[a.META(),"Z"]]:[[a.CTRL(),"Z"]],p=d?[[a.META(),a.SHIFT(),"Z"]]:m?[[a.CTRL(),"Y"],
[a.CTRL(),a.SHIFT(),"Z"]]:[[a.CTRL(),"Y"]],q=[[a.SHIFT(),121]],k=d?[[a.ALT(),121]]:[[121]],s=d?[[a.META(),a.SHIFT(),"F"]]:[[a.CTRL(),a.SHIFT(),"F"]],t=d?[[a.META(),a.ALT(),"U"]]:m?[[a.CTRL(),a.ALT(),"U"]]:[[a.CTRL(),a.SHIFT(),"U"]],u=d?[[a.CTRL(),a.ALT(),"H"]]:[[a.CTRL(),a.SHIFT(),"H"]],v=b.flatten([n,p,q,s,u,k]),w=d?[[a.META(),"B"]]:[[a.CTRL(),"B"]],x=d?[[a.META(),"I"]]:[[a.CTRL(),"I"]],y=d?[[a.META(),"U"]]:[[a.CTRL(),"U"]],B=d?[[a.META(),221],[a.META(),"M"]]:[[a.CTRL(),221],[a.CTRL(),"M"]],z=d?
[[a.META(),219],[a.META(),a.SHIFT(),"M"]]:[[a.CTRL(),219],[a.CTRL(),a.SHIFT(),"M"]],A=d?[[a.META(),a.SHIFT(),"9"]]:[[a.CTRL(),a.SHIFT(),"9"]],C=d?[[a.META(),"K"]]:[[a.CTRL(),"K"]],D=[[d?a.META():a.CTRL(),"F"]],E=b.flatten([t,w,x,y,B,z,C,D,A]),F=function(a,c){return function(d){return b.contains(a,d)?f.some(c):f.none()}};return function(a,b){var d=l.create({undo:h([]),redo:h([]),context:h([]),fullscreen:h([]),help:h([]),toolbar:h([]),bold:h([]),italic:h([]),underline:h([]),indent:h([]),outdent:h([]),
link:h([]),blockquote:h([]),search:h([]),plaincode:h([])}),f=[F(n,d.trigger.undo),F(p,d.trigger.redo),F(q,d.trigger.context),F(k,d.trigger.toolbar)],m=[F(w,d.trigger.bold),F(x,d.trigger.italic),F(y,d.trigger.underline),F(B,d.trigger.indent),F(z,d.trigger.outdent),F(C,d.trigger.link),F(D,d.trigger.search),F(A,d.trigger.blockquote),F(u,d.trigger.help),F(s,d.trigger.fullscreen),F(t,d.trigger.plaincode)],K=!0===b.features,M=v.concat(K?E:[]),Q=f.concat(K?m:[]),R=null;a.onCanvas(function(a){R=c({scopes:[a],
shortcuts:M});R.swallowShortcuts(M);R.events.command.bind(function(a){var b=a.command();g.findMap(Q,function(a){return a(b)}).each(e.apply)});R.on()});return{isHelpShortcutEnabled:e.constant(K),events:d.registry,destroy:function(){null!==R&&R.destroy()}}}});k("n5",["b","s","33"],function(b,d,c){var a=function(a){return function(b){return b.key()===a}},e=c.immutable("key","value");return{put:function(c,d,h,l,m){var n=void 0!==l?l:e,p=void 0!==m?m:a(d);c=b.foldl(c,function(a,b){var c=p(b)?n(d,h):b;
return{updated:p(b)||a.updated,acc:a.acc.concat([c])}},{updated:!1,acc:[]});return c.updated?c.acc:c.acc.concat([n(d,h)])},get:function(c,e,h){e=void 0!==h?h:a(e);c=b.find(c,e);return d.from(c)}}});k("n6",["33"],function(b){return b.immutable("popup","anchor")});k("f5",["b","n5","n6","9z"],function(b,d,c,a){return function(){var e=[],f=function(){e=b.filter(e,function(b){return a.isVisible(b.popup().panel())})};return{recalculate:function(){f();b.map(e,function(a){a.anchor().recalculate(a.popup())})},
dismiss:function(){f();b.map(e,function(a){a.anchor().isAnchored()||a.popup().close()})},update:function(a,b){e=d.put(e,a,b,c,function(b){return b.popup()===a})},destroy:function(){}}}});k("f6",["7","3n","28"],function(b,d,c){return{bind:function(a,b){var f=c.get(a);return{unbind:d.bind(a,"scroll",function(d){d=c.get(a);d.top()===f.top()&&d.left()===f.left()||b(d);f=d}).unbind}}}});k("80","b 9n 7 f5 30 1x 3n l 2m f6 2y m 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q){return function(k,s,t){var u=
a(),v=null;k.events.loaded.bind(function(){v=k.isInline()?null:m.bind(k.doc().getOrDie(),u.dismiss)});var w=h.fromTag("div");f.add(w,e.resolve("ui-container"));t.updateUi(w);k.events.loaded.bind(function(){var a=k.placeholder(),a=n.ancestor(a,"."+e.resolve("socket")).bind(q.parent).getOr(a);l.prepend(a,w)});var x=g.bind(w,"keydown",function(a){var e;if(e=b.contains(d.BACKSPACE(),a.raw().which))e=a.target(),e=c.curry(p.is,e),e=!b.exists(["textarea","input",'[contenteditable="true"]'],e);e&&a.kill()});
return{uiContainer:c.constant(w),refresh:u.recalculate,bounds:s,show:function(a,b){u.update(a,b);b.place(a)},destroy:function(){null!==v&&v.unbind();u.destroy();x.unbind()}}}});k("f7","7 em 4x 3z 65 3m".split(" "),function(b,d,c,a,e,f){return function(g,h,l){g=d(l,g);l=function(){var a=f(function(){e(a);m.trigger.expired()},h);return{clear:function(){e(a)}}};var m=a.create({expired:c([]),close:c([])}),n=0<h?l():{clear:b.noop};g.events.close.bind(function(){n.clear();m.trigger.close()});return{element:g.element,
action:g.action,destroy:g.destroy,events:m.registry}}});k("81","7 f7 7h 30 1x 3n 6e".split(" "),function(b,d,c,a,e,f,g){return function(h,l,m,n,p,q,k,s){var t=k.layout.build(h,l,m,n,p,q,k,s),u=f.bind(t.element(),"mousedown",function(a){g.closest(a.target(),'input,div[contenteditable="true"],textarea,.ephox-polish-dialog.ephox-polish-help-modal,select')||a.prevent()});(function(){var d=e.toggler(t.element(),a.resolve("content-ltr")),f=e.toggler(t.element(),a.resolve("content-rtl"));h.events.uiStale.bind(function(){c.readDir(h).each(function(a){a.ltrdir().fold(d.off,
b.noop,d.on);a.rtldir().fold(f.off,b.noop,f.on)})})})();return{element:t.element,connect:t.connect,viewport:t.viewport,socket:t.socket,showMessage:function(a,c,e){a=d(a,c,e);c=b.curry(t.hideBanner,a);a.events.expired.bind(c);t.displayBanner(a);return c},displayBanner:t.displayBanner,hideBanner:t.hideBanner,init:t.init,refocus:t.tabstrip.refocus,tabstrip:t.tabstrip,refresh:t.refresh,position:t.position,state:t.state,destroy:function(){t.destroy();u.unbind()}}}});k("f8",[],function(){return{isDefaultEmpty:function(b){return/^\s*<p>\s*<br\s?\/?>\s*<\/p>\s*$/.test(b)}}});
k("v2",["s"],function(b){return function(d){var c=void 0!==d?d.slice(0):[];return{pop:function(){return b.from(c.pop())},push:function(a){c.push(a)},peek:function(){return b.from(c[c.length-1])},pushAll:function(a){c=c.concat(a)},clear:function(){c=[]},isEmpty:function(){return 0===c.length},size:function(){return c.length},state:function(){return c.slice(0)}}}});k("n7",["b","v2","4x","3z"],function(b,d,c,a){return function(e){var f=a.create({changed:c([])}),g=e.initial,h=d(e.undo),l=d(e.redo),m=
function(a){h.isEmpty()&&h.push(g);h.push(a);f.trigger.changed()},n=function(a,b){b(h.peek().getOr(g),a)?(h.pop(),h.push(a)):(m(a),l.clear())};return{save:n,checkChanged:function(a,b){return!b(h.peek().getOr(g),a)},undo:function(a,b){n(a,b);return h.pop().bind(function(a){h.isEmpty()||l.push(a);return h.peek()})},redo:function(a,b){b(h.peek().getOr(g),a)||l.clear();return l.pop().bind(function(a){m(a);return h.peek()})},reset:function(a){g=a;h.clear();l.clear()},state:function(){return{initial:g,
undo:h.state(),redo:l.state()}},rewrite:function(a){var c=a(g),e=b.map(h.state(),a);a=b.map(l.state(),a);g=c;h=d(e);l=d(a)},events:f.registry}}});k("f9",["n7"],function(b){return{fromInitial:function(d){return b({initial:d,undo:[],redo:[]})},fromState:function(d){return b(d)}}});k("82","b 7 dv 6u f8 6l 6v 33 2k f9".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=h.immutable("clean","marked"),p=function(a){return n(a.clean,a.marked)},q=function(a,c){return{initial:c(a.initial),undo:b.map(a.undo,c),
redo:b.map(a.redo,c)}},k=function(a){return{clean:a.clean(),marked:a.marked()}};return function(b,h,u,v,w){var x=m.fromState(q(w,p)),y=function(a,c){var d;if(!(d=""===a.clean()&&e.isDefaultEmpty(c.clean()))){d=b.filterHtml(b.internal(),a.clean());var f=b.filterHtml(b.internal(),c.clean());d=d===f}return d},B=function(){var a=b.filterHtml(b.history(),h.getContent()),c=b.filterHtml(b.history(),h.serialize());return n(a,c)},z=function(a){return h.deserialize(a.marked())};w=function(){var a=B();x.undo(a,
y).each(z);h.domChanged();h.toEditing()};var A=function(){var a=B();x.redo(a,y).each(z);h.domChanged();h.toEditing()},C=c.tap(function(a,b){if(a()){var c=B();x.save(c,b)}}),D=function(){C.instance(function(){return h.getSelectionStart().exists(l.inBody)},y)},E=function(a){var b=C.control.isBlocked();C.control.block();a=a();b||C.control.unblock();return a};u.editor().events.space.bind(D);u.editor().events.enter.bind(D);v.events.undo.bind(w);v.events.redo.bind(A);h.events.loaded.bind(D);h.events.undoChanged.bind(D);
h.events.loiter.bind(D);u=f.ui({"undo.general":{toggle:!1,value:"undo",textkey:a.key("action.undo"),action:w,shortcut:!0,updateGeneral:d.identity,tooltip:g.get},"redo.general":{toggle:!1,value:"redo",textkey:a.key("action.redo"),action:A,shortcut:!0,updateGeneral:d.identity,tooltip:g.get}});return{undo:w,redo:A,save:D,checkChanged:function(){var a=B();return x.checkChanged(a,y)},reset:function(a){x.reset(n(a,a))},resetToCurrent:function(){var a=B();x.reset(a)},destroy:d.noop,state:function(){return q(x.state(),
k)},rewrite:function(a,b){var c=function(c){return c.replace(a,b)};x.rewrite(function(a){return n(c(a.clean()),c(a.marked()))})},transaction:function(a){D();a=E(a);D();return a},disable:E,replaceTop:function(){C.instance(d.constant(!0),d.constant(!0))},ui:u,events:x.events}}});k("fa",["7","6f"],function(b,d){return{make:function(c,a,e){return{open:b.noop,hide:b.noop,destroy:b.noop,represent:b.identity,events:d(["ok"])}}}});k("fb",["1n","7","s","33"],function(b,d,c,a){var e=a.immutable("spelling",
"autocorrect","capitalisation","linkpreviews");return function(a){var g=!1,h=c.none(),l=e(a.spelling(),a.autocorrect(),a.capitalisation(),a.linkpreviews());return{isLoggedIn:function(){return g},updateLogin:function(a){g=!0;h=c.some(a)},updatePreferences:function(a){l=a},getUsername:function(){return h.map(function(a){return{name:d.constant(a),loggedIn:d.constant(g)}})},getPreferences:function(){return b.map(l,function(a){return d.constant(a().get())})}}}});k("v3",["1","7","s"],function(b,d,c){var a=
function(){try{var a=b.localStorage;a.setItem("__storage_test__","__storage_test__");a.removeItem("__storage_test__");return c.some(a)}catch(d){return c.none()}}().fold(function(){var a={};return{getItem:function(b){return a[b]},setItem:function(b,c){a[b]=c}}},function(a){return{getItem:function(b){return a.getItem("ephox.textboxio."+b)},setItem:function(b,c){a.setItem("ephox.textboxio."+b,c)}}}),e=function(b){return c.from(a.getItem(b)).map(JSON.parse).getOr({})},f=function(b,c){var d=JSON.stringify(c);
a.setItem(b,d)};return{read:e,write:f,access:function(a){return{read:d.curry(e,a),write:d.curry(f,a)}}}});k("v4",["b","6","7"],function(b,d,c){var a=function(a){var b={},d=a.get();b[a.name()]=c.constant(d);return b};return{refetch:function(c,f){var g=b.foldr(c,function(b,c){return d.merge(a(c),b)},{});f(g)}}});k("n8",["b","6","v3","v4"],function(b,d,c,a){var e=c.access("local.settings");return function(c){var g=function(a,b){var c=e.read(),f={};f[a]=b;c=d.merge(c,f);e.write(c)},h=function(b){a.refetch(c,
b)},l=function(a){var d=e.read();b.each(c,function(a){var b=a.parse(d);a.set(b)});h(a)};return{menu:function(a,d){b.each(c,function(b){a[b.event()].bind(function(a){a=a.enabled();b.set(a);g(b.name(),a);h(function(a){d.trigger.preferences(a)})})})},fromLocal:l,fromService:l}}});k("nf",["2g"],function(b){return function(){return new (b.getOrDie("FileReader"))}});k("zl",["3l","nf"],function(b,d){return function(c){return b.nu(function(a){var b=d();b.onload=function(b){a(b.target.result)};b.readAsText(c)})}});
k("zm",["2g"],function(b){return function(){return new (b.getOrDie("XMLHttpRequest"))}});k("vr","a 1n 6 zl 3l zm s p v o".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"};return{ajax:function(p,q,k,s){var t=c.merge({url:p,contentType:"application/json",processData:!1,type:"GET"},s),u=f();u.open(t.type.toUpperCase(),t.url,!0);"blob"===t.responseType&&(u.responseType=t.responseType);
b.isString(t.contentType)&&u.setRequestHeader("Content-Type",t.contentType);var v=t.dataType;s=b.isString(v)&&"*"!==v?n[v]+", "+n["*"]+"; q=0.01":n["*"];u.setRequestHeader("Accept",s);void 0!==t.xhrFields&&!0===t.xhrFields.withCredentials&&(u.withCredentials=!0);b.isObject(t.headers)&&d.each(t.headers,function(a,c){b.isString(c)||b.isString(a)?u.setRequestHeader(c,a):m.error("Request header data was not a string: ",c," -> ",a)});var w=function(){var b;b="blob"===t.responseType?g.from(u.response).map(a).getOr(e.pure("no response content")):
e.pure(u.responseText);b.get(function(a){0===u.status?k("Unknown HTTP error (possible cross-domain request)",u.status,a):k('Could not load url "'+p+'": '+u.statusText,u.status,a)})},x=function(){var a;if("json"===v)try{a=h.value(JSON.parse(u.response))}catch(b){a=h.error({status:u.status,statusText:"Response was not JSON",responseText:u.responseText})}else a=h.value(u.response);a.fold(w,function(a){q(a)})};u.onerror=w;u.onload=function(){0===u.status?l.startsWith(t.url,"file:")?x():w():100>u.status||
400<=u.status?w():x()};void 0===t.data?u.send():u.send(t.data)}}});k("v5",["6","vr","v6"],function(b,d,c){var a=function(a){return function(b,d,e){var m;try{m=void 0===e||""===e?e:c.parse(e)}catch(n){m={contents:e}}a(b,d,m)}},e=function(c,e,h,l,m){d.ajax(c,h,a(l),b.merge({dataType:"json",type:e},m))};return{get:function(b,c,d,l){e(b,"GET",c,a(d),l)},post:function(a,d,h,l,m){e(a,"POST",h,l,b.merge({data:c.stringify(d)},m))},ajax:e}});k("qt",["6","v5","v6","7"],function(b,d,c,a){return{json:function(){return{get:function(b,
c,g,h){d.get(b,c,g||a.identity,h)},post:function(b,c,g,h){d.ajax(b,"POST",c,g||a.identity,h)},ajaxData:function(e,f,g,h,l,m){f=b.merge(m||{},{data:void 0!==f?c.stringify(f):""});d.ajax(e,g,h,l||a.identity,f)}}}}});k("n9",["b","7","qt","v4"],function(b,d,c,a){return function(e,f,g){var h=function(b){a.refetch(g,b)};return{menu:function(a,m){b.each(g,function(b){a[b.event()].bind(function(a){a=a.enabled();b.set(a);var g={};g[b.name()]=a;c.json().ajaxData(f.preferencesUrl+"/preferences",g,"POST",d.identity,
d.identity,e.headers());h(function(a){m.trigger.preferences(a)})})})},fromLocal:h,fromService:function(a){c.json().get(f.preferencesUrl+"/preferences",function(c){b.each(g,function(a){var b=a.parse(c);a.set(b)});h(a)},d.identity,e.headers())}}}});k("fc",["7","n8","n9"],function(b,d,c){var a=function(a,c,d,e){return{name:b.constant(a),event:b.constant(c),set:d.set,get:d.get,parse:function(b){return void 0!==b[a]?b[a]:e}}},e=function(b){return[a("spelling","spellcheck",b.spelling(),!0),a("autocorrect",
"autocorrect",b.autocorrect(),!0),a("capitalisation","capitalisation",b.capitalisation(),!1),a("linkpreviews","linkpreviews",b.linkpreviews(),!1)]};return{server:function(a,b,d){d=e(d);return c(a,b,d)},local:function(a,b,c){a=e(c);return d(a)}}});k("fd","9k 9l b 7i e6 fi 6 7 s 6u 6v 4x 3z mh 1x l 2m 2o q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k,s,t,u,v,w){return function(x,y){var B=t.fromDom(w),z=q.create({login:p([]),logout:p([]),done:p([]),abort:p([]),spellcheck:p(["enabled"]),capitalisation:p(["enabled"]),
linkpreviews:p(["enabled"]),autocorrect:p(["enabled"]),help:p([]),wordcount:p([])}),A=function(a,b,c,d){b=m.translate(b);a=(!0===c?f.ellipsisItem:f.item)(B,a,b);d(a,b);return a},C=a.menuItem,D=a.menuItemCheckbox,E=function(a){var b=t.fromTag("li");u.append(b,t.fromText(a));return b}(m.translate("cog.not-logged-in")),F=A("login","cog.login",!0,C),G=A("logout","cog.logout",!1,C),I=A("spellcheck","cog.spellcheck",!1,D),H=A("capitalisation","cog.capitalisation",!1,D),L=A("autocorrect","cog.autocorrect",
!1,D),J=A("linkpreviews","cog.linkpreviews",!1,D),D=A("wordcount","wordcount.open",!0,C),A=A("help","cog.help",!1,C),C=function(a){return!0===x[a]&&c.contains(y.menu,a)},D=c.flatten([[D],!0===y.login?[E,F]:[],[f.separator(B)],C("spellcheck")?[I]:[],C("autocorrect")?[L]:[],C("capitalisation")?[H]:[],C("linkpreviews")?[J]:[],[f.separator(B)],[A]]),A=function(a){return function(b){var c=s.toggle(b,"ephox-pastry-toggle-list-item-selected");e.checked(b,c);z.trigger.done();a(c)}},C=function(a){return function(){z.trigger.done();
a()}},C={login:C(z.trigger.login),spellcheck:A(z.trigger.spellcheck),capitalisation:A(z.trigger.capitalisation),autocorrect:A(z.trigger.autocorrect),linkpreviews:A(z.trigger.linkpreviews),wordcount:C(z.trigger.wordcount),help:C(z.trigger.help),logout:C(z.trigger.logout)},A={textkey:m.key("cog.menu"),name:"usersettings",icon:l.none(),tooltip:n.get,contentFocus:!1,toggle:!1},D=[[{handlers:h.constant(C),destroyer:h.noop,refreshMenu:h.noop,structure:h.constant({}),submenus:h.constant([]),items:h.constant(D),
events:z.registry}]],D=b.menu(A,D,m.get,d.menu({focusActive:!0}));return g.merge(D,{updateItems:function(a,b){if(!0===y.login){v.empty(E);var d=a?m.translate("cog.user",b):m.translate("cog.not-logged-in");u.append(E,t.fromText(d));c.each([F,G],v.remove);u.after(E,a?G:F)}},updateToggles:function(a){var b=function(a,b){(b?s.add:s.remove)(a,"ephox-pastry-toggle-list-item-selected");e.checked(a,b)};b(I,a.spelling());b(L,a.autocorrect());b(H,a.capitalisation());b(J,a.linkpreviews())},layout:k.southwest})}});
k("na",[],function(){return function(){var b=!1,d=null;return{login:function(c){d=c;b=!0},logout:function(){d=null;b=!1},username:function(){return d},loggedIn:function(){return b}}}});k("12r",["1n","6","vr","v6"],function(b,d,c,a){var e=function(a,b){void 0!==b.authenticated&&(b.authenticated?a.updateSession(b):a.clearSession())},f=function(a,b){return function(c){c=c||{};e(a,c);a.updateCsrf(c);b(c)}},g=function(b,c){return function(d,f,g){g=void 0===g||""===g?{}:a.parse(g);e(b,g);c(d,f,g)}};return{ajax:function(e,
l,m,n,p,q,k){k=d.merge({dataType:"json",type:m,xhrFields:{withCredentials:!0}},k);0<b.keys(n).length&&(k.data=a.stringify(n));e.applyCsrf(m,k);c.ajax(l,f(e,p),g(e,q),k)}}});k("zn",["12r"],function(b){return{request:function(d,c,a,e,f,g,h,l){d=d.route(a,e);b.ajax(c,d.url(),d.method(),f,g,h,l)}}});k("v7",["zn"],function(b){return{get:function(d,c,a,e,f){b.request(d,c,"session.get",{},{},a,e,f)},login:function(d,c,a,e,f,g,h){b.request(d,c,"session.login",{},{login:a,password:e},f,g,h)},logout:function(d,
c,a,e,f){if(null===c.session())a();else{var g={session:c.session()};b.request(d,c,"session.logout",g,{},a,e,f)}}}});k("zo",["6"],function(b){return function(){var d=null;return{update:function(b){void 0!==b.csrf&&(d=b.csrf)},set:function(c,a){"GET"!==c&&null!==d&&(a.headers=b.merge(a.headers||{},{"X-CSRF-Token":d}))}}}});k("v8",["zo"],function(b){return function(d){var c=b();return{session:d.session,username:d.username,email:d.email,updateSession:d.update,clearSession:d.clear,applyCsrf:c.set,updateCsrf:c.update}}});
k("nb",["7","v7","v8"],function(b,d,c){return function(a,e){var f=c(e);return{get:b.curry(d.get,a,f),login:b.curry(d.login,a,f),logout:b.curry(d.logout,a,f),session:f.session}}});k("v9",["33"],function(b){return b.immutable("url","method")});k("gt",["6"],function(b){var d={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},c=function(a,b){for(var c=b.parser[b.strictMode?"strict":"loose"].exec(a),d={},h=14;h--;)d[b.key[h]]=c[h]||"";d[b.q.name]={};d[b.key[12]].replace(b.q.parser,function(a,c,f){c&&(d[b.q.name][c]=f)});return d};return{parse:function(a,e){var f=b.merge(d,e);return c(a,f)}}});k("va","b 1n 7 v gt 5z".split(" "),
function(b,d,c,a,e,f){return function(g){return{pattern:c.constant(g),get:function(a){var b=g;d.each(a,function(a,c){b=b.replace(new f("{"+c+"}","g"),a)});return b},match:function(c){c=e.parse(c).path.split("/");var d=g.split("/"),f={match:!1,variables:{}},n={match:!0,variables:{}};if(d.length!==c.length)return f;b.each(c,function(b,c){var e=d[c];a.startsWith(e,"{")&&a.endsWith(e,"}")?(e=a.removeTrailing(a.removeLeading(e,"{"),"}"),n.variables[e]=b):e!==b&&(n.match=!1)});return n.match?n:f}}}});k("nc",
["v9","va"],function(b,d){return function(c){var a={"session.get":b(d(""),"GET"),"session.login":b(d(""),"POST"),"session.logout":b(d("/{session}"),"DELETE")};return{route:function(d,f){var g=a[d];return b(c+g.url().get(f),g.method())}}}});k("nd",[],function(){return function(){var b=null,d=null,c=null;return{session:function(){return b},username:function(){return d},email:function(){return c},update:function(a){b=a.session;d=a.username;c=a.email},clear:function(){c=d=b=null}}}});k("fe",["7","na",
"nb","nc","nd"],function(b,d,c,a,e){return function(f){f=a(f.url);var g=e(),h=c(f,g),l=d();return{user:b.constant(l),session:b.constant(g),sessions:b.constant(h),router:b.constant(f),get:function(){return{email:g.email}}}}});k("83","7 fa 6l fb fc fd fe 4x 3z o".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n,p,q,k,s,t,u){var v=l.create({done:h([]),abort:h([]),login:h(["username","email"]),initialLogin:h(["username","email"]),wordcount:h([]),logout:h([]),help:h([]),analytics:h(["message",
"username","email"])}),w=l.create({preferences:h(["preferences"]),user:h(["loggedIn","username"])}),x=a(p),y=g(u),B=e.local(n,u,p),z=d.make(k,s.uiContainer(),u);z.events.ok.bind(function(){v.trigger.done();y.sessions().get(function(a){v.trigger.initialLogin(a.username,a.email);C(a)},D)});var A=function(a){v.trigger.analytics("login",a.username,a.email);y.user().login(a.username);B.fromService(function(a){x.updatePreferences(a);w.trigger.preferences(a)});x.updateLogin(a.username);w.trigger.user(!0,
a.username);v.trigger.login(a.username,a.email)},C=function(a){!1!==a.authenticated&&A(a)},D=function(a){m.log("session failure:");m.log(a)},E=function(){z.open();v.trigger.done()},F=function(a){var b=function(a,b){a.bind(function(){b()})};b(a.events.done,v.trigger.done);b(a.events.help,v.trigger.help);b(a.events.wordcount,v.trigger.wordcount);a.events.login.bind(E);a.events.logout.bind(function(){y.sessions().logout(function(){v.trigger.analytics("logout","","");y.user().logout();w.trigger.user(!1,
"");v.trigger.done();v.trigger.logout()},function(){m.log("logout failed.")},n.headers())});w.registry.preferences.bind(function(b){a.updateToggles(b.preferences())});w.registry.user.bind(function(b){a.updateItems(b.loggedIn(),b.username())});x.getUsername().each(function(b){a.updateItems(b.loggedIn(),b.name())});a.updateToggles(x.getPreferences());B.menu(a.events,w)};p=c.ui({"cog.menu":function(){var a=f(t,u);F(a);return a}},b.identity);q=c.actions({showLogin:E});return{init:function(){B.fromLocal(function(a){w.trigger.preferences(a)});
!0===u.login&&y.sessions().get(C,D,n.headers())},ui:p,actions:q,destroy:function(){z.destroy()},events:v.registry,get:y.get}}});k("5a","b 7i c 7 s 7j 61 7k 7l 7m 7n 7o 7p 7q 6g 7r 7s 7t 7u 7v 7w 7x 7y 7z 80 81 82 83 4w 6u 4x 3z 3n 2y o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k,s,t,u,v,w,x,y,B,z,A,C,D,E,F,G,I,H,L,J,K,M){var Q=function(){var b=L.create({login:H([]),logout:H([])});return{init:function(){b.trigger.login()},authorised:function(a,b){return b()},destroy:a.noop,events:b.registry}};
return function(H,L,O){var V=g(H),U=x(O.profile),N=n(O.filters),X=q(),T=h(N,X,H.content,L,O.content),W=z(L,N,T),Z=A(T,H.shortcuts),ba=H.ui.layout.bounds(H.ui),$=C(T,ba,L),ha=!1!==H.fullscreen.bundled?p(T,Z,H.fullscreen):G.fullscreen(),ga=w(T,$,L,ha,H.platform),ea=D(T,Z,$,ga,ha,L,H.ui,O.ui),da=k(T,ea),Y=E(N,T,da,Z,O.undo),S=y(T,da,Y),aa=u(N,T),ca=m(T,Y,H.editorcontext),ia=F(V,U,T,da,$,{spellcheck:H.spelling.bundled,autocorrect:H.spelling.bundled&&H.spelling.service&&H.macros.bundled,capitalisation:H.macros.bundled},
H.usersettings),fa=!0===H.usersettings.login?t(ea,ia):Q(),ja=B(ea,H.registration),la=l(L,T,da,Z,$,H.contextmenu),sa=v.onNodeChange(T,aa),ka=s(O.laundry);Y.events.changed.bind(function(){ka.setDirty(!0)});T.events.interaction.bind(function(a){!ka.isDirty()&&Y.checkChanged()&&ka.setDirty(!0)});var pa=c.detect(),qa=pa.deviceType.isTouch(),ba=Z.isHelpShortcutEnabled();O=!T.isInline()&&!qa&&H.ui.showHelpHint;var ra=f.editor(H.ui.editorName);H=I.translate(pa.os.isOSX()?"aria.help.mac":"aria.help.ctrl");
H=ba?e.some(H):e.none();var oa=d.editor(ea.element(),T.element(),ra,H,O),ma=e.none();T.runOrOnLoaded(function(a){var b=J.bind(a,"click",function(a){K.closest(a.target(),"a").each(function(b){K.ancestor(b,'[contenteditable="false"]').each(a.kill)})});ma=e.some(b);qa&&d.label(a,ra)});return{region:a.constant(L),communication:a.constant(V),profile:a.constant(U),filter:a.constant(N),internalevents:a.constant(X),content:a.constant(T),keyboard:a.constant(da),shortcuts:a.constant(Z),smartview:a.constant($),
undo:a.constant(Y),proximity:a.constant(S),operations:a.constant(aa),context:a.constant(ca),fullscreen:a.constant(ha),platform:a.constant(ga),users:a.constant(ia),locker:a.constant(fa),registration:a.constant(ja),contextmenu:a.constant(la),ui:a.constant(ea),selections:a.constant(W),insertFilteredHtmlAtCursor:function(a){a=N.filterHtml(N.input(),a);T.insertHtmlAtCursor(a)},laundry:a.constant(ka),state:function(){return{ui:ea.state(),undo:Y.state(),content:T.state(),profile:U.state(),laundry:ka.state()}},
destroy:function(){ma.each(function(a){a.unbind()});b.each([sa,la,ja,ea,fa,ia,ga,ha,ca,aa,S,Y,$,Z,da,W,T,N,U,V],function(a){a.destroy?a.destroy():M.log("Feature missing destroy method: ",a)});oa.destroy()}}}});k("ne",["48"],function(b){return{resolve:b.create("ephox-hermes").resolve}});k("fh",["6","4g"],function(b,d){var c=d.generate([{blob:["id","blob","objurl","data"]},{url:["id","url","raw"]}]);return b.merge(c,{cata:function(a,b,c){return a.fold(b,c)}})});k("fy",["2g"],function(b){return{createObjectURL:function(d){return b.getOrDie("URL").createObjectURL(d)},
revokeObjectURL:function(d){b.getOrDie("URL").revokeObjectURL(d)}}});k("fg","b 2w c fh 3l nf fy 1a".split(" "),function(b,d,c,a,e,f,g,h){c=c.detect();var l=function(a){var b=g.createObjectURL(a);return m(a,b)},m=function(b,c){return e.nu(function(e){var g=f();g.onload=function(f){var g=d.generate("image");f=a.blob(g,b,c,f.target);e(f)};g.readAsDataURL(b)})},n=function(a){return 1===a.length&&b.contains(a,"Files")},p=function(a){return!b.contains(a,"text/_moz_htmlcontext")},q=function(a){return b.contains(a,
"Files")},k=function(a){return!0};return{multiple:function(a){return 0===a.length?e.pure([]):e.mapM(a,l)},toFiles:function(a){return a.raw().target.files||a.raw().dataTransfer.files},isFiles:c.browser.isChrome()||c.browser.isSafari()||c.browser.isOpera()?q:c.browser.isFirefox()?p:c.browser.isIE()?n:k,fromImages:function(c){c=b.map(c,function(b){var c=d.generate("image");return a.url(c,h.get(b,"src"),b)});return e.pure(c)},single:l,singleWithUrl:m}});k("ff","ne fg 7 4x 3z 1a 1x 3n l 2z".split(" "),
function(b,d,c,a,e,f,g,h,l,m){var n=function(){var n=e.create({upload:a(["files"])}),q=l.fromTag("input");g.add(q,b.resolve("hidden"));g.add(q,b.resolve("file-selector-input"));f.setAll(q,{type:"file",accept:"image/*"});var k=h.bind(q,"change",function(a){a=d.toFiles(a);n.trigger.upload(a)});return{element:c.constant(q),open:function(){m.set(q,"");q.dom().click()},destroy:function(){k.unbind()},events:n.registry}};return{single:n,multiple:function(){var a=n();f.set(a.element(),"multiple","multiple");
return{element:a.element,open:a.open,destroy:a.destroy,events:a.events}}}});k("84",["ff","fg","4x","3z"],function(b,d,c,a){return function(){var e=b.single(),f=a.create({upload:c(["assets"])});e.events.upload.bind(function(a){d.multiple(a.files()).get(function(a){f.trigger.upload(a)})});return{element:e.element,open:e.open,destroy:e.destroy,events:f.registry}}});k("86",["s","ba","be"],function(b,d,c){return function(a){var e=b.none(),f=function(c){g();c=d(c);c.events.close.bind(function(){e=b.none()});
e=b.some(c);a().displayBanner(c)},g=function(){e.each(a().hideBanner);e=b.none()};return{show:f,showKey:function(a){var b=c.get.apply(void 0,arguments);f(b)},hide:g,reset:function(){e=b.none()}}}});k("87","b fh 8x 1a 3n l".split(" "),function(b,d,c,a,e,f){var g=function(c,g){return b.map(g,function(b){var g=f.fromTag("img"),l=e.bind(g,"load",function(){l.unbind();c.domChanged()});b=d.cata(b,function(a,b,c,d){return c},function(a,b,c){return b});a.set(g,"src",b);return g})};return{insertMobileAssets:function(a,
b,d,e){var f=g(a,e);return a.undoOperation(function(){var g=c.insertAt(a,b,f);d.uploadAssets(e);return g})},insertAssets:function(a,b,d){var e=g(a,d);a.focus();a.undoOperation(function(){c.insertAtCursor(a,e);b.uploadAssets(d)})}}});k("vb",["48"],function(b){return{resolve:b.create("ephox-gel").resolve}});k("qp","vb 6 4x 3z 1x 2l l 2m 2o 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n,p){var q=d.merge({layerClass:void 0,zindex:void 0,padding:"0px"},n),k=a.create({exiting:c([])}),s=
g.fromTag("div");e.add(s,b.resolve("modal"));e.add(s,b.resolve("modal-hidden"));f.setAll(s,{position:"fixed",left:q.padding,top:q.padding,right:q.padding,bottom:q.padding});void 0!==q.background&&f.set(s,"background",q.background);void 0!==q.zindex&&f.set(s,"z-index",q.zindex);void 0!==q.layerClass&&e.add(s,q.layerClass);var t=void 0!==p?p:m.first("body").getOrDie();h.append(t,s);return{element:function(){return s},content:function(a){l.empty(s);h.append(s,a)},show:function(){e.add(t,b.resolve("modal-active"));
e.remove(s,b.resolve("modal-hidden"));e.add(s,b.resolve("modal-show"))},hide:function(){e.remove(t,b.resolve("modal-active"));e.add(s,b.resolve("modal-hidden"));e.remove(s,b.resolve("modal-show"))},destroy:function(){l.remove(s);e.remove(t,b.resolve("modal-active"))},events:k.registry}}});k("vc","vb 6 z6 7 4x 3z 1x 2l 3n l 2m 2o 2y 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k){return function(s,t){var u=c.onChange(),v=f.create({exiting:e([])}),w=d.merge({layerClass:null,zindex:null,padding:"0px",
background:"rgba(0, 0, 0, 0.5)"},s),x=m.fromTag("div");g.add(x,b.resolve("moodal"));g.add(x,b.resolve("moodal-hidden"));h.setAll(x,{left:w.padding,top:w.padding,right:w.padding,bottom:w.padding});w.background&&h.set(x,"background",w.background);w.zindex&&h.set(x,"z-index",w.zindex);w.layerClass&&g.add(x,w.layerClass);var y=void 0!==t?t:q.first("body").getOrDie();n.append(y,x);var B=m.fromTag("div");g.add(B,b.resolve("moodal-flexor"));n.append(x,B);var z=function(){h.setAll(B,{top:k.scrollY+"px",height:k.innerHeight+
"px"})},A=function(){C.unbind();u.destroy();p.remove(x);g.remove(y,b.resolve("modal-active"))},C=l.bind(x,"click",function(){v.trigger.exiting();A()});u.events.ready.bind(function(){z()});return{element:a.constant(x),content:function(a){p.empty(B);n.append(B,a)},show:function(){g.add(y,b.resolve("moodal-active"));g.remove(x,b.resolve("moodal-hidden"));g.add(x,b.resolve("moodal-show"));z()},hide:function(){g.remove(y,b.resolve("moodal-active"));g.add(x,b.resolve("moodal-hidden"));g.remove(x,b.resolve("moodal-show"))},
destroy:A,events:v.registry}}});k("nh","c qp vc vb 6 3z 40 1x 2l 2m 2o 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(q){var k=e.deepMerge({layerClass:void 0,zindex:void 0,modal:{}},q);q=void 0!==q.container?q.container:p.first("body").getOrDie();var s=(b.detect().os.isiOS()?c:d)(k.modal,q),t=s.element(),u=f.create({exiting:g([],s.events.exiting)});void 0!==k.zindex&&l.set(t,"z-index",k.zindex);void 0!==k.layerClass&&h.add(t,k.layerClass);h.add(t,a.resolve("centered-dialog"));m.append(q,
t);return{content:s.content,show:function(){s.show()},hide:function(){s.hide()},destroy:function(){n.remove(t);s.destroy()},events:u.registry}}});k("ni","7i 2w 6u 30 4x 3z 1a 1x 3n l 2v 2m 35 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k){return function(){var s=function(b,c){var d=m.fromTag(b);h.add(d,a.resolve(c));return d},t=s("div","dialog"),u=s("div","top"),v=s("span","dialog-title"),w=s("span","dialog-close"),x=s("div","dialog-content"),y=s("div","dialog-controls");g.set(t,"tabindex",
-1);g.set(w,"tabindex",-1);b.button(w,c.translate("button.cancel"));var B=l.bind(w,"click",function(){z.trigger.close()});q.append(t,[u,x,y]);q.append(u,[v,w]);var z=f.create({close:e([])});return{element:function(){return t},focus:function(){n.focus(t)},setTitle:function(a){k.empty(v);p.append(v,m.fromText(a));b.dialog(t,a);a=d.generate("ephox-aria");g.set(v,"id",a);b.labelledBy(t,a)},setContent:function(a){k.empty(x);p.append(x,a);a=d.generate("ephox-aria");g.set(x,"id",a);b.describedBy(t,a)},setControls:function(a){k.empty(y);
p.append(y,a);a=d.generate("ephox-aria");g.set(y,"id",a);b.controls(t,a)},close:function(){z.trigger.close()},destroy:function(){k.remove(t);B.unbind()},events:z.registry}}});k("fl","c nh s ni 3f 30 2k 3n".split(" "),function(b,d,c,a,e,f,g,h){var l=b.detect();return function(b){var n=a(),p=c.none(),q=d({container:b,layerClass:f.resolve("layer-dialog"),modal:{layerClass:f.resolve("layer-below-dialog")}});q.content(n.element());q.events.exiting.bind(function(){e.unlock([g.body()]);n.close()});var k=
function(){q.hide();e.unlock([g.body()])};return{element:n.element,destroy:function(){n.destroy();p.each(function(a){a.unbind()});k();q.destroy()},setTitle:n.setTitle,setContent:n.setContent,setControls:n.setControls,show:function(){q.content(n.element());q.show();n.focus();l.deviceType.isTouch()&&(p=c.some(h.bind(n.element(),"click",function(a){a.stop()})));e.lock([g.body()])},hide:k,events:n.events}}});k("fm","fk 85 7 s 2y m".split(" "),function(b,d,c,a,e,f){var g=function(b){b.dom().click();return a.some(b)};
return{setup:function(a,c,e){c=b.dialog({execute:function(a){a.dom().click()},ok:c.ok().element(),cancel:c.cancel().element()});a=d.dialog(a.element(),e,c);return{enter:a.enter,exit:a.exit,destroy:a.destroy}},button:function(b){return(f.is(b,".ephox-pastry-button")?a.some(b):e.descendant(b,".ephox-pastry-button")).bind(g)},click:g,radio:function(a,e,f){e={item:c.constant(e),selected:c.constant(f)};return d.radio(a,e,b.radio({one:function(a,b){b.dom().click()}}))}}});k("89","fk fl fm 6u fn 30 4x 3z 1x 3n l 31".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p){return function(q,k,s,t,u){var v=e.okCancel("file-upload"),w=s(t),x=null,y=h.create({close:g([]),analytics:g(["message"]),escaped:g([]),insertAssets:g(["assets"]),opened:g([])}),B=function(){x.unbind();A.hide();y.trigger.close();y.trigger.analytics("insert_image_closed");z()},z=function(){w.reset();v.ok().disable()},A=d(k);A.setTitle(a.translate("fileupload.title"));A.setContent(w.element());A.setControls(v.element());A.events.close.bind(B);l.add(A.element(),f.resolve("imageupload-dialog"));
var C=u(A.element(),w.keylayouts(),b.dialog({cancel:v.cancel().element(),ok:v.ok().element(),execute:c.click,index:0}));w.events.upload.bind(function(a){y.trigger.insertAssets(a.assets());B()});w.events.dragndrop.bind(function(a){y.trigger.insertAssets(a.assets());B()});w.events.success.bind(function(a){v.ok().enable()});w.events.lookup.bind(function(a){v.ok().disable()});w.events.setActive.bind(function(a){z()});v.events.ok.bind(function(){w.selected().each(function(a){y.trigger.insertAssets([a]);
B()})});v.events.cancel.bind(B);z();return{show:function(){A.show();C.enter();var a=n.fromDom(p);y.trigger.analytics("insert_image_opened");y.trigger.opened();x=m.bind(a,"orientationchange",function(){q.foreground()})},element:A.element,events:y.registry,destroy:function(){C.exit();C.destroy();A.hide();A.destroy();w.destroy();v.destroy()}}}});k("nj","fh ne 7 1a 1x 1r".split(" "),function(b,d,c,a,e,f){return{previewAsset:function(f,h){b.cata(f,c.die("asset should not be a file type"),function(b,c,
f){e.add(h,d.resolve("fluid-image"));a.set(h,"src",c)})}}});k("nk","7i 2w c ma ne fg 7 gy s 4x 3z 1a 1x 3n l 2v 2m 35 2z mb".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k,s,t,u,v,w,x){var y=c.detect();return function(c){var x=n.create({success:m(["assets"]),invalidUrl:m(["url"]),empty:m([]),lookup:m([])}),A=[],C=s.fromTag("div"),D=q.toggler(C,e.resolve("url-indicator-loading")),E=a();E.events.start.bind(function(){D.on()});E.events.fail.bind(function(a){D.off();x.trigger.invalidUrl(a.url());A=[]});
E.events.success.bind(function(a){D.off();var b=w.get(H);a.url()===b?f.fromImages([a.image()]).get(function(a){A=a;x.trigger.success(A)}):E.go(b)});var F=s.fromTag("div");q.add(F,e.resolve("url-selector"));var G=s.fromTag("label");c=s.fromText(c("fileupload.web.url"));var I=d.generate(e.resolve("label-id"));p.set(G,"id",I);q.add(G,e.resolve("url-input-label"));u.append(G,c);var H=s.fromTag("input");p.set(H,"placeholder","http://www.example.com/image.jpg");q.add(H,e.resolve("url-input"));p.set(H,"type",
"url");y.os.isAndroid()&&p.set(H,"autofocus","true");b.labelledBy(H,I);b.required(H);c=s.fromHtml("<span>*<span>");q.add(c,e.resolve("url-input-required"));u.append(G,c);v.append(F,[G,H,C]);var L=h(function(a){""!==a&&E.go(a)},1E3),J=k.bind(H,"input",function(){var a=w.get(H);""===a.trim()?(x.trigger.empty(),L.throttle("")):(x.trigger.lookup(),L.throttle(a))});return{element:g.constant(F),input:g.constant(H),events:x.registry,reset:function(){D.off();w.set(H,"")},focus:function(){t.focus(H)},selected:function(){return l.from(A[0])},
destroy:function(){J.unbind()}}}});k("fq","b 7i 2w ne nj nk 7 4x 3z 1x l 2m 35 2o mb".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k,s){return function(s){var u=l.create({lookup:h([]),success:h([])}),v=n.fromTag("span"),w=n.fromHtml('<div><span class="'+a.resolve("url-input-required")+'">*</span> '+s("fileupload.weburlhelp")+"</div>");m.add(w,a.resolve("fileupload-weburl-help"));var x=n.fromHtml("<div><div>"+s("fileupload.invalid1")+"</div><div>"+s("fileupload.invalid2")+"</div><div>"+s("fileupload.invalid3")+
"</div></div>");m.add(x,a.resolve("fileupload-weburl-help"));m.add(x,a.resolve("fileupload-weburl-help-invalid"));var y=function(a){k.empty(C);p.append(C,a)},B=function(a){var b=n.fromTag("img");p.append(C,b);e.previewAsset(a,b)},z=n.fromTag("div");m.add(z,a.resolve("web-url-container"));var A=f(s),C=n.fromTag("div");m.add(C,a.resolve("image-preview-container"));s=c.generate("ephox-hermes-url-state");d.live(C,s,"polite");d.controls(A.input(),s);d.describedBy(A.input(),s);s=n.fromTag("div");m.add(s,
a.resolve("hbox"));q.append(s,[A.element(),C,w]);p.append(z,s);A.events.lookup.bind(function(a){u.trigger.lookup();k.empty(C)});A.events.success.bind(function(a){b.each(a.assets(),B);u.trigger.success()});A.events.invalidUrl.bind(function(){y(x)});A.events.empty.bind(function(){y(v)});y(v);return{element:g.constant(z),selected:A.selected,input:A.input,events:u.registry,focus:A.focus,reset:function(){y(v);A.reset()},destroy:function(){A.destroy()}}}});k("fo","fq fk 85 7 6u 4x 3z 40 l 2m".split(" "),
function(b,d,c,a,e,f,g,h,l,m){return function(n){n=l.fromTag("div");var p=b(e.translate),q=g.create({upload:f(["assets"]),dragndrop:f(["assets"]),dragover:f([]),dragleave:f([]),drop:f([]),setActive:f(["item"]),lookup:h([],p.events.lookup),success:h([],p.events.success)}),k=[function(){var a=p.input();return c.input(a,d.input({}))}()];m.append(n,p.element());return{element:a.constant(n),events:q.registry,keylayouts:a.constant(k),reset:function(){p.reset()},focus:p.focus,selected:p.selected,destroy:function(){p.destroy()}}}});
k("88","9k 9l b 7i fi 84 85 6 fj 7 s 89 fo 6u 6v 4x 3z l 35 q".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,q,k,s,t,u,v,w,x){return function(y,B,z,A){var C=u.create({insertAsset:t(["asset"]),open:t([]),done:t([]),abort:t([])}),D=v.fromDom(x);z=e.mainmenu(D,"file-upload-menu",[]);var E=function(b,c){var d=e.item(D,b,k.get(c)+"...");a.menuItem(d,k.get(c));return d},F=E("from-url",k.key("image.from-url")),E=E("from-camera",k.key("image.from-camera")),F=!0===A.allowLocalImages?[F,E]:[F],G=f();G.events.upload.bind(function(a){n.from(a.assets()[0]).each(function(a){H();
C.trigger.insertAsset(a)})});var I=function(a){a=a.assets();c.each(a,function(a){C.trigger.insertAsset(a)})},H=function(){l.target(B.uiContainer(),"mousedown")};w.append(z,F);z={name:"image",textkey:k.key("image.menu"),icon:n.none,tooltip:s.get,contentFocus:!1,toggle:!1};F=[[{handlers:m.constant({"from-url":function(a){C.trigger.open();var b=p(y,B.uiContainer(),q,A,g.dialog);b.events.insertAssets.bind(I);a=function(){y.focus();b.destroy()};b.events.opened.bind(H);b.events.close.bind(a);b.events.escaped.bind(a);
b.show()},"from-camera":function(){C.trigger.open();G.open()}}),destroyer:m.noop,refreshMenu:m.noop,structure:m.constant({}),submenus:m.constant([]),items:m.constant(F),events:C.registry}]];z=b.menu(z,F,k.get,d.menu({focusActive:!0}));F={label:m.constant(!1),hasDialog:!0};return h.merge(z,F)}});k("no","c fg 4x 3z 1x 3n".split(" "),function(b,d,c,a,e,f){b=b.detect();var g=b.browser.isIE()||b.browser.isSpartan()||b.browser.isChrome()&&(b.os.isOSX()||b.os.isLinux());return{register:function(b,l,m){var n=
a.create({dragover:c(["original"]),dragleave:c(["original"]),drop:c(["original"]),dragndrop:c(["original","files"])});l.each(function(a){var c=function(c){return function(){c(b,a)}};n.registry.dragover.bind(c(e.add));n.registry.dragleave.bind(c(e.remove));n.registry.drop.bind(c(e.remove))});l=function(a){return function(b){(!1===m||g)&&b.kill();a(b)}};var p=f.bind(b,"dragover",l(n.trigger.dragover)),k=f.bind(b,"dragleave",l(n.trigger.dragleave)),r=f.bind(b,"drop",function(a){n.trigger.drop(a);a.kill();
var b=d.toFiles(a);n.trigger.dragndrop(a,b)});return{destroy:function(){p.unbind();k.unbind();r.unbind()},events:n.registry}}}});k("vd",["ka","1a","l"],function(b,d,c){return function(a){var e=c.fromTag("button");d.set(e,"type","button");return b(e,a)}});k("nl","no ff ne vd dd 7 s 1x l 2v 2m 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(k){var r=d.multiple(),s=l.fromTag("div");h.add(s,c.resolve("drop-container"));var t=b.register(s,g.some(c.resolve("drop-active")),!1),u=a();u.content(e(k("fileupload.chooseimage")));
h.add(u.element(),c.resolve("default-action"));h.add(u.element(),c.resolve("file-selector-trigger"));var v=l.fromTag("p");h.add(v,c.resolve("help-text-drop-icon"));var w=l.fromTag("p");h.add(w,c.resolve("help-text-drop"));n.append(w,l.fromText(k("fileupload.dropimages")));p.append(s,[v,w,u.element(),r.element()]);return{container:f.constant(s),dropper:f.constant(t),picker:f.constant(r),button:f.constant(u),focus:function(){m.focus(u.element())},destroy:function(){r.destroy();t.destroy();u.destroy()}}}});
k("fp","nl fg 7 4x 3z 40".split(" "),function(b,d,c,a,e,f){return function(g){var h=b(g);g=h.picker();var l=h.container(),m=h.dropper(),n=h.button(),p=e.create({upload:a(["assets"]),dragndrop:a(["assets"]),dragover:f([],m.events.dragover),dragleave:f([],m.events.dragleave),drop:f([],m.events.drop)}),k=function(a){return function(b){d.multiple(b.files()).get(function(b){a(b)})}};g.events.upload.bind(k(p.trigger.upload));m.events.dragndrop.bind(k(p.trigger.dragndrop));n.events.click.bind(g.open);return{element:c.constant(l),
button:c.constant(n),input:g.element,focus:h.focus,events:p.registry,destroy:function(){h.destroy()}}}});k("fr","b nm dd kb 7 4x 3z 33 1a 1x l 2m 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k){return function(r,s,t){var u=[],v=h.immutable("view","item","container"),w=g.create({setActive:f(["item"])}),x=n.fromTag("div");m.add(x,a.resolve("tablayout-wrapper"));m.add(x,a.resolve("tablayout-wrapper-"+r));void 0!==t&&m.add(x,t);var y=n.fromTag("div");m.add(y,a.resolve("tablayout-body"));var B=n.fromTag("div");
m.add(B,a.resolve("tablayout-menu"));k.append(x,[B,y]);var z=function(b){var e=d(b);e.content(c(b));m.add(e.element(),a.resolve("tablayout-item"));return e},A=[],C=b.map(s,function(b){var c=z(b.heading());l.set(c.element(),"data-ephox-pastry-tablayout-tab",b.heading());p.append(B,c.element());var d=n.fromTag("div");m.add(d,a.resolve("tablayout-content"));l.set(d,"data-ephox-pastry-tablayout-view",b.heading());p.append(y,d);A.push(d);var e=v(b,c,d);u.push(e);c.events.click.bind(function(){D(e)});return c}),
D=function(c){b.each(u,function(b){var d=b.view(),e=b.item(),f=b.container();b===c?(m.add(f,a.resolve("tablayout-active")),e.select(),d.renderer().render(f),w.trigger.setActive(e)):(m.remove(f,a.resolve("tablayout-active")),e.deselect())})};D(u[0]);return{element:function(){return x},tabs:e.constant(C),body:e.constant(y),menu:e.constant(B),tabContent:e.constant(A),destroy:function(){b.each(C,function(a){a.destroy()})},events:w.registry}}});k("fs",["2m","2o"],function(b,d){return function(c){return{render:function(a){d.empty(a);
b.append(a,c)}}}});k("ft",["33"],function(b){return b.immutable("heading","renderer")});k("fu",["7"],function(b){return{left:b.constant("left"),top:b.constant("top")}});k("8a","b 7i c fp fq fk 85 6 fr fs ft fu 7 fm 6u 30 3z 40 1a 1x l 2m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w,x,y,B){return function(z){var A=y.fromTag("div"),C=a(s.translate),D=e(s.translate),E=function(a,b){var c=s.translate(a),d=m(b);return n(c,d)},F=E("fileupload.tabweburl",D.element());z=(z.allowLocalImages?
[E("fileupload.tablocal",C.element())]:[]).concat(F);var G=l(p.top(),z,"file-upload");d.hidden(C.input(),!0);E=function(){var a=C.button();x.add(a.element(),t.resolve("dialog-button-default"));var b=c.detect().browser.isFirefox(),d={execute:r.button},b=b?h.merge(d,{process:k.noop}):d,b=f.button(b);return g.button(a.element(),b)}();d.tabList(G.menu());var F=function(){var a=D.input();return g.input(a,f.input({}))}(),I=g.flow(G.menu(),{item:k.constant(".ephox-pastry-statebutton")},f.flow({trigger:r.button,
executeOnArrow:!0})),E=[I].concat(E).concat(F),H=G.tabs();b.each(G.tabContent(),function(a){d.tabPanel(a)});b.each(z,function(a,b){var c=H[b];d.tabButton(c.element(),a.heading());x.add(c.element(),t.resolve("tab-button"));c.events.click.bind(function(){I.clickFocus(c.element())})});z=u.create({upload:v(["assets"],C.events.upload),dragndrop:v(["assets"],C.events.dragndrop),dragover:v([],C.events.dragover),dragleave:v([],C.events.dragleave),drop:v([],C.events.drop),lookup:v([],D.events.lookup),success:v([],
D.events.success),setActive:v(["item"],G.events.setActive)});G.events.setActive.bind(function(a){a=w.get(a.item().element(),"data-ephox-pastry-tablayout-tab");a===s.translate("fileupload.tablocal")?C.focus():a===s.translate("fileupload.tabweburl")&&D.focus()});B.append(A,G.element());return{element:k.constant(A),events:z.registry,focus:D.focus,keylayouts:k.constant(E),reset:function(){D.reset()},selected:D.selected,destroy:function(){G.destroy();C.destroy();D.destroy()}}}});k("fw",["no","fg","4x",
"3z"],function(b,d,c,a){return{forImages:function(e,f,g){e=b.register(e,f,g);var h=a.create({dragover:c(["original"]),dragleave:c(["original"]),drop:c(["original"]),dragndrop:c(["assets","original"])});f=function(a,b){a.bind(function(a){d.isFiles(a.original().raw().dataTransfer.types)&&b(a.original())})};e.events.dragndrop.bind(function(a){d.multiple(a.files()).get(function(b){h.trigger.dragndrop(b,a.original())})});f(e.events.dragover,h.trigger.dragover);f(e.events.dragleave,h.trigger.dragleave);
f(e.events.drop,h.trigger.drop);return{destroy:e.destroy,events:h.registry}}}});k("8b","fv ap fw s 4x 3z".split(" "),function(b,d,c,a,e,f){return function(g){var h=f.create({insertAssets:e(["assets"])}),l=a.none(),m=c.forImages(g.canvas(),l,!0);m.events.dragndrop.bind(function(a){var c=g.win(),e=a.original();b.find(c,e.x(),e.y()).each(function(a){d.set(c,a)});h.trigger.insertAssets(a.assets())});return{events:h.registry,destroy:function(a){m.destroy()}}}});k("8c",["a","b","fh","7"],function(b,d,c,
a){var e=["image"],f=function(a,c,f,m){return d.exists(e,function(a){return b.isString(c.type)&&-1<c.type.indexOf(a)})};return{validate:function(b){b=d.foldl(b,function(b,d){return!1===c.cata(d,f,a.constant(!0))?{assets:b.assets,failure:!0}:{assets:b.assets.concat([d]),failure:b.failure}},{assets:[],failure:!1});return{assets:a.constant(b.assets),failure:a.constant(b.failure)}}}});k("fx",["fg"],function(b){return{multiple:function(d){return b.multiple(d)},single:function(d){return b.single(d)},singleWithUrl:function(d,
c){return b.singleWithUrl(d,c)}}});k("ve",[],function(){function b(b,c,a){b.width=c;b.height=a;return b}return{create:function(d,c){return b(document.createElement("canvas"),d,c)},resize:b,get2dContext:function(b){return b.getContext("2d")},get3dContext:function(b){var c=null;try{c=b.getContext("webgl")||b.getContext("experimental-webgl")}catch(a){}c||(c=null);return c}}});k("vf",[],function(){return{getWidth:function(b){return b.naturalWidth||b.width},getHeight:function(b){return b.naturalHeight||
b.height}}});k("vg",[],function(){function b(a,b){return function(){a.apply(b,arguments)}}function d(c){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof c)throw new TypeError("not a function");this._value=this._state=null;this._deferreds=[];h(c,b(a,this),b(e,this))}function c(a){var b=this;null===this._state?this._deferreds.push(a):l(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)(b._state?a.resolve:a.reject)(b._value);
else{var d;try{d=c(b._value)}catch(e){a.reject(e);return}a.resolve(d)}})}function a(c){try{if(c===this)throw new TypeError("A promise cannot be resolved with itself.");if(c&&("object"===typeof c||"function"===typeof c)){var d=c.then;if("function"===typeof d){h(b(d,c),b(a,this),b(e,this));return}}this._state=!0;this._value=c;f.call(this)}catch(g){e.call(this,g)}}function e(a){this._state=!1;this._value=a;f.call(this)}function f(){for(var a=0,b=this._deferreds.length;a<b;a++)c.call(this,this._deferreds[a]);
this._deferreds=null}function g(a,b,c,d){this.onFulfilled="function"===typeof a?a:null;this.onRejected="function"===typeof b?b:null;this.resolve=c;this.reject=d}function h(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){d||(d=!0,c(e))}}if(window.Promise)return window.Promise;var l=d.immediateFn||"function"===typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},m=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};
d.prototype["catch"]=function(a){return this.then(null,a)};d.prototype.then=function(a,b){var e=this;return new d(function(d,f){c.call(e,new g(a,b,d,f))})};d.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&m(arguments[0])?arguments[0]:arguments);return new d(function(b,c){function d(f,g){try{if(g&&("object"===typeof g||"function"===typeof g)){var h=g.then;if("function"===typeof h){h.call(g,function(a){d(f,a)},c);return}}a[f]=g;0===--e&&b(a)}catch(l){c(l)}}if(0===a.length)return b([]);
for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})};d.resolve=function(a){return a&&"object"===typeof a&&a.constructor===d?a:new d(function(b){b(a)})};d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,c){for(var d=0,e=a.length;d<e;d++)a[d].then(b,c)})};return d});k("vh",[],function(){return{guessMimeType:function(b){var d=document.createElement("a");d.href=b;b=d.pathname.split(".");(b=b[b.length-1])&&(b=b.toLowerCase());return{jpg:"image/jpeg",jpeg:"image/jpeg",
png:"image/png"}[b]}}});k("ok",["vg","ve","vh","vf"],function(b,d,c,a){function e(a){return new b(function(b){function c(){a.removeEventListener("load",c);b(a)}a.complete?b(a):a.addEventListener("load",c)})}function f(b){return e(b).then(function(b){var c;c=d.create(a.getWidth(b),a.getHeight(b));d.get2dContext(c).drawImage(b,0,0);return c})}function g(a){return new b(function(b){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="blob";c.onload=function(){200==this.status&&b(this.response)};
c.send()})}function h(a){return new b(function(b){var c,d,e,f,g;a=a.split(",");(c=/data:([^;]+)/.exec(a[0]))&&(f=c[1]);c=atob(a[1]);if(window.WebKitBlobBuilder){g=new WebKitBlobBuilder;d=new ArrayBuffer(c.length);for(e=0;e<d.length;e++)d[e]=c.charCodeAt(e);g.append(d);b(g.getBlob(f))}else{d=new Uint8Array(c.length);for(e=0;e<d.length;e++)d[e]=c.charCodeAt(e);b(new Blob([d],{type:f}))}})}function l(a){return new b(function(b){var c=new FileReader;c.onloadend=function(){b(c.result)};c.readAsDataURL(a)})}
return{blobToImage:function(a){return new b(function(b){function c(){d.removeEventListener("load",c);b(d)}var d=new Image;d.addEventListener("load",c);d.src=URL.createObjectURL(a);d.complete&&c()})},imageToBlob:function(a){return e(a).then(function(a){var b=a.src;return 0===b.indexOf("blob:")?g(b):0===b.indexOf("data:")?h(b):f(a).then(function(a){return h(a.toDataURL(c.guessMimeType(b)))})})},blobToDataUri:l,blobToBase64:function(a){return l(a).then(function(a){return a.split(",")[1]})},imageToCanvas:f,
canvasToBlob:function(a,b){return h(a.toDataURL(b))},revokeImageUrl:function(a){URL.revokeObjectURL(a.src)},uriToBlob:function(a){return 0===a.indexOf("blob:")?g(a):0===a.indexOf("data:")?h(a):null}}});k("vi",[],function(){function b(a,b,c){a=parseFloat(a);a>c?a=c:a<b&&(a=b);return a}function d(a,b){var c,d,l,m,n=[],p=Array(10);for(c=0;5>c;c++){for(d=0;5>d;d++)n[d]=b[d+5*c];for(d=0;5>d;d++){for(l=m=0;5>l;l++)m+=a[d+5*l]*n[l];p[d+5*c]=m}}return p}function c(a,c){c=b(c,0,1);return a.map(function(a,
d){a=0===d%6?1-(1-a)*c:a*c;return b(a,0,1)})}var a=[0,0.01,0.02,0.04,0.05,0.06,0.07,0.08,0.1,0.11,0.12,0.14,0.15,0.16,0.17,0.18,0.2,0.21,0.22,0.24,0.25,0.27,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.53,0.56,0.59,0.62,0.65,0.68,0.71,0.74,0.77,0.8,0.83,0.86,0.89,0.92,0.95,0.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];return{identity:function(){return[1,
0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},adjust:c,multiply:d,adjustContrast:function(c,f){var g;f=b(f,-1,1);f*=100;0>f?g=127+f/100*127:(g=f%1,g=0===g?a[f]:a[Math.floor(f)]*(1-g)+a[Math.floor(f)+1]*g,g=127*g+127);return d(c,[g/127,0,0,0,0.5*(127-g),0,g/127,0,0,0.5*(127-g),0,0,g/127,0,0.5*(127-g),0,0,0,1,0,0,0,0,0,1])},adjustBrightness:function(a,c){c=b(255*c,-255,255);return d(a,[1,0,0,0,c,0,1,0,0,c,0,0,1,0,c,0,0,0,1,0,0,0,0,0,1])},adjustSaturation:function(a,c){var g;c=b(c,-1,1);g=1+(0<c?
3*c:c);return d(a,[0.3086*(1-g)+g,0.6094*(1-g),0.082*(1-g),0,0,0.3086*(1-g),0.6094*(1-g)+g,0.082*(1-g),0,0,0.3086*(1-g),0.6094*(1-g),0.082*(1-g)+g,0,0,0,0,0,1,0,0,0,0,0,1])},adjustHue:function(a,c){var g,h;c=b(c,-180,180)/180*Math.PI;g=Math.cos(c);h=Math.sin(c);return d(a,[0.213+0.787*g+-0.213*h,0.715+-0.715*g+-0.715*h,0.072+-0.072*g+0.928*h,0,0,0.213+-0.213*g+0.143*h,0.715+g*(1-0.715)+0.14*h,0.072+-0.072*g+-0.283*h,0,0,0.213+-0.213*g+-0.787*h,0.715+-0.715*g+0.715*h,0.072+0.928*g+0.072*h,0,0,0,0,
0,1,0,0,0,0,0,1])},adjustColors:function(a,c,g,h){c=b(c,0,2);g=b(g,0,2);h=b(h,0,2);return d(a,[c,0,0,0,0,0,g,0,0,0,0,0,h,0,0,0,0,0,1,0,0,0,0,0,1])},adjustSepia:function(a,f){f=b(f,0,1);return d(a,c([0.393,0.769,0.189,0,0,0.349,0.686,0.168,0,0,0.272,0.534,0.131,0,0,0,0,0,1,0,0,0,0,0,1],f))},adjustGrayscale:function(a,f){f=b(f,0,1);return d(a,c([0.33,0.34,0.33,0,0,0.33,0.34,0.33,0,0,0.33,0.34,0.33,0,0,0,0,0,1,0,0,0,0,0,1],f))}}});k("np",["ve","vf","ok","vi"],function(b,d,c,a){function e(a,e){return c.blobToImage(a).then(function(a){var f=
b.create(d.getWidth(a),d.getHeight(a)),g=b.get2dContext(f);g.drawImage(a,0,0);m(a);a=g.getImageData(0,0,f.width,f.height);var h=a.data,l,n,k,x,y,B=e[0],z=e[1],A=e[2],C=e[3],D=e[4],E=e[5],F=e[6],G=e[7],I=e[8],H=e[9],L=e[10],J=e[11],K=e[12],M=e[13],Q=e[14],R=e[15],P=e[16],O=e[17],V=e[18],U=e[19];for(y=0;y<h.length;y+=4)l=h[y],n=h[y+1],k=h[y+2],x=h[y+3],h[y]=l*B+n*z+k*A+x*C+D,h[y+1]=l*E+n*F+k*G+x*I+H,h[y+2]=l*L+n*J+k*K+x*M+Q,h[y+3]=l*R+n*P+k*O+x*V+U;g.putImageData(a,0,0);return c.canvasToBlob(f)})}function f(a,
e){return c.blobToImage(a).then(function(a){var f=b.create(d.getWidth(a),d.getHeight(a)),g=b.get2dContext(f),h;g.drawImage(a,0,0);m(a);a=g.getImageData(0,0,f.width,f.height);h=g.getImageData(0,0,f.width,f.height);h=function(a,b,c){function d(a,b,c){a>c?a=c:a<b&&(a=b);return a}var e,f,g,h,l,m,n,p,k,q,r,s,t,K;g=Math.round(Math.sqrt(c.length));h=Math.floor(g/2);e=a.data;f=b.data;t=a.width;K=a.height;for(l=0;l<K;l++)for(a=0;a<t;a++){for(q=m=n=p=0;q<g;q++)for(k=0;k<g;k++)r=d(a+k-h,0,t-1),s=d(l+q-h,0,K-
1),r=4*(s*t+r),s=c[q*g+k],m+=e[r]*s,n+=e[r+1]*s,p+=e[r+2]*s;r=4*(l*t+a);f[r]=d(m,0,255);f[r+1]=d(n,0,255);f[r+2]=d(p,0,255)}return b}(a,h,e);g.putImageData(h,0,0);return c.canvasToBlob(f)})}function g(a){return function(e,f){return c.blobToImage(e).then(function(e){var g=b.create(d.getWidth(e),d.getHeight(e)),h=b.get2dContext(g),l,p=Array(256);for(l=0;l<p.length;l++)p[l]=a(l,f);h.drawImage(e,0,0);m(e);e=h.getImageData(0,0,g.width,g.height);l=e.data;var k;for(k=0;k<l.length;k+=4)l[k]=p[l[k]],l[k+1]=
p[l[k+1]],l[k+2]=p[l[k+2]];h.putImageData(e,0,0);return c.canvasToBlob(g)})}}function h(b){return function(c,d){return e(c,b(a.identity(),d))}}function l(a){return function(b){return f(b,a)}}var m=c.revokeImageUrl;return{invert:function(a){return function(b){return e(b,a)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]),brightness:h(a.adjustBrightness),hue:h(a.adjustHue),saturate:h(a.adjustSaturation),contrast:h(a.adjustContrast),grayscale:h(a.adjustGrayscale),sepia:h(a.adjustSepia),colorize:function(b,
c,d,f){return e(b,a.adjustColors(a.identity(),c,d,f))},sharpen:l([0,-1,0,-1,5,-1,0,-1,0]),emboss:l([-2,-1,0,-1,1,1,0,1,2]),gamma:g(function(a,b){return 255*Math.pow(a/255,1-b)}),exposure:g(function(a,b){return 255*(1-Math.exp(-(a/255)*b))}),colorFilter:e,convoluteFilter:f}});k("vj",["vg","ok","ve","vf"],function(b,d,c,a){function e(b,c,d){var m=a.getWidth(b),n=a.getHeight(b),m=c/m,p=d/n,n=!1;if(0.5>m||2<m)m=0.5>m?0.5:2,n=!0;if(0.5>p||2<p)p=0.5>p?0.5:2,n=!0;b=f(b,m,p);return n?b.then(function(a){return e(a,
c,d)}):b}function f(d,e,f){return new b(function(b){var n=a.getWidth(d),p=a.getHeight(d),k=Math.floor(n*e),r=Math.floor(p*f),s=c.create(k,r);c.get2dContext(s).drawImage(d,0,0,n,p,0,0,k,r);b(s)})}return{scale:e}});k("nq",["ok","ve","vf","vj"],function(b,d,c,a){var e=b.revokeImageUrl,f=function(a){return function(b){e(a);return b}};return{rotate:function(a,f){return b.blobToImage(a).then(function(l){var m=d.create(c.getWidth(l),c.getHeight(l)),n=d.get2dContext(m),p=0,k=0;f=0>f?360+f:f;90!=f&&270!=f||
d.resize(m,m.height,m.width);if(90==f||180==f)p=m.width;if(270==f||180==f)k=m.height;n.translate(p,k);n.rotate(f*Math.PI/180);n.drawImage(l,0,0);e(l);return b.canvasToBlob(m,a.type)})},flip:function(a,f){return b.blobToImage(a).then(function(a){var g=d.create(c.getWidth(a),c.getHeight(a)),n=d.get2dContext(g);"v"==f?(n.scale(1,-1),n.drawImage(a,0,-g.height)):(n.scale(-1,1),n.drawImage(a,-g.width,0));e(a);return b.canvasToBlob(g)})},crop:function(a,c,f,m,n){return b.blobToImage(a).then(function(a){var g=
d.create(m,n);d.get2dContext(g).drawImage(a,-c,-f);e(a);return b.canvasToBlob(g)})},resize:function(c,d,e){return b.blobToImage(c).then(function(m){var n=f(m);return a.scale(m,d,e).then(function(a){return b.canvasToBlob(a,c.type)}).then(n,n)})}}});k("g0",["np","nq"],function(b,d){return{invert:function(c){return b.invert(c)},sharpen:function(c){return b.sharpen(c)},emboss:function(c){return b.emboss(c)},brightness:function(c,a){return b.brightness(c,a)},hue:function(c,a){return b.hue(c,a)},saturate:function(c,
a){return b.saturate(c,a)},contrast:function(c,a){return b.contrast(c,a)},grayscale:function(c,a){return b.grayscale(c,a)},sepia:function(c,a){return b.sepia(c,a)},colorize:function(c,a,d,f){return b.colorize(c,a,d,f)},gamma:function(c,a){return b.gamma(c,a)},exposure:function(c,a){return b.exposure(c,a)},flip:function(b,a){return d.flip(b,a)},crop:function(b,a,e,f,g){return d.crop(b,a,e,f,g)},resize:function(b,a,e){return d.resize(b,a,e)},rotate:function(b,a){return d.rotate(b,a)}}});k("92",["fz",
"g0"],function(b,d){var c=function(a){return function(b){return d.rotate(b,a)}},a=function(a){return function(b){return d.flip(b,a)}},e=function(a){return function(b){return d.resize(b,a.width(),a.height())}},f=b.pToFR(d.sharpen),g=b.pToFR(c(-90)),c=b.pToFR(c(90)),h=b.pToFR(a("v")),a=b.pToFR(a("h"));return{rotateLeft:g,rotateRight:c,flipVertical:h,flipHorizontal:a,sharpen:f,crop:function(a,c,e,f){return b.pToFR(function(b){return d.crop(b,a,c,e,f)})},resizeTo:function(a){return b.pToFR(e(a))}}});
k("g1",["fz"],function(b){return{mapIfSet:function(d,c){return b.map(d,function(a){return a.map(c)})},applyIfSet:function(d){return function(c){return b.bind(d,function(a){return a.fold(function(){return b.pure(c)},function(a){return a(c)})})}}}});k("au",["b"],function(b){return{partition:function(d){var c=[],a=[];b.each(d,function(b){b.fold(function(a){c.push(a)},function(b){a.push(b)})});return{errors:c,values:a}}}});k("nr",["33"],function(b){return b.immutable("width","height")});k("vk",["4g",
"o0"],function(b,d){var c=b.generate([{special:["size"]},{regular:["value","size","unit"]}]);return{identify:function(a){a=a.match(/(\d*\.?\d*)(.*)/);return""!==a[1]?c.regular(a[0],d(a[1]),a[2]):c.special(a[0])}}});k("ns","s nr vk 33 1a 2l 64 2p cy".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a,d){return f.getRaw(a,d).orThunk(function(){return e.has(a,d)?b.some(e.get(a,d)):b.none()}).bind(function(a){return c.identify(a).fold(function(a){return b.none()},function(a,c,d){switch(d){case "":case "px":return b.some(l(c,
10));default:return b.none()}})})},n=function(a,c,d){c=c(a);return 0<c?b.some(c):m(a,d)};return{get:function(a){return n(a,h.get,"width").bind(function(b){return n(a,g.get,"height").map(function(a){return d(b,a)})})},measure:n}});k("nt",[],function(){var b=function(a,b){var c=b/a;return 1>c?c:1},d=function(a,c){var d=b(a.height,c.height);return 1===d?a:{width:a.width*d,height:c.height}},c=function(a,c){var d=b(a.width,c.width);return 1===d?a:{width:c.width,height:a.height*d}};return{max:function(a,
b){var f=0<b.height?b.height:0,g=0<b.width?b.width:0;if(!(a.height>f||a.width>g)||f===g&&0===f)return a;var f={width:g,height:f},g=a.width>a.height,h=0<f.height,l=(h?a.height/f.height:0)>(0<f.width?a.width/f.width:0);return(f.width===f.height&&g||!h||!l?c:d)(a,f)}}});k("g2","fy s nr fz ns e3 nt".split(" "),function(b,d,c,a,e,f,g){var h=function(c){var d=b.createObjectURL(c);return a.map(f.load(d),function(a){a=l(a);b.revokeObjectURL(d);return a})},l=function(a){return c(a.dom().naturalWidth,a.dom().naturalHeight)},
m=function(a){var b=l(a);return e.get(a).filter(function(a){return a.width()!==b.width()||a.height()!==b.height()})};return{restrain:function(b){var e=b.width(),f=b.height(),l=function(a){var b=g.max({width:a.width(),height:a.height()},{width:e,height:f});return a.height()>f||a.width()>e?d.some(c(b.width,b.height)):d.none()};return function(b){b=h(b);return a.map(b,l)}},changedBounds:function(b){return a.map(f.loadIfNeeded(b),m)}}});k("8d","fh fx fy 92 fz g1 au g2 o".split(" "),function(b,d,c,a,e,
f,g,h,l){var m=function(b){b=f.mapIfSet(b,a.resizeTo);return f.applyIfSet(b)},n=function(a,b,c){return e.fromChain([m(a),c])(b)};return{instance:function(a){var f=h.restrain(a);return function(a){return b.cata(a,function(b,g,h,l){b=f(g);return n(b,g,function(b){if(b===g)return e.pure(a);c.revokeObjectURL(h);return e.fromFuture(d.single(b))})},function(){return e.pure(a)})}},processResults:function(a){return function(b){b=g.partition(b);0<b.errors.length&&(a("imageedit.generic"),l.error("Image resample errors: ",
b.errors));return b.values}},resampleAction:n}});k("5b","84 85 7 s 86 87 88 89 8a 8b 8c 6u 8d 6l 4x 3z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t){return function(u,v,w,x){var y=u.content(),B=u.smartview(),z=a.none(),A=e(u.ui),C=k.processResults(A.showKey),D=function(a){u.undo().save();a=n.validate(a);(a.failure()?c.curry(A.showKey,"fileupload.invalidimages"):A.hide)();w.assets(a.assets()).map(C).get(function(a){f.insertAssets(y,v,a)})},E=function(a){x.allowLocalImages?D(a.assets()):A.showKey("errors.dragdrop.images.disallowed")},
F=function(a){D(a.assets())};y.events.ready.bind(function(b){b=m(b.api());b.events.insertAssets.bind(E);z=a.some(b)});var G=y.cursor(),I=t.create({analytics:s(["message"])});return{ui:r.ui({"fileupload.general":c.constant({value:"image",textkey:p.key("insert.image"),icon:!0,updateGeneral:c.identity,action:function(){var a=h(y,B.uiContainer(),l,x,d.dialog);a.events.insertAssets.bind(F);a.events.close.bind(function(){y.focus();a.destroy()});a.events.escaped.bind(function(){y.focus();a.destroy()});u.content().hideInlineSelection();
a.show()},hasDialog:!0}),"fileupload.menu":function(){var a=g(y,B,u.ui(),x);a.events.insertAsset.bind(function(a){G.get().bind(function(b){f.insertMobileAssets(y,b,v,[a.asset()])})});a.events.open.bind(function(a){y.getSelection().each(G.save)});return a},"camera.general":function(){var a=b();a.events.upload.bind(function(a){G.get().bind(function(b){f.insertMobileAssets(y,b,v,a.assets())})});return{value:"image",textkey:p.key("image.from-camera"),icon:!0,updateGeneral:c.identity,action:function(){y.getSelection().each(G.save);
y.toReading();a.open()},hasDialog:!0}}},c.identity),events:I.registry,destroy:function(){z.each(function(a){a.destroy()})}}}});k("8e",["7","30","bs"],function(b,d,c){var a=d.resolve("find-match");d=d.resolve("find-mark");var e="."+a+", ."+d;return{configure:function(a){a.addSelector(a.output(),e,c.unwrap);a.addSelector(a.history(),e,c.unwrap);a.addSelector(a.internal(),e,c.unwrap)},matchClass:b.constant(a),markClass:b.constant(d),findIdAttr:b.constant("data-ephox-find-id")}});k("vl",[],function(){var b=
function(b){return{fold:b}};return{created:function(d){return b(function(b,a){return a(d)})},preserved:function(d){return b(function(b,a){return b(d)})}}});k("zp",["33"],function(b){return b.immutable("id","match","current")});k("zq",["48"],function(b){return{resolve:b.create("data.ephox.cram").resolve}});k("zr",["48"],function(b){return{resolve:b.create("ephox-cram").resolve}});k("wq","zq zr 7 s 1a 1x 46 2y 29".split(" "),function(b,d,c,a,e,f,g,h,l){var m=b.resolve("highlight-id"),n=d.resolve("highlight-wrap"),
p=function(a,b){return h.closest(a,"."+b)},k=function(b){return a.from(e.get(b,m))};return{marker:p,idMarker:function(a){return p(a,n)},id:k,set:function(a,b){e.set(a,m,b);f.add(a,b)},all:function(a){return k(a).fold(c.constant([a]),function(b){var c=l.owner(a);return g.descendants(c,"."+b)})}}});k("nv",["33"],function(b){return b.immutable("word","pattern")});k("150",["b","7","tk","go"],function(b,d,c,a){return{separate:function(e,f,g){var h=b.bind(g,function(a){return[a.start(),a.finish()]}),l=
a.splits(f,h,function(a,b){return c.subdivide(e,a.element(),b)});return b.map(g,function(c){var f=a.sublist(l,c.start(),c.finish()),f=b.map(f,function(a){return a.element()}),g=b.map(f,e.property().getText).join("");return{elements:d.constant(f),word:c.word,exact:d.constant(g)}})}}});k("14h","b s nv du y8 11a 150 6b go gp".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=function(b,c){return l.generate(c,function(c,e){var f=e+b.property().getText(c).length;return d.from(a.range(c,e,f))})},p=function(a,
c,d,h){c=e.group(a,c,h);return b.bind(c,function(c){c=f.justText(c);var e=b.map(c,a.property().getText).join(""),e=m.findmany(e,d);c=n(a,c);return g.separate(a,c,e)})};return{safeWords:function(a,d,e,f){e=b.map(e,function(a){var b=h.safeword(a);return c(a,b)});return p(a,d,e,f)},safeToken:function(a,b,d,e){d=c(d,h.safetoken(d));return p(a,b,[d],e)},run:p}});k("12s",["14h"],function(b){return{safeWords:function(d,c,a,e){return b.safeWords(d,c,a,e)},safeToken:function(d,c,a,e){return b.safeToken(d,
c,a,e)},run:function(d,c,a,e){return b.run(d,c,a,e)}}});k("zs",["dg","12s"],function(b,d){var c=b();return{safeWords:function(a,b,f){return d.safeWords(c,a,b,f)},safeToken:function(a,b,f){return d.safeToken(c,a,b,f)},run:function(a,b,f){return d.run(c,a,b,f)}}});k("vm","b zp wq 2w 7 s zs".split(" "),function(b,d,c,a,e,f,g){var h=function(g,h){var n=b.bind(g.elements(),function(a){return c.marker(a,h).fold(e.constant([]),function(a){return[a]})}),p=a.generate("ephox-cram");return d(p,g,f.from(n[0]))};
return{matchWords:function(a,b,c){return g.safeWords(a,b,c)},matchToken:function(a,b,c){return g.safeToken(a,b,c)},matchPattern:function(a,b,c){return g.run(a,[b],c)},annotates:function(a,c){return b.map(a,function(a){return h(a,c)})}}});k("nu",["b","vl","vm","7","gn"],function(b,d,c,a,e){var f=function(f,h,l,m){h=c.annotates(m,l.label());return b.bind(h,function(c){return c.current().fold(function(){var h=c.match();if(f.ignore(h))return[];h=e.wrapper(h.elements(),l.nu)||[];b.each(h,a.curry(l.tag,
c));return[d.created(h)]},function(a){return[d.preserved(a)]})})};return{highlight:function(a,b,d,e){d=c.matchToken(b,d,a.optimise);return f(a,b,e,d)},highlightPattern:function(a,b,d,e){d=c.matchPattern(b,d,a.optimise);return f(a,b,e,d)}}});k("b1",[],function(){return{get:function(b){return b.dom().textContent},set:function(b,d){b.dom().textContent=d}}});k("g3","b nu 7 s nv 6b 8e e4 1a 1x l 2m 20 2o 46 b1 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u){var v=function(a,b){return k.isElement(b)&&
h.isBlock(b)?0>t.get(b).toLowerCase().indexOf(a):!1},w=function(a){return{ignore:c.constant(!1),optimise:c.curry(v,a.toLowerCase())}},x=c.constant("."+g.matchClass()),y={label:g.matchClass,tag:function(a,b){m.add(b,g.matchClass());l.set(b,g.findIdAttr(),a.id())},nu:function(){var a=n.fromTag("span");return{element:c.constant(a),wrap:c.curry(p.append,a)}}},B=function(a){b.each(a,function(a){m.add(a,g.markClass())})},z=function(a){b.each(a,function(a){m.remove(a,g.markClass())})},A=function(c,d){var e=
b.groupBy(s.descendants(c,d),function(a){return l.get(a,g.findIdAttr())});return 0===e.length?a.none():a.some(e)},C=function(a,b){var d=f.custom(f.sanitise(a),c.constant(0),c.constant(0),b);return e(a,d)},D=function(a,c,d){return A(a,x()).map(function(e){var f=b.filter(e,function(a){return m.has(a[0],g.markClass())}),h=b.findIndex(e,function(a){return b.contains(f,a)});return{pos:d(e,b.flatten(f),h,c(h,e.length)),all:A(a,x())}})},E=function(a,b,c,d){z(b);B(a[d]);return d},F=function(a,b){return a===
b-1?0:a+1},G=function(a,b){return 0===a?b-1:a-1},I=function(a,c){return D(a,F,function(a,d,e,f){E(a,d,e,f);p.before(d[0],n.fromText(c));b.each(d,r.remove);return 0===f?f:e})};return{search:function(b,c,e){if(0===c.length)return a.none();var f=w(c),g=u.children(b);c=!0===e?C(c,a.none()):C(c,a.some("gi"));d.highlightPattern(f,g,c,y);return A(b,x()).map(function(b){B(b[0]);return{all:a.some(b),pos:0}})},clear:function(c){c=s.descendants(c,x());b.each(c,r.unwrap);return a.none()},next:function(a){return D(a,
F,E)},prev:function(a){return D(a,G,E)},replace:I,replaceAll:function(b,c){for(;I(b,c).isSome(););return a.none()}}});k("g4",["7","s","g3","29"],function(b,d,c,a){return function(e,f,g){var h=function(){f.counter.update(0,0)},l=function(b){b.all.fold(h,function(c){f.counter.update(b.pos+1,c.length);var d=c[b.pos];c=d[0];d=d[d.length-1];e.setSelection(c,0,d,a.children(d).length);g.element(c)})},m=function(){g.cursor();h()},n=function(a,b,e){c.clear(a);c.search(a,b,e).fold(m,l);return d.some(b)},p=
function(a,b){var d=(!0===b?c.prev:c.next)(a);d.fold(m,l);return d},k=function(a){e.body().each(function(b){c.replace(b,a).fold(m,l);e.domChanged();e.undoChanged()})},r=d.none(),s=function(){r=d.none()};f.events.search.bind(function(a){e.body().each(function(b){n(b,a.term(),a.matchcase())})});f.events.next.bind(function(){e.body().each(function(a){p(a,!1)})});f.events.prev.bind(function(){e.body().each(function(a){p(a,!0)})});f.events.replace.bind(function(a){k(a.value())});f.events.replaceAll.bind(function(a){e.body().each(function(b){c.replaceAll(b,
a.value()).fold(m,l);e.undoChanged()})});f.events.interactive.bind(function(a){e.body().each(function(b){r=n(b,a.term(),a.matchcase())})});f.events.encase.bind(function(a){e.body().each(function(b){r.each(function(c){n(b,c,a.matchcase())})})});f.events.clear.bind(function(a){e.body().each(function(a){c.clear(a);s()})});return{zeroCount:h,updateMatch:l,enterSearchAction:function(a,c){e.body().each(function(d){var e=f.getCase();r=r.filter(function(b){return a===b}).fold(function(){return n(d,a,e)},
function(f){return p(d,c.isShift()).fold(function(){return n(d,a,e)},b.constant(r))})});(0===a.length?f.counter.hide:f.counter.show)()},enterReplaceAction:k,clearLastSearch:s}}});k("g5",["c","7","bt"],function(b,d,c){var a=b.detect().deviceType.isiOS();return function(b){var f=b.content();b=function(a){f.elementIntoView(a)};var g=function(){f.cursorIntoView()};b={element:a?b:d.curry(c.elementIntoView,f),cursor:a?g:d.curry(c.cursorIntoView,f)};return{get:d.constant(b)}}});k("nx","7i 9m g9 dd kc 7 6u 30 4x 3z 40 1a 2k 1x 43 2l 3n l 2v 2m 35 hg 2o".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w,x,y,B,z){var A=function(a,c,d){a=a();var e=a.element();s.add(e,c);b.button(e,d);p.set(e,"tabindex","-1");a.events.click.bind(function(){w.focus(e)});return a},C=function(a,b){var d=A(c,a,b);p.set(d.element(),"title",b);return d},D=function(b,d){var e=h.resolve("inline-main-button"),e=b.concat([e]),e=A(c,e,d);e.content(a(d));return e},E=function(a,b,c){var d=h.resolve("inline-main-button-toggle");a=a.concat([d]);c=A(e,a,c);p.set(c.element(),"title",b);
return c},F=function(a,c,d){var e=v.fromTag("input");s.add(e,a);p.set(e,"placeholder",c);b.label(e,d);return{element:f.constant(e),destroy:f.curry(z.remove,e)}};return{counter:function(a){var b=v.fromTag("div"),c=v.fromTag("span");r.add(b,h.resolve("search-widget-counter"));r.add(c,h.resolve("search-widget-counter-text"));x.append(b,c);return{element:f.constant(b),update:function(a,b){var e=g.translate("units.amount-of-total",a,b);z.empty(c);x.append(c,v.fromText(e));d.speak(k.body(),e)},hide:function(){t.set(b,
"display","none")},show:function(){t.remove(b,"display")},destroy:function(){z.remove(c);z.remove(b)}}},dummyCounter:function(a){a=v.fromTag("div");r.add(a,h.resolve("search-widget-counter"));return{element:f.constant(a),update:f.noop,hide:f.noop,show:f.noop,destroy:f.curry(z.remove,a)}},searchField:function(){var a=v.fromTag("span"),b=C([h.resolve("stepper-button"),h.resolve("search-widget-previous")],g.translate("search.previous")),c=C([h.resolve("stepper-button"),h.resolve("search-widget-next")],
g.translate("search.next")),d=E([h.resolve("search-widget-more")],g.translate("aria.label.more"),g.translate("aria.label.more"));r.add(a,h.resolve("search-widget-searchField"));var e=F([h.resolve("search-widget-input"),h.resolve("search-widget-input-search")].concat(B.isSmallTouch()?[h.resolve("search-widget-small-touch")]:[]),g.translate("search.search"),g.translate("search.search")),p=m.create({next:n([],c.events.click),previous:n([],b.events.click),more:n([],d.events.click),input:l(["raw"])}),
k=u.bind(e.element(),"input",p.trigger.input);y.append(a,[e.element(),b.element(),c.element(),d.element()]);return{events:p.registry,element:f.constant(a),input:e.element,focus:function(){w.focus(e.element())},previous:b.element,next:c.element,moreToggle:d,destroy:function(){k.unbind();e.destroy();b.destroy();c.destroy();d.destroy()}}},replaceDrawer:function(){var a=F([h.resolve("search-widget-input"),h.resolve("search-widget-input-replace")],g.translate("search.replace"),g.translate("search.replace")),
b=E([h.resolve("search-widget-matchcase")],g.translate("search.matchcase"),g.translate("search.matchcase")),c=D([h.resolve("search-widget-replace")],g.translate("search.replace")),d=D([h.resolve("search-widget-replace-all")],g.translate("search.replace-all")),e=v.fromTag("div"),l=v.fromTag("div");r.add(e,h.resolve("search-widget-replace-drawer"));r.add(l,h.resolve("search-widget-replace-drawer-tools"));y.append(l,[b.element(),c.element(),d.element()]);y.append(e,[a.element(),l]);return{element:f.constant(e),
replace:c,replaceAll:d,input:a,matchcase:b,destroy:function(){b.destroy();c.destroy();d.destroy();z.remove(l);z.remove(e)}}},button:C,input:F}});k("g6","nw 7 gy nx 30 4x 3z 40 1x 2l 3n l 64 35 hg 2o 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u){return function(){var v=p.fromTag("div");l.add(v,e.resolve("search-widget"));var w=a.searchField(),x=(s.isSmallTouch()?a.dummyCounter:a.counter)(w.input()),y=a.replaceDrawer(),B=y.element(),z=g.create({next:h([],w.events.next),prev:h([],w.events.previous),
replace:f(["value"]),replaceAll:f(["value"]),search:f(["term","matchcase","isShift"]),interactive:f(["term","matchcase"]),encase:f(["matchcase"]),clear:f([])}),A=b(B);w.moreToggle.events.click.bind(function(){(A.visible()?A.hide:A.show)()});w.events.input.bind(function(){var a=u.get(w.input()),b=k.get(w.element());m.set(x.element(),"height",b+"px");3<=a.length?D.throttle(a):(z.trigger.clear(),x.update(0,0),x.hide())});y.replace.events.click.bind(function(){var a=u.get(y.input.element());z.trigger.replace(a)});
y.replaceAll.events.click.bind(function(){var a=u.get(y.input.element());z.trigger.replaceAll(a)});y.matchcase.events.click.bind(function(){z.trigger.encase(C())});var C=function(){return y.matchcase.selected()},D=c(function(a){z.trigger.interactive(a,C());x.show()},500),E=n.bind(B,"transitionend",function(a){"opacity"===a.raw().propertyName&&l.remove(B,"ephox-chameleon-toolbar-more-open")});r.append(v,[x.element(),w.element(),y.element()]);return{element:d.constant(v),search:w,focus:function(){w.focus()},
drawer:y,counter:x,getCase:C,destroy:function(){E.unbind();w.destroy();y.destroy();x.destroy();A.destroy();t.remove(v)},events:z.registry}}});k("8f","fk 85 7 g3 fm g4 g5 g6 4x 3z".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n,p){var k=n.content(),r=h(),s=g(n),t=f(k,r,s.get()),u=function(a){var b=a.endContainer();a=a.endOffset();k.setSelection(b,a,b,a)},s=b.button({execute:e.button}),s=[d.input(r.search.input(),b.input({execute:function(a,b){t.enterSearchAction(a,b)}})),d.button(r.search.previous(),
s),d.button(r.search.next(),s),d.button(r.search.moreToggle.element(),s),d.input(r.drawer.input.element(),b.input({execute:function(a,b){t.enterReplaceAction(a)}})),d.button(r.drawer.matchcase.element(),s),d.button(r.drawer.replace.element(),s),d.button(r.drawer.replaceAll.element(),s)],v=m.create({done:l([])});return{element:r.element,name:c.constant("find-replace-button"),anchorName:c.constant("search-widget-anchor"),textkey:c.constant("action.search"),destroy:function(){r.destroy()},keylayouts:c.constant(s),
openWidget:function(){t.zeroCount();r.counter.hide()},closeWidget:function(){k.body().each(function(b){k.getSelection().each(u);a.clear(b)});t.clearLastSearch();k.focus()},events:v.registry}}});k("g7",["4g"],function(b){return{text:b.generate([{text:["field","input"]}]).text,cata:function(b,c){return b.fold(c)}}});k("8g","7 g3 g4 g5 g7 g6 4x 3z 2v 2m 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(p,k){var r=p.content(),s=f(),t=a(p),u=c(r,s,t.get()),t=h.create({toEditor:g([])}),v=e.text(s.search.element(),
s.search.input()),w=function(a){var b=n.get(s.search.input());u.enterSearchAction(b,{isShift:function(){return!0===a.raw().shiftKey}})};return{element:s.element,addEscape:function(a){m.append(s.search.element(),a.element())},open:function(){u.zeroCount();s.counter.hide();s.focus()},close:function(){r.body().each(function(a){d.clear(a).fold(u.zeroCount,u.updateMatch)});u.clearLastSearch()},execute:function(a){l.hasFocus(s.search.input())?a=w(a):(a=n.get(s.drawer.input.element()),u.enterReplaceAction(a),
a=void 0);return a},type:b.constant(v),events:t.registry,destroy:function(){s.destroy()}}}});k("gb",["a","b","1n"],function(b,d,c){return{isFunctionOrEvents:function(a){var c=function(c){return!0===d.forall(a,function(a){return void 0!==c[a]&&void 0!==c[a].bind&&b.isFunction(c[a].bind)})?!0:!1};return{validate:function(a,d){return b.isFunction(a)||"events"===d&&b.isObject(a)&&c(a)},label:"Function (or events)"}}}});k("8h","6w b 7i g8 g9 ga 7 r s gb g7 6u 9g 30 4x 3z 4f 4v 1a 1x 3n l 2v 2m 49 46 3m".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w,x,y,B,z,A,C,D,E){var F=v.ensureWith("element addEscape open close execute type events destroy".split(" "),m.isFunctionOrEvents(["toEditor"]));return function(m,v){F(v);var E=m.content(),L=m.ui().tabstrip.element();x.add(v.element(),r.resolve("slick-widget"));var J=n.cata(v.type(),function(b,c){x.add(b,r.resolve("slick-widget-field"));x.add(c,r.resolve("slick-widget-input"));var e=y.bind(v.element(),"keydown",function(a){var b={original:g.constant(a)};
if(k.isEnter(b))v.execute(a),a.kill();else if(k.isTab(b)){var b=D.descendants(v.element(),"input,textarea"),c=d.findIndex(b,z.hasFocus);-1<c&&(c=(c+1)%b.length,0<=c&&c<b.length&&z.focus(b[c]));a.kill()}else k.isEscape(b)&&(V(),a.kill())}),f=y.bind(c,"blur",function(b){l.from(b.raw().relatedTarget).each(function(b){!0===C.ancestor(B.fromDom(b),function(a){return x.has(a,"ephox-polish-mobile-toolbar-hide")}).isSome()&&a.refreshInput(c)})});return{destroy:function(){e.unbind();f.unbind()}}}),K=e("shizniz"),
M=p.translate("toolbar.backbutton"),Q=f([b.resolve("icon")]);K.content(Q);w.set(K.element(),"title",M);c.toolbarButton(K.element(),M,!1,!1);v.addEscape(K);var R=u(!0),P=function(){return!R.get()};A.prepend(L,v.element());var O=t.create({done:s([]),abort:s([]),open:s([]),close:s([])}),V=function(){N();E.toEditing()};v.events.toEditor.bind(V);var U=h.cached(function(a){return D.children(L,"."+b.resolve("toolbar"))}),N=function(){P()||(v.close(),R.set(!1),d.each(U(),function(a){x.remove(a,r.resolve("mobile-toolbar-hide"))}),
x.remove(v.element(),r.resolve("mobile-toolbar-show")),x.add(v.element(),r.resolve("mobile-toolbar-hide")),O.trigger.close())};E.events.mousedown.bind(N);N();K.events.click.bind(function(){V();O.trigger.abort()});return{element:v.element,destroy:function(){E.events.mousedown.unbind(N);J.destroy();v.destroy()},events:O.registry,open:function(){R.set(!0);v.open();d.each(U(),function(a){x.remove(a,r.resolve("mobile-toolbar-show"));x.add(a,r.resolve("mobile-toolbar-hide"))});x.remove(v.element(),r.resolve("mobile-toolbar-hide"));
x.add(v.element(),r.resolve("mobile-toolbar-show"));O.trigger.open()},close:N,isClosed:P}}});k("5c","c 8e 8f 8g 6t 8h 6u 30 6l 6v 4x 3z 1x".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k){var r=function(a,b){var d=c(a,b);return e(a,d,b)},s=function(b,c){var d=a(b,c);return f(b,d)},t=function(a,c){return(b.detect().deviceType.isTouch()?s:r)(a,c)};return function(a,b){var c=a.filter();d.configure(c);var e=p.create({analytics:n(["message"])}),f=t(a,b);k.add(f.element(),h.resolve("toolbar-dialog"));f.events.open.bind(function(){e.trigger.analytics("search_tool_open")});
f.events.close.bind(f.close);f.events.abort.bind(f.close);c=function(){(f.isClosed()?f.open:f.close)()};a.shortcuts().events.search.bind(c);return{ui:l.ui({"find.general":{toggle:!1,hasPopup:!1,value:"search",textkey:g.key("action.search"),action:c,updateGeneral:function(a){k.add(a.element(),h.resolve("find-replace-button"))},icon:!0,tooltip:m.get}}),events:e.registry,destroy:function(){f.destroy()}}}});k("8i","7 d9 73 7e d3 db 1a".split(" "),function(b,d,c,a,e,f,g){var h=function(b){return a.isAnnotation(b)||
g.has(b,e.overrideSpan())},l=function(a,e,f,g,l,m){var k=function(b){a(b,l,h)};c.cata(g.get(),b.noop,d.multiple(e,f,k,m),d.single(e,f,k,m))},m=function(a,b,c,d,e){l(a,b,c,d,e,b.toEditing)};return{face:b.curry(m,f.face),background:b.curry(m,f.background),foreground:b.curry(m,f.foreground),size:b.curry(m,f.size),partialSize:b.curry(function(a,c,d,e,f){l(a,c,d,e,f,b.noop)},f.size)}});k("8k",["33"],function(b){return{color:b.immutable("hex","classes","name"),face:b.immutable("textkey","value","icon"),
size:b.immutable("name","size")}});k("8j",["7","r","s","8k","6u"],function(b,d,c,a,e){var f=a.color,g=a.face,h=a.size;a=d.cached(function(){return[f("#FFF",["color-highlight-dark","color-option-white"],e.key("color.white")),f("#000",["color-highlight-light"],e.key("color.black")),f("#444",["color-highlight-light"],e.key("color.gray")),f("#777",["color-highlight-light"],e.key("color.metal")),f("#CCC",["color-highlight-light"],e.key("color.smoke")),f("#FC1D00",["color-highlight-light"],e.key("color.red")),
f("#C81500",["color-highlight-light"],e.key("color.darkred")),f("#FF8C00",["color-highlight-dark"],e.key("color.darkorange")),f("#FEBE00",["color-highlight-dark"],e.key("color.orange")),f("#FFFC00",["color-highlight-dark"],e.key("color.yellow")),f("#22AE50",["color-highlight-dark"],e.key("color.green")),f("#006400",["color-highlight-dark"],e.key("color.darkgreen")),f("#3CB371",["color-highlight-dark"],e.key("color.mediumseagreen")),f("#8FCD4E",["color-highlight-dark"],e.key("color.lightgreen")),f("#00FF00 ",
["color-highlight-dark"],e.key("color.lime")),f("#0000CD",["color-highlight-dark"],e.key("color.mediumblue")),f("#002360",["color-highlight-light"],e.key("color.navy")),f("#0173C1",["color-highlight-light"],e.key("color.blue")),f("#14B2F2",["color-highlight-dark"],e.key("color.lightblue")),f("#ee82ee",["color-highlight-light"],e.key("color.violet"))]});d=d.cached(function(){return[g(e.key("font.arial"),"Arial",c.none()),g(e.key("font.comicsans"),"Comic Sans MS",c.none()),g(e.key("font.consolas"),
"Consolas",c.none()),g(e.key("font.courier"),"Courier",c.none()),g(e.key("font.georgia"),"Georgia",c.none()),g(e.key("font.impact"),"Impact",c.none()),g(e.key("font.tahoma"),"Tahoma",c.none()),g(e.key("font.timesnr"),"Times New Roman",c.none()),g(e.key("font.trebuchet"),"Trebuchet MS",c.none()),g(e.key("font.verdana"),"Verdana",c.none())]});h=[h("font.small","10px"),h("font.medium","13px"),h("font.large","18px"),h("font.huge","32px")];return{colors:a,faces:d,sizes:b.constant(h)}});k("hf",["7i","g9",
"6u","1a","43"],function(b,d,c,a,e){return function(f,g){var h=d();e.add(h.element(),f);b.button(h.element(),c.translate(g));a.set(h.element(),"title",c.translate(g));return h}});k("gg",["7"],function(b){return{configuration:b.constant({i18nNamespace:"font",cssNamespace:"font",property:"font-size",tag:"span",specials:["xx-small x-small small medium large x-large xx-large".split(" ")]})}});k("60",["a"],function(b){return{isEmpty:function(d){return null===d||void 0===d||""===d||b.isArray(d)&&0===d.length}}});
k("nz","7 s p 60 vk 2l 1j 1r o0".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a){var b=g.pNum(a)?"px":"";return a+b},n=function(a,b,e){return(f.isValidValue(a,b,e)?d.some(e):d.none()).fold(function(){return c.error("Invalid value: "+e)},function(a){return a===e?c.value(e):c.error("Invalid value: "+e)})},p=function(a){return e.identify(a).fold(function(a){return a},function(a,b,c){return h.round(10*b)/10+c})};return{identify:e.identify,validate:function(d,e,f){return(a.isEmpty(d)?c.error("can not use empty value for font size."):
c.value(d)).map(m).map(p).bind(b.curry(n,e,f))},sanitise:function(a){return p(a)}}});k("ny","a b 7 s nz 1r o0".split(" "),function(b,d,c,a,e,f,g){var h={px:1,em:0.1,"%":10,pt:1,rem:"0.1"},l=function(b,c,e){c=d.find(c,function(a){return d.contains(a,e)});return a.from(c).bind(function(c){var f=d.indexOf(c,e);return-1<f?a.from(c[b(f,c)]):a.none()}).getOr(e)};g=function(a,c,d,g){return e.identify(g).fold(function(b){return l(a,d,b)},function(a,d,e){a=void 0!==h[e]?h[e]:1;var g=c*(void 0!==h[e]?h[e]:
1);return(b.isNumber(d)&&0<=d?f.max(a,d+g):a)+e})};return{decrease:c.curry(g,function(a,b){return f.max(0,a-1)},-1),increase:c.curry(g,function(a,b){return f.min(b.length-1,a+1)},1)}});k("gc","54 7i 7 8i hf g7 gg 6u ny nz 30 4x 3z 33 1x l 2v 2m 35 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w,x){var y=r.immutableBag(["i18nNamespace","cssNamespace","property","tag","specials"],[]);return function(r,z){var A=y(g.configuration()),C=A.i18nNamespace(),D=A.cssNamespace(),E=t.fromTag("div");
s.add(E,n.resolve("fontsize-widget"));var F=t.fromTag("span");s.add(F,n.resolve("fontsize-widget-field"));var G=t.fromTag("div");s.add(G,n.resolve("fontsize-widget-exit"));var I=t.fromTag("input");s.add(I,n.resolve("fontsize-widget-input"));d.label(I,h.translate(C+".stepper.input"));var H=function(b){s.remove(I,n.resolve("slick-widget-invalid-input"));x.set(I,b);a.partialSize(r.content(),r.undo(),r.selections(),b)},L=function(){s.add(I,n.resolve("slick-widget-invalid-input"))},J=function(a){return function(){var b=
x.get(I),b=a(A.specials(),b);m.validate(b,A.tag(),A.property()).fold(L,H)}},K=J(l.decrease),J=J(l.increase),M=function(a,b){return e([n.resolve(D+a),n.resolve("stepper-button")],C+b)},Q=M("-stepper-decrease",".stepper.decrease"),M=M("-stepper-increase",".stepper.increase");Q.events.click.bind(K);M.events.click.bind(J);w.append(F,[Q.element(),I,M.element()]);v.append(E,F);v.append(E,G);var F=f.text(F,I),R=k.create({toEditor:p([]),size:p(["value"])}),P=function(){x.set(I,"")},O=function(a){a=m.sanitise(a);
m.validate(a,A.tag(),A.property()).fold(L,function(a){s.remove(I,n.resolve("slick-widget-invalid-input"))});x.set(I,a)};return{element:c.constant(E),addEscape:function(a){v.append(G,a.element())},open:function(){u.focus(I)},close:c.noop,execute:function(){var a=x.get(I);m.validate(a,A.tag(),A.property()).fold(L,function(a){H(a);R.trigger.toEditor()})},destroy:c.noop,type:c.constant(F),represent:function(a){a.fold(P,O,O)},refreshValue:function(){var a=x.get(I);x.set(I,a+b.zeroWidth());x.set(I,a)},
events:R.registry}}});k("gd","s 73 60 71 33 2l 20 49 29 o0".split(" "),function(b,d,c,a,e,f,g,h,l,m){var n=e.immutable("size"),p=function(b){b=d.toSelection(b.get()).fold(a.off,function(b){b=s(b.startContainer());return a.on(b)});return n(b)},k=function(a){return a.body().bind(function(a){a=f.get(a,"font-size");return b.from(a)})},r=function(a){var b=a.dom();if(!b.style)return!1;b=b.style.fontSize;return"body"!==g.name(a)&&!c.isEmpty(b)},s=function(a){var c=g.isText(a)?l.parent(a).getOrDie():a;return(r(c)?
b.some(c):h.ancestor(c,r)).fold(function(){return f.get(c,"font-size")},function(a){return a.dom().style.fontSize})};return{getState:function(a,b){return{readState:p(a),fallbackSize:k(b).getOr("12px")}}}});k("8l","7 s gc 8h 6u gd 4f 3m".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){var n=l.content(),p=g(d.none()),k=function(){var b=c(l,m),e=a(l,b),b={represent:b.represent,refreshValue:b.refreshValue,open:e.open,close:e.close,isClosed:e.isClosed};p.set(d.some(b));return b},r=function(a){var b=
f.getState(l.selections(),n);a.open();a.represent(b.readState.size());h(function(){a.refreshValue()},0)},s={toggle:!1,value:"size",textkey:e.key("font.size"),action:function(){var a=p.get().getOrThunk(k);a.isClosed()?r(a):a.close()},updateGeneral:b.noop,icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!1};return{general:b.constant(s)}}});k("o3","7i 7 6u 30 4x 3z 1a 1x 3n l 2v 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(k){var r=k.hex(),s=m.fromHtml("<span></span>");h.add(s,a.resolve("palette-detail-action"));
g.set(s,"title",c.get(k.name()));b.toolbarButton(s,c.get(k.name()),!1,!1);var t=f.create({selected:e(["value"])}),u=l.bind(s,"click",function(){n.focus(s);t.trigger.selected(r)});return{element:function(){return s},value:d.constant(r),destroy:function(){u.unbind();p.remove(s)},events:t.registry}}});k("o4","b 7i e6 7 6u 30 37 4x 3z 1x 2l l 2m 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r){return function(){var s=[],t=p.fromTag("div");d.tabPanel(t);d.label(t,e.translate("aria.font.palette"));
var u=p.fromTag("span");d.listBox(u);m.add(u,f.resolve("palette-detail-actions"));m.add(u,f.resolve("palette-color-options"));d.label(u,e.translate("aria.font.palette"));k.append(t,u);var v=g.create(),w=l.create({selected:h(["value"])});return{element:function(){return t},add:function(a){s.push(a.destroy);k.append(u,a.element());v.bind(a.events.selected,function(a){w.trigger.selected(a.value())})},remove:function(a){r.remove(a.element());v.unbind(a.events.selected)},show:function(){m.add(t,f.resolve("palette-detail-active"));
c.showPanel(t);n.remove(t,"display")},hide:function(){m.remove(t,f.resolve("palette-detail-active"));c.hidePanel(t);n.set(t,"display","none")},destroy:function(){b.each(s,a.apply);r.remove(t);s=[]},events:w.registry}}});k("ia","b fk 85 6 7 s 8j o3 o4 30 1x 43 2l 64 3e 46 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u){var v=function(a){a.dom().click();return f.some(a)},w=function(a,c){var d=t.descendants(a,c);if(0<r.get(a)&&0<d.length){var g=s.absolute(d[0]).top(),h=b.findIndex(d.slice(1),
function(a){return s.absolute(a).top()!==g});return-1<h?f.some({rows:e.constant(u.ceil(d.length/(h+1))),columns:e.constant(h+1)}):f.none()}return f.none()};return{create:function(a){var c=void 0!==a?a:g.colors();a=l();c=b.map(c,function(a){var c=h(a);p.add(c.element(),b.map(a.classes(),m.resolve));n.add(c.element(),m.resolve("palette-color-option"));k.set(c.element(),"background-color",a.hex());return c});b.each(c,a.add);return a},makeLayout:function(b,f,g){g=d.grid(a.deepMerge({trigger:v},g));var h=
c.grid(b,{cell:e.constant(f)},4,5,g);return{layout:e.constant(h),refresh:function(){h.clear();w(b,f).each(function(a){h.resize(a.rows(),a.columns())})}}}}});k("o1",["ia","6e","1r"],function(b,d,c){var a=function(a){return d.closest(a,".ephox-polish-palette-detail-active")};return function(c,d){var g=b.makeLayout(d,".ephox-polish-palette-detail-action.ephox-polish-palette-color-option",{isValid:a}),h=g.layout();return{isFocused:h.isFocused,enterGrid:h.enter,grid:h,refresh:g.refresh,destroy:h.destroy,
clear:h.clear}}});k("o2","7i dd kc 7 6u 30 1x l 2m 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(){var n=h.fromTag("div");g.add(n,f.resolve("color-widget"));b.widget(n);var p=h.fromTag("div");g.add(p,f.resolve("color-widget-controls"));b.tabList(p);var k=h.fromTag("div");g.add(k,f.resolve("color-widget-palettes"));b.toolbarGroup(k);var r=c("text-color");g.add(r.element(),f.resolve("tab-button"));r.content(d(e.translate("font.color")));b.tabButton(r.element(),e.translate("aria.font.color"));
var s=c("highlight-color");g.add(s.element(),f.resolve("tab-button"));s.content(d(e.translate("font.highlight")));b.tabButton(s.element(),e.translate("aria.font.highlight"));l.append(p,r.element());l.append(p,s.element());l.append(n,p);l.append(n,k);return{element:a.constant(n),colorToggle:a.constant(r),highlightToggle:a.constant(s),content:a.constant(k),controls:a.constant(p),destroy:function(){r.destroy();s.destroy();m.remove(k);m.remove(p)}}}});k("ge","7i e6 fk 85 7 8j o1 o2 ia 4x 3z 40 2m 2y 1r".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s){return function(){var s=l.create(f.colors()),u=l.create(f.colors()),v=n.create({color:p(["value"],s.events.selected),highlight:p(["value"],u.events.selected),abort:m([])}),w=h(),x=w.colorToggle(),y=w.highlightToggle();b.linkTabToPanel(x.element(),s.element());b.linkTabToPanel(y.element(),u.element());k.append(w.content(),s.element());k.append(w.content(),u.element());var B=g(w,s.element()),z=g(w,u.element()),A=a.flow(w.controls(),{item:e.constant(".ephox-pastry-statebutton")},
c.flow({trigger:function(a,b){return r.descendant(a,".ephox-pastry-button").map(function(a){a.dom().click();return a})},executeOnArrow:!0})),C=a.multiple(w.element(),[A,B.grid,z.grid]);C.events.exit.bind(function(a){v.trigger.abort()});var D=function(){C.exit()},E=function(){u.hide();x.select();y.deselect();d.tabSelected(x.element(),[y.element()]);s.show()};x.events.click.bind(function(){A.clickFocus(x.element());E()});y.events.click.bind(function(){A.clickFocus(y.element());s.hide();x.deselect();
d.tabSelected(y.element(),[x.element()]);u.show()});return{element:w.element,destroy:function(){D();s.destroy();C.destroy();u.destroy();w.destroy()},open:function(){C.clear();C.refresh();x.click();E();C.enter()},close:D,events:v.registry}}});k("8m","7 4t 8i ge 6u 4x 3z 40".split(" "),function(b,d,c,a,e,f,g,h){return{widget:function(l){var m=l.content(),n=l.undo(),p=l.selections(),k=a(),r=g.create({color:h(["value"],k.events.color),highlight:h(["value"],k.events.highlight),done:f([]),abort:h([],k.events.abort)});
k.events.color.bind(function(a){c.foreground(m,n,p,a.value());r.trigger.done();m.toEditing()});k.events.highlight.bind(function(a){c.background(m,n,p,a.value());r.trigger.done();m.toEditing()});return{element:k.element,name:b.constant("color"),textkey:b.constant(e.key("font.coloroption")),open:k.open,close:k.close,updateWidget:function(a){d.isHighContrast(l.smartview())?a.disable():k.open()},ability:b.noop,destroy:k.destroy,events:r.registry,label:b.constant(!1)}}}});k("vn",["7","s"],function(b,d){return function(){var c=
d.none(),a=function(a){c.bind(function(b){b[a]()})};return{enter:b.curry(a,"enter"),exit:b.curry(a,"exit"),destroy:b.curry(a,"destroy"),set:function(a){c=d.some(a)}}}});k("o5","7i 9m fk 85 jq 9n g9 ga 7 s vn 6u 30 4x 3z 1a 1x 43 1b 3n l 2v 2m 35 2o 29 2z 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w,x,y,B,z,A,C,D,E,F){return function(v,F){var H=F.i18nNamespace(),L=F.cssNamespace(),J=s.create({plus:r([]),minus:r([]),validate:r([]),abort:r([])}),K=g(),M=g(),Q=y.fromTag("div"),R=y.fromTag("div"),
P=y.fromTag("input");b.label(P,p.translate(H+".stepper.input"));b.toolbarButton(K.element(),p.translate(H+".stepper.increase"),!1,!1);b.toolbarButton(M.element(),p.translate(H+".stepper.decrease"),!1,!1);t.set(P,"tabindex","-1");t.set(K.element(),"tabindex","-1");t.set(M.element(),"tabindex","-1");u.add(R,k.resolve(L+"-stepper-input"));u.add(Q,k.resolve(L+"-stepper-options"));u.add(K.element(),k.resolve("stepper-button"));K.content(h([k.resolve(L+"-stepper-increase")]));u.add(M.element(),k.resolve("stepper-button"));
M.content(h([k.resolve(L+"-stepper-decrease")]));z.append(R,P);A.append(Q,[K.element(),M.element()]);A.append(v,[R,Q]);K.events.click.bind(function(){B.focus(K.element());J.trigger.plus()});M.events.click.bind(function(){B.focus(M.element());J.trigger.minus()});var O=function(){P.dom().setSelectionRange(0,E.get(P).length)},V=x.bind(R,"click",function(a){w.eq(a.target(),R)&&U.enter()}),U=n(),N=u.toggler(P,k.resolve("invalid-"+L+"-size"));return{destroy:function(){K.destroy();M.destroy();U.exit();U.destroy();
V.unbind();C.remove(P)},highlight:function(){N.on();d.shout(P,p.translate("aria.input.invalid"))},dehighlight:N.off,input:l.constant(P),focus:function(){B.focus(P);O()},enter:U.enter,exit:U.exit,initLayout:function(){var b=a.single(P,[e.basic(f.ENTER()[0],function(){J.trigger.validate();return m.some(!0)})],m.none());b.events.enter.bind(O);var d=c.button({execute:function(a){a.dom().click();B.focus(a);return m.some(a)}}),b=a.multiple(v,[b,a.button(K.element(),d),a.button(M.element(),d)]);b.events.exit.bind(function(){D.parent(R).each(B.focus);
J.trigger.abort()});U.set(b)},events:J.registry}}});k("gh","7 o5 ny nz 30 4x 3z 40 33 1x 1b 3n l 2o 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s){var t=l.immutableBag(["i18nNamespace","cssNamespace","property","tag","specials"],[]);return function(l){var v=t(l),w=k.fromTag("div"),x=d(w,v);m.add(w,e.resolve(v.cssNamespace()+"-size-widget"));var y=function(){return s.get(x.input())},B=function(b){var c=y();b=b(c);b=a.sanitise(b);s.set(x.input(),b);z.trigger.action(b);x.dehighlight()};x.events.validate.bind(function(b){b=
y();a.validate(b,v.tag(),v.property()).fold(function(){x.highlight()},function(a){s.set(x.input(),a);z.trigger.action(a);x.dehighlight();z.trigger.close()})});x.events.plus.bind(function(a){B(b.curry(c.increase,v.specials()))});x.events.minus.bind(function(a){B(b.curry(c.decrease,v.specials()))});var z=g.create({close:f([]),action:f(["value"]),abort:h([],x.events.abort)}),A=p.bind(w,"click",function(a){(n.eq(a.target(),w)||n.eq(a.target(),x.input()))&&x.enter()});return{element:b.constant(w),input:x.input,
getCurrentValue:y,focus:x.focus,enter:x.enter,initLayout:x.initLayout,destroy:function(){A.unbind();x.destroy();r.remove(w)},updateInlineWidget:function(c,d){var f=function(b){a.validate(b,v.tag(),v.property()).each(function(a){s.set(x.input(),a);x.dehighlight()})};c.size().fold(function(){f(d);m.add(w,e.resolve("default-"+v.cssNamespace()+"-size"))},b.noop,function(a){f(a);m.remove(w,e.resolve("default-"+v.cssNamespace()+"-size"))})},open:b.noop,close:b.noop,events:z.registry}}});k("8n","7i 7 8i gf gg gh 6u gd 4x 3z 40 2v".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p){return{widget:function(k,r){var s=a.cata(r,d.constant(d.noop),d.constant(function(a){a.initLayout()})),t=k.content(),u=k.undo(),v=f(e.configuration());s(v);b.dialog(v.element(),g.translate("font.size"));var w=m.create({done:l([]),abort:n([],v.events.abort)});v.events.close.bind(function(a){w.trigger.done()});v.events.action.bind(function(a){var b=p.active();t.focus();c.size(t,u,k.selections(),a.value());b.each(p.focus)});return{element:v.element,item:v.item,name:d.constant("size"),
textkey:d.constant(g.key("font.size")),open:v.open,close:v.close,updateInlineWidget:function(){var a=h.getState(k.selections(),t);v.updateInlineWidget(a.readState,a.fallbackSize)},ability:d.noop,destroy:v.destroy,events:w.registry}}}});k("gj","fl 6u fn 30 4x 3z 1x 3n l 31".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n,p,k,r){var s=k();k=c.okCancel("font-size");var t=b(p),u=null,v=f.create({close:e([]),open:e([]),analytics:e(["message"]),ok:e(["value"])});p=function(){u.unbind();t.hide();
v.trigger.close()};t.setTitle(d.translate("font.size"));t.setContent(s.element());t.setControls(k.element());t.events.close.bind(p);k.events.ok.bind(function(){v.trigger.ok(s.getCurrentValue())});k.events.cancel.bind(p);g.add(t.element(),a.resolve("widget-dialog"));return{show:function(){t.show();var a=l.fromDom(m);u=h.bind(a,"orientationchange",function(){n.foreground()});v.trigger.open()},element:t.element,contents:s,events:v.registry,destroy:function(){t.hide();t.destroy();s.destroy()}}}});k("8o",
"gi 7 8i gj gg gh 6u gd 4x 3z 40 1a 3n 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r){return{widget:function(r,t){var u=r.content(),v=r.smartview().uiContainer();r.region();var w=r.ui().tabstrip.element,x=r.undo(),y=f(e.configuration()),B=y.input(),z=b(w());p.set(B,"disabled","true");var A=k.bind(B,"touchstart",function(b){b.kill();z.closeMenus();var g=a(u,v,d.curry(f,e.configuration()));g.show();b=g.contents;var l=h.getState(r.selections(),u),m=function(){g.destroy();u.cursorIntoView()};b.updateInlineWidget(l.readState,
l.fallbackSize);b.events.close.bind(m);b.events.action.bind(function(a){c.size(u,x,r.selections(),a.value())});g.events.close.bind(g.destroy);g.events.ok.bind(function(a){c.size(u,x,r.selections(),a.value());m()})}),C=m.create({done:l([]),abort:n([],y.events.abort)});y.events.close.bind(function(a){C.trigger.done()});y.events.action.bind(function(a){c.size(u,x,r.selections(),a.value())});return{element:y.element,item:y.item,name:d.constant("size"),textkey:d.constant(g.key("font.size")),open:y.open,
close:y.close,updateInlineWidget:function(){var a=h.getState(r.selections(),u);y.updateInlineWidget(a.readState,a.fallbackSize)},ability:d.noop,destroy:function(){A.unbind();y.destroy()},events:C.registry}}}});k("8p",["73","60","71","gk"],function(b,d,c,a){return{face:function(e){return b.toSelection(e.get()).map(function(b){b=a.value(b.startContainer(),"font-family");return d.isEmpty(b)?c.off():c.on(b)}).getOrThunk(c.unchanged)}}});k("5d","b c 7 s 8i 6y 7a 8j 8k 8l 8m 8n 8o 6u 8p 6l 71 4x 3z".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w){return function(x,y){var B=x.content(),z=x.undo(),A=function(a){return b.map(a.split(/,\s?/g),function(a){return a.trim().replace(/^[\'\"](.*)[\'\"]$/,"$1")}).join(",")},C=(0===y.faces.length?a.none():a.some(y.faces)).fold(h.faces,function(c){return b.map(c,function(b){return l.face(r.raw(b.text),A(b.value),a.none())})}),D=d.detect().deviceType.isiOS(),E=w.create({analytics:v(["message","properties"])}),F=a.some(g.face),G=function(c){var d=A(c);c=b.find(C,
function(a){return a.value()===d});var e=l.face(r.raw(d),d,a.none());return void 0!==c&&null!==c?c:e},D=D?k:p,I=m(x,y);return{ui:t.ui({"fontface.dropdown":c.constant({name:"fontface",textkey:r.key("font.face"),updateDropdown:function(b){var d=s.face(x.selections()).map(G);b.populate([{label:a.none,items:c.constant(C)}]);f.updateMenu(b,d,u.on(),C,F)},action:function(a){e.face(B,z,x.selections(),a)},values:C,render:F,describe:function(a){return r.translate("font.describe",r.get(a.textkey()))}}),"fontcolor.widget":c.curry(n.widget,
x),"fontsize.widget":c.curry(D.widget,x),"fontsize.general":I.general},c.identity),events:E.registry,destroy:c.noop}}});k("o6","b 7i 2w fr 30 1a 1x 2v 2y".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,n,p){var k=a(m,n,p);d.tabList(k.menu());b.map(k.tabs(),function(a){var b='.ephox-pastry-tablayout-content[data-ephox-pastry-tablayout-view="'+a.name()+'"]';f.set(a.element(),"tabindex","-1");g.add(a.element(),e.resolve("tab-button"));a.events.click.bind(function(){h.focus(a.element())});l.descendant(k.body(),
b).each(function(b){var e=c.generate("ephox-aria");f.set(a.element(),"id",e);d.tabButton(a.element(),a.name());d.tabPanel(b);d.linkTabToPanel(a.element(),b);d.labelledBy(b,e)})});return{element:k.element,tabs:k.tabs,body:k.body,menu:k.menu,destroy:k.destroy,events:k.events}}});k("vo","b 1n 7 33 2l 2y".split(" "),function(b,d,c,a,e,f){return function(g){var h=2===d.keys(g.integration).length;return{content:function(c){var d=a.immutable("str","replace"),e=[d("@@FULL_VERSION@@","2.0.0.185"),d("@@CLIENT_VERSION@@",
"2.0.0.269")],d=h?[d("@@INTEGRATION_TYPE@@",g.integration.type),d("@@INTEGRATION_VERSION@@",g.integration.version)]:[],e=b.flatten([e,d]);return b.foldl(e,function(a,b){return a.replace(b.str(),b.replace())},c)},dom:h?function(a){f.descendant(a,".ephox-polish-help-integration").each(function(a){e.set(a,"display","block")})}:c.noop}}});k("vp","7i 7 s 30 1x 3n l 2m 2o 2y o 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){var k=function(a){var b=a.baseUrl;!0===a.source&&(b+="/licenses");return b+"/textbox-licenses.html"};
return function(r,s,t){var u=c.none(),v=c.none(),w=k(t),x=function(a,b){var d=s.content(b.trim());u=c.some(d);y(a,d)},y=function(c,d){var f=g.fromHtml(d.trim());s.dom(f);l.empty(c);e.remove(c,a.resolve("tablayout-loading"));B(f);var m=g.fromTag("div");b.document(m);h.append(m,f);h.append(c,m)},B=function(a){A();v=m.descendant(a,".ephox-license-link").map(function(a){return f.bind(a,"click",function(a){p.open(w,"","height=700,width=620,resizable=yes,scrollbars=yes")})})},z=function(a){r.get(function(b){b.fold(function(b){a("&nbsp;");
n.error("Unable to download help article",b)},a)})},A=function(){v.each(function(a){a.unbind()})};return{render:function(b){u.fold(function(){e.add(b,a.resolve("tablayout-loading"));z(d.curry(x,b))},function(a){y(b,a)})},destroy:function(){A()}}}});k("oj",["6","vr","v6"],function(b,d,c){return{get:function(a,c,f,g){d.ajax(a,c,f,b.merge({dataType:"text",type:"GET"},g))},post:function(a,e,f,g,h){d.ajax(a,f,g,b.merge({dataType:"text",data:c.stringify(e),type:"POST"},h))}}});k("gu",["oj","2j","p"],function(b,
d,c){return{get:function(a,e){return d.nu(function(d){b.get(a,function(a){d(c.value(a))},function(a,b,e){d(c.error({message:a,status:b,text:e}))},e)})}}});k("vq","a 1n 4e gu 7 p 1f".split(" "),function(b,d,c,a,e,f,g){var h=function(a,c){return a.map(function(a){return a.bind(function(a){var e=a[c];return void 0===e?f.error("Cannot find method "+c+" in help article list: "+d.keys(a)):b.isFunction(e)?f.value(e()):f.error("Key "+c+" in help article list was not a function")})})};return function(b){!0===
b.source?(b=b.baseUrl+"/help/"+g.get()+"/",b={about:a.get(b+"about.html"),accessibility:a.get(b+"accessibility.html"),a11ycheck:a.get(b+"a11ycheck.html"),markdown:a.get(b+"markdown.html"),shortcuts:a.get(b+"shortcuts.html")}):(b=b.baseUrl+"/help_"+g.get()+".js",b=c.addScript(b,e.identity),b={about:h(b,"about"),accessibility:h(b,"accessibility"),a11ycheck:h(b,"a11ycheck"),markdown:h(b,"markdown"),shortcuts:h(b,"shortcuts")});return b}});k("o7","c ft 7 vo vp vq 6u".split(" "),function(b,d,c,a,e,f,g){return function(h){var l=
{content:c.identity,dom:c.noop},m=b.detect(),n=f(h),p=[d(g.translate("help.dialog.accessibility"),e(n.accessibility,l,h)),d(g.translate("help.dialog.markdown"),e(n.markdown,l,h)),d(g.translate("help.dialog.a11ycheck"),e(n.a11ycheck,l,h)),d(g.translate("help.dialog.about"),e(n.about,a(h),h))];h=d(g.translate("help.dialog.shortcuts"),e(n.shortcuts,l,h));m.deviceType.isTouch()||p.unshift(h);return p}});k("gl","b fk 85 fu 7 fl fm o6 o7 6u 3f 30 4x 3z 1a 1x 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,
n,p,k,r,s,t,u){var v=function(a){var b={item:e.constant(".ephox-pastry-statebutton.ephox-pastry-tablayout-item")},f=d.flow({trigger:g.button,executeOnArrow:!0});return c.flow(a.menu(),b,f)},w=function(a){var b={stops:e.constant(["a"])},f=d.page({trigger:g.click,first:".ephox-pastry-tablayout-active"});return c.page(a.body(),b,f)};return function(d,e){var g=r.create({close:k([])}),z=f(d),A=l(e),C=h(a.left(),A,"help");s.set(C.body(),"tabindex","-1");t.add(z.element(),p.resolve("help-modal"));var D=
u.children(C.element());b.each(D,n.register);z.setTitle(m.translate("cog.help"));z.setContent(C.element());var E=v(C),D=w(C),F=c.multiple(z.element(),[E,D]);C.events.setActive.bind(function(a){E.clickFocus(a.item().element())});var G=function(){z.hide()};z.events.close.bind(function(){F.exit();G()});F.events.exit.bind(function(){G();g.trigger.close()});return{element:z.element,open:function(){z.show();F.enter()},destroy:function(){C.destroy();z.destroy();F.destroy();b.each(A,function(a){a.renderer().destroy()})},
hide:G,events:g.registry}}});k("8r",["gl","4x","3z","q"],function(b,d,c,a){return function(a,f){var g=b(a,f),h=function(){l.trigger.analytics("help_screen_hide");l.trigger.close();m()},l=c.create({close:d([]),analytics:d(["message"])});g.events.close.bind(h);var m=function(){g.events.close.unbind(h);g.destroy()};return{show:function(){l.trigger.analytics("help_screen_show");g.open()},destroy:m,events:l.registry}}});k("5e","7 8q 8r 6u 6l 6v 4x 3z 3m".split(" "),function(b,d,c,a,e,f,g,h,l){return function(l,
n){var p=l.content(),k=l.smartview(),r=l.shortcuts(),s=h.create({analytics:g(["message"])}),t=d.destroyable(),u=function(){var a=c(k.uiContainer(),n);t.set(a);a.events.close.bind(function(){p.toEditing();t.clear()});a.events.analytics.bind(function(a){s.trigger.analytics(a.message())});p.toReading();l.content().hideInlineSelection();a.show()};r.events.help.bind(u);r=e.ui({"help.general":{toggle:!1,value:"help",textkey:a.key("cog.help"),action:u,updateGeneral:b.noop,icon:!0,hasPopup:!1,tooltip:f.get}});
l.users().events.help.bind(u);return{ui:r,events:s.registry,destroy:function(){t.clear()}}}});k("8s",["7","30","bs"],function(b,d,c){var a=d.resolve("highlight-common"),e=d.resolve("highlight-placeholder");return{configure:function(b){b.add(b.output(),a,c.unwrap);b.add(b.history(),e,c.unwrap);b.add(b.output(),e,c.unwrap)},highlightClass:b.constant(a),placeholderClass:b.constant(e)}});k("8t",["33"],function(b){return b.immutable("prefix","suffix","style")});k("8u","b s 8s 43 2l l 2m 35 20 2o 9y 29 v".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,p,k){return{rehighlight:function(r,s,t){var u=p.children(t),v=b.bind(u,function(a){return l.isText(a)?n.get(a):""}).join("");d.from(b.find(s,function(a){return k.startsWith(v,a.prefix())&&k.endsWith(v,a.suffix())})).fold(function(){r.preserve(function(){m.unwrap(t)})},function(b){var d=f.fromTag("span");a.add(d,[c.highlightClass()]);e.setAll(d,b.style());r.preserve(function(){g.before(t,d);h.append(d,u);m.remove(t)})})},unhighlight:function(b,d){var e=p.children(d),
l=f.fromTag("span");a.add(l,[c.placeholderClass()]);b.preserve(function(){g.before(d,l);m.unwrap(d);h.append(l,e)})}}});k("8v","b 7 gm gn 6b go gp 8s gq ef bs 43 2l l 20 68 9y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u){var v=function(a,c){var f=b.bind(c,function(a){var b=e.sanitise(a.prefix()),c=e.sanitise(a.suffix()),b=e.unsafetoken(b+"[^"+c+"]*"+c);return{pattern:d.constant(b),style:a.style}});return g.findmany(a,f)},w=m("."+h.highlightClass(),n.unwrap);return{run:function(d,e){d.body().each(function(d){l.filterDom(d,
[w]);d=t.descendants(d,s.isText);b.each(d,function(d){var g=u.get(d),g=v(g,e),l=b.bind(g,function(a){return[a.start(),a.finish()]}),m=c.subdivide(d,l);b.each(g,function(c){var d=f.sublist(m,c.start(),c.finish()),d=b.map(d,function(a){return a.element()});a.wrapper(d,function(){var b=r.fromTag("span");p.add(b,[h.highlightClass()]);k.setAll(b,c.style());return a.nu(b)})})})})}}});k("5f","b 8s 8t 8u 8v 3b 43 2l l 2d 2m 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(k,r,s){var t=k.filter(),
u=k.content(),v=k.operations();d.configure(t);var w=void 0===s.external?[]:b.map(s.external,function(a){return c(a.prefix,a.suffix,a.style)});b.each(w,function(a){var b=f(a.prefix(),a.suffix(),function(b){var c=l.fromTag("span");g.add(c,[d.highlightClass()]);h.setAll(c,a.style());var e=l.fromTag("div");n.append(c,l.fromText(a.prefix()+b+a.suffix()));n.append(e,c);return m.get(e)});r.customMacros().add(b)});u.events.nodeChanged.bind(function(b){u.getSelection().each(function(c){b.prev().each(function(b){p.ancestor(b,
"."+d.placeholderClass()).each(function(b){a.rehighlight(v,w,b)})});p.ancestor(c.startContainer(),"."+d.highlightClass()).each(function(b){a.unhighlight(v,b)})})});return{run:function(){e.run(u,w)},destroy:function(){}}}});k("5g","8w 7 8x 6u 6l l".split(" "),function(b,d,c,a,e,f){return function(g){var h=g.content();return{ui:e.ui({"horizontalrule.general":{toggle:!1,value:"horizontalrule",textkey:a.key("insert.horizontalrule"),action:function(){c.insertAtCursor(h,[f.fromTag("hr")]).each(function(a){a=
b.after(a.element());h.setRelativeSelection(a,a);h.toEditing()})},updateGeneral:d.noop,icon:!0,shortcut:!1,hasPopup:!1}}),destroy:d.noop}}});k("og","b 9m 6 7 p 6u 30 33 1x 2l l 46 2z cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r){var s=g.resolve("input-invalid-field"),t=function(a){return r(a,10).toString()===a&&0<=r(a,10)},u=function(a,b,c){var d=k.get(a);if(""===d)return e.value("");var f=n.fromTag("img");c=t(d)?d+c.getOr(""):d;m.set(f,b,c);c=m.getRaw(f,b);m.remove(f,b);return c.fold(function(){return e.error(a)},
e.value)},v=function(a){l.remove(a,s)};return{highlight:function(a){d.shout(a,f.translate("aria.input.invalid"));l.add(a,s)},dehighlight:v,clearHighlights:function(a){a=p.descendants(a,"."+s);b.each(a,v)},validate:function(d){return b.foldr(d,function(b,d){return b.bind(function(b){return u(d.input(),d.property(),d.defaultUnit()).map(function(e){k.set(d.input(),e);var f={};f[d.property()]=a.constant(e);return c.deepMerge(f,b)})})},e.value({}))},validateField:u,rule:h.immutable("input","property",
"defaultUnit")}});k("oh","b e6 2w c g9 7 fm 6u 30 1a 1x l 2v 2m 35 2y 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u){var v=a.detect().browser.isFirefox();return function(a){var x=l.resolve("dialog-float-selected"),y=p.fromTag("fieldset");m.set(y,"role","radiogroup");a=p.fromHtml("<legend>"+h.translate(a)+"</legend>");if(!v){var B=c.generate("ephox-aria");m.set(a,"id",B);m.set(y,"aria-describedby",B)}var z=p.fromTag("div");n.add(z,l.resolve("dialog-float-options"));s.append(y,[a,z]);var A=
function(){b.each(C,function(a){n.remove(a.element(),x);d.checked(a.element(),!1)})},C=b.map(["none","center","left","right"],function(a){var b=e(),c=h.translate("align."+a);m.setAll(b.element(),{tabindex:"-1","data-float-value":a,title:c,"aria-label":c,role:"radio"});a=p.fromTag("div");var c=p.fromTag("div"),f=p.fromTag("div"),g=p.fromTag("div");n.add(c,l.resolve("dialog-float-icon-inner-left"));n.add(f,l.resolve("dialog-float-icon-inner-center"));n.add(g,l.resolve("dialog-float-icon-inner-right"));
s.append(a,[c,f,g]);b.events.click.bind(function(){A();n.add(b.element(),x);d.checked(b.element(),!0);k.focus(b.element())});n.add(b.element(),l.resolve("dialog-float-container"));n.add(a,l.resolve("dialog-float-icon"));r.append(b.element(),a);return b});s.append(z,b.map(C,function(a){return a.element()}));var D=g.radio(y,"."+l.resolve("dialog-float-container"),"."+l.resolve("dialog-float-selected"));return{element:function(){return y},get:function(){return t.child(z,"."+x).map(function(a){return m.get(a,
"data-float-value")})},select:function(a){A();a.each(function(a){t.child(z,'span[data-float-value="'+a+'"]').or(u.firstChild(z)).each(function(a){n.add(a,x);d.checked(a,!0)})});D.refresh()},keylayout:f.constant(D),destroy:function(){b.each(C,function(a){a.destroy()})}}}});k("oi",["s","vk","33","1r"],function(b,d,c,a){var e=c.immutable("size","unit"),f=function(a){return d.identify(a).fold(b.none,function(a,c,d){return b.some(e(c,d))})};return{fromHeight:function(b,c){return f(c).map(function(c){return a.ceil(b*
c.size())+c.unit()})},fromWidth:function(b,c){return f(c).map(function(c){return a.ceil(1/b*c.size())+c.unit()})},calculate:function(a,c){return f(a).fold(b.none,function(a){return f(c).fold(b.none,function(c){return b.some((a.size()+0)/(c.size()+0))})})}}});k("gr","7i e6 2w fk 85 ga kc 7 s fm kd og oh 8z 6u oi 30 1a 1x 1b 3n l 2v 35 2z 1u cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p,k,r,s,t,u,v,w,x,y,B,z,A,C,D,E){return function(){var E=B.fromTag("div"),G=B.fromTag("div"),I=B.fromTag("div"),H=
B.fromTag("div");w.add(I,u.resolve("image-url-controls"));w.add(H,u.resolve("image-size-controls"));var L=k("image.dialog.fields.align"),J=n.input("image-url","image.dialog.fields.url"),K=n.input("image-alt","image.dialog.fields.alt"),M=n.input("image-width","image.dialog.fields.width"),Q=n.input("image-height","image.dialog.fields.height"),R=B.fromTag("input");v.set(R,"type","hidden");var P=g("lock");w.add(P.element(),u.resolve("dialog-button"));var O=f([u.resolve("icon"),u.resolve("image-lock-button")]);
v.set(P.element(),"title",s.translate("image.dialog.fields.constrain.on"));b.toolbarButton(P.element(),s.translate("image.dialog.fields.constrain.label"),!1,!0);d.press(P.element());P.select();P.content(O);P.events.click.bind(function(){z.focus(P.element());var a=P.selected()?"on":"off";v.set(P.element(),"title",s.translate("image.dialog.fields.constrain."+a));(P.selected()?d.press:d.release)(P.element())});O=B.fromTag("div");w.add(O,u.resolve("form-group"));w.add(O,u.resolve("form-group-lock"));
var V=B.fromHtml("<label>"+s.translate("image.dialog.fields.constrain.label")+"</label>"),U="constrain"+c.generate("");v.set(P.element(),"id",U);v.set(V,"for",U);var N=function(a){a.isLocal()?(v.set(J.input(),"disabled","disabled"),C.set(J.input(),s.translate("image.dialog.fields.urllocal"))):(v.remove(J.input(),"disabled"),C.set(J.input(),a.url()))},X=function(a,b,c){var d=D(C.get(R),10);a=C.get(a);C.set(b,c(d,a).getOrThunk(function(){return C.get(b)}));p.dehighlight(b)},U=function(a){p.validateField(a.target(),
"width",l.some("px")).fold(function(){p.highlight(a.target())},function(b){p.dehighlight(a.target());b=a.target();P.selected()&&(x.eq(b,M.input())?X(M.input(),Q.input(),t.fromWidth):x.eq(b,Q.input())&&X(Q.input(),M.input(),t.fromHeight))})},T=function(a){if(v.has(a.target(),"placeholder")){var b=v.get(a.target(),"placeholder");""===C.get(a.target())&&C.set(a.target(),b)}},W=y.bind(M.input(),"input",U),Z=y.bind(Q.input(),"input",U),ba=y.bind(M.input(),"focus",T),$=y.bind(Q.input(),"focus",T);A.append(O,
[V,P.element()]);A.append(G,[L.element()]);A.append(I,[J.element(),K.element()]);A.append(H,[M.element(),Q.element(),O]);A.append(E,[I,H,G]);G=[e.input(J.input(),a.input({})),e.input(K.input(),a.input({})),e.input(M.input(),a.input({})),e.input(Q.input(),a.input({})),e.button(P.element(),a.button({execute:m.button})),L.keylayout()];return{element:h.constant(E),destroy:function(){P.destroy();W.unbind();Z.unbind();ba.unbind();$.unbind();L.destroy()},dehighlight:h.curry(p.clearHighlights,E),highlight:p.highlight,
keylayouts:h.constant(G),set:function(a){N(a);C.set(K.input(),a.alt());C.set(M.input(),a.width());C.set(Q.input(),a.height());var b=a.computedWidth().bind(function(b){return a.computedHeight().bind(function(a){return t.calculate(b,a)})}).getOr(1);a.computedWidth().each(h.curry(v.set,M.input(),"placeholder"));a.computedHeight().each(h.curry(v.set,Q.input(),"placeholder"));C.set(R,b);L.select(a.align())},get:function(){return p.validate([p.rule(M.input(),"width",l.some("px")),p.rule(Q.input(),"height",
l.some("px"))]).map(function(a){return r.properties({url:C.get(J.input()),alt:C.get(K.input()),width:a.width(),height:a.height(),isLocal:v.has(J.input(),"disabled"),align:L.get()})})}}}});k("8y","s fl fm 8z gr 6u fn 30 4x 3z 4f 1x".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,p){return function(k){var r=m.create({ok:l(["image","properties"]),close:l([])}),s=n(b.none()),t=d(k),u=g.okCancel("image-properties"),v=e();t.setContent(v.element());p.add(t.element(),h.resolve("dialog-narrow"));k=function(){var a=
v.get();v.dehighlight();a.fold(function(a){v.highlight(a)},function(a){s.get().each(function(b){r.trigger.ok(b,a)})})};u.events.ok.bind(k);u.events.cancel.bind(function(){t.hide();r.trigger.close()});t.setTitle(f.translate("image.dialog.title"));t.setControls(u.element());t.events.close.bind(function(){r.trigger.close()});var w=c.setup(t,u,v.keylayouts());return{element:t.element,open:function(){t.show();w.enter()},hide:function(){w.exit();t.hide()},destroy:function(){t.destroy();w.destroy();u.destroy();
v.destroy()},represent:function(c){var d=a.divine(c);s.set(b.some(c));v.set(d)},execute:k,events:r.registry}}});k("90","b 7 s 6u 4x 3z 33 1a 20".split(" "),function(b,d,c,a,e,f,g,h,l){var m=g.immutable("value","text","attrs"),n=function(a){return"img"===l.name(a)};return{image:function(){var b=c.none(),g=f.create({properties:e(["image"]),contextmenu:e(["image"])});return{situation:function(c){c=b.map(function(b){return[m("imagemenu-properties",a.translate("image.context.properties"),{})]}).getOr([]);
return{primary:d.constant(c),secondary:d.constant([]),submenus:d.constant([])}},handle:function(a){b.each(function(a){g.trigger.properties(a)})},assign:function(a){b=a.filter(n);b.each(g.trigger.contextmenu)},events:g.registry}},imageEdit:function(e,f,g){var l=c.none(),k=function(c){return b.map(c,function(b){return m(b.spec.value,a.get(b.spec.textkey),{})})};return{situation:function(a){a=l.map(k).getOr([]);return{primary:d.constant(a),secondary:d.constant([]),submenus:d.constant([])}},handle:function(a){l.each(function(c){var d=
h.get(a,"data-ephox-gopher-item-value");c=b.find(c,function(a){return a.spec.value===d});void 0!==c&&c.spec.action()})},assign:function(a){l=e()?c.some(f):a.filter(n).map(d.constant(g))}}}}});k("91",["4x","3z","40"],function(b,d,c){return{generate:function(a,e,f){a=function(){h();g.trigger.close()};var g=d.create({ok:c(f,e.events.ok),close:b([])});e.events.close.bind(a);var h=function(){e.destroy()};return{open:function(){e.open()},hide:a,destroy:h,represent:e.represent,events:g.registry}}}});k("5h",
"7 8y 8z 90 91 4x 3z 40".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){var n=a.image(l.content()),k=g.create({changed:f(["image"]),contextmenu:h(["image"],n.events.contextmenu)}),q=function(a){var b=l.content(),f=d(l.smartview().uiContainer()),g=e.generate(l.keyboard(),f,["image","properties"]);g.events.ok.bind(function(a){c.apply(a.image(),a.properties());k.trigger.changed(a.image());g.destroy();b.uiChanged();b.focus()});g.events.close.bind(function(a){g.destroy();b.focus()});g.represent(a);
g.open()};n.events.properties.bind(function(a){q(a.image())});return{destroy:b.noop,situation:n.situation,handle:n.handle,assign:n.assign,events:k.registry,fireChanged:function(a){k.trigger.changed(a)}}}});k("93","b 1n 7 fz 4g 1a 2l".split(" "),function(b,d,c,a,e,f,g){var h=e.generate([{html:["key","value"]},{css:["key","value"]}]),l=function(a,c){return b.flatten(d.mapToArray(a,function(a,b){var d=[];if(f.has(c,b)){var e=f.get(c,b);d.push(h.html(a,e))}g.getRaw(c,b).each(function(b){d.push(h.css(a,
b))});return d}))},m=function(a){g.remove(a,"width");g.remove(a,"height");f.remove(a,"width");f.remove(a,"height")};e=c.curry(l,{width:"width",height:"height"});l=c.curry(l,{width:"height",height:"width"});c=c.constant([]);return{keepCrop:c,keepFlip:e,keepRotate:l,keepResample:c,updater:function(c,d){var e=c(d);return a.effect(function(){m(d);b.each(e,function(a){a.fold(function(a,b){f.set(d,a,b)},function(a,b){g.set(d,a,b)})})})}}});k("gs",["v","gt","w"],function(b,d,c){var a=function(a){return""!==
a.trim()&&!b.contains(a,"://")};return{local:function(a){return b.startsWith(a,"data:")||b.startsWith(a,"blob:")||b.startsWith(a,"file:")},relative:a,sameDomain:function(b,c){if(""===b.trim()||""===c.trim())return!1;if(a(b))return!0;var g=d.parse(c),h=d.parse(b);return g.host===h.host&&g.port===h.port}}});k("94",["gs","be","33","gt"],function(b,d,c,a){var e=c.immutable("bannerMessage","consoleMessage"),f=function(a){return void 0!==a.message&&void 0!==a.status&&void 0!==a.text};return{diagnoseImageEdit:function(c,
h){var l=18===c.code||"SecurityError"===c.name?"imageedit.needsproxy":f(c)&&0===c.status?"imageedit.proxyerror":"imageedit.generic",m;m=a.parse(h);m=""===m.host||b.relative(h)?h:""===m.port?m.host:m.host+":"+m.port;l=d.get(l,[m]);m=f(c)?c.message+". Response code "+c.status+". Error details: "+c.text:c;return e(l,m)}}});k("gv",["ok"],function(b){return{blobToImage:function(d){return b.blobToImage(d)},imageToBlob:function(d){return b.imageToBlob(d)},blobToDataUri:function(d){return b.blobToDataUri(d)},
blobToBase64:function(d){return b.blobToBase64(d)}}});k("95","1 6 gu s fz gs 1a gv w".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m){var n={responseType:"blob"},k=function(a,b){var e=d.merge(b||{},m.headers(),n);return c.get(a,e)},q=function(a){return!(f.local(a)||f.sameDomain(a,l(b.location)))};return{getImage:function(b){var c=g.get(b,"src");return(q(c)?m.proxy(c):a.none()).fold(function(){return e.fromPromise(h.imageToBlob(b.dom()))},k)}}}});k("96",["7","6u","6v"],function(b,d,c){return{make:function(a,
e,f){return{type:"general",spec:{value:a,textkey:d.key(e),action:f,updateGeneral:b.noop,icon:!0,hasPopup:!1,toggle:!1,tooltip:c.get}}}}});k("67",["48","7"],function(b,d){var c=d.constant(4);return{resolve:b.create("ephox-clipper").resolve,CORNER_SIZE:c}});k("ol","67 3l 7 1a 1x 2l 3n l 35 1r cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){var k=function(a,b){var d={left:"0px",top:"0px",width:a.width()+"px",height:a.height()+"px"},e={left:f.get(b,"left"),top:f.get(b,"top"),width:f.get(b,"width"),height:f.get(b,
"height")};return{outside:c.constant(d),inside:c.constant(e)}};return{snap:function(c,r){var s=k(c,r),t=h.fromTag("div");e.add(t,b.resolve("dynamic-box"));f.setAll(t,s.outside());var u=h.fromTag("div");e.add(u,b.resolve("opaque-box"));f.setAll(u,s.outside());var v=function(a,b){return 2<m.abs(n(a,10)-n(b,10))},w=function(a){return d.nu(function(b){b(a)})},x=function(a,b){return d.nu(function(c){var d=g.bind(a,"transitionend",function(){d.unbind();c(a)});f.setAll(a,b.inside())})};return{prepare:function(c,
d,g){var h=a.get(d,"src"),m=f.get(d,"width");d=f.get(d,"height");f.setAll(r,{"background-image":"url("+h+")","background-size":m+" "+d,"background-position-x":-g.left()+"px","background-position-y":-g.top()+"px"});e.add(r,b.resolve("snapshot"));e.add(t,b.resolve("dynamic-box-animate"));l.append(c,[t,u]);f.reflow(c)},showcase:function(){var a=s.outside(),b=s.inside();return v(a.left,b.left)||v(a.top,b.top)||v(a.right,b.right)||v(a.bottom,b.bottom)?x(t,s):w(t)}}}}});k("gw",["ol","3l","7"],function(b,
d,c){return{slide:function(){return{animate:function(a,d,f,g){f=b.snap(f.box(),f.shade());f.prepare(a,d,{left:g.cropX,top:g.cropY,width:g.cropWidth,height:g.cropHeight});return f.showcase().map(c.constant(g))}}},none:function(){return{animate:function(a,b,c,g){return d.pure(g)}}}}});k("om",["33"],function(b){return b.immutableBag("displayWidth displayHeight cropX cropY cropWidth cropHeight".split(" "),[])});k("vs",["3n","3m"],function(b,d){return{bind:function(c,a){return b.bind(c,"mousedown",function(c){c.kill();
var f=c.target(),g=!1,h=b.bind(f,"mouseup",function(){g=!0;h.unbind()});d(function(){g||(h.unbind(),a(f))},250)})}}});k("oo",["33"],function(b){var d=b.immutableBag(["top","left","width","height"],[]),c=b.immutableBag(["top","left"],[]);b=b.immutableBag(["top","left"],[]);return{boxModel:d,delta:c,cornersMovements:b}});k("vt",["oo","1r"],function(b,d){var c=function(a,b){var c=d.min(a.top()+a.height(),d.max(0,a.top()+b.top())),e=c-a.top(),e=a.height()-e;return{top:c,height:e}},a=function(a,b,c){a=
d.min(a.width(),d.max(b.left(),b.left()+b.width()+c.left()))-b.left()-b.width();return{width:b.width()+a}},e=function(a,b,c){return d.min(a.height(),d.max(b.top(),b.top()+c.top()+b.height()))-b.top()},f=function(a,b){var c=d.min(a.width()+a.left(),d.max(0,a.left()+b.left())),e=c-a.left(),e=a.width()-e;return{left:c,width:e}};return{nw:function(a,d,e){a=c(d,e);d=f(d,e);return b.boxModel({left:d.left,width:d.width,top:a.top,height:a.height})},n:function(a,d,e){a=c(d,e);return b.boxModel({left:d.left(),
width:d.width(),top:a.top,height:a.height})},ne:function(d,e,f){var m=c(e,f);d=a(d,e,f);return b.boxModel({left:e.left(),width:d.width,top:m.top,height:m.height})},e:function(c,d,e){c=a(c,d,e);return b.boxModel({left:d.left(),width:c.width,top:d.top(),height:d.height()})},se:function(c,d,f){var m=a(c,d,f);c=e(c,d,f);return b.boxModel({left:d.left(),width:m.width,top:d.top(),height:c})},s:function(a,c,d){a=e(a,c,d);return b.boxModel({left:c.left(),width:c.width(),top:c.top(),height:a})},sw:function(a,
c,d){a=e(a,c,d);d=f(c,d);return b.boxModel({left:d.left,width:d.width,top:c.top(),height:a})},w:function(a,c,d){a=f(c,d);return b.boxModel({left:a.left,width:a.width,top:c.top(),height:c.height()})},translate:function(a,c,e){var f=d.min(d.max(0,c.top()+e.top()),d.max(0,a.height()-c.height()));a=d.min(d.max(0,c.left()+e.left()),d.max(0,a.width()-c.width()));return b.boxModel({top:f,left:a,width:c.width(),height:c.height()})}}});k("vu",["jq","9n","s","3d"],function(b,d,c,a){return{navigation:function(e,
f){var g=function(b,d,e){return function(){f(b,a(d,e));return c.some(!0)}};return[b.rule(b.and([b.isShift,b.inSet(d.LEFT())]),g(e,-1,0)),b.rule(b.and([b.isShift,b.inSet(d.RIGHT())]),g(e,1,0)),b.rule(b.and([b.isShift,b.inSet(d.UP())]),g(e,0,-1)),b.rule(b.and([b.isShift,b.inSet(d.DOWN())]),g(e,0,1)),b.basic(d.LEFT()[0],g(e,-10,0)),b.basic(d.RIGHT()[0],g(e,10,0)),b.basic(d.UP()[0],g(e,0,-10)),b.basic(d.DOWN()[0],g(e,0,10))]}}});k("zt",["67","oo","1n","6","7"],function(b,d,c,a,e){var f=function(a,b,c){var f=
b.top(),n=b.left()+b.width()/2-c.middle(),k=f+b.height()/2-c.middle(),q=b.left()+b.width()-c.right();a=b.left()-c.left();c=f+b.height()-c.bottom();b=d.cornersMovements({top:f,left:n});var n=d.cornersMovements({top:c,left:n}),r=d.cornersMovements({top:k,left:q}),k=d.cornersMovements({top:k,left:a}),s=d.cornersMovements({top:f,left:a}),f=d.cornersMovements({top:f,left:q}),q=d.cornersMovements({top:c,left:q});a=d.cornersMovements({top:c,left:a});return{n:e.constant(b),s:e.constant(n),e:e.constant(r),
w:e.constant(k),nw:e.constant(s),ne:e.constant(f),se:e.constant(q),sw:e.constant(a)}};return{calculate:function(a,c){var d={middle:e.constant(2*b.CORNER_SIZE()+1),right:e.constant(b.CORNER_SIZE()),left:e.constant(0),bottom:e.constant(b.CORNER_SIZE())};return f(a,c,d)},limitBounds:function(b,d){var f={};if(20>d.width()){var m=20-d.width();f.width=d.width()+m;f.left=d.left()===b.left()?b.left():d.left()-m}20>d.height()&&(m=20-d.height(),f.height=d.height()+m,f.top=d.top()===b.top()?b.top():d.top()-
m);return a.merge(d,c.map(f,e.constant))},doCalculate:f}});k("vx",["zt","67","oo","1a","2l"],function(b,d,c,a,e){var f=function(b){return c.boxModel({left:parseInt(a.get(b,"data-"+d.resolve("image-left")),10),top:parseInt(a.get(b,"data-"+d.resolve("image-top")),10),width:parseInt(a.get(b,"data-"+d.resolve("image-width")),10),height:parseInt(a.get(b,"data-"+d.resolve("image-height")),10)})},g=function(b,c){a.set(b,"data-"+d.resolve("image-left"),c.left());a.set(b,"data-"+d.resolve("image-top"),c.top());
a.set(b,"data-"+d.resolve("image-width"),c.width());a.set(b,"data-"+d.resolve("image-height"),c.height())};return{readPosition:f,writePosition:g,updatePosition:function(a,c){var d=f(a),e=c(d),d=b.limitBounds(d,e);g(a,d);return d},drawAtOrigin:function(a){var b=f(a);e.setAll(a,{left:b.left()+"px",top:b.top()+"px",width:b.width()+"px",height:b.height()+"px"})}}});k("vv",["oo","vx","s"],function(b,d,c){return function(a,e,f){var g=c.none();return{setTarget:function(a){g=c.some(a)},clearTarget:function(){g=
c.none()},mutate:function(c,l){g.each(function(g){var n=b.delta({top:l,left:c}),k=d.updatePosition(f,function(b){return g(a,b,n)});d.drawAtOrigin(f,a);e.update(k)})}}}});k("41",["67","7"],function(b,d){var c=b.resolve("magic-box");return{magicBox:d.constant(c)}});k("w1",["1a"],function(b){return{grab:function(d,c){b.set(d,"aria-grabbed",c)},effect:function(d,c){b.set(d,"aria-dropeffect",c)}}});k("w2","c1 2w 33 1a 1x l 2m".split(" "),function(b,d,c,a,e,f,g){var h=c.immutable("help","ids");return{base:function(b,
c){a.setAll(b,{"aria-label":c,role:"grid"})},row:function(b){a.set(b,"role","row")},cell:function(b,c){a.setAll(b,{role:"gridcell","aria-label":c})},createHelp:function(c,m,n){var k=f.fromTag("div");e.add(k,b.resolve("aria-help"));for(var q=[],r=0;r<m;r++){var s=d.generate("ephox-aria"),t=f.fromTag("span");a.set(t,"id",s);e.add(t,b.resolve("aria-help"));g.append(t,f.fromText(n.col(r+1)));g.append(k,t);q[r]=s}r=[];for(s=0;s<c;s++){var t=d.generate("ephox-aria"),u=f.fromTag("span");a.set(u,"id",t);
e.add(u,b.resolve("aria-help"));g.append(u,f.fromText(n.row(s+1)));g.append(k,u);r[s]=[];for(u=0;u<m;u++)r[s][u]=q[u]+" "+t}return h(k,r)}}});k("zu","zt vu 67 b w1 w2 85 2j 7 s 4x 3z 1a 43 2l l 64 2m 2p 3m w".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w,x,y){var B=function(a,b,d){var g=t.fromTag("div");s.set(g,"position","absolute");var h=t.fromTag("div");v.append(g,h);d.each(function(a){f.cell(g,a);e.grab(g,!1)});r.add(g,[c.resolve("corner-wrapper"),c.resolve("corner-wrapper-"+b)]);
r.add(h,[c.resolve("corner-element"),c.resolve("corner-"+a)]);q.set(g,"data-"+c.resolve("direction"),b);return g},z=function(a,b){s.setAll(a,{top:b.top()+"px",left:b.left()+"px"})},A=function(b,c,d){var e=c()<d()?0:1;a.each(b,function(a){s.set(a,"opacity",y(e))})};return function(a){var c=k.create({reposition:n(["direction","delta"])}),e=B("top","n",m.none()),f=B("bottom","s",m.none()),r=B("right","e",m.none()),q=B("left","w",m.none()),t=B("top-left","nw",m.some(a("image.crop.handle.nw"))),v=B("top-right",
"ne",m.some(a("image.crop.handle.ne"))),y=B("bottom-right","se",m.some(a("image.crop.handle.se"))),K=B("bottom-left","sw",m.some(a("image.crop.handle.sw"))),M=h.nu(function(a){x(function(){s.reflow(e);var b=w.get(e),c=u.get(e);a(l.constant(3*b+2*c))},0)}),Q=c.trigger.reposition;a=[e,f,r,q,v,t,y,K];Q=[g.single(t,d.navigation("nw",Q),m.none()),g.single(v,d.navigation("ne",Q),m.none()),g.single(y,d.navigation("se",Q),m.none()),g.single(K,d.navigation("sw",Q),m.none())];return{elements:l.constant(a),
keylayouts:l.constant(Q),events:c.registry,refresh:function(a,c){var d=b.calculate(a,c);z(e,d.n());z(f,d.s());z(r,d.e());z(q,d.w());z(t,d.nw());z(K,d.sw());z(y,d.se());z(v,d.ne());M.get(function(a){A([e,f],c.width,a);A([r,q],c.height,a)})}}}});k("12t",["oo","7"],function(b,d){return{derive:function(c,a){return{leftRim:function(){var d=a.left(),f=c.height();return b.boxModel({top:0,left:0,width:d,height:f})},topRim:function(){var d=a.left(),f=c.width()-a.left(),g=a.top();return b.boxModel({top:0,left:d,
width:f,height:g})},rightRim:function(){return b.boxModel({top:a.top(),left:a.left()+a.width(),width:c.width()-a.width()-a.left(),height:c.height()-a.top()})},bottomRim:function(){return b.boxModel({top:a.top()+a.height(),left:a.left(),width:a.width(),height:c.height()-a.height()-a.top()})},shadeBox:d.constant(a)}}}});k("zv","12t 67 7 43 2l l".split(" "),function(b,d,c,a,e,f){var g=function(b){var c=f.fromTag("div");a.add(c,[d.resolve("panel-"+b),d.resolve("side-panel")]);return c},h=function(a,b){e.setAll(a,
{top:b.top()+"px",left:b.left()+"px",width:b.width()+"px",height:b.height()+"px"})};return function(){var a=g("left"),d=g("top"),e=g("right"),f=g("bottom");return{elements:c.constant([a,d,e,f]),refresh:function(c,g){var k=b.derive(c,g);h(a,k.leftRim());h(d,k.topRim());h(e,k.rightRim());h(f,k.bottomRim())}}}});k("vw","41 vt 67 zu zv b w1 w2 7 s 4x 3z 40 1a 1x 2l l 2m 35 2o 2y".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w,x,y){return function(B,z,A,C){var D=u.fromTag("div");s.add(D,b.magicBox());
h.base(D,C("image.crop.handle.shade"));g.effect(D,"execute");var E=u.fromTag("div");r.set(E,"role","row");var F=e(),G=a(C),I=function(a){t.setAll(D,{top:a.top()+"px",left:a.left()+"px"})};C=function(a){var b=B();I(b);F.refresh(b,a);G.refresh(b,a);H.trigger.updated(a)};w.append(E,f.flatten([F.elements(),[z],G.elements()]));v.append(D,E);var H=k.create({updated:n(["newBounds"]),reposition:q(["direction","delta"],G.events.reposition)});C(A);z=G.keylayouts();return{element:l.constant(D),bitsbox:l.constant(E),
keylayouts:l.constant(z),move:I,update:C,destroy:function(){x.remove(D)},events:H.registry,tryMovement:function(a){return y.closest(a,"."+c.resolve("corner-wrapper")).bind(function(a){a=r.get(a,"data-"+c.resolve("direction"));return void 0!==d[a]?m.some(d[a]):m.none()})}}}});k("on","vs vt vu vv 67 oo vw vx b ho w1 w2 85 7 s 4x 3z 40 1a 43 3n l 2v 2m 2y 29 1r".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w,x,y,B,z,A,C,D,E){var F=function(a){var b=a.width();a=a.height();var c=E.floor(0.125*
a),d=E.floor(0.125*b);return f.boxModel({top:c,left:d,width:b-2*d,height:a-2*c})};return function(f,E,H,L){var J=B.fromTag("div");x.add(J,[e.resolve("panel-central"),e.resolve("side-panel")]);w.set(J,"tabindex","-1");k.cell(J,L("image.crop.handle.shade"));n.grab(J,!1);var K=F(f());h.writePosition(J,K);h.drawAtOrigin(J);var M=g(f,J,K,L);A.append(E,M.element());var Q=a(f(),M,J),R=m.transform(Q),P=y.bind(J,"dblclick",function(){W.trigger.apply()}),O=b.bind(M.element(),function(a){M.tryMovement(a).orThunk(function(){return C.closest(a,
"."+e.resolve("panel-central")).map(function(){return d.translate})}).each(V)}),V=function(a){R.off();Q.clearTarget();Q.setTarget(a);R.on();R.go(H)},U=function(a,b){var c=h.updatePosition(J,function(c){return d[a](f(),c,b)});h.drawAtOrigin(J);M.update(c)};L=l.flatten([M.keylayouts(),[q.single(J,c.navigation("translate",U),s.none())]]);var N=function(){var a=f();return y.bind(D.defaultView(E),"resize",function(){var b=f();if(b.height()!==a.height()||b.width()!==a.width())W.trigger.cancel();else if(b.top()!==
a.top()||b.left()!==a.left())M.move(b),a=b})}(),K=function(a){return function(){z.active(D.owner(E)).each(function(b){n.grab(b,a)})}},X=K("true"),T=K("false");l.each(L,function(a){a.events.enter.bind(X);a.events.exit.bind(T)});M.events.reposition.bind(function(a){U(a.direction(),a.delta())});var W=u.create({updated:v(["newBounds"],M.events.updated),apply:t([]),cancel:t([])});return{element:M.element,keylayouts:r.constant(L),destroy:function(){R.destroy();N.unbind();O.unbind();P.unbind();M.destroy()},
boxes:function(){return{box:f,magic:M.element,shade:r.constant(J)}},get:function(){return h.readPosition(J)},events:W.registry}}});k("gx","om on oo 7 64 3e 2p".split(" "),function(b,d,c,a,e,f,g){var h=function(a){var b=f.absolute(a),d=b.top(),h=e.get(a),b=b.left();a=g.get(a);return c.boxModel({top:d,left:b,width:a,height:h})};return function(c,f,n,k,q){var r=a.curry(h,c),s=d(r,f,n,q);return{element:s.element,keylayouts:s.keylayouts,crop:function(){var a;a=s.get();var d=g.get(c),f=e.get(c);a=b({cropX:a.left(),
cropY:a.top(),cropWidth:a.width(),cropHeight:a.height(),displayWidth:d,displayHeight:f});return k.animate(s.boxes().magic(),c,s.boxes(),a)},destroy:function(){s.destroy()},events:s.events}}});k("97","gw gx 9m c 8w fk 85 7 gy 92 8q 6u g2 8d 70 37 4x 3z 2k 3n 29 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w,x,y,B){var z=a.detect(),A=function(a,b){s.detect(a).fold(function(){a.setRelativeSelection(e.before(b),e.before(b))},function(b){var c=z.browser.isIE()||z.browser.isSpartan()?e.on:
e.after;a.setRelativeSelection(c(b.container()),c(b.container()))})};return function(a){var e=a.content(),z=v.create({ok:u(["cropAction","image","cleanup"]),cancel:u(["image"])}),F=n.value(),G=n.value(),I=function(a){var h=e.body().getOrDie();c.speak(w.body(),k.translate("image.crop.announce"));var s=y.documentElement(a),u=d(a,s,s,b.slide(),k.translate),v=l(function(a,b){c.speak(w.body(),k.translate("aria.image.crop.size",a,b))},500);u.events.updated.bind(function(a){a=a.newBounds();v.throttle(a.width(),
a.height())});var C=function(){F.clear();N.exit();N.destroy();X.unbindAll();U.clear()},I=function(){C();G.clear();u.destroy()},P=function(){I();z.trigger.cancel(a)},O=function(){C();u.crop().get(function(b){U.clear();c.speak(w.body(),k.translate("image.crop.apply"));var d=m.crop(b.cropX(),b.cropY(),b.cropWidth(),b.cropHeight()),e=q.changedBounds(a);z.trigger.ok(function(a){return r.resampleAction(e,a,d)},a,function(a){P();return a})})};F.set(O);G.set(I);A(e,a);var V=function(){c.speak(w.body(),k.translate("image.crop.cancel"));
P()},U=n.unbindable();B(function(){U.set(x.bind(h,"focus",function(a){V()}))});var N=g.inlineDialog(s,u.keylayouts(),f.inlineDialog({ok:O,cancel:V}));N.enter();var X=t.create();X.bind(e.events.domChanged,P);X.bind(e.events.nodeChanged,function(a){w.inBody(a.node())&&P()});X.bind(u.events.apply,O);X.bind(u.events.cancel,P)};return{apply:function(){F.on(h.apply)},open:function(){a.content().getSelection().bind(s.selectionContains).each(function(a){I(a)})},destroy:function(){G.on(h.apply)},isActive:F.isSet,
events:z.registry}}});k("gz",["3l","p","3n","65","3m"],function(b,d,c,a,e){return{waitFor:function(f,g,h){return b.nu(function(b){var m=c.bind(f,g,function(c){a(n);m.unbind();b(d.value(c))}),n=e(function(){m.unbind();b(d.error("Event "+g+" did not fire within "+h+"ms"))},h)})}}});k("98",["fh","fx","gz","fz","1a"],function(b,d,c,a,e){var f=a.fToFR(d.single);return{run:function(b,c,d){return a.fromChain([b.getImage,c,f,d])},applyEdit:function(d){return function(f){var l=b.cata(f,function(a,b,c,d){return c},
function(a,b,c){return b});e.set(d,"src",l);l=c.waitFor(d,"load",1E3);return a.map(l,function(){return f})}}}});k("h0",["s","nr"],function(b,d){var c=function(a){return 20<=a},a=function(a){return b.from(a).filter(c)};return{ensureMin:a,parse:function(c,f){var g=a(c).getOr(0),h=a(f).getOr(0);return 0===g&&0===h?b.none():b.some(d(g,h))}}});k("99","fh 3l 7 fz e3 h0 8d 1a".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a){return function(d){var f=d.image(),g=d.asset(),l=function(a){a.fold(function(){h.remove(f,
"src")},function(a){b.cata(a,function(a,b,c,d){h.set(f,"src",c)},c.noop)})};return e.loadIfNeeded(f).bind(function(){return a(g).map(function(a){l(a);return a})})}},m=c.constant(a.pure),n=c.constant(function(b){return a.pure(b.asset())});return function(a){a=f.parse(a.preferredWidth,a.preferredHeight);var b=a.fold(m,g.instance),c=a.fold(n,function(){return l(b)});return{assets:function(a){return d.mapM(a,b)},correlated:function(a){return d.mapM(a,c)}}}});k("9a",["7","s","6u"],function(b,d,c){return{edit:function(a,
e,f,g){return{items:g,updatePalette:function(g){if(f())g.hide(d.none())&&a();else{var l=b.curry(g.show,d.some(c.translate("image.context.palette.show")));g=b.curry(g.hide,d.some(c.translate("image.context.palette.hide")));(e().isSome()?l:g)()&&a()}}}},crop:function(a,b,c){return{items:c,updatePalette:function(c){(b()?c.show:c.hide)(d.none())&&a()}}}}});k("5i","7 86 92 93 94 95 96 90 97 98 99 9a 70 6l 1a o".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t){return function(u,v,w,x){var y=f(u.communication()),
B=d(u.ui),z=function(a){return function(b){b.fold(function(b){b=e.diagnoseImageEdit(b,s.get(a,"src"));B.show(b.bannerMessage());t.error("Image edit operation failed: ",b.consoleMessage())},function(a){w.uploadAssets([a]);u.content().focus();u.undo().save()});v.fireChanged(a);return b}},A=function(a,b){u.undo().save();var c=m.applyEdit(a);return m.run(y,b,c)(a)},C=l(u);C.events.cancel.bind(function(a){v.fireChanged(a.image())});C.events.ok.bind(function(b){var c=b.image(),d=b.cropAction();b=b.cleanup();
var e=a.updater(a.keepCrop,c);A(c,d).map(e).map(b).get(z(c))});var D=function(){return u.content().getSelection().bind(q.selectionContains)},E=function(c,d){return function(){D().each(function(e){var f=b.identity,g=a.updater(d,e);A(e,c).map(g).map(f).get(z(e))})}},F=[g.make("crop-begin","image.crop.begin",C.open),g.make("rotate-left","image.toolbar.rotateleft",E(c.rotateLeft,a.keepRotate)),g.make("rotate-right","image.toolbar.rotateright",E(c.rotateRight,a.keepRotate)),g.make("flip-horizontal","image.toolbar.fliphorizontal",
E(c.flipHorizontal,a.keepFlip)),g.make("flip-vertical","image.toolbar.flipvertical",E(c.flipVertical,a.keepFlip))],G=[g.make("crop-apply","image.crop.apply",C.apply)],E=r.ui({"edit.palette":b.curry(k.edit,u.ui().refresh,D,C.isActive,F),"crop.palette":b.curry(k.crop,u.ui().refresh,C.isActive,G)},b.identity),F=h.imageEdit(C.isActive,G,F);x=n(x);return{destroy:function(){C.destroy()},ui:E,insertResample:b.constant(x),situation:F.situation,handle:F.handle,assign:F.assign,name:b.constant("imageEdit")}}});
k("h4",["7","v"],function(b,d){var c=function(a){a=d.removeTrailing(a,".");var c=d.startsWith(a,"www.")?"http://"+a:a;return{text:b.constant(a),href:b.constant(c)}};return{preprocess:c,auto:function(a){return c(a).href()}}});k("h1","b 8w 7 8x cv h4 cp 70 1a l 2m b1".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k){var q=function(a,b){a.setRelativeSelection(d.after(b),d.after(b))},r=function(a,b,c,d){return h.detect(a).fold(function(){a.focus();return a.getSelection().fold(function(){return[]},function(a){return(a.collapsed()?
c:d)(a)})},function(a){return b(a.container())})},s=function(a,b,c){var d=m.fromTag("a");l.set(d,"href",b);n.wrap(c,d);a.focus();return[d]},t=function(a,b,d){d=f.auto(b.url());e.attr(a,"href",d);e.attr(a,"target",b.target());e.attr(a,"title",b.title());b.text().fold(function(){k.set(a,b.url())},c.noop,function(b){k.set(a,b)})},u=function(a){var b=g.findDescendants(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset(),"a");return 0<b.length?b:g.findAncestors(a.startContainer(),a.endContainer(),
"a")},v=function(d,e,g){return r(d,c.curry(s,d,e),function(b){var c=m.fromTag("a");l.set(c,"href",f.auto(e));g.fold(function(){n.append(c,m.fromText(e))},function(a){t(c,a,d)});a.insertAtCursor(d,[c]);q(d,c);return[c]},function(a){d.execCommand("CreateLink",!1,f.auto(e));a=d.getSelection().map(u).getOr([]);b.each(a,function(a){g.each(function(b){t(a,b,d)});q(d,a)});return a})};return{hyperlink:function(a,b,c){b=c.map(function(a){return a.url()}).getOr(b);return 0<b.trim().length?v(a,b,c):[]},setProperties:t}});
k("h2",["co"],function(b){var d=function(a,c){var d=b.getEnd(c);a.setSelection(c,d,c,d)},c=function(a,b){a.setSelection(b,0,b,0)};return{selectEnd:d,moveToEnd:function(a){a.getSelection().each(function(b){d(a,b.endContainer());a.focus()})},selectStart:c,moveToStart:function(a){a.getSelection().each(function(b){c(a,b.endContainer());a.focus()})}}});k("op","7 fn 30 3z 40 1x l 35".split(" "),function(b,d,c,a,e,f,g,h){return{controls:function(l){var m=void 0!==l?l+"-":"";l=g.fromTag("div");f.add(l,c.resolve(m+
"dialog-controls"));var n=d.okCancel(m),k=n.ok(),q=n.cancel(),r=d.button(m,"remove","link.properties.button.remove");d.makeNormal(r.element());f.add(r.element(),c.resolve("secondary-action"));h.append(l,[r.element(),q.element(),k.element()]);m=a.create({ok:e([],k.events.click),cancel:e([],q.events.click),remove:e([],r.events.click)});return{element:b.constant(l),ok:b.constant(k),cancel:b.constant(q),remove:b.constant(r),destroy:function(){k.destroy();r.destroy();q.destroy()},events:m.registry}}}});
k("9e",["s","70","1a","1b","2y"],function(b,d,c,a,e){var f=function(a){return e.closest(a,"a[href]")},g=function(b,c){return f(b).bind(function(b){return f(c).filter(function(c){return a.eq(b,c)})})};return{contentLink:function(a){return a.getSelection().bind(function(c){return d.detect(a).fold(function(){return g(c.startContainer(),c.endContainer())},function(a){return b.some(a.image()).bind(f)})})},sharedLink:g}});k("oq","s 9e 33 1a 6e b1".split(" "),function(b,d,c,a,e,f){var g=c.immutableBag("text url title target textDisabled removeLink hasText".split(" "),
[]),h=function(a){return b.from(a).getOr("")};return{divine:function(b,c){var n=b.getSelection(),k=n.map(function(a){return!a.collapsed()}).getOr(!1);return n.bind(function(a){return d.sharedLink(a.startContainer(),a.endContainer())}).fold(function(){var a=k?b.getSelectedText().getOr(""):c;return g({text:a,url:h(c),target:"",title:"",textDisabled:k,removeLink:!1,hasText:!1})},function(b){var c=e.descendant(b,"img"),c=k||c;return g({text:f.get(b),url:h(a.get(b,"href")),title:h(a.get(b,"title")),target:h(a.get(b,
"target")),textDisabled:c,removeLink:!0,hasText:!0})})}}});k("w3","1n 7i 2w 7 kd 6u 30 1a 1x l 2m 35".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k){return{target:function(){var n=m.fromTag("div");l.add(n,g.resolve("target-container"));var r=m.fromHtml("<label>"+f.translate("link.properties.target.label")+"</label>"),s="target-select"+c.generate("");h.set(r,"for",s);var t=m.fromTag("select");h.set(t,"id",s);d.label(t,f.translate("link.properties.target.label"));s=b.mapToArray({_blank:"link.properties.target.blank",
_top:"link.properties.target.top",_self:"link.properties.target.self",_parent:"link.properties.target.parent"},function(a,b){return m.fromHtml('<option value="'+b+'">'+f.translate(a)+"</option>")});s=[m.fromHtml('<option value="" selected="selected">'+f.translate("link.properties.target.none")+"</option>")].concat(s);k.append(t,s);s=e.wrapSelect(t);k.append(n,[r,s]);return{element:a.constant(n),input:a.constant(t)}}}});k("or","fk 85 7 s fm kd w3 30 1a 1x l 35".split(" "),function(b,d,c,a,e,f,g,h,
l,m,n,k){return function(q,r){var s=n.fromTag("div"),t=f.input("text-to-display","link.properties.text.label");m.add(t.element(),h.resolve("text-to-display"));m.add(t.label(),h.resolve("inline-label"));var u=f.input("href-url-value","link.properties.url.label");l.set(u.input(),"type","url");var v=g.target(),w=f.input("title-text","link.properties.title.label");m.add(w.element(),h.resolve("title-container"));var x=n.fromTag("div");m.add(x,h.resolve("title-target-group"));k.append(x,[v.element(),w.element()]);
m.add(s,h.resolve("link-properties-body"));k.append(s,[t.element(),u.element(),x]);q.setControls(r.element());q.setContent(s);s=[d.input(t.input(),b.input({})),d.input(u.input(),b.input({})),d.single(v.input(),[],a.none()),d.input(w.input(),b.input({})),d.button(r.remove().element(),b.button({execute:e.click}))];return{url:c.constant(u.input()),target:c.constant(v.input()),text:c.constant(t.input()),title:c.constant(w.input()),keylayouts:c.constant(s)}}});k("os",["s"],function(b){return{getValue:function(d){var c=
d.dom();d=c.selectedIndex;c=c.options[d];return void 0===c||-1===d?b.none():b.from(c.value)}}});k("h3","s cv fl fm 6u op oq or 30 71 4x 3z 4f 1a 1x 2l 2z os".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v){return function(w,x,y,B){var z=k.create({ok:n(["url","target","text","title"]),remove:n([]),close:n([])}),A=f.controls("link-properties"),C=c(B);s.add(C.element(),l.resolve("linkproperties-dialog"));C.setTitle(e.translate("link.properties.dialog.title"));var D=h(C,A),E=q(b.none());w=function(){C.hide();
z.trigger.close()};var F=a.setup(C,A,D.keylayouts()),G=function(){var a=u.get(D.text()),b=E.get().map(function(b){return b.hasText()?b.text()!==a:!0}).getOr(!0);return r.has(D.text(),"disabled")?m.unchanged():0===a.length?m.off():b?m.on(a):m.unchanged()};B=function(){var a=v.getValue(D.target()).getOr(""),b=G();z.trigger.ok(u.get(D.url()),a,b,u.get(D.title()))};A.events.ok.bind(B);A.events.remove.bind(function(){z.trigger.remove()});A.events.cancel.bind(w);C.events.close.bind(w);return{open:function(){C.show();
F.enter()},element:C.element,events:z.registry,destroy:function(){F.exit();F.destroy();C.destroy();A.destroy()},represent:function(a){a=g.divine(y,x);E.set(b.some(a));u.set(D.url(),a.url());u.set(D.target(),a.target());u.set(D.text(),a.text());u.set(D.title(),a.title());var c=a.textDisabled()?"disabled":"";d.attr(D.text(),"disabled",c);a=a.removeLink()?"block":"none";t.set(A.remove().element(),"display",a)},hide:C.hide(),execute:B}}});k("9b","s h1 h2 h3 h4 91 9e 1a 2o 29".split(" "),function(b,d,
c,a,e,f,g,h,l,m){var n=function(a,b){a.getSelection().each(function(a){g.sharedLink(a.startContainer(),a.endContainer()).each(function(a){b(a)})})},k=function(a){n(a,function(b){a.setSelection(b,0,b,m.children(b).length);var d=m.lastChild(b);l.unwrap(b);d.each(function(b){c.selectEnd(a,b)});a.focus()})};return{insert:d.hyperlink,update:function(a,b,c,f){n(b,function(a){h.set(a,"href",e.auto(c));f.each(function(c){d.setProperties(a,c,b)});b.focus()})},properties:function(c,d,e,g,h,l,m){c=a(c,d,e,g.uiContainer());
var n=f.generate(h,c,["url","target","text","title"]);c.events.remove.bind(function(){e.activate();l.save();k(e);n.destroy();e.focus()});n.events.ok.bind(function(a){e.activate();n.destroy();m(a);e.focus()});n.events.close.bind(function(a){e.activate();n.destroy();e.focus()});e.deactivate();n.represent();n.open();return b.none()},unlink:k}});k("hm",["7","3d"],function(b,d){return{generate:function(c,a,e,f){var g=d(f,c);c=d(e,c);f=d(f,a);a=d(e,a);return{northwest:b.constant(g),northeast:b.constant(c),
southwest:b.constant(f),southeast:b.constant(a)}}}});k("h6",["hm"],function(b){return function(d){return b.generate(0,d,0,0)}});k("9h","ap co 7 s du en h5 h6 ea 20 29 1r 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q){var r=function(a,b){return m.isText(a)?e.point(a,b):f.descend(a,b)},s=function(a,e){return e.getSelection().bind(function(a){return e.win().bind(function(f){return e.body().bind(function(e){var g=d.getEnd(e),h=r(a.startContainer(),a.startOffset());return b.rectangleAt(f,h.element(),
h.offset(),e,g).map(function(b){return{bounds:c.constant(b),element:c.constant(a.startContainer())}})})})})},t=function(b,d,e){s(b,d).fold(function(){g.insertAtCursor(b,d,e)},function(f){var g=f.bounds();f=f.element();(m.isText(f)?n.parent(f):a.some(f)).each(function(a){a=b.directionAt(a);var f=a.isRtl()?g.right:g.left,f=d.translateScreen(f,g.top),h=k.min(f.top(),q.innerHeight);e({left:f.left,top:c.constant(h),height:c.constant(g.height),direction:c.constant(a)})})})};return{show:function(a,b,c,d,
e){t(a,b,function(a){var f=a.direction();a=l.makeshift(b,c,a.left(),a.top(),f,h(a.height()));c.show(d,a);d.setComponents([e.element()])})}}});k("h7","7 s 6u 6j 4x 3z 33 2y".split(" "),function(b,d,c,a,e,f,g,h){return{enabled:function(a){var m=d.none(),n=g.immutable("value","text","attrs"),k=f.create({properties:e(["link"])});return{situation:function(a){a=m.map(function(a){return[n("linkmenu-properties",c.translate("link.context.edit"),{})]}).getOr([]);return{primary:b.constant(a),secondary:b.constant([]),
submenus:b.constant([])}},handle:function(a){m.each(function(a){k.trigger.properties(a)})},assign:function(b){m=b.bind(function(b){return h.closest(b,"a[href]",a.isRoot)})},events:k.registry}},disabled:function(){var c=a.noSituation(),d=f.create({properties:e(["link"])});return{situation:c,handle:b.noop,assign:b.noop,events:d.registry}}}});k("h8",["7","30","bs"],function(b,d,c){var a=d.resolve("link-eph-cursor");return{configure:function(b){b.add(b.internal(),a,c.remove);b.add(b.output(),a,c.remove)},
insertCursor:b.constant(a)}});k("w4","6w 7i c fk 85 6 g9 dd 7 s fm kd 6u fn 30 4x 3z 1a 1x 43 2l l 2v 35 2o 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w,x,y,B,z,A,C,D){var E=function(a){return f.merge({commandLabel:q.translate("link.dialog.insert")},a)},F=c.detect().deviceType.isTouch(),G=function(a){var c=B.fromTag("span");w.add(c,s.resolve("link-dialog"));w.add(c,s.resolve("link-dialog-insert"));var e=B.fromTag("span");w.add(e,s.resolve("link-dialog-icon"));v.set(e,"alt",q.translate("link.dialog.aria.insert"));
d.presentation(e);var f=k.input("link-input-url","link.dialog.tooltip");w.add(f.input(),s.resolve("link-insert-input"));v.set(f.input(),"type","url");var m=g();r.makeDefault(m.element());w.add(m.element(),s.resolve("default-action"));w.add(m.element(),s.resolve("link-dialog-insert"));m.content(h(a.commandLabel));var n=g();r.makeNormal(n.element());x.add(n.element(),[s.resolve("link-properties"),b.resolve("icon")]);v.set(n.element(),"title",q.translate("link.dialog.aria.properties"));F&&y.set(n.element(),
"display","none");return{element:function(){return c},icon:l.constant(e),input:l.constant(f.input()),button:l.constant(m),properties:l.constant(n),setUrl:function(a){D.set(f.input(),a)},execute:function(){m.click()},focus:function(){z.focus(f.input())},destroy:function(){m.destroy();n.destroy();C.remove(c)}}};return{insert:function(b){b=E(b);var c=G(b),f=u.create({insert:t(["url","extra"]),properties:t(["url","extra"])});d.dialog(c.element(),q.translate("link.dialog.aria.insert"));d.toolbarButton(c.properties().element(),
q.translate("link.dialog.aria.properties"),!1,!1);c.properties().events.click.bind(function(){f.trigger.properties(D.get(c.input()),m.none())});d.toolbarButton(c.button().element(),q.translate("link.dialog.aria.insert"),!1,!1);c.button().events.click.bind(function(){f.trigger.insert(D.get(c.input()),m.none())});r.makeDefault(c.button().element());r.makeNormal(c.properties().element());b=[e.input(c.input(),a.input({})),e.button(c.button().element(),a.button({execute:n.click})),e.button(c.properties().element(),
a.button({execute:n.click}))];A.append(c.element(),[c.icon(),c.input(),c.button().element(),c.properties().element()]);return{element:c.element,setUrl:c.setUrl,execute:c.execute,focus:c.focus,destroy:c.destroy,keylayouts:l.constant(b),events:f.registry}},update:function(b){b=E(b);var c=u.create({insert:t(["url","extra"]),remove:t([]),properties:t(["url","extra"])}),f=G(b);d.dialog(f.element(),q.translate("link.dialog.aria.update"));var k=g();r.makeNormal(k.element());k.content(h(q.translate("link.dialog.remove")));
w.add(k.element(),s.resolve("link-quick-url-remove"));d.toolbarButton(k.element(),q.translate("link.dialog.remove"),!1,!1);k.events.click.bind(function(){c.trigger.remove()});d.toolbarButton(f.properties().element(),q.translate("link.dialog.aria.properties"),!1,!1);f.properties().events.click.bind(function(){c.trigger.properties(D.get(f.input()),m.none())});d.toolbarButton(f.button().element(),q.translate("link.dialog.aria.update"),!1,!1);f.button().events.click.bind(function(){c.trigger.insert(D.get(f.input()),
m.none())});A.append(f.element(),[f.icon(),f.input(),f.button().element(),k.element(),f.properties().element()]);b=[e.input(f.input(),a.input({})),e.button(f.button().element(),a.button({execute:n.click})),e.button(k.element(),a.button({execute:n.click})),e.button(f.properties().element(),a.button({execute:n.click}))];return{element:f.element,setUrl:f.setUrl,execute:f.execute,focus:f.focus,destroy:function(){k.destroy();f.destroy()},events:c.registry,keylayouts:l.constant(b)}}}});k("zz","30 1x l 2m 2o 9z".split(" "),
function(b,d,c,a,e,f){return function(g,h){var l=c.fromTag("div");d.add(l,b.resolve("palette-row"));d.add(l,b.resolve("palette-row-"+g));var m=c.fromTag("span");d.add(m,b.resolve("palette-detail"));a.append(m,h.element());a.append(l,m);m=f.displayToggler(l,"block");return{element:function(){return l},destroy:function(){e.remove(l)},show:m.off,hide:m.on}}});k("w5",["zz"],function(b){return function(d,c){var a=b(c,d);return{element:a.element,destroy:a.destroy,show:a.show,hide:a.hide,execute:d.execute}}});
k("w6","b r1 30 43 l 2m 35 2o".split(" "),function(b,d,c,a,e,f,g,h){return function(){var l=e.fromTag("div");a.add(l,[c.resolve("palette-container"),c.resolve("inline-dialog")]);var m=d.disable(l);return{element:function(){return l},add:function(a){f.append(l,a.element())},addAll:function(a){g.append(l,b.map(a,function(a){return a.element()}))},remove:function(a){h.remove(a.element())},destroy:function(){m.unbind();h.remove(l)},empty:function(){h.empty(l)}}}});k("ov","b 7 s w4 w5 6u w6 30 4x 3z 1x".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n){return function(){var k=g();n.add(k.element(),h.resolve("inline-palette"));var q=a.insert(),r=e(q,"insert");q.events.insert.bind(function(a){x.trigger.insert(a.url(),c.none())});q.events.properties.bind(function(a){x.trigger.close();x.trigger.properties(a.url(),function(b){x.trigger.insert(a.url(),c.some(b))})});var s=a.update({commandLabel:f.translate("link.dialog.update")}),t=e(s,"update");s.events.insert.bind(function(a){x.trigger.update(a.url(),a.extra())});s.events.properties.bind(function(a){x.trigger.close();
x.trigger.properties(a.url(),function(b){x.trigger.update(a.url(),c.some(b))})});s.events.remove.bind(function(a){x.trigger.remove()});k.add(r);k.add(t);var u=[r,t],v=r,w=function(a){v=a;b.each(u,function(a){a.hide()});a.show()},x=m.create({insert:l(["url","extra"]),update:l(["url","extra"]),properties:l(["url","action"]),remove:l([]),close:l([])}),y=b.bind([q,s],function(a){return a.keylayouts()});return{element:k.element,insert:function(){w(r);q.focus();q.setUrl("")},context:function(a){w(t);s.setUrl(a);
s.focus()},execute:function(){v.execute()},keylayouts:d.constant(y),destroy:function(){q.destroy();r.destroy();s.destroy();t.destroy();k.destroy()},events:x.registry}}});k("h9","9k kg c fk 85 3l 7 gz ov 4x 3z 40 l 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r){var s=c.detect();return function(c,u,v,w,x){var y=l(),B=b.popup(x.uiContainer,x.bounds,c,[]).initMenu(y.element()),z=function(){return h.waitFor(q.fromDom(r),"resize",500)},A=function(){return f.pure({})},C=n.create({insert:k(["url","extra"],
y.events.insert),update:k(["url","extra"],y.events.update),properties:k(["url","action"],y.events.properties),remove:k([],y.events.remove),escaped:m([]),close:m([])}),D=e.inlineDialog(y.element(),y.keylayouts(),a.inlineDialog({ok:y.execute,cancel:g.noop}));u=function(){B.close();C.trigger.close()};y.events.close.bind(u);D.events.exit.bind(u);B.events.close.bind(function(){v.foreground()});return{insert:y.insert,context:y.context,showPopup:function(a,b){b();B.open();D.enter();var e=s.deviceType.isAndroid()?
z:A,f=g.curry(a.show,c,v,x,B,y);e().get(function(){d.preserve(f,y.element())})},hide:function(){B.closed()||D.exit()},destroy:function(){D.exit();D.destroy();B.close();B.destroy();y.destroy()},events:C.registry}}});k("9c","c 7 s 9b 9h h7 h8 h9 4x 3z 1a".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(k){var q=k.filter(),r=k.content(),s=k.keyboard(),t=k.undo(),u=k.smartview(),v=f.enabled(r),w=b.detect();g.configure(q);var x=function(){r.getSelection().each(function(a){r.setSelection(a.startContainer(),
a.startOffset(),a.endContainer(),a.endOffset())})},y=w.browser.isIE()?x:d.noop,B=h(k.region(),k.profile(),r,s,u),z=m.create({insert:l(["url","extra"]),update:l(["url","extra"]),unlink:l([])}),A=function(a){a=n.get(a,"href");return c.from(a).getOr("")},C=function(b,c){a.properties(q,b,r,u,s,t,c)};B.events.close.bind(function(){r.focus();y()});B.events.insert.bind(function(a){z.trigger.insert(a.url(),a.extra());B.hide()});B.events.properties.bind(function(a){C(a.url(),a.action());B.hide()});B.events.update.bind(function(a){z.trigger.update(a.url(),
a.extra());B.hide()});B.events.remove.bind(function(a){z.trigger.unlink();B.hide()});B.events.escaped.bind(function(a){k.ui().refocus()});v.events.properties.bind(function(a){var b=A(a.link());C(b,function(a){z.trigger.update(b,c.some(a))})});r.events.mousedown.bind(B.hide);return{showContext:function(a){B.showPopup(e,d.curry(B.context,A(a)))},showInsert:function(){r.selectWord();B.showPopup(e,B.insert)},situation:v.situation,handle:v.handle,assign:v.assign,events:z.registry,destroy:function(){B.destroy();
r.events.mousedown.unbind(B.hide)}}}});k("ha","b 7 s hf g7 6u 30 4x 3z 4f 1a 1x l 2v 2m 35 2o 2z 9z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w){return function(x){var y=m(c.none());x=q.fromTag("div");k.add(x,g.resolve("link-widget"));var B=q.fromTag("span");k.add(B,g.resolve("link-widget-field"));var z=q.fromTag("input");k.add(z,g.resolve("link-widget-input"));s.append(B,z);n.set(z,"type","url");n.set(z,"placeholder",f.translate("link.dialog.tooltip"));var A=e.text(B,z),C=a([g.resolve("link-widget-insert")],
"insert.link"),D=a([g.resolve("link-widget-update")],"link.dialog.aria.update"),E=a([g.resolve("link-widget-remove")],"link.dialog.remove");s.append(x,B);var F=l.create({insert:h(["url","extra"]),update:h(["url","extra"]),unlink:h([]),toEditor:h([])}),G=function(){var a=v.get(z);F.trigger.insert(a,c.none());F.trigger.toEditor()},I=function(){F.trigger.update(v.get(z),c.none());F.trigger.toEditor()};C.events.click.bind(G);D.events.click.bind(I);E.events.click.bind(function(){F.trigger.unlink();F.trigger.toEditor()});
return{element:d.constant(x),addEscape:function(a){s.append(B,a.element())},type:d.constant(A),execute:function(){w.isVisible(C.element())?G():w.isVisible(D.element())&&I()},open:function(){r.focus(z)},close:d.noop,destroy:d.noop,represent:function(a){b.each([C.element(),D.element(),E.element()],u.remove);a.fold(function(){v.set(z,"http://");s.after(z,C.element())},function(a){t.after(z,[D.element(),E.element()]);a=n.get(a,"href");v.set(z,a)});y.set(a)},events:F.registry}}});k("9d","s 8h h7 ha 4x 3z".split(" "),
function(b,d,c,a,e,f){return function(g){var h=a(g),l=d(g,h);g=c.disabled();var m=f.create({insert:e(["url","extra"]),update:e(["url","extra"]),unlink:e([])});h.events.insert.bind(function(a){m.trigger.insert(a.url(),a.extra())});h.events.update.bind(function(a){m.trigger.update(a.url(),a.extra())});h.events.unlink.bind(function(a){m.trigger.unlink()});return{showContext:function(a){h.represent(b.some(a));l.open()},showInsert:function(){h.represent(b.none());l.open()},situation:g.situation,handle:g.handle,
assign:g.assign,events:m.registry,destroy:function(){l.destroy()}}}});k("5j","c 7 9b 6u 9c 9d 9e 6l 4x 3z".split(" "),function(b,d,c,a,e,f,g,h,l,m){return function(n){var k=n.content(),q=n.undo(),r=n.shortcuts(),s=b.detect().deviceType.isTouch()?f(n):e(n),t=m.create({analytics:l(["message"])});s.events.insert.bind(function(a){q.save();a=c.insert(k,a.url(),a.extra());n.internalevents().input(a);k.domChanged();k.cursorIntoView();t.trigger.analytics("link_inserted")});s.events.update.bind(function(a){q.save();
c.update(n.filter(),k,a.url(),a.extra());k.domChanged();k.cursorIntoView()});s.events.unlink.bind(function(a){q.save();c.unlink(k);k.domChanged();k.cursorIntoView()});var u=function(){k.getSelection().each(function(a){g.sharedLink(a.startContainer(),a.endContainer()).fold(function(){k.selectWord();s.showInsert()},s.showContext)})},v=h.ui({"link.general":{toggle:!1,value:"link",textkey:a.key("insert.link"),action:u,updateGeneral:d.noop,icon:!0,shortcut:!0,hasPopup:!1,hasDialog:!0}});r.events.link.bind(u);
return{ui:v,situation:s.situation,handle:s.handle,assign:s.assign,events:t.registry,destroy:function(){s.destroy()}}}});k("100",["s","hj"],function(b,d){return{top:{rules:[{current:d.backtrack,next:d.sidestep,fallback:b.none()},{current:d.sidestep,next:d.sidestep,fallback:b.some(d.backtrack)},{current:d.advance,next:d.sidestep,fallback:b.some(d.sidestep)}],inclusion:function(b,a,d){return!b.property().parent(d).exists(function(d){return b.eq(d,a.item())})}},all:{rules:void 0,inclusion:function(b,
a,d){return b.property().isText(a.item())}}}});k("w7",["b","7","hj","100"],function(b,d,c,a){var e=c.walkers(),f=function(a,b,d,g){return c.walk(a,b,d,e.left(),g.rules).map(function(c){return a.property().isEmptyTag(c.item())||a.property().isBoundary(c.item())?[]:(g.inclusion(a,c,b)?[c.item()]:[]).concat(f(a,c.item(),c.mode(),g))}).getOr([])},g=function(a,d,e){a=f(d,e,c.sidestep,a);return b.reverse(a).concat([e])};return{top:d.curry(g,a.top),all:d.curry(g,a.all)}});k("ow",["dg","w7"],function(b,d){var c=
b();return{top:function(a){return d.top(c,a)},all:function(a){return d.all(c,a)}}});k("w8",["b","7","s","du","go"],function(b,d,c,a,e){var f=function(f,g){var m=e.generate(g,function(b,d){return f.property().isText(b)?c.some(a.range(b,d,d+f.property().getText(b).length)):c.none()}),n=b.foldr(m,function(a,b){return f.property().getText(b.element())+a},"");return{list:d.constant(m),text:d.constant(n)}},g=function(a,b,c,f){var g=e.find(b.list(),function(b){return a.eq(b.element(),c)}).map(function(a){return a.start()+
f});return{list:b.list,text:b.text,cursor:d.constant(g)}};return{from:function(a,b,c,d){b=f(a,b);return g(a,b,c,d)}}});k("ox",["dg","w8"],function(b,d){var c=b();return{from:function(a,b,f){return d.from(c,a,b,f)}}});k("hb",["7","s","ow","ox","20"],function(b,d,c,a,e){return{get:function(f,g){var h=c.all(f),l=a.from(h,f,g),h=l.cursor().orThunk(function(){return e.isText(f)?d.none():d.some(l.text().length)});return{list:l.list,text:l.text,cursor:b.constant(h)}}}});k("oy",["4i","7","s","l","5z"],function(b,
d,c,a,e){return function(f,g,h){return{patterns:function(){return[new e("(\\W)(\\w+)(\\W*)$","gi"),new e("(^)(\\w+)(\\W*)$","gi")]},useCursor:d.constant(!0),generate:function(e,f){var g=a.fromText(f.text());return b.species({elements:d.constant([g]),cursor:c.none,dictation:d.constant(c.some(function(){return h(f.text())})),notify:c.none})},derive:function(a){var b=a.index+a[1].length,c=b+a[2].length;return g(a[2]).map(function(a){return{startIndex:d.constant(b),finishIndex:d.constant(c),text:d.constant(a)}})},
label:f}}});k("oz","4i 7 s 6b l 5z".split(" "),function(b,d,c,a,e,f){return function(g,h){var l=a.sanitise(g);return{patterns:function(){return[new f("("+l+")","gi")]},useCursor:d.constant(!0),generate:function(a,f){var g=e.fromTag("span",a.dom());g.dom().innerHTML=h;return b.species({elements:d.constant([g]),cursor:c.none,dictation:c.none,notify:c.none})},derive:function(a){var b=a.index;a=b+a[0].length;return c.some({startIndex:d.constant(b),finishIndex:d.constant(a)})}}}});k("p0","4i 7 s du 6b 2l l 2m 35 5z".split(" "),
function(b,d,c,a,e,f,g,h,l,m){return function(n,k,q){var r=e.sanitise(k);return{patterns:function(){return[new m("^("+r+"\\s)(.+)","gi")]},useCursor:d.constant(!1),generate:function(e,m){var k=g.fromTag(n,e.dom());f.set(k,"list-style-type",q);var p=g.fromTag("li",e.dom()),r=g.fromTag("li",e.dom());h.append(r,g.fromTag("br",e.dom()));l.append(k,[p,r]);l.append(p,m.clones());return b.species({elements:d.constant([k]),cursor:d.constant(c.some(a.point(r,0))),dictation:c.none,notify:c.none})},derive:function(a){var b=
a[1];return c.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+b.length)})}}}});k("p1","4i 7 s 6b l 35 5z".split(" "),function(b,d,c,a,e,f,g){var h=function(a,h){return{patterns:function(){return[new g("^("+a+")(.+)","gi")]},useCursor:d.constant(!1),generate:function(a,g){var l=e.fromTag(h,a.dom());f.append(l,g.clones());return b.species({elements:d.constant([l]),cursor:c.none,dictation:c.none,notify:c.none})},derive:function(a){var b=a[1];return c.some({startIndex:d.constant(a.index),
finishIndex:d.constant(a.index+b.length)})}}};return{normal:function(b,c){var d=a.sanitise(b);return h(d,c)},spaced:function(b,c){var d=a.sanitise(b)+"\\s";return h(d,c)}}});k("p2","4i 7 s 6b l 2m 5z".split(" "),function(b,d,c,a,e,f,g){return function(h,l,m,n){var k=a.sanitise(l),q=a.sanitise(m);return{patterns:function(){return[new g(k+"([^\\s].*?[^\\s])"+q,"gi"),new g(k+"([^\\s])"+q,"gi")]},useCursor:d.constant(!0),generate:function(a,g){var h=e.fromTag(n,a.dom()),l=e.fromText(g.text());f.append(h,
l);return b.species({elements:d.constant([h]),cursor:c.none,dictation:c.none,notify:c.none})},derive:function(a){return c.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+a[0].length),text:d.constant(a[1])})}}}});k("p3","4i 7 s 6b l 5z".split(" "),function(b,d,c,a,e,f){return function(g,h){var l=a.sanitise(g);return{patterns:function(){return[new f("("+l+")","gi")]},useCursor:d.constant(!0),generate:function(a,f){return b.species({elements:d.constant([e.fromTag(h,a.dom())]),cursor:c.none,
dictation:c.none,notify:c.none})},derive:function(a){return c.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+a[0].length)})}}}});k("p4","4i 7 s l v 5z".split(" "),function(b,d,c,a,e,f){var g=function(e,f){return b.species({elements:d.constant([a.fromText(f.text())]),cursor:c.none,dictation:c.none,notify:c.none})},h=function(){return{patterns:function(){return[/([^.?!][.?!]\s+)([a-z][^\s]*)/g,/^()([a-z][^\s]*)/g]},useCursor:d.constant(!0),generate:g,derive:function(a){var b=a.index,
f=b+a[0].length;a=a[1]+e.capitalize(a[2]);return c.some({startIndex:d.constant(b),finishIndex:d.constant(f),text:d.constant(a)})}}}(),l=function(){return{patterns:function(){return[new f("([A-Z][A-Z]+)([a-z]+)","g")]},useCursor:d.constant(!1),generate:g,derive:function(a){var b=a[2],b=e.capitalize(a[1].toLowerCase())+b.toLowerCase(),f=a.index;a=f+a[0].length;return c.some({startIndex:d.constant(f),finishIndex:d.constant(a),text:d.constant(b)})}}}();return{capitalise:d.constant(h),normalise:d.constant(l)}});
k("p5","4i 7 s bd h4 1a l 2m".split(" "),function(b,d,c,a,e,f,g,h){return{patterns:function(){return[a.link()]},useCursor:d.constant(!0),generate:function(a,e){var n=g.fromTag("a");f.set(n,"href",e.href());h.append(n,g.fromText(e.text()));return b.species({elements:d.constant([n]),cursor:c.none,dictation:c.none,notify:d.curry(c.some,[n])})},derive:function(a){var b=e.preprocess(a[0]),f=b.text(),b=b.href();return-1<f.indexOf("@")?c.none():c.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+
f.length),text:d.constant(f),href:d.constant(b)})}}});k("hc","b oy oz p0 p1 p2 p3 7 r 6u p4 p5 6e 29 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s){var t=h.constant(function(a,b){return b});return function(s,v,w){var x=w.whitelist.fold(t,function(a){return function(c,d){return b.contains(a,c)?d:[]}}),y=function(a){return{derive:a.derive,generate:a.generate,patterns:a.patterns,useCursor:a.useCursor,allowed:h.constant(!0)}},B=function(a,b){return{derive:a.derive,generate:a.generate,patterns:a.patterns,
useCursor:a.useCursor,allowed:function(a){return!1===q.closest(a,b)}}};w=x("headings",[y(e.spaced("######","h6")),y(e.spaced("#####","h5")),y(e.spaced("####","h4")),y(e.spaced("###","h3")),y(e.spaced("##","h2")),y(e.spaced("#","h1"))]);var z=x("lists",[y(a("ul","*","disc")),y(a("ol","1.","decimal")),y(a("ol","a.","lower-alpha")),y(a("ol","i.","lower-roman")),y(a("ol","1)","decimal")),y(a("ol","a)","lower-alpha")),y(a("ol","i)","lower-roman"))]),A=x("semantics",[y(f("bold","**","**","strong")),y(f("bold",
"__","__","strong")),y(f("italic","*","*","em")),y(f("italic","_","_","em"))]),C=x("entities",[y(c("(c)","&copy;")),y(c("-","&mdash;"))]),D=x("capitalisation",[y(n.normalise()),y(n.capitalise())]);s=x("autocorrect",[y(d("autocorrect",s.lookup,function(a){return m.translate("aria.autocorrect.announce",a)}))]);var E=x("hr",[y(g("---","hr"))]),F=l.cached(function(a){a.runOrOnLoaded(function(b){var c=l.cached(function(){r.owner(b).dom().execCommand("AutoUrlDetect",!1,!1)});a.events.focus.bind(function(){c()})});
return x("link",[B(k,"a")])});return{headings:h.constant(w),semantics:h.constant(A),entities:h.constant(C),cases:h.constant(D),lists:h.constant(z),dynCustoms:function(){var a=v.get();return b.map(a,y)},link:F,hr:h.constant(E),corrections:h.constant(s)}}});k("w9",["33"],function(b){return b.immutable("startContainer","startOffset","endContainer","endOffset")});k("wa","b 1b 20 ei 9y 1r".split(" "),function(b,d,c,a,e,f){return{cloneAfter:function(g,h,l){var m=h;return b.map(g,function(b){var g=a.deep(b);
c.isText(b)&&d.eq(l.endContainer(),b)&&e.get(b).length>l.endOffset()&&e.set(g,e.get(g).substring(0,l.endOffset()));if(c.isText(g)&&0<m){var h=e.get(g);b=f.min(h.length,m);h=h.substring(b);e.set(g,h);m-=b}return g})}}});k("wb",["s","k"],function(b,d){return{matcher:function(c,a,e){var f=function(a){return e.fold(function(){return a&&1<a.length},function(b){return a&&0<a.length&&a.index+a[0].length===b})};return d.findMap(c,function(c){a:{if(!c.global)throw"Macro matching only works with global regexes: "+
c;for(var d=c.exec(a);d;){if(f(d)){c=b.some(d);break a}d=c.exec(a)}c=b.none()}return c})}}});k("p6","4i w9 wa wb 6 7 s ow".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a,d,g,h){d=c.cloneAfter(d,h.finishIndex(),g);var l=e.merge(h,{clones:f.constant(d)});return{build:function(c){c=a.generate(c,l);return b.applicator({elements:c.elements,cursor:c.cursor,range:f.constant(g),dictation:c.dictation,notify:c.notify})}}};return{detect:function(b,c,e,f){var k=c.patterns(),s=b.cursor().filter(c.useCursor);
return a.matcher(k,b.text(),s).bind(c.derive).bind(function(a){var b=h.top(e);if(0<b.length){var m=d(b[0],0,e,f);return g.some(l(c,b,m,a))}return g.none()})}}});k("p7",["4i","w9","wb","7","go"],function(b,d,c,a,e){var f=function(b,c,d){c=e.get(b,c);var f=e.get(b,d);return c.bind(function(b){return f.map(function(c){return{start:a.constant(b),finish:a.constant(c)}})})};return{detect:function(e,h,l,m){l=h.patterns();m=e.cursor().filter(h.useCursor);return c.matcher(l,e.text(),m).bind(h.derive).bind(function(c){return f(e.list(),
c.startIndex(),c.finishIndex()).map(function(e){var f=c.startIndex()-e.start().start(),g=c.finishIndex()-e.finish().start(),l=d(e.start().element(),f,e.finish().element(),g);return{build:function(d){d=h.generate(d,c);return b.applicator({elements:d.elements,cursor:d.cursor,range:a.constant(l),dictation:d.dictation,notify:d.notify})}}})})}}});k("wc",["54","b","s","33","5z"],function(b,d,c,a,e){var f=a.immutable("ch","offset"),g=function(a,b){return f(a.charAt(b),b)};return{previous:function(a,d){for(var e=
d.getOr(a.length)-1;0<=e;e--)if(a.charAt(e)!==b.zeroWidth())return c.some(g(a,e));return c.none()},next:function(a,d){for(var e=d.getOr(0)+1;e<a.length;e++)if(a.charAt(e)!==b.zeroWidth())return c.some(g(a,e));return c.none()},rfind:function(a,b){b.lastIndex=-1;var e=d.reverse(a).join(""),f=e.match(b);return void 0!==f&&null!==f&&0<=f.index?c.some(e.length-1-f.index):c.none()},lfind:function(a,b){b.lastIndex=-1;var d=a.match(b);return void 0!==d&&null!==d&&0<=d.index?c.some(d.index):c.none()}}});k("wd",
"7 s du kx hj mt ky 4g".split(" "),function(b,d,c,a,e,f,g,h){var l=e.walkers().left(),m=e.walkers().right(),n=h.generate([{abort:[]},{kontinue:[]},{finish:["info"]}]),k=h.generate([{aborted:[]},{edge:["element"]},{success:["info"]}]),q=function(a,b){return g.isEmptyTag(a,b)||a.property().isBoundary(b)},r=function(a,b,c,f,g,h,l){var m=function(){return l.fold(k.aborted,k.edge)},s=function(f){return e.walk(a,b,c,h).fold(m,function(b){return r(a,b.item(),b.mode(),d.none(),g,h,f)})};if(q(a,b))return m();
if(a.property().isText(b)){var u=a.property().getText(b);return g(a,n,b,u,f).fold(m,function(){return s(d.some(b))},k.success)}return s(l)},s=function(b,e,g,h){g=a.toLeaf(b,e,g);return b.property().isText(e)?d.none():f.left(b,g.element(),b.property().isText,h).map(function(a){return c.point(a,b.property().getText(a).length)})},t=function(b,e,g,h){g=a.toLeaf(b,e,g);return b.property().isText(e)?d.none():f.right(b,g.element(),b.property().isText,h).map(function(a){return c.point(a,0)})},u=function(a,
d,e){var f=b.curry(q,a);return s(a,d,e,f).orThunk(function(){return t(a,d,e,f)}).getOr(c.point(d,e))};return{repeatLeft:function(a,b,c,f){b=u(a,b,c);return r(a,b.element(),e.sidestep,d.some(b.offset()),f,l,d.none())},repeatRight:function(a,b,c,f){b=u(a,b,c);return r(a,b.element(),e.sidestep,d.some(b.offset()),f,m,d.none())}}});k("p8","7 s du hj wc wd 4v".split(" "),function(b,d,c,a,e,f,g){var h=g.exactly(["regex","attempt"]),l=function(a,b,c,d){return f.repeatLeft(a,b,c,d)},m=function(a,b,c,d){return f.repeatRight(a,
b,c,d)},n=function(e,f,g){var h=b.constant(!1);if(!e.property().isText(f))return d.none();var l=e.property().getText(f);return g<=l.length?d.some(c.point(f,g)):a.seekRight(e,f,e.property().isText,h).bind(function(a){return n(e,a,g-l.length)})};return{previousChar:function(a,b){return e.previous(a,b)},nextChar:function(a,b){return e.next(a,b)},repeatLeft:l,repeatRight:m,expandLeft:function(a,b,c,d){var f=h(d);return l(a,b,c,function(a,b,c,d,g){a=g.getOr(d.length);return e.rfind(d.substring(0,a),f.regex()).fold(function(){return b.kontinue()},
function(a){return f.attempt(b,c,d,a)})})},expandRight:function(a,b,c,d){var f=h(d);return m(a,b,c,function(a,b,c,d,g){var h=g.getOr(0);return e.lfind(d.substring(h),f.regex()).fold(function(){return b.kontinue()},function(a){return f.attempt(b,c,d,h+a)})})},scanRight:n}});k("hk",["dg","p8"],function(b,d){var c=b();return{previousChar:function(a,b){return d.previousChar(a,b)},nextChar:function(a,b){return d.nextChar(a,b)},repeatLeft:function(a,b,f){return d.repeatLeft(c,a,b,f)},repeatRight:function(a,
b,f){return d.repeatRight(c,a,b,f)},expandLeft:function(a,b,f){return d.expandLeft(c,a,b,f)},expandRight:function(a,b,f){return d.expandRight(c,a,b,f)},scanRight:function(a,b){return d.scanRight(c,a,b)}}});k("hd","do b p6 p7 9m il 7 du 8x hk 2k 20".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k){var q=function(a,b){var c=h.point(a,b);return k.isText(a)?m.scanRight(a,b).getOr(c):c},r=function(a){var b=q(a.startContainer(),a.startOffset());a=q(a.endContainer(),a.endOffset());return f(b.element(),b.offset(),
a.element(),a.offset())},s=function(a,c,f){return c.doc().bind(function(g){g=a.build(g);var h=g.elements();d.map(h,b.doNotMerge);var m=r(g.range());l.insertAt(c,m,h);d.map(h,b.clear);g.dictation().each(function(a){e.shout(n.body(),a())});g.notify().each(function(){f.input(h)});return g.cursor()})},t=function(a,b,c,d,e){return a.detect(b,c,d,e).map(function(a){return{execute:g.curry(s,a)}})};return{block:g.curry(t,c),inline:g.curry(t,a)}});k("9f","b hb 7 s k en hc hd".split(" "),function(b,d,c,a,e,
f,g,h){return function(l,m,n,k,q,r,s,t){var u=a.none(),v=a.none(),w=g(q,r,t),x=b.flatten([w.link(m),w.hr(),w.semantics(),w.entities()]),y=function(){return b.flatten([x,l.autocorrect().get()?w.corrections():[],l.capitalisation().get()?w.cases():[],w.dynCustoms()])},B=w.headings().concat(w.lists()),z=function(a,c,g,h){var l=f.descend(c,g),m=d.get(l.element(),l.offset());g=b.filter(h,function(a){return a.allowed(c)&&b.forall(m.list(),function(b){return a.allowed(b.element())})});return e.findMap(g,
function(b){return a(m,b,l.element(),l.offset())})},A=function(a,b){m.undoOperation(function(){a(function(){return b.execute(m,s)}).each(function(a){m.setSelection(a.element(),a.offset(),a.element(),a.offset())});m.domChanged()})};return{spaceDown:function(){m.getSelection().map(function(a){a.collapsed()&&(u=z(h.inline,a.startContainer(),a.startOffset(),y()))})},spaceUp:function(){var b=c.curry(A,k.run);u.each(b);u=a.none()},enterDown:function(){m.getSelection().map(function(a){a.collapsed()&&(v=
z(h.block,a.startContainer(),a.startOffset(),B.concat()));v=v.orThunk(function(){return z(h.inline,a.startContainer(),a.startOffset(),y())})})},enterUp:function(){var b=c.curry(A,c.apply);v.each(b);v=a.none()}}}});k("5k","7 6i 9f 9g 4x 3z".split(" "),function(b,d,c,a,e,f){return function(g,h,l,m){var n=g.profile(),k=g.content(),q=g.undo(),r=g.context(),s=g.operations();g=g.internalevents();var t=f.create({analytics:e(["message"])}),u=d(l.customs),v=c(n,k,q,s,h,u,g,m);k.events.keydown.bind(function(b){a.isSpace(b)&&
v.spaceDown()});k.events.keyup.bind(function(b){a.isSpace(b)&&v.spaceUp()});r.events.preLinebreak.bind(function(a){v.enterDown()});r.events.postLinebreak.bind(function(a){v.enterUp()});return{destroy:b.noop,events:t.registry,customMacros:b.constant(u),state:function(){return{customs:u.state()}}}}});k("he","7i 9m c fk 85 g9 dd 7 fm kd 6u fn 30 4x 3z 1a 1x l 2v 2m 35 2o 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t,u,v,w,x,y,B,z){var A=c.detect().deviceType.isTouch();return function(){var c=
s.create({insert:r(["embed"])}),D=v.fromTag("span"),E=m.textarea("media-embed","media.embed"),F=n.translate("media.placeholder"),G=d.describe(E.textarea(),F);x.append(E.element(),G);G=v.fromTag("span");u.add(G,q.resolve("media-icon"));t.set(G,"alt",n.translate("media.insert"));b.presentation(G);var I=f(),H=n.translate("media.insert");I.content(g(H));u.add(I.element(),[q.resolve("media-insert")]);k.makeDefault(I.element());b.button(I.element(),H);t.set(E.textarea(),"placeholder",F);y.append(D,[G,E.element(),
I.element()]);var L=function(){var a=z.get(E.textarea());c.trigger.insert(a);A&&w.blur(E.textarea())},F=[e.input(E.textarea(),a.input({})),e.button(I.element(),a.button({execute:l.click}))];I.events.click.bind(function(){L()});return{element:h.constant(D),execute:L,empty:function(){z.set(E.textarea(),"")},keylayouts:h.constant(F),events:c.registry,destroy:function(){I.destroy();B.remove(D)}}}});k("9i","9k 7i fk 85 7 6u he 30 3z 40 43".split(" "),function(b,d,c,a,e,f,g,h,l,m,n){return function(k){var q=
k.region(),r=k.content(),s=k.smartview(),t=g(),u=a.inlineDialog(t.element(),t.keylayouts(),c.inlineDialog({ok:t.execute,cancel:e.noop}));d.dialog(t.element(),f.translate("insert.media"));var v=b.popup(s.uiContainer,s.bounds,q,[]).initMenu(t.element());n.add(t.element(),[h.resolve("media-embed-dialog"),h.resolve("inline-dialog")]);u.events.exit.bind(function(){w()});var w=function(){v.closed()||(v.close(),t.empty(),r.focus(),u.exit())};k=l.create({insert:m(["embed"],t.events.insert)});return{element:t.element,
showPopup:function(a){v.open();a.show(q,r,s,v,t);u.enter()},isClosed:v.closed,events:k.registry,closePopup:w,destroy:function(){u.destroy();t.destroy();v.destroy()}}}});k("9j","7 hf g7 6u 30 4x 3z 1a 1x l 2v 2m hg 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r){return function(s){s=m.fromTag("div");l.add(s,e.resolve("media-widget"));var t=m.fromTag("span");l.add(t,e.resolve("media-widget-field"));var u=m.fromTag(q.isLarge()?"textarea":"input");l.add(u,e.resolve("media-widget-input"));var v=a.translate("media.placeholder");
h.set(u,"placeholder",v);h.set(u,"title",v);k.append(t,u);v=d([e.resolve("media-widget-insert")],"insert.media");k.append(t,v.element());k.append(s,t);var w=c.text(t,u),x=g.create({insert:f(["embed"]),toEditor:f([])}),y=function(){var a=r.get(u);x.trigger.insert(a);x.trigger.toEditor()};v.events.click.bind(function(){y()});return{element:b.constant(s),addEscape:function(a){k.append(t,a.element())},open:function(){r.set(u,"");n.focus(u)},close:b.noop,execute:function(){y()},destroy:b.noop,type:b.constant(w),
events:x.registry}}});k("5l","c 7 9h 8h 6u 9i 9j 6l".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var m=l.content(),n=function(){var a=f(l);a.events.insert.bind(function(a){a=a.embed();l.insertFilteredHtmlAtCursor(a);m.cursorIntoView();b()});m.events.mousedown.bind(a.closePopup);var b=function(){a.closePopup()};return{open:function(){a.showPopup(c)},close:b,isClosed:a.isClosed,destroy:function(){m.events.mousedown.unbind(a.closePopup);a.destroy()}}},k=function(){var b=g(l);b.events.insert.bind(function(a){a=
a.embed();l.insertFilteredHtmlAtCursor(a);m.cursorIntoView()});return a(l,b)},q=(b.detect().deviceType.isTouch()?k:n)();return{ui:h.ui({"media.general":{toggle:!1,value:"media",textkey:e.key("insert.media"),action:function(){(q.isClosed()?q.open:q.close)()},updateGeneral:d.noop,icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!0}}),destroy:function(){q.destroy()}}}});k("9o","7 30 1x l 2m 2o 65 3m".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){var n=a.fromTag("div");c.add(n,d.resolve("mentions-business-card"));
var k=l.initMenu(n),q=null,r=function(a,b,c){f.empty(n);e.append(n,c);k.open();a(b,k)};return{showFull:function(a){return function(b,c){g(q);q=h(function(){r(a,b,c)},500)}}(m.showUnder),showMini:b.curry(r,m.showAtSide),hide:function(){g(q);k.close()},destroy:function(){g(q);k.destroy()}}}});k("9p","a 1o s p 33 l o".split(" "),function(b,d,c,a,e,f,g){var h=e.immutable("rawData","extra"),l=function(c,d,e){if(b.isArray(d)&&b.isArray(e))return a.value(h(d,e));g.error(c+" callback parameters were not both arrays",
d,e);return a.error(c+" callback parameters were not both arrays")},m=function(b,c){if(d.isPrototypeOf(c))return a.value(f.fromDom(c));g.error(b+" was not a DOM element",c);return a.error(b+" was not a DOM element")};return function(a){var b=c.none();return{fetch:function(b,c){a.fetch(b,function(a,b){var d=l("fetch()",a,b);c(d)})},fetchExtra:function(b,c,d){a.menuExtra(b,c,function(a,b){var c=l("menuExtra()",a,b);d(c)})},menuHover:function(d,e){b=c.some(d.userid);a.menuHover(d,function(a){a=m("menuHover() callback",
a);b.is(d.userid)&&e(a)})},hover:function(b,c){a.hover(b.dom(),function(a){a=m("hover() callback",a);c(a)})},menuComplete:function(b){b=a.menuComplete(b);return m("menuComplete result",b)},hoverSelector:function(){return a.hoverSelector},isTrigger:function(a){return 64===a}}}});k("9q",["b","bs"],function(b,d){return{configure:function(c){var a=[c.internal(),c.history(),c.output()];b.each(a,function(a){c.addSelector(a,"span.ephox-polish-incomplete-mention",d.unwrap)})}}});k("p9","b fi 6 7 s 30 4g 4f 1a l 2d 35 2o 2y 9z q".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s,t){var u=f.resolve("no-results"),v=f.resolve("loading-results"),w=g.generate([{none:["item"]},{extra:["value","item"]},{fetched:["userId","name","rawname","info","item"]}]);return function(g){var y=d.mainmenu(m.fromDom(t),f.resolve("mentions-list"),[]),B=h({}),z=function(a){return a.userid},A=function(a){return a.name},C=function(a,b){r.child(a,".ephox-gopher-item-text").each(function(a){n.set(a,b)})},D=function(a){return b.map(a,function(a){var b=d.item(m.fromDom(t),
a.userid,a.name);C(b,a.name);return b})},E=function(a){return b.foldr(a,function(a,b){var d={};d[b.userid]=b;return c.merge(a,d)},{})},F=function(a,c){var e=D(a),f=b.map(c,function(a){return d.item(m.fromDom(t),a.key,a.value)});return e.concat(f)},G=function(a){var c=l.get(a,"data-ephox-gopher-item-value"),d=B.get();return void 0!==d[c]?w.fetched(d[c].userid,d[c].name,d[c].rawname,d[c],a):b.contains([v,u],c)?w.none(a):w.extra(c,a)};return{element:a.constant(y),selected:function(){return r.descendant(y,
".ephox-gopher-item-selected")},setData:function(a,b){var d=E(a);B.set(c.merge(B.get(),d));d=0===a.length?[{userid:u,name:g.get("mentions.lookahead.noresults")}]:a;d=F(d,b);q.empty(y);k.append(y,d)},getInfo:G,getUserId:function(b){return G(b).fold(e.none,e.none,a.compose(e.some,z))},setLoading:function(){var a=[{userid:v,name:g.get("mentions.lookahead.searching")}],a=F(a,[]);q.empty(y);k.append(y,a)},getName:function(b){return G(b).fold(e.none,e.none,a.compose(e.some,A))},refind:function(a){a=l.get(a,
"data-ephox-gopher-item-value");return void 0!==a&&null!==a?r.descendant(y,'[data-ephox-gopher-item-value="'+a+'"]'):e.none()},isOpen:function(){return s.isVisible(y)}}}});k("hh","9m 7 s p9 4x 3z 4g 4f 2k b1 v 65 o q 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,n,k,q,r,s){var t=g.generate([{nothing:[]},{refetch:["term"]},{open:["term"]}]);return function(g,k,p){var r=function(a){b.speak(l.body(),a)},q=a(p);g.setView(q.element());var s=h(""),z=function(a){C(a.rawData(),a.extra());g.reposition(c.none())},
A=function(a){var b=q.selected();a();return b.bind(q.refind)},C=function(a,b){r(p.get("mentions.lookahead.open"));g.updateItems(A,function(){q.setData(a,b)})},D=function(a){return q.isOpen()&&2<=a.length?t.refetch(a):2<=a.length?t.open(a):t.nothing()},E=function(a){a.fold(G,z)},F=f.create({accept:e(["information"]),menuHover:e(["element","info"]),none:e([])}),G=function(){g.cancel()};return{setData:C,isOpen:function(){return q.isOpen()},lookup:function(a,b){var c=n.startsWith(a,"@")?a.substring(1):
a;s.set(c);var e=d.noop;D(c).fold(e,function(a){k.fetch(a,E)},function(a){q.setLoading();g.open(b);k.fetch(a,E)})},close:function(){g.close()},onClick:function(a){q.getInfo(a).fold(function(){F.trigger.none()},function(a,b){k.fetchExtra(a,s.get(),E)},function(a,c,d,e,f){b.speak(l.body(),p.get("mentions.lookahead.selected",d));F.trigger.accept(e)})},onHover:function(a){r(m.get(a));q.getInfo(a).fold(d.noop,d.noop,function(a,b,c,d,e){F.trigger.menuHover(e,d)})},events:F.registry}}});k("hi","7 s 30 4x 3z 4f 1x l 2m 2o 9z".split(" "),
function(b,d,c,a,e,f,g,h,l,m,n){return function(k,q,r,s){var t=h.fromTag("div");g.add(t,c.resolve("mentions-lookahead-container"));var u=r.initMenu(t),v=f(d.none()),w=e.create({close:a([])}),x=function(){return n.isVisible(t)};r=function(){v.set(d.none());u.close()};u.events.close.bind(function(){q.close();w.trigger.close()});k.events.mousedown.bind(r);return{element:b.constant(t),destroy:function(){v.set(d.none());u.destroy()},setView:function(a){m.empty(t);l.append(t,a)},updateItems:function(a,
b){a(b).fold(function(){q.setActiveMenu(t)},function(a){q.select(a)})},reposition:function(a){a.isSome()&&v.set(a);x()&&v.get().each(function(a){s.showUnder(a,u)})},open:function(a){k.body().each(function(b){u.open();s.showUnder(a,u);v.set(d.some(a));q.open([q.sandbox()],b)})},isOpen:x,cancel:function(){v.set(d.none());w.trigger.close()},close:r,events:w.registry}}});k("9r",["s","hh","hi","3z","40"],function(b,d,c,a,e){return function(f,g,h,l,m,k){var p=c(f,g,h,l),q=d(p,m,k);f=a.create({menuHover:e(["element",
"info"],q.events.menuHover),accept:e(["information"],q.events.accept),close:e([],p.events.close)});q.events.none.bind(p.close);return{onHover:q.onHover,onClick:q.onClick,close:function(){q.isOpen()&&q.close();p.isOpen()&&p.cancel()},isOpen:p.isOpen,lookup:function(a,c){p.reposition(b.some(c));q.lookup(a,c)},destroy:function(){p.destroy()},events:f.registry}}});k("9t","co 7 s du hj 6b hk 5z".split(" "),function(b,d,c,a,e,f,g,h){var l=function(){return new h(f.wordbreak(),"i")},m=function(a,b,d){return g.repeatLeft(a,
d,function(a,b,c,d,e){return g.previousChar(d,e).fold(function(){return b.kontinue()},function(a){return b.finish(a.ch())})}).fold(c.none,c.none,c.some)},k=function(b,c,d,e){return 0<=e&&"@"===d.charAt(e)?b.finish(a.point(c,e)):b.abort()},p=function(b,c,d,e){return b.finish(a.point(c,e))},q=function(d){return c.some(a.point(d,b.getEnd(d)))};return{isValidMention:function(a,b){return m(a,e.sidestep,b).fold(d.constant(!0),function(a){return null===a.match(/[0-9a-zA-Z]/)})},scan:function(a,b){return g.expandLeft(a,
b,{regex:l,attempt:k}).fold(c.none,c.none,c.some).bind(function(d){return g.expandRight(a,b,{regex:l,attempt:p}).fold(c.none,q,c.some).map(function(a){return{start:d.element,soffset:d.offset,finish:a.element,foffset:a.offset}})})}}});k("9s","b s 9t 30 4g 20 68 2y 9y".split(" "),function(b,d,c,a,e,f,g,h,l){var m=e.generate([{none:[]},{bare:["text","start","soffset","finish","foffset"]},{incomplete:["text","element"]},{complete:["text","element"]}]),k=a.resolve("incomplete-mention"),p=function(a,b){return c.scan(a,
b).map(function(a){return m.bare("",a.start(),a.soffset(),a.finish(),a.foffset())})},q=function(a){if(f.isText(a))return l.get(a);a=g.descendants(a,f.isText);return b.map(a,l.get).join("")},r=function(a,b){return a.collapsed()?h.closest(a.startContainer(),b.hoverSelector()).fold(function(){return h.closest(a.startContainer(),"."+k).fold(function(){return p(a.startContainer(),a.startOffset())},function(a){return d.some(m.incomplete(q(a),a))})},function(a){return d.some(m.complete(q(a),a))}).getOrThunk(m.none):
m.none()};return{detect:function(a,b){return a.getSelection().map(function(a){return r(a,b)}).getOrThunk(m.none)},detectOn:r,withinIncomplete:function(a){return h.closest(a,"."+k)}}});k("9u","9s 30 1x 1b l 2m 2o".split(" "),function(b,d,c,a,e,f,g){var h=function(a){c.remove(a,d.resolve("incomplete-mention"));g.unwrap(a)};return{cancel:h,create:function(){var a=e.fromTag("span");c.add(a,d.resolve("incomplete-mention"));var b=e.fromText("@");f.append(a,b);return a},validatePrevious:function(c,d){b.withinIncomplete(c).filter(function(c){return b.withinIncomplete(d).forall(function(b){return!a.eq(c,
b)})}).each(h)}}});k("9v","b s 30 4x 3z 4f 2k 3n l 6e 2y 65 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q){var r="."+c.resolve("mentions-business-card");return function(c,t){var u=f([]),v=null,w=null,x=e.create({contentHover:a(["target"]),stopHover:a([]),menuHover:a(["info"])});c.runOrOnLoaded(function(a){u.set([h.bind(a,"mouseover",function(a){A(a)}),h.bind(g.body(),"mouseover",function(a){k.closest(a.target(),r).each(B)}),h.bind(a,"mouseout",function(a){C(a)}),h.bind(g.body(),"mouseout",function(a){D(a)})])});
var y=function(a){p(v);p(w);v=q(function(){x.trigger.contentHover(a)},300)},B=function(){p(w)},z=function(){p(v);w=q(function(){x.trigger.stopHover()},300)},A=function(a){k.closest(a.target(),t).each(function(a){y(a);x.trigger.contentHover(a)})},C=function(a){if(!m.closest(a.target(),t))return!1;d.from(a.raw().relatedTarget||a.raw().toElement).map(l.fromDom).filter(function(a){return m.closest(a,t)}).isNone()&&z()},D=function(a){if(!m.closest(a.target(),r))return!1;d.from(a.raw().relatedTarget||a.raw().toElement).map(l.fromDom).filter(function(a){return m.closest(a,
r)}).isNone()&&z()};return{destroy:function(){b.each(u.get(),function(a){a.unbind()})},events:x.registry}}});k("9w",["a","bd","6u","9"],function(b,d,c,a){var e=function(a,b){return 1<arguments.length||/\{(\d+)\}/.test(a)?d.tokens.call(void 0,a,b):a};return function(d){return{get:function(g){var h=d[g];return b.isString(h)?e(h,a.prototype.slice.call(arguments,1)):c.translate.apply(void 0,arguments)}}}});k("hl",["7","h6","ea","jj"],function(b,d,c,a){return function(e){return{show:function(a,g,h,l,m){g=
d(0);a=a.directionAt(e);a=c.mainmenu(h,b.constant(e),g,a);h.show(l,a);l.setComponents([e,m.element()])},showWith:function(d,g,h,l,m,k){d=d.directionAt(e);d=c.submenu(h,b.constant(e),d,a.available);h.show(l,d);l.setComponents([e,m.element()])}}}});k("9x",["7","hl","hm","2p","w"],function(b,d,c,a,e){return function(e,g,h,l){return{showAtSide:function(l,k){d(l).showWith(e,g,h,k,{element:b.constant(k.element())},c.generate(0,0,a.get(l),0))},showUnder:function(a,c){d(a).show(e,g,h,c,{element:b.constant(c.element())})}}}});
k("5m","54 9k 9l b 9m 8w 9n 7 8x 9o 9p 9q 9r 9s 9t 9u 9v 9w 9x 2k 2l l 2v 2m 20 68 2o 9y 9z w".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r,s,t,u,v,w,x,y,B,z,A,C,D,E,F,G,I){return function(H,L){var J=v(L.aria),K=H.content(),M=H.smartview(),Q=H.region(),R=H.operations(),P=k(L),O=d.menuSystem(M.uiContainer,h.constant("mentions"),c.menu({focusActive:!1}));y.set(O.sandbox(),"z-index",I(void 0!==L.zIndex?L.zIndex:1E6));var V=d.popup(O.sandbox,M.bounds,Q,[]),M=w(Q,K,M,O.sandbox()),U=q(K,O,V,M,P,J),N=
m(V,M);p.configure(H.filter());var X=u(K,P.hoverSelector());U.events.menuHover.bind(function(a){P.menuHover(a.info(),function(b){b.fold(h.noop,function(b){G.isVisible(a.element())&&N.showMini(a.element(),b)})})});X.events.contentHover.bind(function(a){P.hover(a.target(),function(b){b.fold(h.noop,function(b){U.close();N.showFull(a.target(),b)})})});X.events.stopHover.bind(function(a){N.hide()});O.events.itemHover.bind(function(a){a=a.item();U.onHover(a);K.backupSelection();z.focus(a);K.focus()});O.events.itemAction.bind(function(a){U.onClick(a.item())});
K.events.nodeChanged.bind(function(a){K.getSelection().each(function(b){b.collapsed()&&(r.detectOn(b,P).fold(U.close,U.close,h.noop,U.close),a.prev().each(function(a){t.validatePrevious(a,b.startContainer())}))})});K.events.keyup.bind(function(b){K.getSelection().each(function(c){c.collapsed()&&(a.contains(T,b.original().raw().which)||r.withinIncomplete(c.startContainer()).each(function(b){var c=D.descendants(b,C.isText),c=a.map(c,F.get).join("");U.lookup(c,b);N.hide()}))})});K.events.keypress.bind(function(a){var b=
a.original();P.isTrigger(b.raw().which)&&K.getSelection().each(function(a){s.isValidMention(a.startContainer(),a.startOffset())&&(a=function(){var a=t.create();l.insertAtCursor(K,[a]).each(function(a){K.setSelection(a.element(),a.offset(),a.element(),a.offset())});b.kill();e.speak(x.body(),J.get("mentions.initiated"))},r.detect(K,P).fold(a,a,h.noop,h.noop))})});var T=a.flatten([g.ENTER(),g.DOWN(),g.UP()]);H.context().events.preLinebreak.bind(function(a){W(function(b,c){U.isOpen()?a.handler().handle():
$()},h.noop)});K.events.keydown.bind(function(b){var c=b.original().raw().which;a.contains(g.ESCAPE(),c)?W(function(){$();b.original().kill()},h.noop):a.contains(T,c)&&U.isOpen()&&(O.simulateKey(b.original()),b.original().kill())});var W=function(a,b){r.detect(K,P).fold(b,b,a,b)},Z=function(a){W(function(c,d){P.menuComplete(a).each(function(a){A.after(d,a);E.remove(d);var c=B.fromText(b.zeroWidth());A.after(a,c);K.setRelativeSelection(f.after(c),f.after(c));ba()})},ba)},ba=function(){N.hide();U.close()},
$=function(){W(function(a,b){e.speak(x.body(),J.get("mentions.lookahead.cancelled"));R.atomic(function(){t.cancel(b)});ba()},ba)};U.events.close.bind($);U.events.accept.bind(function(a){Z(a.information())});return{destroy:function(){U.destroy();N.destroy();X.destroy();O.destroy()}}}});k("a0",["b","s","6u","33"],function(b,d,c,a){var e=a.immutable("textkey","value","icon");return function(a){var g=function(a){var b;b={zh:"zh_cn",pt:"pt_br"};b=void 0===b[a]?a:b[a];b=c.has("parlance."+b)?c.key("parlance."+
b):c.raw(b);return e(b,a,d.none())},h=b.map(a.languages,g);return{build:function(c){return c.filter(function(c){return!b.contains(a.languages,c)}).fold(function(){return h},function(a){return h.concat([g(a)])})}}}});k("5n","7 s 72 73 a0 6u 6l 71 75 a1 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,k){return function(p,q){var r=p.content(),s=p.undo(),t=e(q),u=function(){return r.on(function(a){return m.language(a).fold(h.off,h.on)}).getOrThunk(h.unchanged)};return{ui:g.ui({"parlance.dropdown":b.constant({name:"parlance",
textkey:f.key("parlance.set"),updateDropdown:function(a){var c=u(),e=c.fold(d.none,d.none,d.some),e=t.build(e);a.populate([{label:d.none,items:b.constant(e)}]);c.fold(a.deactivate,b.noop,a.activate);c.fold(a.untick,b.noop,a.tick)},action:function(d){var e=function(a){return l.language(r.isRoot,a,d)};a.cata(p.selections().get(),b.noop,c.multiple(r,s,e),c.single(r,s,e));k(function(){r.uiChanged()},0)},values:t.build(d.none()),render:d.none(),toggle:!1,describe:function(){return f.key("parlance.set")}})},
b.identity),destroy:b.noop}}});k("pa",["7i","7","6u","l"],function(b,d,c,a){return function(){var e=a.fromTag("textarea");b.label(e,c.translate("plaincode.dialog.editor"));b.textarea(e);return{element:d.constant(e)}}});k("hn","85 jq 9n s fl fm pa 6u fn 30 4x 3z 1x 2z".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){return function(s){var t=p.create({execute:k(["html"]),close:k([])}),u=e(s);q.add(u.element(),m.resolve("plaincode-modal"));u.setTitle(h.translate("plaincode.dialog.title"));var v=function(){w();
t.trigger.close()},w=function(){u.hide()},x=g();u.setContent(x.element());s=l.okCancel("plaincode");s.events.ok.bind(function(){t.trigger.execute(r.get(x.element()));v()});s.events.cancel.bind(function(){v()});u.events.close.bind(function(){y.exit();v()});u.setControls(s.element());var y=f.setup(u,s,[b.single(x.element(),[d.rule(d.is(c.ENTER()[0]),function(b){b.raw().stopPropagation();return a.none()})],a.none())]);return{element:u.element,open:function(){u.show();y.enter()},setHtml:function(a){r.set(x.element(),
a)},destroy:function(){u.destroy();y.destroy()},hide:w,events:t.registry}}});k("a2",["hn","4x","3z"],function(b,d,c){return function(a){var e=b(a),f=function(){g.trigger.close();e.events.close.unbind(f);e.events.execute.unbind(h);e.destroy()},g=c.create({execute:d(["html"]),close:d([])}),h=function(a){g.trigger.execute(a.html())};e.events.close.bind(f);e.events.execute.bind(h);return{show:function(){e.open()},setHtml:e.setHtml,events:g.registry}}});k("5o",["7","a2"],function(b,d){return function(c,
a){var e=c.content(),f=c.shortcuts(),g=c.smartview(),h=a.setContent,l=a.getContent;f.events.plaincode.bind(function(){m()});var m=function(){var a=d(g.uiContainer());a.events.close.bind(function(){e.toEditing()});a.events.execute.bind(function(a){h(a.html())});e.toReading();a.setHtml(l());a.show()};return{destroy:b.noop}}});k("a4",["7","30"],function(b,d){var c=d.resolve("resizable"),a=d.resolve("no-resize");return{style:b.constant(c),noStyle:b.constant(a)}});k("a5",["b","7","30","bs","43"],function(b,
d,c,a,e){var f=c.resolve("resize-eph-block"),g=c.resolve("resize-eph-container"),h=c.resolve("resize-eph-resizer"),l=c.resolve("resize-eph-target"),m=c.resolve("element-resize-selected"),k=function(a){e.remove(a,[f,g,h,l,m])};return{configure:function(c){var d=[c.internal(),c.history(),c.output(),c.paste()];b.each(d,function(b){c.add(b,f,a.remove);c.add(b,g,a.unwrap);c.add(b,h,a.remove)});d=function(a){b.each(a,k)};c.add(c.output(),l,d);c.add(c.history(),l,d)},clean:k,resizeBlock:d.constant(f),resizeContainer:d.constant(g),
resizer:d.constant(h),resizeTarget:d.constant(l),resizeSelected:d.constant(m)}});k("hp","s 4x 3z 2l 64 2p v 1r".split(" "),function(b,d,c,a,e,f,g,h){return function(){var l=c.create({grow:d(["x","y"])}),m=1,k=1,p=b.none(),q=function(c){return a.getRaw(c,"width").bind(function(a){return g.endsWith(a,"px")?b.some(parseInt(a,10)):b.none()}).getOrThunk(function(){return f.get(c)})};return{setTarget:function(a){p=b.some(a);k=f.get(a)/(e.get(a)+0)},setMultiplier:function(a){m=a},clearTarget:function(){p=
b.none()},mutate:function(a,b){p.each(function(c){var d=q(c)+m*a,g=1===d?1:h.floor(d/k);5<=d&&5<=g&&(f.set(c,d),e.set(c,g));l.trigger.grow(a,b)})},events:l.registry}}});k("hq","b a5 30 4x 3z 1a 1x 43 2l 3n l 64 2m 35 2o 29 2p q cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r,s,t,u,v,w){return function(x){var y=x.doc().getOr(k.fromDom(v)),B=k.fromTag("span",y.dom());f.set(B,"contenteditable","false");l.set(B,"position","relative");h.add(B,[c.resolve("element-resize-container"),d.resizeContainer()]);
var z="data-"+c.resolve("resize-direction"),A=function(a,b){var e=k.fromTag("span",y.dom());h.add(e,[c.resolve(a),d.resizer()]);f.set(e,z,b);return e};x=A("element-se-resize","1");var C=A("element-ne-resize","1"),D=A("element-sw-resize","-1"),A=A("element-nw-resize","-1"),E=[x,C,D,A],F=k.fromTag("span",y.dom());r.append(B,[F].concat(E));h.add(F,[c.resolve("element-resize-border"),d.resizeContainer()]);var G=function(a){l.getRaw(a,"display").filter(function(a){return"block"===a}).fold(function(){l.remove(B,
"display");l.remove(F,"margin");l.remove(F,"display")},function(b){l.set(B,"display","block");l.set(F,"display","block");l.getRaw(a,"margin").each(function(a){l.set(F,"margin",a)})})},I=function(){t.firstChild(F).each(function(a){q.before(B,a);s.remove(B);d.clean(a)})},H=e.create({click:a(["multiplier"])}),L=m.bind(B,"mousedown",function(a){g.has(a.target(),d.resizer())&&(a.prevent(),a=f.get(a.target(),z),a=void 0!==a?w(a,10):1,H.trigger.click(a))});return{connect:function(){},destroy:function(){L.unbind();
I()},components:function(){return[B]},show:function(a){b.each([B,F].concat(E),s.empty);r.append(B,[F].concat(E));var c=l.getRaw(a,"float");G(a);I();var e=u.getOuter(a),f=p.getOuter(a);q.before(a,B);q.append(F,a);l.setAll(F,{width:e-2+"px",height:f-2+"px"});h.add(a,[d.resizeSelected(),d.resizeTarget()]);c.fold(function(){l.remove(B,"float")},function(a){l.set(B,"float",a)})},hide:I,isOver:function(a){return g.has(a,d.resizeSelected())},cleanup:function(){I()},events:H.registry}}});k("a6","ho s a5 hp hq 30 4x 3z 1x q 31".split(" "),
function(b,d,c,a,e,f,g,h,l,m,k){return function(m){var k=e(m),n=d.none(),s=a();s.events.grow.bind(function(){k.hide()});var t=b.transform(s,{layerClass:f.resolve("layer-below-dialog")});t.events.stop.bind(function(){n.each(function(a){k.show(a);v.trigger.stop(a)})});l.add(t.element(),c.resizeBlock());var u=function(){t.off();s.clearTarget();n=d.none();k.hide()},v=h.create({stop:g(["target"])});return{connect:function(){k.connect();k.events.click.bind(function(a){m.body().each(function(b){s.setMultiplier(a.multiplier());
t.go(b)})})},components:function(){return n.fold(function(){return k.components()},function(a){return[a].concat(k.components())})},open:function(a){u();s.setTarget(a);n=d.some(a);t.on();k.show(a)},close:u,isOver:k.isOver,events:v.registry,cleanup:function(){k.cleanup()},destroy:function(){k.destroy();t.destroy()}}}});k("5p","a3 8w 7 9g 70 a4 a5 a6 1x 20 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,k){return function(k,n){var r=k.filter(),s=k.content(),t=k.undo();g.configure(r);var u=h(s),v=b(u.close,
u.components),w=function(a){e.detect(s).each(function(b){t.save();e.remove(s,u,b.image());s.domChanged();t.save();a.original().kill()})},x=function(a){e.detect(s).each(function(b){s.setRelativeSelection(d.before(b.container()),d.before(b.container()));a.original().kill()})},y=function(a){e.detect(s).each(function(b){s.setRelativeSelection(d.after(b.container()),d.after(b.container()));a.original().kill()})};s.events.nodeChanged.bind(function(){e.detect(s).fold(function(){u.close()},c.noop)});s.events.keydown.bind(function(b){a.isDel(b)||
a.isBackspace(b)?w(b):a.isLeftOrUp(b)?x(b):a.isRightOrDown(b)&&y(b)});var B=function(a){return("img"===m.name(a)||l.has(a,f.style()))&&!l.has(a,f.noStyle())},z=function(a){B(a)&&(u.open(a),e.select(s,a))};s.events.mouseup.bind(function(a){a=a.original().target();z(a)});n.events.changed.bind(function(a){a=a.image();z(a)});s.events.mousedown.bind(function(a){var b=a.original().target();B(b)&&u.isOver(b)&&a.original().raw().preventDefault();v.mousedown(a.original())});s.events.loaded.bind(function(){try{s.execCommand("enableObjectResizing",
!1,!1)}catch(a){}u.connect()});u.events.stop.bind(function(a){e.select(s,a.target())});return{cleanup:function(){u.cleanup()},destroy:function(){u.destroy()}}}});k("ht","a 1n ap 7 4v 2l l 2d 2m 2o 3m".split(" "),function(b,d,c,a,e,f,g,h,l,m,k){var p=function(a,c){if(void 0!==a&&b.isFunction(a.setData))try{return d.each(c,function(b,c){a.setData(c,b())}),!0}catch(e){return!1}else return!1},q=function(a,b,d){var e=g.fromTag("div",a.doc().dom());f.setAll(e,{position:"absolute",top:"-1000px"});b=b["text/html"]();
h.set(e,b);l.append(a.body(),e);var p=a.getSelection();c.selectElementContents(a.win(),e);k(function(){m.remove(e);p.each(function(b){a.setSelection(b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())});k(d,0)},0)},r=function(a){return function(c,d,e){var f=c.raw();if(!b.isString(f.type)||"copy"!==f.type.toLowerCase()&&"cut"!==f.type.toLowerCase())throw"Can only set the clipboard with a cut or copy event";if(!b.isFunction(d["text/html"]))throw"Must provide at least text/html data function when setting clipboard contents";
p(f.clipboardData,d)?(c.kill(),k(e,0)):a(d,e)}},s=e.exactly(["doc","win","body","getSelection","setSelection"]);return{register:function(b){s(b);b=a.curry(q,b);return{setClipboard:r(b)}},textMime:a.constant("text/plain"),htmlMime:a.constant("text/html")}});k("pd",["20","e5"],function(b,d){var c=d(b.isComment,"comment");return{get:function(a){return c.get(a)},getOption:function(a){return c.getOption(a)},set:function(a,b){c.set(a,b)}}});k("hs","b 7 r s k ht pd 20 v".split(" "),function(b,d,c,a,e,f,
g,h,l){var m={clipboardType:d.constant("x-textbox/html"),findClipboardTags:function(c){c=e.cat(b.map(c,function(b){if(h.isComment(b)){var c=g.get(b);if(l.contains(c,"x-textbox/html"))return a.some(b)}return a.none()}));return 0===c.length?a.none():a.some(c)}};return{intraFlag:d.constant(m),buildClipboardContents:function(a,b){var e={};e["x-textbox/html"]=d.constant("true");e[f.textMime()]=c.cached(a);e[f.htmlMime()]=c.cached(function(){return"\x3c!-- x-textbox/html --\x3e"+b()});return e}}});k("hu",
"b 1n 33 pe pf 1a 2l l 2m 2o 46 m".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p){var q=c.immutable("minRow","minCol","maxRow","maxCol"),r=function(a,b){var c=a.grid().columns(),e=a.grid().rows(),f=c,g=0,h=0;d.each(a.access(),function(a){if(b(a)){var c=a.row(),d=c+a.rowspan()-1,l=a.column();a=l+a.colspan()-1;c<e?e=c:d>g&&(g=d);l<f?f=l:a>h&&(h=a)}});return q(e,f,g,h)},s=function(a,b,c,d){for(var f=b.grid().columns(),g=b.grid().rows(),m=0;m<g;m++)for(var k=!1,n=0;n<f;n++)if(!(m<c.minRow()||m>c.maxRow()||
n<c.minCol()||n>c.maxCol()))if(e.getAt(b,m,n).filter(d).isNone()){var p=k,r=a[m].element(),q=h.fromTag("td");l.append(q,h.fromTag("br"));(p?l.append:l.prepend)(r,q)}else k=!0},t=function(a,c){var d=b.filter(k.descendants(a,"tr"),function(a){return 0===a.dom().childElementCount});b.each(d,m.remove);c.minCol()!==c.maxCol()&&c.minRow()!==c.maxRow()||b.each(k.descendants(a,"th,td"),function(a){f.remove(a,"rowspan");f.remove(a,"colspan")});f.remove(a,"width");f.remove(a,"height");g.remove(a,"width");g.remove(a,
"height")};return{extract:function(c,d){var f="."+d,g=function(a){return p.is(a.element(),f)},h=a.fromTable(c),l=e.generate(h),q=r(l,g),A=k.descendants(c,"th:not("+f+"),td:not("+f+")");b.each(A,m.remove);s(h,l,q,g);t(c,q);return c}}});k("a7","b hr 7 73 dx e7 hs ht hu am l 2m 2o ei".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){var s=function(a){b.each(a,function(a){q.empty(a);p.append(a,k.fromTag("br"))})},t=function(a){return m.table(a[0]).map(r.deep).map(function(a){return[l.extract(a,d.selectedClass())]})},
u=function(a,d){var l=c.curry(d.filterDom,d.output()),m=h.register({doc:a.doc,win:a.win,body:a.body,getSelection:a.getSelection,setSelection:a.setSelection});return function(d,h,k){b.each(h,l);var n=c.curry(e.toText,h);h=c.curry(e.toHtml,h);var n=g.buildClipboardContents(n,h),p=f.fromSafe(a);p.begin();m.setClipboard(d,n,function(){p.end();k.apply(void 0,arguments)})}},v=function(b,d,e){var f=function(b,f){a.cata(d.get(),c.noop,function(a){t(a).each(function(d){e(b,d,c.curry(f,a))})},c.noop)};b.events.cut.bind(function(a){f(a.original(),
s)});b.events.copy.bind(function(a){f(a.original(),c.noop)})};return function(a,b){var d=a.content(),e=a.filter(),f=a.selections();d.events.ready.bind(function(a){a=a.api();var b=u(a,e);v(a,f,b)});return{destroy:c.noop}}});k("pg",["48"],function(b){return{resolve:b.create("ephox-cement").resolve}});k("hv",["pg","7"],function(b,d){var c=b.resolve("smartpaste-eph-bin");return{binStyle:d.constant(c)}});k("ph",["7","s","2m","2o"],function(b,d,c,a){return function(e,f){var g=function(c,e,f){c(f,e);return d.some({element:b.constant(e),
cleanup:function(){a.remove(e)},splits:b.constant([])})},h=function(a){return{none:d.none,start:b.curry(g,c.before,a),end:b.curry(g,c.after,a),middle:function(b,d,e){return g(c.after,a,d)}}},l=function(a){var d=function(a){return function(b,d){c.appendAt(b,d,a)}};return{prepend:b.curry(g,c.prepend,a),before:b.curry(g,c.before,a),after:b.curry(g,c.after,a),insertAt:function(b,c){return g(d(c),a,b)},append:b.curry(g,c.append,a)}};return{before:{text:h(e),element:{hasPrevious:l(e).insertAt,first:l(e).prepend,
empty:l(e).before,otherwise:l(e).append}},after:{text:h(f),element:{hasNext:l(f).insertAt,rightEdge:l(f).append,empty:l(f).after,otherwise:l(f).append}},general:{insertBefore:l(e).before,insertAfter:l(f).after}}}});k("hw","b 8w i7 bt 8x ph e7 pi 2k l 2o 6e".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p){return function(q){var r=g.fromUnsafe(q),s=m.fromTag("span"),t=m.fromTag("span");b.each([s,t],q.markAsEphemeral);var u=f(s,t);return{backup:function(){q.getSelection().each(function(a){a.collapsed()?
(e.insertAtCursor(q,[s]),k.unwrap(t),r.begin()):h.both(u,a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})},insert:function(f,g,h){q.setRelativeSelection(d.after(s),l.inBody(t)?d.before(t):d.after(s));e.insertAtCursorWith(q,f,g,h).each(function(a){p.ancestor(a.element(),"table")?q.setSelection(a.element(),0,a.element(),0):q.setRelativeSelection(d.after(a.element()),d.after(a.element()))});r.end();q.getSelection().each(function(b){b=c.toLeaf(b.startContainer(),b.startOffset());a.cursorIntoView(q,
b.element())});b.each([s,t],k.unwrap)},cancel:function(){b.each([s,t],k.unwrap)}}}});k("pl","b ez 7 s 73 1a cy".split(" "),function(b,d,c,a,e,f,g){return{mergable:function(b,f){return e.cata(f.get(),a.none,function(e,f){return 0===e.length?a.none():d.retrieveBox(b).bind(function(b){return 1<e.length?a.some({bounds:c.constant(b),cells:c.constant(e)}):a.none()})},a.none)},unmergable:function(d,l){var m=function(a){return f.has(a,"rowspan")&&1<g(f.get(a,"rowspan"),10)||f.has(a,"colspan")&&1<g(f.get(a,
"colspan"),10)},k=e.cata(l.get(),c.constant([]),c.identity,c.constant([d]));return 0<k.length&&b.forall(k,m)?a.some(k):a.none()}}});k("ii",["7","s","pl","33"],function(b,d,c,a){var e=function(a){return{element:b.constant(a),mergable:d.none,unmergable:d.none}};a=a.immutable("element","clipboard","generators");return{noMenu:e,forMenu:function(a,d,e){return{element:b.constant(e),mergable:b.constant(c.mergable(d,a)),unmergable:b.constant(c.unmergable(e,a))}},caption:function(a){return e(a)},paste:a}});
k("hx","pj b 7 s if pk ii am ik 20 b1".split(" "),function(b,d,c,a,e,f,g,h,l,m,k){var p=function(a){return"table"===m.name(a)||0===k.get(a).trim().length},q=function(b){var c=d.filter(b,function(a){return"table"===m.name(a)});return 1!==c.length?a.none():d.forall(b,p)?a.from(c[0]):a.none()};return{rules:function(a,d,m){var k=c.noop,n=function(b,n){return h.table(b).bind(function(h){var p=a.doc().getOrDie(),p=f.paste(p),p=g.paste(b,n,p),q=c.constant(m);return e.execute(d,l.pasteCells,k,q)(a,h,p).map(function(a){return a.startContainer()})})},
p=function(a){return q(a).map(function(a){return{single:c.constant(a)}})};return{collapsed:c.constant(b(function(a,b,c){return h.cell(b)},p,function(a,b){return n(a.element(),b.single())},"custom arcade table insert collapsed")),ranged:c.constant(b(function(a,b,d){return h.cell(b.element()).map(function(a){return{left:c.constant(a),right:c.constant(a)}})},p,function(a,b){return n(a.left(),b.single())},"custom arcade table insert ranged"))}},extractTable:q}});k("12v",["b","33","o"],function(b,d,c){var a=
"officeStyles htmlStyles isWord proxyBin isInternal backgroundAssets".split(" "),e=d.immutableBag([],a);return{nu:e,merge:function(c,d){var h={};b.each(a,function(a){d[a]().or(c[a]()).each(function(b){h[a]=b})});return e(h)}}});k("102",["s","4g"],function(b,d){var c=d.generate([{error:["message"]},{paste:["elements","assets","correlated"]},{cancel:[]},{incomplete:["elements","assets","correlated","message"]}]),a=function(a,b,c,d,l){return a.fold(b,c,d,l)};return{error:c.error,paste:c.paste,cancel:c.cancel,
incomplete:c.incomplete,cata:a,carry:function(d,f){return a(d,b.none,b.none,b.none,function(d,e,l,m){return a(f,b.none,function(a,d,e){return b.some(c.incomplete(a,d,e,m))},b.none,b.none)}).getOr(f)}}});k("12u",["12v","102","3j","33"],function(b,d,c,a){var e=a.immutableBag(["response","bundle"],[]),f=function(a){return g(function(b){var c=e(a);b(c)})},g=function(a){return c(g,function(b){a(b)})};return{call:function(a,b){a(e(b))},sync:g,pure:f,pass:function(a){return f({response:a.response(),bundle:a.bundle()})},
done:e,error:function(a){return f({response:d.error(a),bundle:b.nu({})})},initial:function(){return f({response:d.paste([],[],[]),bundle:b.nu({})})},cancel:function(){return f({response:d.cancel(),bundle:b.nu({})})}}});k("101","12u 12v 102 b 7 k 33".split(" "),function(b,d,c,a,e,f,g){var h=g.immutable("steps","input","label","capture"),l=function(a,b){return f.findMap(a,function(a){return a.getAvailable(b).map(function(b){return h(a.steps(),b,a.label(),a.capture())})})},m=function(a,f){var g=e.curry(b.pass,
a),h=function(){return f().map(function(e){var f=d.merge(a.bundle(),e.bundle());e=c.carry(a.response(),e.response());return b.done({response:e,bundle:f})})};return c.cata(a.response(),g,h,g,h)};return{choose:function(a,b,c){return l(a,c).getOrThunk(function(){var a=b.getAvailable(c);return h(b.steps(),a,b.label(),b.capture())})},run:function(c,d){return a.foldl(c,function(a,b){return a.bind(function(a){return m(a,function(){return b(d,a)})})},b.initial()).map(function(a){return a.response()})}}});
k("103",["c","7","3m"],function(b,d,c){var a=b.detect();b=function(a,b,c){b.control.block();a.dom().execCommand("paste");c();b.control.unblock()};var e=function(a,b,d){c(d,1)},f=(a=a.browser.isIE()&&10>=a.browser.version.major)?b:e;return{willBlock:d.constant(a),run:function(a,b,c){return f(a,b,c)}}});k("we","101 102 b 7 dv 4x 3z 103".split(" "),function(b,d,c,a,e,f,g,h){return function(l,m){var k=g.create({cancel:f([]),error:f(["message"]),insert:f(["elements","assets","correlated"])}),p=e.tap(function(a){h.willBlock()&&
(p.control.block(),a.preventDefault());var e=b.choose(l,m,a);e.capture()&&a.preventDefault();a=c.map(e.steps(),function(a){return a(p.control)});b.run(a,e.input()).get(function(a){d.cata(a,function(a){k.trigger.error(a)},function(a,b,c){k.trigger.insert(a,b,c)},function(){k.trigger.cancel()},function(a,b,c,d){k.trigger.insert(a,b,c);k.trigger.error(d)})})});return{paste:p.instance,isBlocked:p.control.isBlocked,destroy:a.noop,events:k.registry}}});k("104",["7"],function(b){return{blocking:function(b){return function(c){return function(a,
e,f){c.block();return b(a,e,f).map(function(a){c.unblock();return a})}}},normal:function(d){return b.constant(d)}}});k("12w","b 2f fx 3l fy 7 s".split(" "),function(b,d,c,a,e,f,g){return{convert:function(b){var f=d.resolve("window.clipboardData.files"),m=void 0!==b.convertURL?b.convertURL:void 0!==b.msConvertURL?b.msConvertURL:void 0;return void 0!==f&&void 0!==m&&0<f.length?(f=a.mapM(f,function(a){var d=e.createObjectURL(a);m.apply(b,[a,"specified",d]);return c.singleWithUrl(a,d)}),g.some(f)):g.none()}}});
k("105",["12w","3l","7","s"],function(b,d,c,a){return{background:function(){var c=a.none();return{convert:function(a){c=b.convert(a)},listen:function(a){return c.fold(function(){return d.nu(function(a){a([])})},function(a){return a}).get(a)},clear:function(){c=a.none()}}},ignore:function(){return{convert:a.none,listen:function(a){a([])},clear:c.noop}}}});k("106",["s","k","5z"],function(b,d,c){var a=function(a,f){var g=new c(f,"i");return d.findMap(a,function(a){return null!==a.match(g)?b.some({type:a,
flavor:f}):b.none()})};return{isValidData:function(a){return void 0!==a&&void 0!==a.types&&null!==a.types},getPreferredFlavor:function(b,c){return d.findMap(b,function(b){return a(c,b)})},getFlavor:a}});k("qr",["6","4g"],function(b,d){var c=d.generate([{none:[]},{error:["message "]},{blob:["blob"]}]);return b.merge(c,{cata:function(a,b,c,d){return a.fold(b,c,d)}})});k("10s",["2g"],function(b){return function(d,c){return new (b.getOrDie("Blob"))(d,c)}});k("10t",["2g"],function(b){return function(d){return new (b.getOrDie("Uint8Array"))(d)}});
k("wz","qr 10s 10t rx s p v 9 1r".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(b,e){for(var f=a.atob(b),g=f.length,m=l.ceil(g/1024),k=new h(m),u=0;u<m;++u){for(var v=1024*u,w=l.min(v+1024,g),x=new h(w-v),y=0;v<w;++y,++v)x[y]=f[v].charCodeAt(0);k[u]=c(x)}return d(k,{type:e})};return{convert:function(a){if(g.startsWith(a,"data:image/")&&11<a.indexOf(";base64,")){var c=a.indexOf(";"),d=a.substr(5,c-5);a=a.substr(c+8);try{return b.blob(m(a,d))}catch(e){return b.error(e)}}else return b.none()}}});
k("qq",["wz"],function(b){return{toBlob:function(d){return b.convert(d)}}});k("12x","102 b fh 7 33 1a l 46 o".split(" "),function(b,d,c,a,e,f,g,h,l){var m=e.immutable("asset","image");return{createImages:function(a){var e=[],h=[],k=[];d.each(a,function(a){return c.cata(a,function(b,c,d,l){b=g.fromTag("img");f.set(b,"src",d);e.push(b);h.push(a);k.push(m(a,b))},function(a,b,c){l.error("Internal error: Paste operation produced an image URL instead of a Data URI: ",b)})});return b.paste(e,h,k)},findImages:function(b,
e){var g=[],l=d.bind(b,function(a){return h.descendants(a,"img")});d.each(e,function(b){c.cata(b,function(a,c,e,h){d.each(l,function(a){f.get(a,"src")===e&&g.push(m(b,a))})},a.noop)});return g},updateSources:function(b,e){var g=[];d.each(b,function(b,d){c.cata(b,function(a,c,h,l){a=e[d];f.set(a,"src",h);g.push(m(b,a))},a.noop)});return g}}});k("107","qq qr 12u 12x 102 b fx s 33 1a l 35 46".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q){var r=l.immutable("blob","image"),s=function(a,c){var e=b.toBlob(c);
return d.cata(e,h.none,h.none,function(b){return h.some(r(b,a))})},t=function(a){var b=k.fromTag("div");p.append(b,a);a=q.descendants(b,"img[src]");return f.bind(a,function(a){var b=m.get(a,"src");return b.indexOf("data:image")-1&&-1<b.indexOf("base64")?s(a,b).toArray():[]})};return function(){return function(b,d){return c.sync(function(b){var h=function(){c.call(b,{response:d.response(),bundle:d.bundle()})},l=function(h){var l=t(h),m=f.map(l,function(a){return a.blob()});g.multiple(m).get(function(g){var m=
f.map(l,function(a){return a.image()}),m=a.updateSources(g,m);c.call(b,{response:e.paste(h,g,m),bundle:d.bundle()})})},m=function(a,b,c,d){return 0===b.length?l(a):h()};e.cata(d.response(),h,m,h,m)})}}});k("12y",["12u","102","3l","o"],function(b,d,c,a){var e=function(a){return a.officeStyles().getOr(!0)},f=function(a){return a.htmlStyles().getOr(!1)},g=function(a){return a.isWord().getOr(!1)};return{proxyBin:function(c){return{handle:function(e,f){return c.proxyBin().fold(function(){a.error(e);return b.pure({response:d.cancel(),
bundle:{}})},f)}}},backgroundAssets:function(a){return c.nu(function(b){a.backgroundAssets().fold(function(){b([])},function(a){a.listen(b)})})},merging:function(a){var b=g(a);return b&&e(a)||!b&&f(a)},mergeOffice:e,mergeNormal:f,isWord:g,isInternal:function(a){return a.isInternal().getOr(!1)}}});k("12z","pg 6 7 s 1x l 2m".split(" "),function(b,d,c,a,e,f,g){return function(h,l){var m=l.translations,k=function(b,c,e){e(a.some(d.merge(c,{officeStyles:b,htmlStyles:b})))},p=function(c,d){var l=f.fromTag("div");
e.add(l,b.resolve("styles-dialog-content"));var p=f.fromTag("p"),u=f.fromText(m("cement.dialog.paste.instructions"));g.append(p,u);g.append(l,p);var p={text:m("cement.dialog.paste.clean"),tabindex:0,className:b.resolve("clean-styles"),click:function(){v.destroy();k(!1,c,d)}},u={text:m("cement.dialog.paste.merge"),tabindex:1,className:b.resolve("merge-styles"),click:function(){v.destroy();k(!0,c,d)}},v=h(!0);v.setTitle(m("cement.dialog.paste.title"));v.setContent(l);v.setButtons([p,u]);v.show();v.events.close.bind(function(){d(a.none());
v.destroy()})};return{get:function(a,b){var c=l[a?"officeStyles":"htmlStyles"];"clean"===c?k(!1,l,b):"merge"===c?k(!0,l,b):p(l,b)},destroy:c.noop}}});k("108",["12u","12v","12y","12z","102"],function(b,d,c,a,e){var f=function(f,h){var l=a(f,h);return function(a,f){var g=f.bundle(),h=f.response();return b.sync(function(a){l.get(c.isWord(g),function(c){c=c.fold(function(){return{response:e.cancel(),bundle:f.bundle()}},function(a){return{response:h,bundle:d.nu({officeStyles:a.officeStyles,htmlStyles:a.htmlStyles})}});
b.call(a,c)})})}};return{fixed:function(a,c){return function(e,f){return b.pure({response:f.response(),bundle:d.nu({officeStyles:a,htmlStyles:c})})}},fromConfig:f,fromConfigIfExternal:function(a,e){return function(l,m){return c.isInternal(m.bundle())?b.pure({response:m.response(),bundle:d.nu({officeStyles:!0,htmlStyles:!0})}):f(a,e)(l,m)}}}});k("15c",["c","7","l","q"],function(b,d,c,a){var e=function(a){for(var b=[];null!==a.nextNode();)b.push(c.fromDom(a.currentNode));return b},f=function(a){try{return e(a)}catch(b){return[]}};
b=b.detect().browser;var g=b.isIE()||b.isSpartan()?f:e,h=d.constant(d.constant(!0));return{find:function(b,c){var d=c.fold(h,function(a){return function(b){return a(b.nodeValue)}});d.acceptNode=d;d=a.createTreeWalker(b.dom(),NodeFilter.SHOW_COMMENT,d,!1);return g(d)}}});k("151",["s","15c","v","q"],function(b,d,c,a){return{find:function(a){return d.find(a,b.some(function(a){return c.startsWith(a,"[if gte vml 1]")}))}}});k("138","s 1a 1x 2l l 20 49 ei 46 v".split(" "),function(b,d,c,a,e,f,g,h,l,m){var k=
function(a,b){var c=f.value(a),d=e.fromTag("div"),h=c.indexOf("]>");d.dom().innerHTML=c.substr(h+2);return g.descendant(d,function(a){return f.name(a)===b})},p=function(a){return f.isComment(a)?k(a,"v:shape"):b.none()},q=function(a){return l.descendants(a,".rtf-data-image")};return{local:function(a){if("img"===f.name(a)){var e=d.get(a,"src");if(void 0!==e&&null!==e&&m.startsWith(e,"file://"))return a=h.shallow(a),e=e.split(/[\/\\]/),d.set(a,"data-image-id",e[e.length-1]),d.remove(a,"src"),d.set(a,
"data-image-type","local"),c.add(a,"rtf-data-image"),b.some(a)}return b.none()},vshape:function(b){return p(b).map(function(b){var f=d.get(b,"o:spid"),f=void 0===f?d.get(b,"id"):f,g=e.fromTag("img");c.add(g,"rtf-data-image");d.set(g,"data-image-id",f.substr(7));d.set(g,"data-image-type","code");a.setAll(g,{width:a.get(b,"width"),height:a.get(b,"height")});return g})},find:q,exists:function(a){return 0<q(a).length},scour:p}});k("14i","151 b 138 s k 33 1a 4j 46 o".split(" "),function(b,d,c,a,e,f,g,
h,l,m){var k=f.immutable("img","vshape"),p=function(b,c){var e=g.get(b,"v:shapes"),f=a.from(d.find(c,function(a){return g.get(a,"id")===e}));f.isNone()&&m.log("WARNING: unable to find data for image",b.dom());return f.map(function(a){var c=g.clone(b);c._rawElement=b.dom();var d=g.clone(a);d._rawElement=a.dom();return k(c,d)})};return{extract:function(a){var f=h.fromHtml(a);a=d.bind(f,function(a){return l.descendants(a,"img")});var f=d.bind(f,b.find),g=e.cat(d.map(f,c.scour));a=d.map(a,function(a){return p(a,
g)});return e.cat(a)}}});k("152","a b 7 s 1a 1x".split(" "),function(b,d,c,a,e,f){var g=function(a,c){var d=c.style;e.has(a,"width")&&e.has(a,"height")&&b.isString(d)&&(d=d.match(/rotation:([^;]*)/),null===d||"90"!==d[1]&&"-90"!==d[1]||e.setAll(a,{width:e.get(a,"height"),height:e.get(a,"width")}))},h=function(a,b,c){return c.img()[a]===b},l=function(b,f,g){var l=e.get(f,g),l=c.curry(h,g,l);b=d.find(b,l);return a.from(b).map(function(a){e.remove(f,g);return a})};return{rotateImage:g,insertRtfCorrelation:function(a,
b,c){d.each(b,function(b){l(a,b,c).each(function(a){a=a.vshape();var c=a["o:spid"],c=void 0===c?a.id:c;g(b,a);f.add(b,"rtf-data-image");e.set(b,"data-image-id",c.substr(7));e.set(b,"data-image-type","code")})})}}});k("15d",["b","33"],function(b,d){var c=d.immutable("selector","style","raw"),a=function(a){return b.map(a.cssRules,function(a){var b=a.selectorText,d=a.style.cssText;if(void 0===d)throw"WARNING: Browser does not support cssText property";return c(b,d,a.style)})};return{extract:a,extractAll:function(c){return b.bind(c,
a)}}});k("153",["15d"],function(b){return{extract:function(d){return b.extract(d)},extractAll:function(d){return b.extractAll(d)}}});k("14j","152 b 7 1a pd 2l 2o 46 29 yl 153".split(" "),function(b,d,c,a,e,f,g,h,l,m,k){var p=c.noop,q=function(a){var b={};d.each(a,function(c){void 0!==a[c]&&(b[c]=a[c])});return b},r=function(b,c){var e=d.bind(c,function(a){var c=h.descendants(b,a.selector());d.each(c,function(b){var c=q(a.raw());f.setAll(b,c)});return c});d.each(e,function(b){a.remove(b,"class")})},
s=function(a,b){var c=m.stylesheets(a),c=k.extractAll(c);r(b,c)},t=function(a){a=l.children(a);d.each(a,function(a){e.getOption(a).each(function(b){"StartFragment"!==b&&"EndFragment"!==b||g.remove(a)})})};return{doMergeInlineStyles:r,process:function(a,c,d,e,f){var g=h.descendants(c,"img");t(c);b.insertRtfCorrelation(d,g,e);(f.mergeInline()?s:p)(a,c)}}});k("14k","7 13g 2l 3n l 2m 2o 3m".split(" "),function(b,d,c,a,e,f,g,h){return function(l){return{play:function(m,k,p){var q=e.fromTag("div"),r=e.fromTag("iframe");
c.setAll(q,{display:"none"});var s=a.bind(r,"load",function(){s.unbind();d.write(r,m);var a=r.dom().contentWindow.document;if(void 0===a)throw"sandbox iframe load event did not fire correctly";var c=e.fromDom(a),a=a.body;if(void 0===a)throw"sandbox iframe does not have a body";a=e.fromDom(a);c=k(c,a);g.remove(q);h(b.curry(p,c),0)});f.append(q,r);f.append(l,q)}}}});k("130","12u 12v 14i 14j 102 7 14k l 4j 2d q".split(" "),function(b,d,c,a,e,f,g,h,l,m,k){var p=function(a){var b=1;return a.replace(/(<img[^>]*)src=".*?"/g,
function(a,c,d){return c+'data-textbox-image="'+b++ +'"'})},q=function(b,c){var d=g(h.fromDom(k.body));return function(e,g){d.play(e,function(d,e){a.process(d,e,b,"data-textbox-image",{mergeInline:f.constant(c)});return m.get(e)},g)}},r=function(a,f,g){return b.sync(function(h){var m=c.extract(a);q(m,f)(g,function(a){a=l.fromHtml(a);b.call(h,{response:e.paste(a,[],[]),bundle:d.nu({})})})})},s=function(a){var b=a.indexOf("</html>");return-1<b?a.substr(0,b+7):a};return{handle:function(a,c,d){a=s(a.data());
var f=p(a);return d.cleanDocument(f,c).fold(function(){return b.pure({response:e.error("errors.paste.word.notready"),bundle:{}})},function(a){return void 0===a||null===a||0===a.length?b.pure(e.paste([],[],[]),{}):r(f,c,a)})}}});k("131",["12u","12v","12x","b","fx"],function(b,d,c,a,e){return{handle:function(f){f=a.filter(f,function(a){return"file"===a.kind&&/image/.test(a.type)});var g=a.map(f,function(a){return a.getAsFile()});return b.sync(function(a){e.multiple(g).get(function(e){e=c.createImages(e);
b.call(a,{response:e,bundle:d.nu({})})})})}}});k("15e",[],function(){return{validStyles:function(){return/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/},specialInline:function(){return/^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/}}});k("15l",[],function(){var b=function(b){return{fold:b,matches:function(c){return b(function(a){return 0===
c.toLowerCase().indexOf(a.toLowerCase())},function(a){return a.test(c.toLowerCase())},function(a){return 0<=c.toLowerCase().indexOf(a.toLowerCase())},function(a){return c.toLowerCase()===a.toLowerCase()},function(){return!0},function(a){return!a.matches(c)})}}};return{starts:function(d){return b(function(b,a,e,f,g,h){return b(d)})},pattern:function(d){return b(function(b,a,e,f,g,h){return a(d)})},contains:function(d){return b(function(b,a,e,f,g,h){return e(d)})},exact:function(d){return b(function(b,
a,e,f,g,h){return f(d)})},all:function(){return b(function(b,c,a,e,f,g){return f()})},not:function(d){return b(function(b,a,e,f,g,h){return h(d)})},cata:function(b,c,a,e,f,g,h){return b.fold(c,a,e,f,g,h)}}});k("15f",["7","20","15l"],function(b,d,c){return{keyval:function(a,d,f,g){var h=g.name,l=void 0!==g.condition?g.condition:b.constant(!0);g=void 0!==g.value?g.value:c.all();return h.matches(f)&&g.matches(d)&&l(a)},name:function(a,c){var f=d.name(a),g=c.name,h=void 0!==c.condition?c.condition:b.constant(!0);
return g.matches(f)&&h(a)}}});k("15r",["b","1n","7","1a"],function(b,d,c,a){var e=function(c,e,h){b.each(e,function(b){a.remove(c,b)});d.each(h,function(b,d){a.set(c,d,b)})};return{filter:function(a,c){var d={};b.each(a.dom().attributes,function(a){c(a.value,a.name)||(d[a.name]=a.value)});return d},clobber:function(a,c,h){h=b.map(a.dom().attributes,function(a){return a.name});d.size(c)!==h.length&&e(a,h,c)},scan:c.constant({})}});k("15s",["b","1n","1a","2l","v"],function(b,d,c,a,e){var f=function(a){var c=
{};a=void 0!==a&&null!==a?a.split(";"):[];b.each(a,function(a){a=a.split(":");2===a.length&&(c[e.trim(a[0])]=e.trim(a[1]))});return c},g=function(a){var c=d.keys(a);return b.map(c,function(b){return b+": "+a[b]}).join("; ")};return{filter:function(a,c){var d=a.dom().style,e={};b.each(void 0===d?[]:d,function(b){var d;d=a.dom().style.getPropertyValue(b);c(d,b)||(e[b]=d)});return e},clobber:function(b,e,f){c.set(b,"style","");var k=d.size(e),p=d.size(f);0===k&&0===p?c.remove(b,"style"):0===k?c.set(b,
"style",g(f)):(d.each(e,function(c,d){a.set(b,d,c)}),e=c.get(b,"style"),f=0<p?g(f)+"; ":"",c.set(b,"style",f+e))},scan:function(a,c,d){a=a.dom().getAttribute("style");var e=f(a),g={};b.each(c,function(a){var b=e[a];void 0===b||d(b,a)||(g[a]=b)});return g}}});k("15g",["15r","15s","7","l"],function(b,d,c,a){var e=["mso-list"],f=function(a,b){var c=d.scan(a,e,b),f=d.filter(a,b);d.clobber(a,f,c)},g=function(a,c){var d=b.filter(a,c);b.clobber(a,d,{})};return{style:f,attribute:g,styleDom:function(b,c){f(a.fromDom(b),
c)},attributeDom:function(b,c){g(a.fromDom(b),c)},validateStyles:function(a){var b=d.filter(a,c.constant(!1));d.clobber(a,b,{})}}});k("155","b 6 15f 15g 7 1a 1x 43 2o 46".split(" "),function(b,d,c,a,e,f,g,h,l,m){var k=function(a,d,e){a(e,function(a,f){return b.exists(d,function(b){return c.keyval(e,a,f,b)})})};return{remover:function(p,q){var r=d.merge({styles:[],attributes:[],classes:[],tags:[]},q),s=m.descendants(p,"*");b.each(s,function(c){k(a.style,r.styles,c);k(a.attribute,r.attributes,c);b.each(r.classes,
function(a){var d=f.has(c,"class")?h.get(c):[];b.each(d,function(b){a.name.matches(b)&&g.remove(c,b)})})});s=m.descendants(p,"*");b.each(s,function(a){b.exists(r.tags,e.curry(c.name,a))&&l.remove(a)})},unwrapper:function(a,f){var g=d.merge({tags:[]},f),h=m.descendants(a,"*");b.each(h,function(a){b.exists(g.tags,e.curry(c.name,a))&&l.unwrap(a)})},transformer:function(a,f){var g=d.merge({tags:[]},f),h=m.descendants(a,"*");b.each(h,function(a){var d=b.find(g.tags,e.curry(c.name,a));void 0!==d&&null!==
d&&d.mutate(a)})},validator:function(c){c=m.descendants(c,"*");b.each(c,function(b){a.validateStyles(b)})}}});k("15o",["1n","2l","l"],function(b,d,c){var a=function(a,b,e){var l,m,k,p=c.fromDom(a);switch(a.nodeType){case 1:b?l="endElement":(l="startElement",d.setAll(p,e||{}));m="HTML"!==a.scopeName&&a.scopeName&&a.tagName&&0>=a.tagName.indexOf(":")?(a.scopeName+":"+a.tagName).toUpperCase():a.tagName;break;case 3:l="text";k=a.nodeValue;break;case 8:l="comment";k=a.nodeValue;break;default:console.log("WARNING: Unsupported node type encountered: "+
a.nodeType)}return{getNode:function(){return a},tag:function(){return m},type:function(){return l},text:function(){return k}}},e=function(b,c){return a(c.createElement(b),!0)};return{START_ELEMENT_TYPE:"startElement",END_ELEMENT_TYPE:"endElement",TEXT_TYPE:"text",COMMENT_TYPE:"comment",FINISHED:e("HTML",window.document),token:a,createStartElement:function(c,d,e,l){var m=l.createElement(c);b.each(d,function(a,b){m.setAttribute(b,a)});return a(m,!1,e)},createEndElement:e,createComment:function(b,c){return a(c.createComment(b),
!1)},createText:function(b,c){return a(c.createTextNode(b))}}});k("15h",["15o"],function(b){return{create:function(d){var c=d.createDocumentFragment(),a=c;return{dom:a,receive:function(e){var f=function(a){a=a.getNode().cloneNode(!1);c.appendChild(a);c=a},g=function(a,b){var e=d.createTextNode(a.text());c.appendChild(e)};switch(e.type()){case b.START_ELEMENT_TYPE:f(e);break;case b.TEXT_TYPE:g(e);break;case b.END_ELEMENT_TYPE:c=c.parentNode;null===c&&(c=a);break;case b.COMMENT_TYPE:break;default:throw{message:"Unsupported token type: "+
e.type()};}},label:"SERIALISER"}}}});k("15i",["15o"],function(b){return{tokenise:function(d,c){var a;c=c||window.document;a=c.createElement("div");c.body.appendChild(a);a.style.position="absolute";a.style.left="-10000px";a.innerHTML=d;nextNode=a.firstChild||b.FINISHED;var e=[];endNode=!1;return{hasNext:function(){return void 0!==nextNode},next:function(){var d=nextNode,g=endNode;!endNode&&nextNode.firstChild?(e.push(nextNode),nextNode=nextNode.firstChild):endNode||1!==nextNode.nodeType?nextNode.nextSibling?
(nextNode=nextNode.nextSibling,endNode=!1):(nextNode=e.pop(),endNode=!0):endNode=!0;d===b.FINISHED||nextNode||(c.body.removeChild(a),nextNode=b.FINISHED);d=d===b.FINISHED?d:d?b.token(d,g):void 0;return d}}}}});k("156",["15h","15i"],function(b,d){var c=function(a,b,c){var d=c;for(c=b.length-1;0<=c;c--)d=b[c](d,{},a);return d};return{build:c,run:function(a,e,f){var g=b.create(a);e=d.tokenise(e,a);for(a=c(a,f,g);e.hasNext();)f=e.next(),a.receive(f);return g.dom}}});k("14p","b 155 156 l 2d 2o 29".split(" "),
function(b,d,c,a,e,f,g){return{removal:function(a){return function(b){d.remover(b,a)}},unwrapper:function(a){return function(b){d.unwrapper(b,a)}},transformer:function(a){return function(b){d.transformer(b,a)}},validate:function(){return function(a){d.validator(a)}},pipeline:function(a){return function(b){var d=e.get(b),k=g.owner(b),d=c.run(k.dom(),d,a);f.empty(b);b.dom().appendChild(d)}},isWordContent:function(a,b){return 0<=a.indexOf("<o:p>")||b.browser.isSpartan()&&0<=a.indexOf('v:shapes="')||
b.browser.isSpartan()&&0<=a.indexOf("mso-")||0<=a.indexOf("mso-list")||0<=a.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal")||0<=a.indexOf("MsoListParagraphCxSpFirst")||0<=a.indexOf("<w:WordDocument>")},go:function(c,d,f){var g=a.fromTag("div",c.dom());g.dom().innerHTML=d;b.each(f,function(a){a(g)});return e.get(g)}}});k("158",["b","15o"],function(b,d){return function(c,a,e){return function(e,g,h){var l=function(a){e.receive(a)},m=function(a,b){return d.token(b,a.type()===d.END_ELEMENT_TYPE,{})},
k={emit:l,emitTokens:function(a){b.each(a,l)},receive:function(a){c(k,a,m)},document:window.document};a(k);return k}}});k("160","15s 15o 7 1a 2l l".split(" "),function(b,d,c,a,e,f){return{getAttribute:function(b,c){var d=f.fromDom(b.getNode());return a.get(d,c)},getStyle:function(a,b){var c=f.fromDom(a.getNode());return e.get(c,b)},isWhitespace:function(a){return a.type()===d.TEXT_TYPE&&/^[\s\u00A0]*$/.test(a.text())},getMsoList:function(a){a=f.fromDom(a.getNode());return b.scan(a,["mso-list"],c.constant(!1))["mso-list"]}}});
k("165",["b","s"],function(b,d){var c=function(a,b,c){return a===b||a&&b&&a.tag===b.tag&&a.type===b.type&&(c||a.variant===b.variant)};return{guessFrom:function(a,e){var f=b.find(a,function(a){return"UL"===a.tag||e&&c(a,e,!0)});return void 0!==f?d.some(f):0<a.length?d.some(a[0]):d.none()},eqListType:c}});k("15w",[],function(){var b=function(b,a){if(void 0===b||void 0===a)throw console.trace(),"brick";b.nextFilter.set(a)},d=function(b,a,d){a.nextFilter.get()(b,a,d)};return{next:b,go:d,jump:function(c){return function(a,
e,f){b(e,c);d(a,e,f)}},isNext:function(b,a){return b.nextFilter.get()===a},setNext:function(c){return function(a,d,f){b(d,c)}}}});k("15z","b 160 165 15w 7 33 1a l".split(" "),function(b,d,c,a,e,f,g,h){var l=f.immutable("level","token","type"),m=function(a,e,f,g){a=f.getCurrentListType();f=f.getCurrentLevel()==g.level()?a:null;return c.guessFrom(g.emblems(),f).filter(function(a){if(a="OL"===a.tag)a=!b.contains(["P"],e.tag())||/^MsoHeading/.test(d.getAttribute(e,"class"));return!a})};return{predicate:function(a,
b){return g.has(h.fromDom(b.getNode()),"data-list-level")},action:function(b){return function(c,d,f){c=h.fromDom(f.getNode());var k=parseInt(g.get(c,"data-list-level"),10),t=g.get(c,"data-list-emblems"),t=JSON.parse(t);g.remove(c,"data-list-level");g.remove(c,"data-list-emblems");c={level:e.constant(k),emblems:e.constant(t)};c.level();d.originalToken.set(f);m(d.listType.get(),f,d.emitter,c).each(d.listType.set);f=l(c.level(),d.originalToken.get(),d.listType.get());d.emitter.openItem(f.level(),f.token(),
f.type());a.next(d,b.inside())}}}});k("161",["7"],function(b){return function(d,c,a){return{pred:d,action:c,label:b.constant(a)}}});k("162",["b","7","s"],function(b,d,c){var a=function(a,b){return function(a,c,d){return b(a,c,d)}};return function(e,f,g){var h=a(e+" :: FALLBACK --- ",g);g=function(g,m,k){c.from(b.find(f,function(a){return a.pred(m,k)})).fold(d.constant(h),function(b){var c=b.label();return void 0===c?b.action:a(e+" :: "+c,b.action)})(g,m,k)};g.toString=function(){return"Handlers for "+
e};return g}});k("15t","15z 15o 160 161 162 15w".split(" "),function(b,d,c,a,e,f){return{inside:function(b){return e("Inside.List.Item",[a(function(a,b){return b.type()===d.END_ELEMENT_TYPE&&a.originalToken.get()&&b.tag()===a.originalToken.get().tag()},function(a,c,d){f.next(c,b.outside())},"Closing open tag")],function(a,b,c){a.emit(c)})},outside:function(g){return e("Outside.List.Item",[a(b.predicate,b.action(g),"Data List ****"),a(function(a,b){return b.type()===d.TEXT_TYPE&&c.isWhitespace(b)},
function(a,b,c){a.emit(c)},"Whitespace")],function(a,b,c){b.emitter.closeAllLists();a.emit(c);f.next(b,g.outside())})}}});k("166",["33"],function(b){var d=b.immutable("state","result"),c=b.immutable("state","value");return{state:b.immutable("level","type","types","items"),value:c,result:d}});k("168",["166","s"],function(b,d){return{start:function(c,a){var e=c.items().slice(0),f=void 0!==a&&"P"!==a?d.some(a):d.none();f.fold(function(){e.push("P")},function(a){e.push(a)});var g=b.state(c.level(),c.type(),
c.types(),e);return b.value(g,f)},finish:function(c){var a=c.items().slice(0);if(0<a.length&&"P"!==a[a.length-1]){var e=a[a.length-1];a[a.length-1]="P";c=b.state(c.level(),c.type(),c.types(),a);return b.value(c,d.some(e))}return b.value(c,d.none())}}});k("169",["166"],function(b){var d=function(c,a,d){for(var f=[];a(c);){var g=d(c);c=g.state();f=f.concat(g.result())}return b.result(c,f)};return{moveRight:function(b,a,e){return d(b,function(b){return b.level()<a},e)},moveLeft:function(b,a,e){return d(b,
function(b){return b.level()>a},e)},moveUntil:d}});k("16b",["160"],function(b){return{from:function(d){var c={"list-style-type":"none"};d?(d=b.getStyle(d,"margin-left"),d=void 0!==d&&"0px"!==d?{"margin-left":d}:{}):d=c;return d}}});k("16a","15g 15o 165 166 168 16b 7".split(" "),function(b,d,c,a,e,f,g){var h=function(b,c,e){var f=c.start&&1<c.start?{start:c.start}:{},h=b.level()+1,l=b.types().concat([c]);e=[g.curry(d.createStartElement,c.tag,f,e)];b=a.state(h,c,l,b.items());return a.result(b,e)},l=
function(b){var c=b.types().slice(0),e=[g.curry(d.createEndElement,c.pop().tag)],f=b.level()-1;b=a.state(f,c[c.length-1],c,b.items());return a.result(b,e)},m=function(b,c){var d=l(b),e=h(d.state(),c,c.type?{"list-style-type":c.type}:{});return a.result(e.state(),d.result().concat(e.result()))};return{open:h,openItem:function(h,l,k){var r=f.from(l);h=h.type()&&!c.eqListType(h.type(),k)?m(h,k):a.result(h,[]);r=[g.curry(d.createStartElement,"LI",{},r)];k=e.start(h.state(),l&&l.tag());var s=k.value().map(function(a){b.styleDom(l.getNode(),
g.constant(!0));return[g.constant(l)]}).getOr([]);return a.result(k.state(),h.result().concat(r).concat(s))},close:l,closeItem:function(b){var c=g.curry(d.createEndElement,"LI");b=e.finish(b);var f=b.value().fold(function(){return[c]},function(a){return[g.curry(d.createEndElement,a),c]});return a.result(b.state(),f)}}});k("167","b 15o 166 168 169 16a 7 s".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a){if(0===a.length)throw"Compose must have at least one element in the list";var d=a[a.length-
1];a=b.bind(a,function(a){return a.result()});return c.result(d.state(),a)},m=function(a){a=f.closeItem(a);var b=f.close(a.state());return l([a,b])},k=function(a,b,c,d){return e.moveRight(a,c,function(a){var e=a.level()===c-1&&b.type?{"list-style-type":b.type}:{};a=f.open(a,b,e);e=f.openItem(a.state(),a.state().level()==c?d:void 0,b);return l([a,e])})},p=function(a,b){return e.moveLeft(a,b,m)},q=function(b,e,f,l){var m=1<f?a.finish(b):c.value(b,h.none());b=m.value().map(function(a){return[g.curry(d.createEndElement,
a)]}).getOr([]);m.state().level();e=k(m.state(),e,f,l);return c.result(e.state(),b.concat(e.result()))};return{openItem:function(a,b,d,e){a=a.level()>b?p(a,b):c.result(a,[]);a.state().level()===b?(b=a.state(),b=0<b.level()?f.closeItem(b):c.result(b,[]),d=f.openItem(b.state(),d,e),d=l([b,d])):d=q(a.state(),e,b,d);return l([a,d])},closeAllLists:p}});k("163",["b","166","167"],function(b,d,c){var a=["disc","circle","square"];return function(e,f){var g=d.state(0,void 0,[],[]),h=function(a){b.each(a.result(),
function(a){a=a(f);e.emit(a)})};return{closeAllLists:function(){var a=c.closeAllLists(g,0);g=a.state();h(a)},openItem:function(b,d,e){e&&("UL"===e.tag&&a[b-1]===e.type&&(e={tag:"UL"}),b=c.openItem(g,b,d,e),g=b.state(),h(b))},getCurrentListType:function(){return g.type()},getCurrentLevel:function(){return g.level()}}}});k("15u",["163","7","4f"],function(b,d,c){var a={getCurrentListType:function(){return e().getCurrentListType()},getCurrentLevel:function(){return e().getCurrentLevel()},closeAllLists:function(){return e().closeAllLists.apply(void 0,
arguments)},openItem:function(){return e().openItem.apply(void 0,arguments)}},e=function(){return{getCurrentListType:d.constant({}),getCurrentLevel:d.constant(1),closeAllLists:d.identity,openItem:d.identity}};return function(f){var g=c(f),h=c(null),l=c(null);return{reset:function(a){g.set(f);h.set(null);l.set(null);_emitter=b(a,a.document);e=d.constant(_emitter)},nextFilter:g,originalToken:h,listType:l,emitter:a}}});k("15v",["15o"],function(b){return function(){var d=!1,c="";return{check:function(a){return d&&
a.type()===b.TEXT_TYPE?(c+=a.text(),!0):a.type()===b.START_ELEMENT_TYPE&&"STYLE"===a.tag()?d=!0:a.type()===b.END_ELEMENT_TYPE&&"STYLE"===a.tag()?(d=!1,!0):!1}}}});k("15j","158 15t 15u 15v 15w q".split(" "),function(b,d,c,a,e,f){f={inside:function(){return h},outside:function(){return l}};var g=a(),h=d.inside(f),l=d.outside(f),m=c(l);return b(function(a,b,c){g.check(b)||e.go(a,m,b)},m.reset,"list.filters")});k("164",["b","6","1t","cy"],function(b,d,c,a){var e=[{regex:/^\(?[dc][\.\)]$/,type:{tag:"OL",
type:"lower-alpha"}},{regex:/^\(?[DC][\.\)]$/,type:{tag:"OL",type:"upper-alpha"}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:"OL",type:"upper-roman"}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,type:{tag:"OL",type:"lower-roman"}},{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:"OL"}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:"OL",variant:"outline"}},{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:"OL",
type:"upper-alpha"}}],f={"\u2022":{tag:"UL",type:"disc"},"\u00b7":{tag:"UL",type:"disc"},"\u00a7":{tag:"UL",type:"square"}},g={o:{tag:"UL",type:"circle"},"-":{tag:"UL",type:"disc"},"\u25cf":{tag:"UL",type:"disc"},"\ufffd":{tag:"UL",type:"circle"}},h=function(a,b){return void 0!==a.variant?a.variant:"("===b.charAt(0)?"()":")"===b.charAt(b.length-1)?")":"."},l=function(b){var d=b.split(".");0===d.length?d=b:(b=d[d.length-1],d=0===b.length&&1<d.length?d[d.length-2]:b);d=a(d,10);return c(d)?{}:{start:d}};
return{extract:function(a,c){var k=g[a]?[g[a]]:[],q=c&&f[a]?[f[a]]:c?[{tag:"UL",variant:a}]:[],r=b.bind(e,function(b){return b.regex.test(a)?[d.merge(b.type,l(a),{variant:h(b.type,a)})]:[]}),k=k.concat(q).concat(r);return b.map(k,function(b){return void 0!==b.variant?b:d.merge(b,{variant:a})})}}});k("15x","b 164 15s 7 s 2l 2d 20 49 b1 29 1r 1t cy".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){var s=function(b){return c.scan(b,["mso-list"],a.constant(!1))["mso-list"]},t=function(a){return h.isElement(a)&&
f.getRaw(a,"font-family").exists(function(a){return b.contains(["wingdings","symbol"],a.toLowerCase())})};return{getMsoList:s,extractLevel:function(a){a=s(a);return(a=/ level([0-9]+)/.exec(a))&&a[1]?e.some(r(a[1],10)):e.none()},extractEmblem:function(a,b){var c=m.get(a).trim(),c=d.extract(c,b);return 0<c.length?e.some(c):e.none()},extractSymSpan:function(a){return l.child(a,t)},extractMsoIgnore:function(b){return l.descendant(b,function(b){return!!(h.isElement(b)?c.scan(b,["mso-list"],a.constant(!1)):
[])["mso-list"]})},extractCommentSpan:function(a){return l.child(a,h.isComment).bind(k.nextSibling).filter(function(a){return"span"===h.name(a)})},isSymbol:t,deduceLevel:function(a){return f.getRaw(a,"margin-left").bind(function(a){a=r(a,10);return q(a)?e.none():e.some(p.max(1,p.ceil(a/18)))})}}});aa("15y",JSON);k("15k","b 15x s 1a 15c 20 2o 29 15y cy".split(" "),function(b,d,c,a,e,f,g,h,l,m){var k=function(d,f,h,m){a.set(d,"data-list-level",f);f=l.stringify(h);a.set(d,"data-list-emblems",f);f=e.find(d,
c.none());b.each(f,g.remove);b.each(m,g.remove);a.remove(d,"style");a.remove(d,"class")},p=function(a){return d.extractLevel(a).bind(function(b){return d.extractSymSpan(a).bind(function(c){return d.extractEmblem(c,!0).map(function(d){return{mutate:function(){k(a,b,d,[c])}}})})})},q=function(a){return d.extractLevel(a).bind(function(b){return d.extractCommentSpan(a).bind(function(c){return d.extractEmblem(c,d.isSymbol(c)).map(function(d){return{mutate:function(){k(a,b,d,[c])}}})})})},r=function(a){return d.extractLevel(a).bind(function(b){return d.extractCommentSpan(a).bind(function(c){return d.extractEmblem(c,
d.isSymbol(c)).map(function(d){return{mutate:function(){k(a,b,d,[c])}}})})})},s=function(a){return"p"!==f.name(a)?c.none():d.extractLevel(a).bind(function(b){return d.extractMsoIgnore(a).bind(function(c){return d.extractEmblem(c,!1).map(function(d){return{mutate:function(){k(a,b,d,[h.parent(c).getOr(c)])}}})})})},t=function(a){return"p"!==f.name(a)?c.none():d.extractMsoIgnore(a).bind(function(b){var c=h.parent(b).getOr(b),e=d.isSymbol(c);return d.extractEmblem(b,e).bind(function(b){return d.deduceLevel(a).map(function(d){return{mutate:function(){k(a,
d,b,[c])}}})})})};return{find:function(a){return p(a).orThunk(function(){return q(a)}).orThunk(function(){return r(a)}).orThunk(function(){return s(a)}).orThunk(function(){return t(a)})}}});k("157",["14p","15j","15k","15l"],function(b,d,c,a){b=b.transformer({tags:[{name:a.pattern(/^(p|h\d+)$/),mutate:function(a){c.find(a).each(function(a){a.mutate()})}}]});return{filter:d,preprocess:b}});k("15m",["b","1a","2d","20","32"],function(b,d,c,a,e){var f=function(b){var c=b.dom().attributes,c=void 0!==c&&
null!==c&&0<c.length;return"span"===a.name(b)?c:!0},g=function(a){return void 0===a.dom().attributes||null===a.dom().attributes?!0:0===a.dom().attributes.length||1===a.dom().attributes.length&&"style"===a.dom().attributes[0].name};return{isNotImage:function(b){return"img"!==a.name(b)},hasContent:function(c){return g(c)?f(c)&&e.descendant(c,function(c){var d=!g(c),e=!b.contains("font em strong samp acronym cite code dfn kbd tt b i u s sub sup ins del var span".split(" "),a.name(c));return a.isText(c)||
d||e}):!0},isList:function(b){return"ol"===a.name(b)||"ul"===a.name(b)},isLocal:function(a){a=d.get(a,"src");return/^file:/.test(a)},hasNoAttributes:g,isEmpty:function(a){return 0===c.get(a).length}}});k("15n","b 1n s 1a 2l l 2d 2m 35 20 2o 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q){var r=function(a,c){var d=f.fromTag(a);h.before(c,d);var e=c.dom().attributes;b.each(e,function(a){d.dom().setAttribute(a.name,a.value)});e=q.children(c);l.append(d,e);k.remove(c);return d},s=function(a){return q.prevSibling(a).bind(function(a){return m.isText(a)&&
0===p.get(a).trim().length?s(a):"li"===m.name(a)?c.some(a):c.none()})};return{changeTag:r,addBrTag:function(a){0===g.get(a).length&&h.append(a,f.fromTag("br"))},properlyNest:function(a){q.parent(a).each(function(c){c=m.name(c);b.contains(["ol","ul"],c)&&s(a).fold(function(){var b=f.fromTag("li");e.set(b,"list-style-type","none");h.wrap(a,b)},function(b){h.append(b,a)})})},fontToSpan:function(b){var c=r("span",b),f={"font-size":{1:"8pt",2:"10pt",3:"12pt",4:"14pt",5:"18pt",6:"24pt",7:"36pt"}};d.each({face:"font-family",
size:"font-size",color:"font-color"},function(b,d){if(a.has(c,d)){var g=a.get(c,d);e.set(c,b,void 0!==f[b]&&void 0!==f[b][g]?f[b][g]:g);a.remove(c,d)}})}}});k("154","15e 14p 157 15m 15n 7 1x 2l 15l".split(" "),function(b,d,c,a,e,f,g,h,l){var m=d.unwrapper({tags:[{name:l.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i)}]});c=[d.pipeline([c.filter])];var k=d.removal({attributes:[{name:l.pattern(/^v:/)},{name:l.exact("href"),value:l.contains("#_toc")},{name:l.exact("href"),value:l.contains("#_mso")},{name:l.pattern(/^xmlns(:|$)/)},
{name:l.exact("type"),condition:a.isList}]}),p=d.removal({tags:[{name:l.exact("script")},{name:l.exact("meta")},{name:l.exact("link")},{name:l.exact("style"),condition:a.isEmpty}],attributes:[{name:l.starts("on")},{name:l.exact('"')},{name:l.exact("id")},{name:l.exact("name")},{name:l.exact("lang")},{name:l.exact("language")}],styles:[{name:l.all(),value:l.pattern(/OLE_LINK/i)}]}),q=d.removal({styles:[{name:l.not(l.pattern(/width|height|list-style-type/)),condition:function(a){return!g.has(a,"ephox-limbo-transform")}},
{name:l.pattern(/width|height/),condition:a.isNotImage}]}),r=d.removal({classes:[{name:l.not(l.exact("rtf-data-image"))}]}),s=d.removal({styles:[{name:l.pattern(b.validStyles())}]}),t=d.removal({classes:[{name:l.pattern(/mso/i)}]}),u=d.unwrapper({tags:[{name:l.exact("img"),condition:a.isLocal},{name:l.exact("a"),condition:a.hasNoAttributes}]}),v=d.unwrapper({tags:[{name:l.exact("a"),condition:a.hasNoAttributes}]}),w=d.removal({attributes:[{name:l.exact("style"),value:l.exact(""),debug:!0}]}),x=d.removal({attributes:[{name:l.exact("class"),
value:l.exact(""),debug:!0}]});b=d.unwrapper({tags:[{name:l.pattern(b.specialInline()),condition:f.not(a.hasContent)}]});a=d.transformer({tags:[{name:l.exact("p"),mutate:e.addBrTag}]});var y=d.transformer({tags:[{name:l.pattern(/ol|ul/),mutate:e.properlyNest}]}),B=d.transformer({tags:[{name:l.exact("b"),mutate:f.curry(e.changeTag,"strong")},{name:l.exact("i"),mutate:f.curry(e.changeTag,"em")},{name:l.exact("u"),mutate:function(a){a=e.changeTag("span",a);g.add(a,"ephox-limbo-transform");h.set(a,"text-decoration",
"underline")}},{name:l.exact("s"),mutate:f.curry(e.changeTag,"strike")},{name:l.exact("font"),mutate:e.fontToSpan,debug:!0}]}),z=d.removal({classes:[{name:l.exact("ephox-limbo-transform")}]});d=d.removal({attributes:[{name:l.exact("href"),value:l.starts("file:///"),debug:!0}]});return{unwrapWordTags:m,removeWordAttributes:k,parseLists:c,removeExcess:p,cleanStyles:q,cleanClasses:r,mergeStyles:s,mergeClasses:t,removeLocalImages:u,removeVacantLinks:v,removeEmptyStyle:w,removeEmptyClass:x,pruneInlineTags:b,
addPlaceholders:a,nestedListFixes:y,inlineTagFixes:B,cleanupFlags:z,removeLocalLinks:d,none:f.noop}});k("14n","b 138 154 14p 157 158 7 l".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a){return a.browser.isIE()&&11<=a.browser.version.major},m=function(a){return f(function(b,c,d){var e=a(h.fromDom(c.getNode())).fold(function(){return c},function(a){return d(c,a.dom())});b.emit(e)},g.noop,"image filters")},k=function(a,b,d){a=[c.mergeStyles,c.mergeClasses];d=[c.cleanStyles,c.cleanClasses];return b?
a:d},p=function(a,b,c){return l(c)||!a?[]:[e.preprocess]},q=function(a,b,d){if(!a)return[c.none];a=[c.unwrapWordTags];d=l(d)?[]:c.parseLists;return a.concat(d).concat([c.removeWordAttributes])};return{derive:function(e,f,g){var h,v;v=g.browser.isFirefox()||g.browser.isSpartan()?d.local:d.vshape;h=l(g)?c.none:a.pipeline([m(v)]);h=[e?h:c.none];v=[v===d.local?c.none:c.removeLocalImages];return b.flatten([p(e,f,g),h,[c.inlineTagFixes],q(e,f,g),[c.nestedListFixes],[c.removeExcess],v,k(e,f,g),[c.removeLocalLinks,
c.removeVacantLinks],[c.removeEmptyStyle],[c.removeEmptyClass],[c.pruneInlineTags],[c.addPlaceholders],[c.cleanupFlags]])}}});k("14o","b s zs 6b 33 1a 2l l 2m 35 20 6e b1 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){var s=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\.\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w\.]+@)[A-Za-z0-9\.\-]+)(:[0-9]+)?((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-_.~*+=!&;:'%@?^${}()\w,]*)#?(?:[\-_.~*+=!&;:'%@?^${}()\w,\/]*))?)/g.source,t=function(b){var d=e.immutable("word",
"pattern"),f=a.unsafetoken(s),d=d("__INTERNAL__",f);return c.run(b,[d])},u=function(a){return!p.closest(a,"a")},v=function(a){return d.from(a[0]).filter(u).map(function(b){var c=h.fromTag("a");l.before(b,c);m.append(c,a);f.set(c,"href",q.get(c));return c})};return{links:function(a){a=t(a);b.each(a,function(a){var b=a.exact(),c;(c=0>b.indexOf("@"))||(b=b.indexOf("://"),c=3<=b&&9>=b);c&&v(a.elements())})},position:function(a){b.each(a,function(a){k.isElement(a)&&g.getRaw(a,"position").isSome()&&g.remove(a,
"position")})},list:function(a){var c=b.filter(a,function(a){return"li"===k.name(a)});if(0<c.length){var d=r.prevSiblings(c[0]),e=h.fromTag("ul");l.before(a[0],e);0<d.length&&(a=h.fromTag("li"),l.append(e,a),m.append(a,d));m.append(e,c)}}}});k("134","b 14n 14o 14p 2d 29".split(" "),function(b,d,c,a,e,f){var g=function(a){var d=f.children(a);b.each([c.links,c.position,c.list],function(a){a(d)})};return{go:function(b,c,f,k,p){g(f);f=e.get(f);c=d.derive(p,k,c);return a.go(b,f,c)},preprocess:g}});k("14l",
"12u 12v 12x 102 b c 134 p 4j o".split(" "),function(b,d,c,a,e,f,g,h,l,m){var k=f.detect(),p=function(a,b,c,d){try{var e=g.go(a,k,b,c,d),f=void 0!==e&&null!==e&&0<e.length?l.fromHtml(e):[];return h.value(f)}catch(p){return m.error(p),h.error("errors.paste.process.failure")}};return{transfer:function(e,f,g,h,l){return p(e,f,h,g).fold(function(a){return b.error(a)},function(e){return b.sync(function(f){l.get(function(g){var h=c.findImages(e,g);b.call(f,{response:a.paste(e,g,h),bundle:d.nu({})})})})})}}});
k("132","14l b 3l s 2o 29".split(" "),function(b,d,c,a,e,f){return{internal:function(g,h,l){h=(void 0!==h?h.findClipboardTags(f.children(l)):a.none()).getOr([]);d.each(h,e.remove);h=c.nu(function(a){a([])});return b.transfer(g,l,!1,!0,h)},external:function(a,c,d,e,f){return b.transfer(a,c,e,d,f)}}});k("14m",["b","l","2d","b1"],function(b,d,c,a){return{encode:function(b){var f=d.fromTag("div");a.set(f,b);return c.get(f)},convert:function(a){a=a.trim().split(/\n{2,}|(?:\r\n){2,}/);a=b.map(a,function(a){return a.split(/\n|\r\n/).join("<br />")});
return 1===a.length?a[0]:b.map(a,function(a){return"<p>"+a+"</p>"}).join("")}}});k("133","12u 14m 12v 106 102 s k 4j 31".split(" "),function(b,d,c,a,e,f,g,h,l){var m=function(a){return 0<a.length},k=function(b){return a.isValidData(b)?g.findMap(b.types,function(a){return"text/plain"===a?f.some(b.getData(a)):f.none()}):f.none()},p=function(){var a=l.clipboardData;return void 0!==a?f.some(a.getData("text")):f.none()},q=function(a){a=d.encode(a);a=d.convert(a);a=h.fromHtml(a);return e.paste(a,[],[])};
return{handle:function(d){return b.sync(function(f){var g=(a.isValidData(d)?k:p)(d).filter(m).fold(e.cancel,q);b.call(f,{response:g,bundle:c.nu({})})})}}});k("109","12u 12v 12y 130 131 132 133 102 c 134 7 l 35 29 o".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r,s){var t=l.detect();return{plain:function(a,b,c){return g.handle(a)},autolink:function(a,c){var d=function(a,d,e){var f=p.fromTag("div");q.append(f,a);m.preprocess(f);a=r.children(f);return b.pure({response:h.paste(a,d,e),bundle:c.bundle()})},
e=k.curry(b.pass,c);return h.cata(c.response(),e,d,e,d)},noImages:function(){return function(a,c){return b.error("errors.local.images.disallowed")}},images:function(){return function(a,c){if(t.browser.isSafari()){var d=t.deviceType.isWebView()?"webview.imagepaste":"safari.imagepaste";return b.error(d)}return e.handle(a)}},internal:function(a,b){return function(d,e){var g=e.bundle();return c.proxyBin(g).handle("There was no proxy bin setup. Ensure you have run proxyStep first.",function(c){var d=r.owner(a);
return f.internal(d,b,c)})}},external:function(a,b){return function(d,e){var g=e.bundle();return c.proxyBin(g).handle("There was no proxy bin setup. Ensure you have run proxyStep first.",function(d){var e=c.merging(g),h=c.isWord(g),l=c.isInternal(g),m=c.backgroundAssets(g),k=r.owner(a);return l?f.internal(k,b,d):f.external(k,d,e,h,m)})}},gwt:function(b){return function(d,e){var f=c.mergeOffice(e.bundle());return a.handle(d,f,b)}},setBundle:function(a){return function(c,e){var f=d.merge(e.bundle(),
d.nu(a));return b.pure({response:e.response(),bundle:f})}},none:function(a,c){return b.cancel()}}});k("135",["14p","1a","2d","32"],function(b,d,c,a){var e=function(b,c){return a.descendant(b,function(a){return d.has(a,"style")?-1<d.get(a,"style").indexOf("mso-"):!1})},f=function(a,d){var e=c.get(a);return b.isWordContent(e,d)};return{isWord:function(a,b){var c=a.browser;return(c.isIE()&&11<=c.version.major?e:f)(b,a)}}});k("10a","12u 12v hv 12w b c 135 1a 1x 46 29".split(" "),function(b,d,c,a,e,f,
g,h,l,m,k){var p=f.detect();return function(a,e,f,h,m){return function(v,w){var x=m(),y=w.response();return b.sync(function(m){var u=a(f);u.events.after.bind(function(a){a=a.container();e(a);l.add(a,c.binStyle());var f=g.isWord(p,a),q=k.children(a),q=h.findClipboardTags(q,f).isSome();b.call(m,{response:y,bundle:d.nu({isWord:f,isInternal:q,proxyBin:a,backgroundAssets:x})})});x.convert(v.data());u.run()})}}});k("15p","10s 10t 9 1r w cy".split(" "),function(b,d,c,a,e,f){return{convert:function(e,h){if(0===
e.length)throw"Zero length content passed to Hex conversion";for(var l=new c(e.length/2),m=0;m<e.length;m+=2){var k=e.substr(m,2),p=a.floor(m/2);l[p]=f(k,16)}l=d(l);return b([l],{type:h})}}});k("15a",["4g"],function(b){b=b.generate([{unsupported:["id","message"]},{supported:["id","contentType","blob"]}]);return{unsupported:b.unsupported,supported:b.supported,cata:function(b,c,a){return b.fold(c,a)}}});k("15q",["7","s"],function(b,d){var c=function(a,c,e,f,g){return-1===a||-1===c?d.none():d.some({start:b.constant(a),
end:b.constant(c),bower:e,regex:b.constant(f),idRef:b.constant(g)})},a=function(a,b,c){return function(){return a.substring(b,c)}},e=function(a,b){if(-1===b)return b;var c=0,d=a.length,e,f;do if(e=a.indexOf("{",b),f=a.indexOf("}",b),f>e&&-1!==e?(b=e+1,++c):(e>f||0>e)&&-1!==f&&(b=f+1,--c),b>d||-1===f)return-1;while(0<c);return b},f=function(b,d,e,f){b=a(b,e,f);return c(e,f,b,/[^a-fA-F0-9]([a-fA-F0-9]+)\}$/,"i")},g=function(b,d,e,f){b=a(b,e,f);return c(e,f,b,/([a-fA-F0-9]{64,})(?:\}.*)/,"s")};return{identify:function(a,
c){var m=a.indexOf("{\\pict{",c),k=e(a,m),p=a.indexOf("{\\shp{",c),q=e(a,p),r=b.curry(g,a,c,p,q),s=b.curry(f,a,c,m,k);return-1===m&&-1===p?d.none():-1===m?r():-1===p?s():p<m&&q>k?s():m<p&&k>q?r():m<p?s():p<m?r():d.none()},endBracket:e}});k("159",["15p","15a","15q","s","p"],function(b,d,c,a,e){var f=function(a,b){return c.identify(a,b)},g=function(a){return 0<=a.indexOf("\\pngblip")?e.value("image/png"):0<=a.indexOf("\\jpegblip")?e.value("image/jpeg"):e.error("errors.imageimport.unsupported")},h=function(a,
b){var c=a.match(b);return c&&c[1]&&0===c[1].length%2?e.value(c[1]):e.error("errors.imageimport.invalid")},l=function(b){b=b.match(/\\shplid(\d+)/);return null!==b?a.some(b[1]):a.none()},m=function(a){var c=a.bower(),e=a.regex();return l(c).map(function(f){var l=a.idRef()+f;return g(c).fold(function(a){return d.unsupported(l,a)},function(a){return h(c,e).fold(function(a){return d.unsupported(l,a)},function(c){return d.supported(l,a,b.convert(c,a))})})})},k=function(a){for(var b=[],c=function(){return a.length},
d=function(a){var c=m(a);b=b.concat(c.toArray());return a.end()},e=0;e<a.length;)e=f(a,e).fold(c,d);return b};return{nextBower:f,extractId:l,extractContentType:g,extractHex:h,images:function(a){a=a.replace(/\r/g,"").replace(/\n/g,"");return k(a)}}});k("14q",["159","15a","p"],function(b,d,c){return{images:function(a){return b.images(a)},toId:function(a){return d.cata(a,function(a,b){return a},function(a,b,c){return a})},toBlob:function(a){return d.cata(a,function(a,b){return c.error(b)},function(a,
b,d){return c.value(d)})}}});k("14r","14q 12x b fx 7 s 1a 1x o".split(" "),function(b,d,c,a,e,f,g,h,l){var m={local:function(a,b,c){return f.from(b[c])},code:function(a,d,e){d=c.find(d,function(c){return b.toId(c)===a});return f.from(d)}},k=function(a){var d=[],e=function(a){return!c.exists(d,function(c){return b.toId(c)===a})};return c.bind(a,function(a){var c=b.toId(a);return e(c)?(d.push(a),[a]):[]})};return{convert:function(e,q,r,s){var t=k(q),u=[],v=!1;e=c.bind(e,function(a,c){var d=g.get(a,
"data-image-type"),e=g.get(a,"data-image-id");h.remove(a,"rtf-data-image");g.remove(a,"data-image-type");g.remove(a,"data-image-id");return(void 0!==m[d]?m[d]:f.none)(e,t,c).fold(function(){l.log("WARNING: unable to find data for image ",a.dom());return[]},function(c){return b.toBlob(c).fold(function(b){v=!0;g.set(a,"alt",s(b));return[]},function(b){u.push(a);return[b]})})});a.multiple(e).get(function(a){var b=d.updateSources(a,u);r(a,b,v)})}}});k("137","14q 14r 138 4x 3z 29".split(" "),function(b,
d,c,a,e,f){return function(g){var h=g.translations,l=e.create({insert:a(["elements","assets","correlated"]),incomplete:a(["elements","assets","correlated","message"])});return{events:l.registry,processRtf:function(a,e,g,k,r){k=b.images(k);var s=c.find(a);d.convert(s,k,function(b,c,d){var h=f.children(a);b=b.concat(e);c=c.concat(g);d?l.trigger.incomplete(h,b,c,"errors.imageimport.failed"):l.trigger.insert(h,b,c);r()},h)}}}});k("136","137 b 138 4x 3z 2o 29".split(" "),function(b,d,c,a,e,f,g){return function(h,
l){var m=e.create({error:a(["message"]),insert:a(["elements","assets","correlated"]),incomplete:a(["elements","assets","correlated","message"])}),k=b(l);k.events.incomplete.bind(function(a){m.trigger.incomplete(a.elements(),a.assets(),a.correlated(),a.message())});k.events.insert.bind(function(a){m.trigger.insert(a.elements(),a.assets(),a.correlated())});return{events:m.registry,gordon:function(a,b,e){var s=function(c){k.processRtf(a,b,e,c.rtf(),c.hide())},t=function(h){var l=c.find(a);d.each(l,f.remove);
m.trigger.incomplete(g.children(a),b,e,h)},u=function(){var h=c.find(a);d.each(h,f.remove);m.trigger.insert(g.children(a),b,e)},v=function(a){t(a.message())};if(!0===l.allowLocalImages&&!0===l.enableFlashImport){var w=h(l);w.events.response.bind(s);w.events.cancel.bind(u);w.events.failed.bind(v);w.events.error.bind(v);w.open()}else t("errors.local.images.disallowed")}}}});k("10b","12u 12v 136 137 102 b 138 7 s 4f l 35 2o 29".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){return function(s,t){var u=
c(s,t),v=a(t),w=m(l.none()),x=function(a){w.get().each(function(c){b.call(c,{response:a,bundle:d.nu({})})})};u.events.insert.bind(function(a){x(e.paste(a.elements(),a.assets(),a.correlated()))});u.events.incomplete.bind(function(a){x(e.incomplete(a.elements(),a.assets(),a.correlated(),a.message()))});u.events.error.bind(function(a){a=a.message();a=e.error(a);x(a)});v.events.insert.bind(function(a){x(e.paste(a.elements(),a.assets(),a.correlated()))});v.events.incomplete.bind(function(a){x(e.incomplete(a.elements(),
a.assets(),a.correlated(),a.message()))});return function(a,c){return b.sync(function(d){var m=function(){b.call(d,{response:c.response(),bundle:c.bundle()})},s=function(b,c,s){w.set(l.some(d));var B=k.fromTag("div");p.append(B,b);a.rtf().fold(function(){g.exists(B)?u.gordon(B,c,s):m()},function(a){!0===t.allowLocalImages?v.processRtf(B,c,s,a,h.noop):(a=g.find(B),f.each(a,q.remove),x(e.incomplete(r.children(B),c,s,"errors.local.images.disallowed")))})};e.cata(c.response(),m,s,m,s)})}}});k("wf","104 105 106 107 108 109 10a 10b c 7 s 33 v 31".split(" "),
function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){var s=p.immutable("data","rtf"),t=l.detect(),u=["image","file"],v=function(a){var b=a.clipboardData;return c.isValidData(b)?c.getFlavor(b.types,"html").bind(function(c){c=b.getData(c.type);return q.contains(c,"<html")&&(q.contains(c,'xmlns:o="urn:schemas-microsoft-com:office:office"')||q.contains(c,'xmlns:x="urn:schemas-microsoft-com:office:excel"'))?k.some(s(c,z(a))):k.none()}):k.none()},w=function(a){return s(a,k.none())},x=function(a){if(t.browser.isIE()||
t.browser.isFirefox())return k.none();if(c.isValidData(a.clipboardData)){var b=a.clipboardData;return c.getPreferredFlavor(u,b.types).map(function(a){return b.items})}return k.none()},y=function(a,b){var d=c.isValidData(b.clipboardData)?b.clipboardData.types:[];return c.getFlavor(d,a.clipboardType()).map(function(a){return s(b,k.none())})},B=function(a){return t.browser.isIE()?k.some(r.clipboardData):c.isValidData(a.clipboardData)?k.some(a.clipboardData):k.none()},z=function(a){var b=a.clipboardData;
return c.isValidData(b)?c.getFlavor(b.types,"rtf").bind(function(a){a=b.getData(a.type);return 0<a.length?k.some(a):k.none()}):k.none()},A=function(a,b,c,d){return{label:m.constant(a),getAvailable:b,steps:m.constant(c),capture:m.constant(d)}};return{internal:function(a,c,h,l){var k=m.curry(y,l);return A("Within Textbox.io (tables) pasting",k,[b.normal(g(c,a,h,l,d.ignore)),b.normal(e.fixed(!0,!0)),b.normal(f.internal(h,l))],!1)},pastiche:function(c,l,m,k,n,p,q){return A("Outside of Textbox.io pasting (could be internal but another browser)",
w,[b.normal(g(k,m,n,q,d.background)),b.normal(e.fromConfigIfExternal(c,l)),b.normal(f.external(n,q)),b.blocking(h(p,l)),b.normal(a())],!1)},gwt:function(a,c,d,g){return A("GWT pasting",v,[b.normal(f.setBundle({isWord:!0})),b.normal(e.fromConfig(c,d)),b.normal(f.gwt(a)),b.blocking(h(g,d))],!0)},image:function(a){return A("Image pasting",x,[b.normal(!1===a.allowLocalImages?f.noImages(m.noop):f.images())],!0)},text:function(){return A("Plain text pasting",B,[b.normal(f.plain),b.normal(f.autolink)],!0)},
none:function(){return A("There is no valid way to paste",k.some,[b.normal(f.none)],!1)}}});k("139","pg c 1a 1x l 2d 35".split(" "),function(b,d,c,a,e,f,g){var h=function(a){return e.fromHtml("<p>"+a("cement.dialog.flash.press-escape")+"</p>")};return{paste:function(c){var f=e.fromTag("div");a.add(f,b.resolve("flashbin-helpcopy"));var k;k=d.detect().os.isOSX()?["\u2318"]:["Ctrl"];var p=e.fromHtml("<p>"+c("cement.dialog.flash.trigger-paste")+"</p>");k=e.fromHtml('<div><span class="ephox-polish-help-kbd">'+
k+'</span> + <span class="ephox-polish-help-kbd">V</span></div>');a.add(k,b.resolve("flashbin-helpcopy-kbd"));g.append(f,[p,k,h(c)]);return f},noflash:function(c){var d=e.fromTag("div");a.add(d,b.resolve("flashbin-helpcopy"));var f=e.fromHtml("<p>"+c("cement.dialog.flash.missing")+"</p>");g.append(d,[f,h(c)]);return d},indicator:function(d){var h=e.fromTag("div");a.add(h,b.resolve("flashbin-loading"));var k=e.fromTag("div");a.add(k,b.resolve("flashbin-loading-spinner"));var p=e.fromTag("p");d=d("loading.wait");
f.set(p,d);c.set(p,"aria-label",d);g.append(h,[k,p]);return h}}});aa("13a",navigator);k("10c","139 pg c 7 1x 2l l 2m 35 13a".split(" "),function(b,d,c,a,e,f,g,h,l,m){var k=c.detect(),p=function(c,d,e,f){d=b.noflash(f);h.append(c,d);return{reset:a.noop}},q=function(a,c,d,e){var g=b.paste(e),h=b.indicator(e);l.append(a,[h,g,c.element()]);a=function(){f.set(g,"display","block");f.set(h,"display","none");d()};c.events.spin.bind(function(){f.set(g,"display","none");f.set(h,"display","block");f.remove(h,
"height");f.remove(h,"padding");d()});c.events.reset.bind(a);c.events.hide.bind(function(){f.setAll(h,{height:"0",padding:"0"})});return{reset:a}};return function(b,c,f){var h=g.fromTag("div"),l="flashbin-wrapper-"+(k.os.isOSX()?"cmd":"ctrl");e.add(h,d.resolve(l));var w;try{w=void 0!==(k.browser.isIE()?new ActiveXObject("ShockwaveFlash.ShockwaveFlash"):m.plugins["Shockwave Flash"])}catch(x){w=!1}b=(w?q:p)(h,b,c,f.translations);return{element:a.constant(h),reset:b.reset}}});k("13b","s 4x 3z 4f 2q 2r".split(" "),
function(b,d,c,a,e,f){return{responsive:function(){var g=a(b.none()),h=c.create({crashed:d([]),timeout:d([])});return{start:function(a,c,d,k){var q=c,r=f(function(){d()?e(r):0>=q?(h.trigger.timeout(),e(r)):k()&&(e(r),h.trigger.crashed());q--},a);g.set(b.some(r))},stop:function(){g.get().each(function(a){e(a)})},events:h.registry}}}});k("13c",["a","b","2q","2r"],function(b,d,c,a){return function(e,f,g){var h=function(a){return d.forall(f,function(c){return b.isFunction(a[c])})},l=!0,m=a(function(){var a=
e.dom();b.isFunction(a.PercentLoaded)&&100===a.PercentLoaded()&&h(a)&&(k(),g())},500),k=function(){l&&(c(m),l=!1)};return{stop:k}}});aa("13d",unescape);k("10d","13b 13c pg b 1n 2w c 4q 7 s 4x 3z 2k 1x 2l l 2v 2m 2q 65 o 2r 3m 13d 31".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q,r,s,t,u,v,w,x,y,B,z,A,C){var D=h.install("ephox.flash"),E=g.detect(),F=m.none();return function(g){var h=p.create({response:k(["rtf"]),spin:k([]),cancel:k([]),error:k(["message"]),reset:k([]),hide:k([]),failed:k(["message"])}),
m=!1,w=t.fromTag("div");r.add(w,c.resolve("flashbin-target"));var B=b.responsive();B.events.crashed.bind(function(){h.trigger.failed("flash.crashed")});B.events.timeout.bind(function(){h.trigger.failed("flash.crashed")});var K=function(){U.stop();if(!m){m=!0;try{var a=O.dom();e.each(P,function(b,c){var d=a[c];if(void 0===d)throw'Flash object does not have the method "'+c+'"';d.call(a,b)});h.trigger.reset();x(X);r.remove(w,c.resolve("flash-activate"));V();N()}catch(b){y.log("Flash dialog - Error during load: ",
b)}}},M=D.permanent(K),Q=function(){return!q.inBody(O)},R=function(){return!O.dom().SetVariable},P={setSpinCallback:D.permanent(function(){B.start(1E3,10,Q,R);h.trigger.spin()}),setPasteCallback:D.permanent(function(a){B.stop();z(function(){""===a?h.trigger.error("flash.crashed"):h.trigger.response(A(a))},0)}),setEscapeCallback:D.permanent(h.trigger.cancel),setErrorCallback:D.permanent(function(a){B.stop();h.trigger.error(a)}),setStartPasteCallback:D.permanent(l.noop)},O=function(){var a=g.replace(/^https?:\/\//,
"//"),b='    <param name="allowscriptaccess" value="always">    <param name="wmode" value="opaque">    <param name="FlashVars" value="onLoad='+M+'">';if(E.browser.isIE()&&10===E.browser.version.major){var c=f.generate("flash-bin");return t.fromHtml('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="'+c+'"><param name="movie" value="'+a+'">'+b+"</object>")}return t.fromHtml('<object type="application/x-shockwave-flash" data="'+a+'">'+b+"</object>")}(),V=function(){s.setAll(O,{width:"2px",
height:"2px"})};V();var U=d(O,e.keys(P),K);v.append(w,O);var N=function(){E.browser.isFirefox()&&C.getSelection().removeAllRanges();u.focus(O)},X=null,T=function(){r.add(w,c.resolve("flash-activate"));s.remove(O,"height");s.remove(O,"width");h.trigger.hide()},W=function(){s.set(w,"display","none");F.each(function(b){a.each(b,function(a){a.unbind()})})};return{focus:N,element:function(){return w},activate:function(){X=z(T,3E3);h.trigger.spin();s.set(w,"display","block");N()},deactivate:W,destroy:function(){W();
a.each(e.values(P),function(a){D.unregister(a)});D.unregister(M);U.stop()},events:h.registry}}});k("wg","10c 10d 4x 3z 3n l 31".split(" "),function(b,d,c,a,e,f,g){return function(h,l){var m=l.translations,k=a.create({response:c(["rtf","hide"]),cancel:c([]),error:c(["message"]),failed:c(["message"])});return{open:function(){var a=d(l.swf);a.deactivate();var c=f.fromDom(g),r=e.bind(c,"mouseup",a.focus),s=function(){v()},c=function(){v();k.trigger.cancel()};a.events.cancel.bind(c);a.events.response.bind(function(a){k.trigger.response(a.rtf(),
s)});a.events.error.bind(function(a){v();k.trigger.error(a.message())});a.events.failed.bind(function(a){v();k.trigger.failed(a.message())});var t=h();t.setTitle(m("cement.dialog.flash.title"));var u=b(a,t.reflow,l);u.reset();t.setContent(u.element());t.events.close.bind(c);t.show();a.activate();var v=function(){r.unbind();t.destroy();a.destroy()}},events:k.registry}}});k("13e",["7","1b"],function(b,d){return function(c,a,e,f){var g=d.eq(c,e)&&a===f;return{startContainer:b.constant(c),startOffset:b.constant(a),
endContainer:b.constant(e),endOffset:b.constant(f),collapsed:b.constant(g)}}});k("10e",["13e","l","2m","2o","29"],function(b,d,c,a,e){return function(f){var g=d.fromTag("br");return{cleanup:function(){a.remove(g)},toOn:function(a,b){a.dom().focus()},toOff:function(a,d){var m;m=e.owner(d).dom().defaultView;m.focus();c.append(d,g);f.set(m,b(g,0,g,0))}}}});k("10f",["7"],function(b){return function(){return{toOn:function(b,c){b.dom().focus()},toOff:function(b,c){c.dom().focus()},cleanup:b.identity}}});
k("14s","b l 2m 35 2o 29".split(" "),function(b,d,c,a,e,f){var g=function(g,l){var m=f.children(g);b.each(m,function(b){if(l(b)){var g=f.children(b),h=d.fromTag("div",f.owner(b).dom());a.append(h,g);c.before(b,h);e.remove(b)}})};return{consolidate:function(b,c){f.nextSibling(b).filter(c).each(function(c){var d=f.children(c);a.append(b,d);e.remove(c)});g(b,c)}}});k("14t",["48"],function(b){return{resolve:b.create("ephox-sloth").resolve}});k("13f","2w 33 14s 14t 1a 1x 43 2l l 2d 2m 2o 2y 29".split(" "),
function(b,d,c,a,e,f,g,h,l,m,k,p,q,r){var s=a.resolve("bin"),t=s+b.generate("");return function(a){var b=l.fromTag("div");e.set(b,"contenteditable","true");g.add(b,[s,t]);h.setAll(b,{position:"absolute",left:"0px",top:"0px",width:"1px",height:"1px",overflow:"hidden",opacity:"0"});var w=function(a){return f.has(a,t)};return{attach:function(a){p.empty(b);k.append(a,b)},focus:function(){q.ancestor(b,"body").each(function(c){a.toOff(c,b)})},contents:function(){c.consolidate(b,w);var a=d.immutable("elements",
"html","container"),e=r.children(b),f=m.get(b);return a(e,f,b)},container:function(){return b},detach:function(){p.remove(b)}}}});k("10g","7 dv 4x 3z 103 13f 29".split(" "),function(b,d,c,a,e,f,g){return function(h,l){var m=f(h),k=function(){h.cleanup();var a=m.contents();m.detach();q.trigger.after(a.elements(),a.html(),m.container())},p=d.tap(function(){q.trigger.before();m.attach(l);m.focus();e.run(g.owner(l),p,k)}),q=a.create({before:c([]),after:c(["elements","html","container"])}),r=b.noop;return{instance:b.constant(function(){p.instance()}),
destroy:r,events:q.registry}}});k("wh","c ap 4x 3z 10e 10f 10g 20".split(" "),function(b,d,c,a,e,f,g,h){var l=b.detect(),m={set:function(a,b){d.setExact(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())}},k=function(a){return(l.browser.isIE()&&"body"!==h.name(a)?f:e)(m)};return function(b){var d=a.create({after:c(["container"])}),e=k(b),f=g(e,b);f.events.after.bind(function(a){e.toOn(b,a.container());d.trigger.after(a.container())});return{run:function(){f.instance()()},events:d.registry}}});
k("10h","c 4q 7 r s 13g 2k 2l 3n l 2m 2n 2o".split(" "),function(b,d,c,a,e,f,g,h,l,m,k,p,q){var r=d.install("ephox.keurig.init"),s=e.none();b=b.detect();var t=b.browser;return{load:t.isIE()||t.isSpartan()||b.deviceType.isiOS()||b.deviceType.isAndroid()?c.noop:a.cached(function(a){var b=m.fromTag("div");if(void 0===a)throw"baseUrl was undefined";var c=m.fromTag("iframe");h.setAll(b,{display:"none"});var d=l.bind(c,"load",function(){var g=r.ephemeral(function(a){s=e.some(a);t.isSafari()||q.remove(b)});
f.write(c,'<script type="text/javascript" src="'+(a+"/wordimport.js")+'">\x3c/script><script type="text/javascript">function gwtInited () {parent.window.'+g+"(com.ephox.keurig.WordCleaner.cleanDocument);};\x3c/script>");d.unbind()});p.execute(function(){k.append(g.body(),b);k.append(b,c)})}),cleanDocument:function(a,b){return s.map(function(c){return c(a,b)})},ready:function(){return s.isSome()}}});k("wi",["10h"],function(b){return function(d){b.ready()||b.load(d);return{cleanDocument:b.cleanDocument}}});
k("pz","we wf wg wh b 2w wi 7 s".split(" "),function(b,d,c,a,e,f,g,h,l){return function(m,k,p,q){var r=g(q.baseUrl),s=h.curry(c,k),t=void 0!==q.intraFlag?q.intraFlag:{clipboardType:f.generate("clipboard-type"),findClipboardTags:l.none},r=e.flatten([void 0!==q.intraFlag?[d.internal(p,a,m,t)]:[],[d.gwt(r,k,q,s)],[d.image(q)]]);m=d.pastiche(k,q,p,a,m,s,t);return b(r,m)}});k("q0",["we","wf"],function(b,d){return function(){return b([d.text()],d.none())}});k("q1","b 7i fk 85 g9 dd 7 fl fm 30 4x 3z 4f 1a 1x l 35 2o 3m".split(" "),
function(b,d,c,a,e,f,g,h,l,m,k,p,q,r,s,t,u,v,w){return function(x,y){return function(B){var z=p.create({close:k([])}),A=h(x);A.events.close.bind(function(){z.trigger.close()});s.add(A.element(),m.resolve("external-dialog"));B&&s.add(A.element(),m.resolve("dialog-vertical-controls"));var C=t.fromTag("div"),D=q([]),E=function(a){var b=e();if(void 0===a.text)throw"dialog button did not specify text";b.content(f(a.text));d.button(b.element(),a.text);void 0!==a.tabindex&&r.set(b.element(),"tabindex",a.tabindex);
void 0!==a.className&&s.add(b.element(),a.className);void 0!==a.click&&b.events.click.bind(a.click);s.add(b.element(),m.resolve("dialog-button"));return b};return{element:A.element,events:z.registry,setTitle:A.setTitle,setContent:A.setContent,setButtons:function(a){v.empty(C);a=b.map(a,E);u.append(C,b.map(a,function(a){return a.element()}));D.set(a);A.setControls(C)},reflow:g.noop,show:function(){y.hideInlineSelection();A.show();var d=b.map(D.get(),function(b){return a.button(b.element(),c.button({execute:l.click}))}),
e=a.multipleAll(A.element(),d);e.events.exit.bind(function(){z.trigger.close()});w(function(){e.enter()},0)},destroy:function(){b.each(D.get(),function(a){a.destroy()});D.set([]);A.destroy()}}}}});k("q2",["9"],function(b){return function(d,c,a){var e={"errors.imageimport.unsupported":"errors.images.import.unsupported","errors.imageimport.invalid":"errors.images.import.invalid"};return{baseUrl:a.baseUrl,enableFlashImport:a.enableFlashImport,swf:a.swf,officeStyles:a.officeStyles,htmlStyles:a.htmlStyles,
translations:function(a){var c=b.prototype.slice.call(arguments,1);return d.translate.apply(void 0,[void 0!==e[a]?e[a]:a].concat(c))},allowLocalImages:a.allowLocalImages,intraFlag:c}}});k("hy","pz q0 q1 6u q2 hs".split(" "),function(b,d,c,a,e,f){var g=function(d,g,m,k){var p=c(d.uiContainer(),k),q=function(a){g.filterDom(g.paste(),a)},r=e(a,f.intraFlag(),m);return function(a){return b(a,p,q,r)}};return function(a,b,c,e){return!0===c.forceText?d:g(a,b,c,e)}});k("a8","hv b 3f c s hw hx ad ba 8d hy be 4x 3z bs 1a l 35 29 v".split(" "),
function(b,d,c,a,e,f,g,h,l,m,k,p,q,r,s,t,u,v,w,x){return function(y,B,z,A){var C=a.detect(),D=y.filter(),E=y.content(),F=y.undo(),G=y.smartview(),I=y.region(),H=y.internalevents(),L=k(G,D,A,E),J=e.none(),K=r.create({analytics:q(["message"])}),M=function(a){Q(a.message())},Q=function(a){"webview.imagepaste"!==a&&(a=l(p.get(a,[])),y.ui().displayBanner(a));R()},R=function(){c.unblock();E.focus()};D.add(D.history(),b.binStyle(),s.remove);!1===A.allowLocalImages&&D.addSelector(D.paste(),"img[src]",function(a){a=
d.filter(a,function(a){a=t.get(a,"src");return x.startsWith(a,"data")||x.startsWith(a,"blob")});0!==a.length&&(Q("errors.local.images.disallowed"),s.remove(a))});if(C.os.isiOS()&&C.browser.isSafari()){var P=C.deviceType.isWebView()?"webview.imagepaste":"safari.imagepaste";D.addSelector(D.paste(),'img[src^="webkit-fake-url"]',function(a){0!==a.length&&(Q(P),s.remove(a))})}E.events.ready.bind(function(a){var b=h.get(E,G,a.api().doc()),d=g.rules(E,I,b),l=f(E);a=a.api();var k=L(a.body());J=e.some(k);
a.events.paste.bind(function(a){k.isBlocked()||(l.backup(),c.block());k.paste(a.original().raw())});k.events.cancel.bind(function(){R();l.cancel()});var n=m.processResults(Q);k.events.error.bind(M);k.events.insert.bind(function(a){z.correlated(a.correlated()).map(n).get(function(b){R();F.save();var c=u.fromTag("div");v.append(c,a.elements());D.filterDom(D.input(),c);c=w.children(c);l.insert(c,[d.collapsed()],[d.ranged()]);H.input(c);E.domChanged();K.trigger.analytics("paste_action");B.pasteUpload();
B.uploadAssets(b)})})});return{destroy:function(){J.each(function(a){a.destroy()})},events:K.registry}}});k("5q",["a7","a8"],function(b,d){return function(c,a,e,f){var g=b(c,f.copy),h=d(c,a,e,f.paste);return{destroy:function(){g.destroy();h.destroy()}}}});k("q3",["b","1n","w"],function(b,d,c){var a=function(a){for(var b=[],d=a.start.charCodeAt(0);d<=a.finish.charCodeAt(0);d++)b.push(c.fromCharCode(d));return b},e=function(a){return{start:a,finish:a}};return function(){var c={latin:[{start:"A",finish:"Z"},
{start:"a",finish:"z"},{start:"\u00c0",finish:"\u00ff"}],punctuation:[{start:"!",finish:"/"},{start:":",finish:"@"},{start:"[",finish:"`"},{start:"{",finish:"~"},{start:"\u00a1",finish:"\u00bf"},{start:"\u2010",finish:"\u2027"},{start:"\u2030",finish:"\u205e"}],currency:[e("$"),{start:"\u00a2",finish:"\u00a5"},{start:"\u20a0",finish:"\u20bd"},e("\u5186"),e("\u5143"),e("\u5713"),e("\u5706")],"extended-latin-a":[{start:"\u0100",finish:"\u017f"}],"extended-latin-b":[{start:"\u0180",finish:"\u024f"}],
arrows:[{start:"\u2190",finish:"\u21ff"},e("\u2794"),{start:"\u2798",finish:"\u27af"},{start:"\u27b1",finish:"\u27be"}],mathematical:[{start:"\u2795",finish:"\u2797"},{start:"\u2200",finish:"\u22ff"}],miscellaneous:[{start:"\u2701",finish:"\u275e"},{start:"\u2761",finish:"\u2793"},e("\u27b0"),e("\u27bf")]},g={};d.each(c,function(c,d,e){g[d]=b.bind(c,a)});return g}});k("q4","7 fn 30 3z 40 1x l 35".split(" "),function(b,d,c,a,e,f,g,h){return{controls:function(l){var k=l+"-";l=g.fromTag("div");f.add(l,
c.resolve(k+"dialog-controls"));var n=d.button(k,"cancel","button.cancel"),p=d.button(k,"insert","specialchar.insert");d.makeNormal(n.element());d.makeDefault(p.element());h.append(l,[n.element(),p.element()]);k=a.create({insert:e([],p.events.click),cancel:e([],n.events.click)});return{element:b.constant(l),ok:b.constant(p),cancel:b.constant(n),destroy:function(){p.destroy();n.destroy()},events:k.registry}}}});k("q5","b 1n w2 fs ft 6u 30 1a 1x 43 l 2m 35 1r 31".split(" "),function(b,d,c,a,e,f,g,h,
l,k,n,p,q,r,s){var t=function(a){var b=n.fromTag("span");l.add(b,g.resolve("special-char"));var c=n.fromTag("span"),d=n.fromHtml(a);h.setAll(b,{"data-ephox-polish-special-char":a,"data-ephox-polish-char-code":a.charCodeAt(0).toString(16),"aria-label":a,role:"gridcell",tabindex:"-1"});p.append(c,d);p.append(b,c);return b},u=function(a,d){var e=n.fromTag("div");k.add(e,[g.resolve("special-char-row"),g.resolve("special-char-row-"+d)]);c.row(e);b.each(a,function(a){p.append(e,t(a))});return e},v=function(a,
d,e){var h=n.fromTag("div");l.add(h,g.resolve(d));c.base(h,f.translate("specialchar."+d));a=b.chunk(a,e);a=b.map(a,function(a){return u(a,d)});q.append(h,a);return h};return{generateItems:function(b){var c=600>=r.min(s.innerWidth,s.innerHeight)?12:16;return d.mapToArray(b,function(b,d){var g=v(b,d,c);return e(f.translate("specialchar."+d),a(g))})}}});k("hz","b fk 85 fu 7 q3 fl fm kd o6 6u 3f q4 q5 30 4x 3z 1a 1x 3n 2v 2m 6e 2y 29 2z".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x,y,B,
z,A,C,D){var E=function(a){var b={item:e.constant(".ephox-pastry-statebutton.ephox-pastry-tablayout-item")},f=d.flow({trigger:h.button,executeOnArrow:!0});return c.flow(a.menu(),b,f)},F=function(a){return z.closest(a,".ephox-pastry-tablayout-active")},G=function(a){var b={row:e.constant(".ephox-pastry-tablayout-active ."+s.resolve("special-char-row")),cell:e.constant(".ephox-pastry-tablayout-active ."+s.resolve("special-char"))},f=d.tabular({trigger:h.click,isValid:F});return c.tabular(a.body(),b,
f)};return function(e){e=e().uiContainer();var z=u.create({insert:t(["string"]),close:t([])}),F=g(e);e=f();e=r.generateItems(e);var J=l.input("specialchar","specialchar.selects"),K=k(a.left(),e,s.resolve("specialchars"));w.add(K.body(),s.resolve("specialchar-body"));w.add(F.element(),s.resolve("specialchar-dialog"));b.each(C.children(K.element()),p.register);var M=x.bind(F.element(),"click",function(a){a=a.target();A.closest(a,"[data-ephox-polish-special-char]").each(function(a){y.focus(a);var b=
v.get(a,"data-ephox-polish-special-char");a=J.input();b=D.get(a)+b;D.set(a,b)})}),Q=q.controls("specialchar");F.setTitle(n.translate("specialchar.dialog"));F.setContent(K.element());F.setControls(Q.element());B.after(K.element(),J.element());e=function(){F.hide();D.set(J.input(),"");z.trigger.close()};var R=E(K),P=G(K),O=h.setup(F,Q,[R,P,c.input(J.input(),d.input({}))]);K.events.setActive.bind(function(a){R.clickFocus(a.item().element())});F.events.close.bind(function(){O.exit();z.trigger.close()});
Q.events.cancel.bind(e);F.events.close.bind(e);Q.events.insert.bind(function(){z.trigger.insert(D.get(J.input()))});return{element:F.element(),events:z.registry,open:function(){F.show();O.enter()},destroy:function(){M.unbind();F.destroy();K.destroy();Q.destroy();O.destroy()},close:function(){F.hide();D.set(J.input(),"")}}}});k("a9",["hz","4x","3z","40"],function(b,d,c,a){return function(e){var f=b(e),g=c.create({insert:a(["string"],f.events.insert),close:d([])}),h=function(){g.trigger.close();f.close()};
f.events.close.bind(h);return{show:function(){f.open()},close:h,destroy:function(){f.events.close.unbind(h);f.destroy()},events:g.registry}}});k("5r","8w 7 8x 8q 6u a9 6l l".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var k=l.content(),n=l.smartview,p=function(a){a=h.fromText(a.string());c.insertAtCursor(k,[a]).each(function(a){a=b.after(a.element());k.setRelativeSelection(a,a);k.focus();k.toEditing()})},q=a.destroyable(),r=function(){q.clear()};return{ui:g.ui({"specialchar.general":{toggle:!1,
value:"specialchar",textkey:e.key("specialchar.open"),action:function(){var a=f(n);q.set(a);a.events.close.bind(function(){k.focus();r()});a.events.insert.bind(function(a){p(a);r()});l.content().hideInlineSelection();a.show()},updateGeneral:d.noop,icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!0}}),destroy:r}}});k("aa",["7","s","6f","6j","1a"],function(b,d,c,a,e){return function(f,g,h,l){var k=f.profile(),n=f.content(),p=b.noop,q=function(a){n.body().each(function(b){e.set(b,"spellcheck",a)})};k.events.spelling.bind(function(a){q(a.value())});
return{events:c(["analytics"]),init:function(a){a.body().each(function(a){var b=k.spelling().get();q(b);p=function(){e.remove(a,"spellcheck")}})},check:b.noop,situation:a.noSituation,handle:b.noop,assign:b.noop,destroy:function(){p()},state:b.constant({}),exclude:b.noop,lookup:b.constant(d.none()),name:b.constant("spelling-disabled")}}});k("wj",["33"],function(b){return b.immutable("suggestions","ignore")});k("wk",["54","5z"],function(b,d){return{clean:function(c){var a=new d(b.zeroWidth(),"g"),e=
new d("[\u2018\u2019]","g");return c.replace(a,"").replace(e,"'")}}});k("q6",["wj","wk","1n","s"],function(b,d,c,a){return function(e){var f={},g=function(c,e){var g=d.clean(c);f.hasOwnProperty(g)&&void 0!==f[g]||(f[g]=b(a.some(e),!1))},h=function(c){c=d.clean(c);var e=f.hasOwnProperty(c)?f[c]:void 0,e=void 0!==e?e.suggestions():a.none(),e=b(e,!0);f[c]=e};c.each(void 0!==e?e:{},function(a,b){!0===a.ignore&&h(b);void 0!==a.suggestions&&g(b,a.suggestions)});return{add:g,get:function(b){b=d.clean(b);
return f.hasOwnProperty(b)?a.from(f[b]):a.none()},ignore:h,suggestions:function(b){b=d.clean(b);return(f.hasOwnProperty(b)?a.from(f[b]):a.none()).bind(function(a){return a.suggestions()})},state:function(){var a={};c.each(f,function(b,c){a[c]={ignore:b.ignore(),suggestions:b.suggestions().getOr([])}});return a},destroy:function(){f={}}}}});k("i0",["q6"],function(b){return function(d){return b(d)}});k("i1",["bs"],function(b){return{configure:function(d){d.add(d.internal(),"ephox-cram-annotation-wrap",
b.unwrap);d.add(d.output(),"ephox-cram-annotation-wrap",b.unwrap);d.add(d.paste(),"ephox-cram-annotation-wrap",b.unwrap)}}});k("i2",["7","43","32"],function(b,d,c){return function(){var a=[];return{exclude:function(b){return d.hasAny(b,a)||c.ancestor(b,function(b){return d.hasAny(b,a)})},add:function(b){a.push(b)},destroy:b.noop}}});k("13k","b 7 s m9 20 68 9y 29".split(" "),function(b,d,c,a,e,f,g,h){var l=function(a){return b.bind(a,function(a){return f.descendants(a,e.isText)})};return{textnodes:l,
text:function(a){a=l(a);return b.map(a,function(a){return e.isText(a)?g.get(a):""}).join("")},parsed:function(b){return c.from(b[0]).bind(function(b){b=a.cluster(b,d.constant(!1)).words();return 1===b.length?c.some(b[0]).map(function(a){return a.word()}):c.none()})},children:function(a){return b.bind(a,h.children)}}});k("10n","b 13k s 35 2o 9y".split(" "),function(b,d,c,a,e,f){return{clobber:function(g,h){var l=d.children(g),k=d.textnodes(g);return c.from(g[0]).bind(function(d){a.before(d,l);d=c.from(k[0]);
d.each(function(a){f.set(a,h)});b.each(k.slice(1),function(a){f.set(a,"")});b.each(g,e.remove);return d})}}});k("10o","wq zq zr 7 s gn 1a 1x l".split(" "),function(b,d,c,a,e,f,g,h,l){var k=d.resolve("annotation"),n=c.resolve("annotation-wrap");return{nu:function(){var a=l.fromTag("span");h.add(a,n);g.set(a,"aria-invalid","spelling");return f.nu(a)},set:function(a,b){g.set(a,k,b)},label:a.constant(n),detail:function(c){return b.id(c).bind(function(b){return e.from(g.get(c,k)).map(function(c){return{id:a.constant(b),
word:a.constant(c)}})})}}});k("10p",["b","wq","zr","1x"],function(b,d,c,a){var e=c.resolve("wrap-disabled");return{enable:function(c){c=d.all(c);b.each(c,function(b){a.remove(b,e)})},disable:function(c){c=d.all(c);b.each(c,function(b){a.add(b,e)})}}});k("13l",["33"],function(b){return b.immutable("id","elements","word")});k("13m",[],function(){var b=function(b){return{fold:b}};return{success:function(d){return b(function(b,a){a(d)})},fail:function(d){return b(function(b,a){b(d)})}}});k("10q","b 1n 13l 13m wq 13k 2k".split(" "),
function(b,d,c,a,e,f,g){var h=function(a,d){var f={};b.each(a,function(a){e.marker(a,d.label()).filter(g.inBody).each(function(a){d.detail(a).each(function(b){var d=b.id();b=b.word();var g=e.all(a);0<g.length&&(f[d]=c(d,g,b))})})});return f},l=function(c){c=d.values(c);return b.map(c,function(b){var c=b.elements(),d=b.word(),e=f.text(c),c=f.parsed(c);return e===d&&c.is(d)?a.success(b):a.fail(b)})};return{verify:function(a,c,d,e){a=h(a,c);a=l(a);b.each(a,function(a){var c=function(a){return function(c){b.each(c.elements(),
a)}};a.fold(c(e),c(d))})}}});k("wr","b 10n 10o vl wq 10p vm 10q 7 s gn 2o".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p){var q=function(a){return e.marker(a,c.label())};return{highlight:function(d,l,k,m){l=l.elements();h.verify(l,c,f.enable,p.unwrap);k=g.matchWords(l,k,m);k=g.annotates(k,c.label());return b.bind(k,function(f){return f.current().fold(function(){var g=f.match(),h=g.word();if(d.ignore(g))return[];g=n.wrapper(g.elements(),c.nu)||[];b.each(g,function(a){e.set(a,f.id());c.set(a,h)});return[a.created(g)]},
function(b){return[a.preserved(b)]})})},marker:q,substitute:function(a,b){var c=q(a).fold(l.constant([]),e.all);return d.clobber(c,b)},detail:function(a){return c.detail(a)}}});k("13h",["b","wr","7"],function(b,d,c){return{highlight:function(a,e,f){var g={operation:a,internal:a,ignore:c.constant(!1)},h=b.map(f,function(a){return a.word()}),l=b.filter(h,function(a,c){return b.indexOf(h,a)===c});g.operation(function(){d.highlight(g,e,l,c.constant(!1))})}}});k("13i",["b","120"],function(b,d){return{sanction:function(c,
a){var e=b.filter(c,function(b){return!a(b)});return d.constant(e)}}});k("10i",["13h","13i","b","7"],function(b,d,c,a){return function(e,f){var g=function(b,d){return c.filter(b,function(b){return d.get(b.word()).fold(a.constant(!1),function(a){return a.suggestions().isSome()})})};return{scan:function(a,c,k,n){k=g(k,e);0<k.length&&(c=d.sanction(c.elements(),f),b.highlight(a,c,k))}}}});k("13j",["wk","b"],function(b,d){return{poll:function(c,a,e,f){a.correction({words:d.map(c,function(a){return b.clean(a.word())}),
language:"en"},function(a){e(a.spell)},function(a){f(a)})}}});k("10j","13h wk 13i 13j b 1n".split(" "),function(b,d,c,a,e,f){return function(g,h,l){var k=function(a){var b=f.keys(a);e.each(b,function(b){g.add(b,a[b])});return b};return{scan:function(f,g,q,r){a.poll(q,h,function(a){var h=k(a);a=e.filter(q,function(a){a=d.clean(a.word());return e.contains(h,a)});var u=c.sanction(g.elements(),l);b.highlight(f,u,a);r()},function(a){console.error("Spelling server error: ",a);r()})}}}});k("wl",["10i","10j",
"7"],function(b,d,c){return function(a,e,f){var g=b(a,f);a=d(a,e,f);return{client:c.constant(g),server:c.constant(a),destroy:c.noop}}});k("q7",["wl"],function(b){return function(d,c,a){return b(c,d,a)}});k("q8",["s","o"],function(b,d){return function(c){var a={};c.autocorrect(function(b){a=b.corrections},function(a){d.log("Error loading autocorrect list")});return{lookup:function(c){return a.hasOwnProperty(c)?b.from(a[c]):b.none()}}}});k("10k",["7"],function(b){return{image:b.constant("1"),spelling:b.constant("1")}});
k("wm",["10k","v"],function(b,d){return{spelling:function(c){var a=b.spelling();return d.ensureTrailing(c,"/")+a+"/"}}});k("q9",["6","qt","wm","4x","3z"],function(b,d,c,a,e){return function(f,g,h){var l=c.spelling(g),k=!1,n=e.create({failed:a(["resource"])}),p=function(a){return function(){k=!0;n.trigger.failed(g);a.apply(null,arguments)}};return{correction:function(a,c,e){!1===k&&d.json().ajaxData(l+"correction",b.deepMerge(a,{language:h}),"POST",c,p(e),f.headers())},autocorrect:function(a,b){!1===
k&&d.json().get(l+"autocorrect?language="+h,a,p(b),f.headers())},events:n.registry}}});k("i3","q7 q8 q9 4x 3z 40 gq ef bs 1a".split(" "),function(b,d,c,a,e,f,g,h,l,k){return function(a,k,m,r,s,t,u,v){r=c(a,t,v);a=e.create({failed:f(["resource"],r.events.failed)});var w=b(r,s,u);s=d(r);var x=function(a){m.body().each(function(b){g.filterDom(b,[h("."+a,l.unwrap)])})};k.events.spelling.bind(function(a){!1===a.value()&&x("ephox-cram-annotation-wrap")});return{run:function(a,b,c){k.spelling().get()&&b.client(a,
w.client(),c);k.spelling().get()&&b.server(a,w.server(),c,function(){return!k.spelling().get()})},refresh:function(){!1===k.spelling().get()&&x("ephox-cram-annotation-wrap")},lookup:s.lookup,destroy:function(){w.destroy()},events:a.registry}}});k("10l",["48"],function(b){return{resolve:b.create("ephox-bee").resolve}});k("wn",["10l","b","1x"],function(b,d,c){return function(){var a=b.resolve("highlight-current"),e=[],f=function(){d.each(e,function(b){c.remove(b,a)})};return{set:function(b){f();e=b.slice(0);
d.each(e,function(b){c.add(b,a)})},clear:f,destroy:function(){f();e=[]}}}});k("10m",["33"],function(b){return b.immutable("element","f")});k("wo",["10m","b","s","1b"],function(b,d,c,a){return function(){var e=[],f=!1,g=function(){f=!0;c.from(e.shift()).fold(function(){f=!1},function(a){a.f()(a.element(),g)})};return{enqueue:function(c,l){void 0===d.find(e,function(b){return a.eq(b.element(),c)})&&e.push(b(c,l));f||g()},destroy:function(){e=[]}}}});k("wp",["7","m9"],function(b,d){return{scan:function(c,
a,e,f){e=d.cluster(e,b.constant(!1));a.scan(c,e.zone(),e.words(),f)}}});k("qa",["wn","wo","wp","wq","7"],function(b,d,c,a,e){return function(){var f=d(),g=b();return{client:function(a,b,d){c.scan(a,b,d,e.identity)},server:function(a,b,d,e){f.enqueue(d,function(d,f){void 0!==e&&e()?f():c.scan(a,b,d,f)})},fade:function(b){a.idMarker(b).map(a.all).fold(g.clear,g.set)},destroy:function(){g.destroy();f.destroy()}}}});k("wt",["7","30"],function(b,d){var c=function(a){a="data-"+d.resolve(a);return b.constant(a)};
return{value:c("spelling-value"),type:c("spelling-type"),overflow:c("spelling-overflow"),overflowMenu:c("spelling-overflow-menu"),spelling:c("spelling-suggestion")}});k("ws",["wt","6u","33"],function(b,d,c){var a=c.immutable("primary","secondary","submenus"),e=c.immutable("value","text","attrs"),f=c.immutable("textkey","value","items");return{generate:function(c,h){var l;if(c.length>h){l=c.slice(0,h);var k=e(b.overflow(),d.translate("spelling.context.more"),{}),n=c.slice(h),p={};p[b.overflow()]=b.overflowMenu();
n=f(d.key("spelling.context.morelabel"),b.overflowMenu(),n);l=a(l.concat([k]),[n],p)}else l=a(c,[],{});return l}}});k("wu","wr s wt 4x 3z 1a".split(" "),function(b,d,c,a,e,f){return function(){var g=e.create({incorrect:a(["substitution"])}),h=d.none(),l={};l[c.spelling()]=function(a){h.each(function(d){d=b.substitute(d,f.get(a,c.value()));g.trigger.incorrect(d)})};return{assign:function(a){h=a},run:function(a){var b=f.get(a,c.type()),b=l[b];void 0!==b&&b(a)},events:g.registry}}});k("qb","b wr 7 h2 ws wt wu 33".split(" "),
function(b,d,c,a,e,f,g,h){var l=h.immutable("value","text","attrs");return function(h,k,p){var q=g();q.events.incorrect.bind(function(b){k.save();h.focus();h.domChanged();b.substitution().each(function(b){a.selectEnd(h,b)})});var r=c.curry(function(a,c,d,e){return a.marker(e).bind(a.detail).bind(function(a){return d(a).map(function(a){return b.map(a,function(a){var b={};b[f.type()]=c;b[f.value()]=a;return l(a,a,b)})})})},d,f.spelling(),function(a){return p.suggestions(a.word())});return{assign:q.assign,
handle:function(a){q.run(a)},situation:function(a){a=r(a).getOr([]);return e.generate(a,4)},destroy:c.noop}}});k("qc",["7","9g","4x","3z"],function(b,d,c,a){return function(e,f){var g=a.create({lookup:c(["element"]),disable:c(["element"])}),h=function(a){e.getSelection().each(a)},l=function(){h(function(a){g.trigger.lookup(a.startContainer())})};e.events.keyup.bind(function(a){d.isSpace(a)&&l()});e.events.nodeChanged.bind(function(a){e.getSelection().each(function(a){g.trigger.disable(a.startContainer())});
a.prev().each(g.trigger.lookup)});return{events:g.registry,destroy:b.noop}}});k("i4","qa c 7 qb qc kq q".split(" "),function(b,d,c,a,e,f,g){var h=d.detect().browser;return function(d,g,k,p,q,r,s,t,u){var v=a(g,q,t),w=e(g,k),x=b(),y=function(a){g.getSelection().each(function(b){var d;(d=b.collapsed())||(d=!h.isIE())||(d=f.after(b.endContainer(),b.endOffset(),b.startContainer(),b.startOffset()));return(d?p.run:c.apply)(a)})};w.events.lookup.bind(function(a){a=a.element();u.run(y,x,a)});w.events.disable.bind(function(a){x.fade(a.element())});
return{destroy:function(){v.destroy();w.destroy();x.destroy()},situation:v.situation,assign:v.assign,handle:v.handle}}});k("ab","i0 7 s ba i1 i2 i3 i4 be 4x 3z 1a 29".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q){return function(r,s,t,u){var v=r.communication(),w=r.profile(),x=r.filter(),y=r.content(),B=r.operations(),z=r.undo(),A=r.smartview(),C=r.shortcuts(),D=r.context();e.configure(x);var E=f(),F=b(s.words),G=g(v,w,y,z,F,t.url,E.exclude,u),I=c.none();s=n.create({analytics:k(["message"])});G.events.failed.bind(function(b){b=
l.get("error.code.spelling.not.found",[b.resource()]);b=a(b);r.ui().displayBanner(b)});y.events.ready.bind(function(a){y.body().each(function(a){p.set(a,"spellcheck",!1)});a=a.api().doc();a=h(a,y,D,B,z,C,A,F,G);G.refresh();I=c.some(a)});return{events:s.registry,destroy:function(){y.body().each(function(a){p.remove(a,"spellcheck")});I.each(function(a){a.destroy()});E.destroy();F.destroy();G.destroy()},state:function(){return{words:F.state()}},init:d.noop,exclude:E.add,check:d.identity,situation:function(a){var b=
{primary:d.constant([]),secondary:d.constant([]),submenus:d.constant({})};return I.fold(d.constant(b),function(b){return b.situation(a)})},assign:function(a){I.each(function(b){b.assign(a.bind(q.firstChild).or(a))})},handle:function(a){I.each(function(b){b.handle(a)})},lookup:G.lookup,name:d.constant("spelling")}}});k("5s",["aa","ab"],function(b,d){return function(c,a,e,f){return(!0===e.service?d:b)(c,a,e,f)}});k("i6","54 7 d3 1x l 2m 29".split(" "),function(b,d,c,a,e,f,g){var h=function(d){d=e.fromTag(d);
var g=e.fromText(b.zeroWidth());f.append(d,g);a.add(d,c.styleSpan());return d},l=function(a,b,c,d){var e=h(d);g.firstChild(e).each(function(d){a(c,e);b.setSelection(d,0,d,0)})};return{nu:h,insertAfter:d.curry(l,f.after),insertBefore:d.curry(l,f.before)}});k("ah","b c 7 s du i7 i8 73 f1 am 1b 20 9y".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q){var r=d.detect().browser,s=function(a){return p.isText(a)&&0!==q.get(a).trim().length},t=function(a){return p.isElement(a)&&"br"===p.name(a)},u=function(a){return b.exists([s,
t],function(b){return b(a)})},v=function(a){return p.isText(a.element())&&0===a.offset()||p.isElement(a.element())},w=function(b,d,f){var h=c.constant(b);return(!1===d&&v(b)?a.some(!0):a.none()).fold(h,function(a){return g.seekLeft(b.element(),u,f).fold(h,function(a){return e.point(a,p.isText(a)?q.get(a).length:0)})})};return{context:function(b){return b.getSelection().bind(function(b){if(b.collapsed()){var d=b.startContainer();return k.cell(d).bind(function(a){return k.table(d).map(function(e){return{cell:c.constant(a),
table:c.constant(e),start:c.constant(d),selection:c.constant(b)}})})}return a.none()})},selectedCells:function(a,b){return h.cata(a.get(),c.constant([]),c.identity,function(a){var c;if(r.isFirefox()){c=a.startContainer();var d=a.startOffset();c=f.toLeaf(c,d)}else c=e.point(a.startContainer(),a.startOffset());if(r.isFirefox())var d=a.endContainer(),g=a.endOffset(),d=f.toLeaf(d,g);else d=e.point(a.endContainer(),a.endOffset());(a=a.collapsed())||(a=n.eq(c.element(),d.element()));a=w(d,a,b);return l.sharedOne(k.cell,
[c.element(),a.element()]).toArray()})}}});k("qd",[],function(){var b=function(b){return{fold:b}};return{none:function(d){return b(function(b,a,e,f){return b(d)})},first:function(d){return b(function(b,a,e,f){return a(d)})},middle:function(d,c){return b(function(a,b,f,g){return f(d,c)})},last:function(d){return b(function(b,a,e,f){return f(d)})}}});k("i9","b 7 s qd am 1b".split(" "),function(b,d,c,a,e,f){var g=function(a){return e.table(a).bind(function(g){g=e.cells(g);var k=b.findIndex(g,function(b){return f.eq(a,
b)});return 0>k?c.none():c.some({index:d.constant(k),all:d.constant(g)})})};return{next:function(b){return g(b).fold(function(){return a.none(b)},function(c){return c.index()+1<c.all().length?a.middle(b,c.all()[c.index()+1]):a.last(b)})},prev:function(b){return g(b).fold(function(){return a.none()},function(c){return 0<=c.index()-1?a.middle(b,c.all()[c.index()-1]):a.first(b)})}}});k("ac","i5 7 i6 ev ah i9".split(" "),function(b,d,c,a,e,f){return{upOrLeft:function(g){e.context(g).each(function(e){f.prev(e.cell()).fold(d.noop,
function(){a.isFirstInContent(g,e.table())&&b.isLeft(e.cell(),e.selection())&&c.insertBefore(g,e.table(),"p")},d.noop,d.noop)})},right:function(g){e.context(g).each(function(e){f.next(e.cell()).fold(d.noop,d.noop,d.noop,function(){a.isLastInContent(g,e.table())&&b.isRight(e.cell(),e.selection())&&c.insertAfter(g,e.table(),"p")})})}}});k("ae","b 7i 7 gh 6u ah 6v 71 4x 3z 40 2l 2v".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q){var r={cssNamespace:"table-cell-border",i18nNamespace:"table.cell.border",
property:"border-width",tag:"table",specials:[["thin","medium","thick"]]};return{widget:function(s){var t=s.content(),u=a(r);u.initLayout();d.dialog(u.element(),e.translate("aria.table.cell.border.size"));var v=k.create({done:l([]),abort:n([],u.events.abort)});u.events.close.bind(function(a){v.trigger.done();t.focus()});u.events.action.bind(function(a){var d=q.active();t.focus();var e=f.selectedCells(s.selections(),t.isRoot);b.each(e,function(b){p.set(b,"border-width",a.value());p.getRaw(b,"border-style").fold(function(){p.set(b,
"border-style","solid")},c.noop)});d.each(q.focus)});var w=function(){u.enter();u.open()};return{element:u.element,destroy:u.destroy,name:c.constant("cellborderwidth"),textkey:c.constant(e.key("table.cell.border.width")),tooltip:g.get,label:c.constant(!1),updateWidget:function(a){var b=f.selectedCells(s.selections(),t.isRoot);0<b.length?(a.enable(),a=p.getRaw(b[0],"border-width").fold(h.off,h.on),u.updateInlineWidget({size:c.constant(a)},"1px")):a.disable();w()},events:v.registry,open:w,close:u.close}}}});
k("af","7i ca 7 4t ia 6u ah 30 6v 4x 3z 33 43 l 2m".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s){var t=p.immutableBag(["name","textkey","action","shortname"],[]);return{widget:function(p,v){var w=t(v),x=p.content(),y=r.fromTag("div");q.add(y,[h.resolve("palette-cell-colors"),h.resolve(w.shortname()+"-cell-colors")]);b.widget(y);var B=e.create();s.append(y,B.element());var z="."+h.resolve(w.shortname()+"-cell-colors")+" ."+h.resolve("palette-detail-action"),A=e.makeLayout(y,z,{}),z=A.layout(),
C=n.create({done:k([]),abort:k([])});B.events.selected.bind(function(a){a=a.value();var b=g.selectedCells(p.selections(),x.isRoot);w.action()(b,a);C.trigger.done()});var D=function(){E.enter();A.refresh()},E=d(y,[z]);E.events.exit.bind(function(){C.trigger.abort()});return{element:c.constant(y),destroy:function(){E.destroy();B.destroy()},name:c.constant(w.name()),textkey:c.constant(f.key(w.textkey())),tooltip:l.get,label:c.constant(!1),updateWidget:function(b){a.isHighContrast(p.smartview())?b.disable():
(0===g.selectedCells(p.selections(),x.isRoot).length?b.disable():b.enable(),D())},events:C.registry,open:D,close:function(){C.trigger.done()}}}}});k("qe",["1a","2l","l","2m","35"],function(b,d,c,a,e){return{render:function(f,g,h,l){var k=c.fromTag("table");d.setAll(k,{"border-collapse":"collapse",width:"100%"});b.set(k,"border","1");var n=c.fromTag("tbody");a.append(k,n);for(var p=[],q=0;q<f;q++){for(var r=c.fromTag("tr"),s=0;s<g;s++){var t=q<h||s<l?c.fromTag("th"):c.fromTag("td");s<l&&b.set(t,"scope",
"row");q<h&&b.set(t,"scope","col");a.append(t,c.fromTag("br"));d.set(t,"width",100/g+"%");a.append(r,t)}p.push(r)}e.append(n,p);return k}}});k("ib",["s","8x","qe","am"],function(b,d,c,a){return{insert:function(e,f,g,h,l){e.focus();return e.getSelection().bind(function(k){return a.table(k.startContainer()).fold(function(){var k=c.render(f,g,h,l);d.insertAtCursor(e,[k]).each(function(b){a.firstCell(k).each(function(a){e.setSelection(a,0,a,0)})});return b.some(k)},b.none)})}}});k("wv","7i e6 9m kc 7 6u 30 1a 1x 43 l 2v 2m".split(" "),
function(b,d,c,a,e,f,g,h,l,k,n,p,q){return function(r){var s=a(r);l.add(s.element(),g.resolve("choice-button"));var t=n.fromTag("span");h.set(s.element(),"title",f.translate("table."+r));h.set(s.element(),"tabindex","-1");b.button(s.element(),f.translate("table."+r),!1);var u=c.describe(s.element(),f.translate("aria.table.headerdescription"));q.append(s.element(),u);s.events.click.bind(function(){p.focus(s.element());d.pressed(s)});k.add(t,[g.resolve(r),"ephox-pastry-icon-content","ephox-polish-icon"]);
s.content({element:e.constant(t)});return s}});k("13o",["7","qn"],function(b,d){var c=d.resolve("table-picker"),a=d.resolve("table-picker-row"),e=d.resolve("table-picker-cell"),f=d.resolve("table-picker-button");return{table:b.constant(c),row:b.constant(a),cell:b.constant(e),button:b.constant(f)}});k("13n","f2 13o 1a 46 2y cy".split(" "),function(b,d,c,a,e,f){var g="."+d.cell(),h="."+d.row();return{cells:function(b){return a.descendants(b,g)},rows:function(b){return a.descendants(b,h)},grid:function(a,
d,e){d=f(c.get(a,d),10);a=f(c.get(a,e),10);return b.grid(d,a)},button:function(a){return e.child(a,"."+d.button()).getOr(a)}}});k("14u",["7","f2","1r"],function(b,d,c){var a=function(a,b,e,l,k){l=c.max(l,c.min(k,a.row()));a=c.max(b,c.min(e,a.column()));return d.address(l,a)},e=function(c,e){var h=a(c,1,e.maxCols,1,e.maxRows),l;l=d.address(h.row()+1,h.column()+1);l=a(l,e.minCols,e.maxCols,e.minRows,e.maxRows);return{selection:b.constant(h),full:b.constant(l)}};return{resize:function(a,b){var c;c=d.address(a.row()+
1,a.column()+1);return e(c,b)},grow:function(a,b,c,l){a=d.address(a.rows()+c,a.columns()+b);return e(a,l)}}});k("13p","f2 14u 2v 64 3e 2p 1r".split(" "),function(b,d,c,a,e,f,g){return function(g,l){var k=!1,n=function(a,b,d){var e=d.full();e.row()===b.rows()&&e.column()===b.columns()||a.setSize(e.row(),e.column());a=a.setSelection(d.selection().row(),d.selection().column());c.focus(a)};return{on:function(){k=!0},off:function(){k=!1},mousemove:function(c,q,r,s){if(k){var t;t=f.get(c.element());var u=
a.get(c.element());t=b.dimensions(t,u);u=e.absolute(c.element());u=b.coords(u.left(),u.top());r=b.coords(r,s);r=g.pickerCell(u,t,q,r);r=d.resize(r,l);n(c,q,r)}},manual:function(a,b,c,e){k&&(c=d.grow(b,c,e,l),n(a,b,c))}}}});k("10r","b w2 7 4x 3z f2 13n 13o 13p qn s6 1a 1x 43 3n l 2v 2m 35 f3 2o cy".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x,y,B){return function(z,A,C){var D=e.create({select:a(["rows","cols","rowHeaders","columnHeaders"])}),E=t.fromTag("table");q.add(E,h.table());var F=
t.fromTag("tbody");v.append(E,F);var G=0,I=0,H=function(a,b){G=b;I=a;L()},L=function(){y.empty(F);var a=C.ids();n.repeat(I,function(b){var c=t.fromTag("tr");q.add(c,h.row());d.row(c);var e=n.repeat(G,function(c){var d=t.fromTag("td");q.add(d,k.resolve("cell-"+c+"-"+b));q.add(d,h.cell());p.set(d,"role","gridcell");var e=t.fromTag("button");p.set(e,"type","button");p.set(e,"role","button");p.set(e,"aria-labelledby",a[b][c]);q.add(e,h.button());v.append(d,e);return d});w.append(c,e);v.append(F,c)})},
J=function(a,c){var d=g.cells(E);b.each(d,function(a){q.remove(a,k.resolve("picker-selected"))});d=g.rows(E).slice(0,a);b.each(d,function(a,d){var e=g.cells(a).slice(0,c);b.each(e,function(a,b){var c=g.grid(E,"data-picker-header-row","data-picker-header-col"),c=d<c.rows()||b<c.columns()?[k.resolve("picker-selected"),k.resolve("picker-header")]:[k.resolve("picker-selected")];r.add(a,c)})});p.set(E,"data-picker-col",c-1);p.set(E,"data-picker-row",a-1);d=g.cells(d[d.length-1]).slice(0,c);return g.button(d[d.length-
1])},K=function(){var a=B(p.get(E,"data-picker-col"),10)+1,b=B(p.get(E,"data-picker-row"),10)+1;return f.grid(b,a)},M={element:c.constant(E),setSelection:J,setSize:H},Q=l(z,A),R=s.bind(E,"mousemove",function(a){Q.mousemove(M,f.grid(I,G),a.raw().pageX,a.raw().pageY)}),P=function(a,b){Q.manual(M,K(),a,b)},O=x.realClick.bind(E,function(a){V();a.raw().preventDefault()}),V=function(){var a=g.grid(E,"data-picker-row","data-picker-col"),b=g.grid(E,"data-picker-header-row","data-picker-header-col");D.trigger.select(a.rows()+
1,a.columns()+1,b.rows(),b.columns())};return{element:function(){return E},destroy:function(){O.unbind();R.unbind();y.remove(E)},setSize:H,setHeaders:function(a,b){p.set(E,"data-picker-header-row",a);p.set(E,"data-picker-header-col",b)},setSelection:J,on:Q.on,off:Q.off,reset:function(){H(A.minRows,A.minCols);var a=J(1,1);u.focus(a)},refresh:function(){var a=K();L();return J(a.rows(),a.columns())},events:D.registry,sendLeft:c.curry(P,z.isRtl()?1:-1,0),sendRight:c.curry(P,z.isRtl()?-1:1,0),sendUp:c.curry(P,
0,-1),sendDown:c.curry(P,0,1),sendExecute:V}}});k("ww",["10r"],function(b){return function(d,c,a){return b(d,c,a)}});k("qf","w2 7i e6 9m fk 85 jq 9n 7 s wv 6u 30 3z 40 ww 1a 1x 43 l 2v 35 2y".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x,y,B,z){return function(A,C){var D=b.createHelp(C.maxRows,C.maxCols,{row:function(a){return p.translate("table.picker.rows",a)},col:function(a){return p.translate("table.picker.cols",a)}}),E=t(A,C,D);b.base(E.element(),p.translate("table.picker.label"));
var F=a.describe(E.element(),p.translate("table.picker.describepicker")),G=x.fromTag("div");u.set(G,"tabIndex","-1");w.add(G,[q.resolve("insert-table"),q.resolve("toolbar-menu")]);var I=x.fromTag("div");v.add(I,q.resolve("table-controls"));d.toolbarGroup(I,p.translate("table.picker.header"));var H=n("row-header"),L=n("column-header");B.append(I,[H.element(),L.element()]);B.append(G,[I,E.element(),F,D.help()]);var J=function(){E.setHeaders(H.selected()?1:0,L.selected()?1:0);var a=y.active(),b=E.refresh();
a.each(function(a){y.hasFocus(a)||y.focus(b)})},D=function(a,b){return function(){b();return k.some(!0)}},D=f.single(E.element(),[g.basic(h.LEFT()[0],D("left",E.sendLeft)),g.basic(h.RIGHT()[0],D("right",E.sendRight)),g.basic(h.UP()[0],D("up",E.sendUp)),g.basic(h.DOWN()[0],D("down",E.sendDown)),g.rule(g.inSet(h.SPACE().concat(h.ENTER())),D("execute",E.sendExecute))],k.none());D.events.enter.bind(function(){y.focus(E.element())});var K=f.flow(I,{item:l.constant(".ephox-pastry-statebutton")},e.flow({trigger:function(a){return z.descendant(a,
".ephox-pastry-button").map(function(a){a.dom().click();return a})}})),M=f.multiple(G,[D,K]);H.events.click.bind(function(){K.clickFocus(H.element());J()});L.events.click.bind(function(){K.clickFocus(L.element());J()});I=r.create({select:s(["rows","cols","rowHeaders","columnHeaders"],E.events.select),exit:s([],M.events.exit)});return{element:function(){return G},destroy:function(){M.destroy();H.destroy();L.destroy();E.destroy()},setSize:E.setSize,setSelection:E.setSelection,on:function(){E.on();M.enter()},
off:function(){E.off();M.isFocused()&&M.exit()},reset:function(){E.setHeaders(0,0);H.deselect();c.release(H.element());L.deselect();c.release(L.element());E.reset()},events:I.registry}}});k("ic",["6","qf","4x","3z"],function(b,d,c,a){return function(e,f){var g=a.create({enabled:c(["enabled"]),select:c(["rows","cols","rowHeaders","columnHeaders"]),insert:c(["table"]),done:c([]),abort:c([])}),h=b.merge({minCols:7,maxCols:10,minRows:4,maxRows:10},f),l=d(e,h);l.events.select.bind(function(a){k();g.trigger.select(a.rows(),
a.cols(),a.rowHeaders(),a.columnHeaders());g.trigger.done()});l.events.exit.bind(function(){k();g.trigger.abort()});var k=function(){l.off()};return{element:l.element,open:function(){l.reset();l.on()},close:k,destroy:function(){l.destroy()},events:g.registry}}});k("qg",["f2","1r"],function(b,d){var c=function(a,c,f,g){var h=a.width()/c.columns();a=a.height()/c.rows();f=d.floor(f/h);g=d.floor(g/a);return b.address(g,f)};return{findCellRtl:function(a,b,d,g){var h=a.x()+b.width()-g.x();a=g.y()-a.y();
return c(b,d,h,a)},findCellLtr:function(a,b,d,g){var h=g.x()-a.x();a=g.y()-a.y();return c(b,d,h,a)}}});k("id",["7","qg"],function(b,d){var c={pickerCell:d.findCellLtr,isRtl:b.constant(!1)},a={pickerCell:d.findCellRtl,isRtl:b.constant(!0)};return{ltr:c,rtl:a}});k("ag","7 ib ic 6u 6v 3z 40 id am".split(" "),function(b,d,c,a,e,f,g,h,l){return{widget:function(k,n){var p=c(k.region().uiDirection().isRtl()?h.rtl:h.ltr,n),q=k.content(),r=k.undo(),s=f.create({done:g([],p.events.done),abort:g([],p.events.abort)});
p.events.select.bind(function(a){r.save();d.insert(q,a.rows(),a.cols(),a.rowHeaders(),a.columnHeaders()).each(function(a){r.save();q.domChanged()})});return{element:p.element,name:b.constant("table"),textkey:b.constant(a.key("insert.table")),tooltip:e.get,label:b.constant(!1),updateWidget:function(a){q.getSelection().each(function(b){(l.table(b.startContainer()).isNone()?a.enable:a.disable)()});p.open()},destroy:p.destroy,events:s.registry,open:p.open,close:p.close}}}});k("wx",["2y"],function(b){return{set:function(b,
c){b.dom().checked=c},find:function(d){return b.descendant(d,"input:checked")}}});k("qh","7i 2w 7 fm 6u 1a wx l 2m 35 2o 2z".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p){return function(){var q=h.fromTag("fieldset"),r=h.fromHtml("<legend>"+e.translate("table.border")+"</legend>");l.append(q,r);var s=d.generate(""),r=function(a,c){var d=h.fromTag("input");b.label(d,e.translate(c));f.setAll(d,{type:"radio",id:"tableborder"+a+s,value:a,name:s});return d},t=r("1","border.labels.on"),u=r("0","border.labels.off");
k.append(q,[t,h.fromHtml('<label for="tableborder1'+s+'">'+e.translate("border.on")+"</label>"),u,h.fromHtml('<label for="tableborder0'+s+'">'+e.translate("border.off")+"</label>")]);var v=a.radio(q,'input[type="radio"]',"input:checked");return{element:function(){return q},get:function(){return g.find(q).map(function(a){return p.get(a)})},select:function(a){g.set(u,!1);g.set(t,!1);a.each(function(a){"0"===a?g.set(u,!0):"1"===a&&g.set(t,!0)});v.refresh()},keylayout:c.constant(v),destroy:function(){n.remove(q)}}}});
k("qi","b fk 85 7 s kd og 30 1a 1x 3n l 35 2o 2z".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s){return function(){var t=p.fromTag("div");k.add(t,h.resolve("table-size-controls"));var u=f.input("table-width","table.width"),v=f.input("table-height","table.height");b.map([u,v],function(a){l.set(a.input(),"placeholder","Auto")});q.append(t,[u.element(),v.element()]);var w=[c.input(u.input(),d.input({})),c.input(v.input(),d.input({}))],x=function(a){var b=a.target();g.validateField(b,"width",e.some("px")).fold(function(){g.highlight(b)},
function(a){g.dehighlight(b)})},y=[n.bind(u.input(),"input",x),n.bind(v.input(),"input",x)];return{element:function(){return t},get:function(){return g.validate([g.rule(u.input(),"width",e.some("px")),g.rule(v.input(),"height",e.some("px"))])},set:function(b){b.width().bind(a.curry(s.set,u.input()));b.height().bind(a.curry(s.set,v.input()))},keylayouts:a.constant(w),highlight:g.highlight,dehighlight:a.curry(g.clearHighlights,t),destroy:function(){r.remove(t);b.each(y,function(a){a.unbind()})}}}});
k("ih","7 s qj 33 cs 1a 2l cx 2d 2o 2y".split(" "),function(b,d,c,a,e,f,g,h,l,k,n){var p=a.immutableBag(["floatval","caption","summary","border","dimensions"],[]),q=function(a){a=f.get(a,"border");return"0"===a||"1"===a?d.some(a):d.none()},r=function(a){var c=g.getRaw(a,"width");a=g.getRaw(a,"height");return{width:b.constant(c),height:b.constant(a)}};return{divine:function(a,b){var c=h.divine(b),d=f.get(b,"summary"),e=n.child(b,"caption").map(function(b){b=l.get(b);return a.filterHtml(a.output(),
b)}).getOr(""),g=q(b),k=r(b);return p({floatval:c,caption:e,summary:d,border:g,dimensions:k})},properties:p,apply:function(a,b){b.floatval().each(function(b){e.runFloat(a,b)});b.border().each(function(b){f.set(a,"border",b)});""===b.summary()?f.remove(a,"summary"):c.setSummary(a,b.summary());""===b.caption()?n.child(a,"caption").each(k.remove):c.setCaption(a,b.caption());c.setDimensions(a,b.dimensions())}}});k("ig","fk 85 7 s fl fm kd oh qh qi ih 6u fn 30 4x 3z 1x l 35 2z".split(" "),function(b,d,
c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x){return function(y,B){var z=t.create({ok:s(["properties"]),close:s([])}),A=e(B);A.setTitle(p.translate("table.dialog"));u.add(A.element(),r.resolve("dialog-narrow"));var C=v.fromTag("div"),D=h("table.float"),E=g.input("tablesummary","table.summary"),F=g.input("tablecaption","table.caption"),G=k(),I=l();w.append(C,[F.element(),E.element(),I.element(),G.element(),D.element()]);var H=q.okCancel("table");H.events.ok.bind(function(){M()});H.events.cancel.bind(function(){A.hide();
z.trigger.close()});A.events.close.bind(function(){A.hide();z.trigger.close()});A.setContent(C);A.setControls(H.element());var L=f.setup(A,H,[d.input(F.input(),b.input({})),d.input(E.input(),b.input({})),I.keylayout()].concat(G.keylayouts()).concat([D.keylayout()])),J=function(){return G.get().map(function(b){b={width:c.constant(a.some(b.width())),height:c.constant(a.some(b.height()))};return n.properties({floatval:D.get(),caption:K(F.input()),summary:K(E.input()),border:I.get(),dimensions:b})})},
K=function(a){return x.get(a).trim()},M=function(){J().fold(function(a){G.highlight(a)},function(a){z.trigger.ok(a)})};return{element:A.element,events:z.registry,open:function(){A.show();L.enter()},represent:function(a){a=n.divine(y,a);D.select(a.floatval());void 0!==a.summary()&&x.set(E.input(),a.summary());void 0!==a.caption()&&x.set(F.input(),a.caption());G.set(a.dimensions());I.select(a.border())},execute:M,destroy:function(){D.destroy();G.destroy();I.destroy();H.destroy();A.destroy();L.destroy()},
hide:function(){L.exit();A.hide()}}}});k("aj","b ez 7 s cj if ig ih 6u 91 ii 33 ij am ik 1a 20 2y".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v){return function(w,x,y,B,z,A,C,D){var E=a.none(),F=function(a,b){var c=q.getWidth(a);q.setWidth(a,c/2);q.setWidth(b,c/2)},G={"tablemenu-delete-table":f.erase,"delete-row":f.execute(x,s.eraseRow,c.noop,D),"delete-column":f.execute(x,s.eraseColumn,c.noop,D),"make-header-column":f.execute(x,s.makeColumnHeader,c.noop,D),"make-header-row":f.execute(x,
s.makeRowHeader,c.noop,D),"unmake-header-column":f.execute(x,s.unmakeColumnHeader,c.noop,D),"unmake-header-row":f.execute(x,s.unmakeRowHeader,c.noop,D),"insert-row-before":f.execute(x,s.insertRowBefore,c.noop,D),"insert-row-after":f.execute(x,s.insertRowAfter,c.noop,D),"insert-column-before":f.execute(x,s.insertColumnBefore,F,D),"insert-column-after":f.execute(x,s.insertColumnAfter,F,D),"tablemenu-table-properties":function(b,c,d){b=g(w,C);var f=k.generate(z,b,["properties"]);f.events.ok.bind(function(a){y.activate();
E.bind(function(b){r.table(b.element()).each(function(b){e.runTransaction(y,A,function(){h.apply(b,a.properties())})})});f.destroy()});f.events.close.bind(function(a){f.destroy();y.activate();y.focus()});y.deactivate();f.represent(c);f.open();return a.none()},"cell-merge":f.execute(x,s.mergeCells,c.noop,D),"cell-unmerge":f.execute(x,s.unmergeCells,c.noop,D)},I=p.immutable("value","text","attrs");return{handle:function(a){y.doc().each(function(b){E.each(function(b){var c=b.element();r.table(c).each(function(c){var f=
t.get(a,"data-ephox-gopher-item-value"),g=G[f];void 0!==g&&e.runTransaction(y,A,function(){g(y,c,b).each(function(a){y.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset());d.clear(c)})})})})})},assign:function(a){E=a.bind(function(a){return r.cell(a).bind(function(a){return v.ancestor(a,"table").map(function(b){return n.forMenu(B,b,a)})}).orThunk(function(){return v.closest(a,"caption").map(function(a){return n.caption(a)})})})},situation:function(a){a=E.map(function(a){var c=
a.element();return b.flatten([b.contains(["td","th"],u.name(c))?[I("tablemenu-row",l.translate("table.context.row.menu"),{})]:[],b.contains(["td","th"],u.name(c))?[I("tablemenu-column",l.translate("table.context.column.menu"),{})]:[],[I("tablemenu-table",l.translate("table.context.table.menu"),{})],a.mergable().isSome()?[I("cell-merge",l.translate("table.context.cell.merge"),{})]:[],a.unmergable().isSome()?[I("cell-unmerge",l.translate("table.context.cell.unmerge"),{})]:[]])}).getOr([]);var d=E.map(function(a){var d=
a.element();a=function(a,b,e){var f=a+"-menu",g="th"===u.name(d)?"unmake":"make",h="make"===g?"header":"normal";b=[I("insert-"+a+"-before",l.translate("table.context."+a+"."+b),{}),I("insert-"+a+"-after",l.translate("table.context."+a+"."+e),{}),I("delete-"+a,l.translate("table.context.common.delete"),{}),I(g+"-header-"+a,l.translate("table.context.common."+h),{})];return{textkey:c.constant(l.key("table.context."+a+".title")),value:c.constant(f),items:c.constant(b)}};var e={textkey:c.constant(l.key("table.context.table.title")),
value:c.constant("table-menu"),items:c.constant([I("tablemenu-table-properties",l.translate("table.context.table.properties"),{}),I("tablemenu-delete-table",l.translate("table.context.common.delete"),{})])};return b.flatten([[a("row","insertabove","insertbelow")],[a("column","insertleft","insertright")],[e]])}).getOr([]);return{primary:c.constant(a),secondary:c.constant(d),submenus:c.constant({"tablemenu-row":"row-menu","tablemenu-column":"column-menu","tablemenu-table":"table-menu"})}},destroy:c.noop}}});
k("ak","il 7 s if ii i9 am ik 46 2y".split(" "),function(b,d,c,a,e,f,g,h,l,k){var n=function(f,n,r,s){return r.fold(c.none,c.none,function(a,d){return c.some(b(d,0,d,0))},function(c){return g.table(c).bind(function(g){a.execute(f,h.insertRowAfter,d.noop,s)(n,g,e.noMenu(c));g=l.descendants(g,"tr");if(0<g.length)return k.descendant(g[g.length-1],"td,th").map(function(a){return b(a,0,a,0)})})})};return{forward:function(a,b,c,d){return n(a,b,f.next(c),d)},backward:function(a,b,c,d){return n(a,b,f.prev(c),
d)}}});k("wy",["4x","3z"],function(b,d){return function(){var c=d.create({drag:b(["xDelta","yDelta"])});return{mutate:function(a,b){c.trigger.drag(a,b)},events:c.registry}}});k("ql",["s","4x","3z","wy"],function(b,d,c,a){return function(){var e=c.create({drag:d(["xDelta","yDelta","target"])}),f=b.none(),g=a();g.events.drag.bind(function(a){f.each(function(b){e.trigger.drag(a.xDelta(),a.yDelta(),b)})});return{assign:function(a){f=b.some(a)},get:function(){return f},mutate:g.mutate,events:e.registry}}});
k("in","ho 7 s 4x 3z ql qm qn py 1a 1x 2l 3n 20 6e 2y cy".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u){return function(v,w,x){var y=f(),B=b.transform(y,{}),z=c.none(),A=function(a,b){return c.from(k.get(a,b))};y.events.drag.bind(function(a){A(a.target(),"data-row").each(function(b){b=l.getInt(a.target(),"top");p.set(a.target(),"top",b+a.yDelta()+"px")});A(a.target(),"data-column").each(function(b){b=l.getInt(a.target(),"left");p.set(a.target(),"left",b+a.xDelta()+"px")})});var C=function(a,
b){var c=l.getInt(a,b),d=u(k.get(a,"data-initial-"+b),10);return c-d};B.events.stop.bind(function(){y.get().each(function(a){z.each(function(b){A(a,"data-row").each(function(c){var d=C(a,"top");k.remove(a,"data-initial-top");H.trigger.adjustHeight(b,d,u(c,10))});A(a,"data-column").each(function(c){var d=C(a,"left");k.remove(a,"data-initial-left");H.trigger.adjustWidth(b,d,u(c,10))});g.refresh(v,b,x,w)})})});var D=function(a,b){H.trigger.startAdjust();y.assign(a);k.set(a,"data-initial-"+b,u(p.get(a,
b),10));n.add(a,h.resolve("resizer-bar-dragging"));p.set(a,"opacity","0.2");B.go(v.parent())},E=q.bind(v.parent(),"mousedown",function(a){g.isRowBar(a.target())&&D(a.target(),"top");g.isColBar(a.target())&&D(a.target(),"left")}),F=q.bind(v.view(),"mouseover",function(a){if("table"===r.name(a.target())||s.ancestor(a.target(),"table"))z="table"===r.name(a.target())?c.some(a.target()):t.ancestor(a.target(),"table"),z.each(function(a){g.refresh(v,a,x,w)})}),G=q.bind(v.view(),"mouseout",function(a){"table"===
r.name(a.target())&&g.hide(v)}),I=q.bind(v.view(),"dragstart",function(a){a.raw().preventDefault()}),H=e.create({adjustHeight:a(["table","delta","row"]),adjustWidth:a(["table","delta","column"]),startAdjust:a([])});return{destroy:function(){E.unbind();F.unbind();G.unbind();I.unbind();B.destroy();g.destroy(v)},refresh:function(a){g.refresh(v,a,x,w)},on:B.on,off:B.off,hideBars:d.curry(g.hide,v),showBars:d.curry(g.show,v),events:H.registry}}});k("an",["4x","3z","im","in","io"],function(b,d,c,a,e){return function(f,
g){var h=e.height,l=a(f,g,h),k=d.create({beforeResize:b([]),afterResize:b([]),startDrag:b([])});l.events.adjustHeight.bind(function(a){k.trigger.beforeResize();var b=h.delta(a.delta(),a.table());c.adjustHeight(a.table(),b,a.row(),h);k.trigger.afterResize()});l.events.startAdjust.bind(function(a){k.trigger.startDrag()});l.events.adjustWidth.bind(function(a){k.trigger.beforeResize();var b=g.delta(a.delta(),a.table());c.adjustWidth(a.table(),b,a.column(),g);k.trigger.afterResize()});return{on:l.on,off:l.off,
hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:k.registry}}});k("5t","b c 7 s ac ad ae af ag 6u ah ai aj ak 6l al am an 2l".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w){return function(x,y){var B=x.content(),z=x.keyboard(),A=x.undo(),C=x.smartview(),D=function(){return Q.getOr(t.only(B.element()))},E=q(x.filter(),x.region(),B,x.selections(),z,A,C.uiContainer(),D),F=function(a,c,d){A.save();b.each(c,function(b){a(b,d)});A.save();B.focus()},G=c.curry(F,function(a,b){w.set(a,
"background-color",b)}),F=c.curry(F,function(a,b){w.set(a,"border-color",b);w.getRaw(a,"border-style").fold(function(){w.set(a,"border-style","solid")},c.noop)}),G=s.ui({"table.widget":c.curry(l.widget,x,y),"cell.palette":c.constant({items:[{type:"widget",build:c.curry(h.widget,x,{action:G,shortname:"background",name:"cellbackgroundcolor",textkey:"table.cell.color.background"})},{type:"widget",build:c.curry(h.widget,x,{action:F,shortname:"border",name:"cellbordercolor",textkey:"table.cell.color.border"})},
{type:"widget",build:c.curry(g.widget,x)}],updatePalette:function(b){var d=n.selectedCells(x.selections(),B.isRoot),e=c.curry(b.show,a.some(k.translate("table.context.palette.show")));b=c.curry(b.hide,a.some(k.translate("table.context.palette.hide")));(0<d.length?e:b)()&&x.ui().refresh()}})},c.identity),I=function(a){var b=a.stopper();B.getSelection().each(function(c){c.collapsed()&&u.cell(c.startContainer()).each(function(c){(a.shift()?r.backward:r.forward)(x.region(),B,c,D).fold(b,function(a){b();
B.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})})})},H=function(a){e.upOrLeft(B)},L=function(a){e.right(B)},J=z.editor();J.on();J.events.tab.bind(I);J.events.left.bind(H);J.events.up.bind(H);J.events.right.bind(L);var K=B.cursor(),M=a.none(),Q=a.none();B.events.ready.bind(function(b){b=f.get(B,C,b.api().doc());Q=a.some(b);var c=p(x.region()),e=v(b,c);e.events.beforeResize.bind(A.save);e.events.afterResize.bind(function(){B.focus();A.save();B.domChanged();K.restore()});
e.on();e.events.startDrag.bind(K.save);M=a.some(e);b=x.selections();b.events.beforeScan.bind(function(){e.hideBars()});b.events.afterScan.bind(function(){e.showBars()});d.detect().browser.isFirefox()&&B.execCommand("enableInlineTableEditing",null,!1)});return{ui:G,destroy:function(){E.destroy();M.each(function(a){a.destroy()});J.off();J.events.tab.unbind(I);J.events.left.unbind(H);J.events.up.unbind(H);J.events.right.unbind(L);J.destroy()},handle:E.handle,assign:E.assign,situation:E.situation,name:c.constant("table")}}});
k("5u",["7","4x","3z"],function(b,d,c){return function(){var a=c.create({pasteUpload:d([]),uploadAssets:d(["assets"]),registerBlob:d(["id","blob","bloburl","data"])});return{destroy:b.noop,events:a.registry,pasteUpload:a.trigger.pasteUpload,uploadAssets:a.trigger.uploadAssets,registerBlob:a.trigger.registerBlob}}});k("qo",["b","7","33"],function(b,d,c){var a=c.immutable("withSpaces","withoutSpaces"),e=function(a){return b.filter(a.split(/[\.,-\/#!$%\^&\*;:{}=\-_`~()\s\u00A0]/gim),function(a){return 0<
a.length}).length};return{count:function(b){return{words:d.constant(e(b)),characters:d.constant(a(b.length,b.replace(/[\s\u00A0]/gim,"").length))}}}});k("ip","7i 85 7 s m4 fl 6u 30 qo 4x 3z 43 l 2m v".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s){return function(t,u){var v=t().uiContainer(),w=n.create({close:k([])}),x=f(v);x.setTitle(g.translate("wordcount.dialog"));p.add(x.element(),[h.resolve("dialog-wordcount"),h.resolve("dialog-narrow")]);var y=e.toText(u().body().getOrDie(),c.constant(!1)),
v=u().getSelectedText().getOr(""),y=l.count(y),v=l.count(v),v=q.fromHtml(s.supplant('<table role="grid" aria-readonly="true" class="ephox-polish-tabular ephox-polish-wordcount-table">    <thead>        <tr role="row">            <th role="columnheader" scope="col"> ${headerCounts}&nbsp;</th>            <th role="columnheader" scope="col"> ${headerDocument}&nbsp;</th>            <th role="columnheader" scope="col"> ${headerSelection}&nbsp;</th>        </tr>    </thead>    <tbody>        <tr role="row">            <td role="gridcell">${wordCountLabel}&nbsp;</td>            <td role="gridcell" class="ephox-polish-wordcount-document-words">${documentCountWords}&nbsp;</td>            <td role="gridcell" class="ephox-polish-wordcount-selection-words">${selectionCountWords}&nbsp;</td>        </tr>        <tr role="row">            <td role="gridcell">${wordCountCharsNoSpacesLabel}&nbsp;</td>            <td role="gridcell" class="ephox-polish-wordcount-document-charsnospaces">${documentCharactersNoSpaces}&nbsp;</td>            <td role="gridcell" class="ephox-polish-wordcount-selection-charsnospaces">${selectionCharactersNoSpaces}&nbsp;</td>        </tr>        <tr role="row">            <td role="gridcell">${wordcountCharsLabel}&nbsp;</td>            <td role="gridcell" class="ephox-polish-wordcount-document-chars">${documentCountCharsWithSpaces}&nbsp;</td>            <td role="gridcell" class="ephox-polish-wordcount-selection-chars">${selectionCountCharsWithSpaces}&nbsp;</td>        </tr>    </tbody></table>',
{headerCounts:g.translate("wordcount.counts"),headerDocument:g.translate("wordcount.document"),headerSelection:g.translate("wordcount.selection"),wordCountLabel:g.translate("wordcount.words"),wordCountCharsNoSpacesLabel:g.translate("wordcount.charactersnospaces"),wordcountCharsLabel:g.translate("wordcount.characters"),documentCountWords:y.words(),selectionCountWords:v.words(),documentCharactersNoSpaces:y.characters().withoutSpaces(),selectionCharactersNoSpaces:v.characters().withoutSpaces(),documentCountCharsWithSpaces:y.characters().withSpaces(),
selectionCountCharsWithSpaces:v.characters().withSpaces()})),y=q.fromTag("div");b.document(y);r.append(y,v);x.setContent(y);var v=d.single(v,[],a.none()),B=d.multiple(x.element(),[v]),v=function(){z();w.trigger.close()},z=function(){x.hide()};x.events.close.bind(v);B.events.exit.bind(v);return{element:x.element,events:w.registry,open:function(){x.show();B.enter()},destroy:function(){B.destroy();x.destroy()},hide:z}}});k("ao",["ip","4x","3z"],function(b,d,c){return function(a,e){var f=b(a,e),g=c.create({close:d([])});
f.events.close.bind(function(){g.trigger.close();f.destroy()});return{show:function(){f.open()},events:g.registry}}});k("5v",["7","6u","6l","ao"],function(b,d,c,a){return function(e){var f=e.content,g=e.smartview,h=function(){var b=a(g,f);b.events.close.bind(function(){e.ui().tabstrip.focused()||f().focus()});e.content().hideInlineSelection();b.show()};e.users().events.wordcount.bind(function(){h()});return{ui:c.ui({"wordcount.general":{toggle:!1,value:"wordcount",textkey:d.key("wordcount.open"),
action:h,updateGeneral:b.noop,icon:!0,shortcut:!1,hasPopup:!1}}),destroy:b.noop}}});k("5w","b c ap 7 9g 70 20 32 9y 29".split(" "),function(b,d,c,a,e,f,g,h,l,k){var n=d.detect(),p=function(a){return"img"===g.name(a)},q=function(a){var b=function(a){return g.isText(a)&&0<l.get(a).length};return b(a)||h.descendant(a,b)},r=function(d,g){var h=d.content(),l=function(a){e.isBackspace(a)&&h.win().each(function(d){h.getSelection().each(function(e){var f=e.startContainer(),g=e.startOffset(),h=e.endContainer(),
l=e.endOffset(),f=c.cloneFragment(d,f,g,h,l),f=k.children(f),g=b.find(f,p);void 0===g||null===g||b.exists(f,q)||(c.deleteRange(d,e.startContainer(),e.startOffset(),e.endContainer(),e.endOffset()),a.original().kill())})})};g.events.changed.bind(function(a){d.content().uiChanged();f.select(h,a.image())});g.events.contextmenu.bind(function(a){var b=a.image();k.parent(b).each(function(a){k.findIndex(b).each(function(b){h.setSelection(a,b,a,b+1)})})});h.events.keydown.bind(l);return{cleanup:a.noop,destroy:function(){h.events.keydown.unbind(l)}}};
return function(b,c){return n.browser.isIE()?r(b,c):{cleanup:a.noop,destroy:a.noop}}});k("5x",["b","6","2i","s"],function(b,d,c,a){var e={en_au:"en_gb",en_bz:"en_gb",en_ca:"en_gb",en_gb:"en_gb",en_ie:"en_gb",en_in:"en_gb",en_jm:"en_gb",en_my:"en_gb",en_nz:"en_gb",en_ph:"en_gb",en_sg:"en_gb",en_tt:"en_gb",en_za:"en_gb",en_zw:"en_gb",en_us:"en_us"},f="da de en en_au en_br en_gb en_uk en_us es fi fr it nb nl pt pt_pt sv".split(" ");return{determine:function(g){var h=d.merge(c.localeList(),e);g=c.determineFrom(g,
h);return""!==g&&b.contains(f,g)?a.some(g):a.none()}}});k("aq",["2g"],function(b){return{serializeToString:function(d){return(new (b.getOrDie("XMLSerializer"))).serializeToString(d)}}});k("5y",["c","aq","5z","w","q"],function(b,d,c,a,e){b=b.detect().browser;var f=function(a){return a.replace(/^<body .*?>/,"").replace(/<\/body>$/,"")},g=function(a){a=a.dom();return f(d.serializeToString(a))},h=function(a){a=e.implementation.createDocument(null,null,null).importNode(a.dom(),!0);return f(d.serializeToString(a))},
l=function(a){a.dom().innerHTML=a.dom().innerHTML;return g(a)},k=b.isChrome()||b.isSafari()?h:b.isIE()?l:g;return{writeNode:function(b){b=k(b).replace(/<iframe([^>]*?)\s*\/\s*>/g,"<iframe$1></iframe>");var d=a.fromCharCode(160);return b.replace(new c(d,"g"),"&nbsp;")}}});k("3t","54 b 1n 6 7 s 4u 3c 3v 55 56 57 58 59 5a 5b 5c 5d 5e 5f 5g 5h 5i 5j 5k 5l 5m 5n 5o 5p 5q 5r 5s 4w 5t 5u 5v 1f 5w 5x 4x 3z 40 33 l 5y 5z 3m".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x,y,B,z,A,C,D,E,F,G,I,H,
L,J,K,M,Q,R,P,O,V,U,N,X,T,W,Z,ba,$){var aa=T.immutableBag("accessibility formatting alignindent directionality table font parlance media imageEdit blocktag specialchar wordcount link horizontalrule help fileupload findreplace plaincodeview".split(" "),[]);return function(T,ea,da){var Y=function(a,b,c,d){return b.bundled?a.apply(void 0,d.concat([b])):c()},S=s(T,ea,da),fa=Q(),ca=Y(B,T.image,K.image,[S]),ia=Y(z,T.imageEdit,K.imageEdit,[S,ca,fa]);ea=Y(p,T.formatting,K.basic,[S]);var oa=Y(n,T.alignindent,
K.basic,[S,ca]),ja=Y(r,T.directionality,K.basic,[S]),la=Y(M,T.table,K.table,[S]),sa=Y(q,T.blocktag,K.basic,[S]),ka=Y(v,T.font,K.basic,[S]),pa=Y(R,T.wordcount,K.basic,[S]),qa=Y(D,T.media,K.basic,[S]),ra=Y(L,T.specialchar,K.basic,[S]),ta=Y(F,T.parlance,K.basic,[S]),ma=Y(A,T.link,K.basic,[S]),za=Y(y,T.horizontalrule,K.basic,[S]),Aa=Y(w,T.help,K.dialog,[S]),na=function(a,b,c,d){var e=void 0!==T.ui.locale.code?T.ui.locale.code:P.get();return(!0===b.bundled?V.determine(e):f.none()).fold(function(){return c()},
function(c){return a.apply(void 0,d.concat([b,c]))})}(J,T.spelling,K.spelling,[S,da.spelling]),Da=Y(I,T.resize,e.curry(O,S,ca),[S,ca]),ua=Y(C,T.macros,K.macros,[S,na,da.macros]),ya=Y(x,T.highlighter,K.highlighter,[S,ua]);da=Y(t,T.fileupload,K.dialog,[S,fa,ia.insertResample()]);var xa=Y(H,T.smartclipboard,K.basic,[S,fa,ia.insertResample()]),Ia=Y(E,T.mentions,K.basic,[S]),Ga=Y(u,T.findreplace,K.basic,[S]),Ha=Y(k,T.accessibility,K.basic,[S]),va=function(){var a=S.content();return a.body().fold(a.getContent,
function(c){c=W.fromDom(c.dom().cloneNode(!0));var d=S.filter();d.filterDom(d.output(),c);c=Z.writeNode(c);c=a.extract(c);d=new ba(b.zeroWidth(),"g");return c.replace(d,"")})},wa=function(a){var b=S.filter(),c=S.content();a=b.filterHtml(b.input(),a);c.resetContent(a);c.runOrOnLoaded(function(a){b.filterDom(b.inputDom(),a)});ya.run();na.check()},Y=Y(G,{getContent:va,setContent:wa,bundled:T.plaincodeview.bundled},K.basic,[S]);S.contextmenu().register("table",la);S.contextmenu().register("imageEdit",
ia);S.contextmenu().register("image",ca);S.contextmenu().register("spelling",na);S.contextmenu().register("link",ma);var Ea=aa({formatting:ea,alignindent:oa,directionality:ja,table:la,font:ka,imageEdit:ia,parlance:ta,blocktag:sa,wordcount:pa,specialchar:ra,media:qa,link:ma,horizontalrule:za,help:Aa,fileupload:da,findreplace:Ga,accessibility:Ha,plaincodeview:Y});S.content().events.loaded.bind(function(){S.ui().init(S.keyboard(),S.undo(),S.users(),Ea);na.init(S.content());ya.run();$(Ba.trigger.loaded,
0)});S.users().init();S.locker().init();var Ba=N.create({loaded:U([]),focus:U([]),dirty:X([],S.laundry().events.dirty),internal:X(["command","data"],S.internalevents().events.internal)});S.content().events.focus.bind(function(){Ba.trigger.focus()});Y=S.content().isInline()?function(){var a=S.ui(),b=S.content(),c=a.state(),c=void 0!==c.toolbar&&void 0!==c.toolbar.drag?c.toolbar.drag.isSome():!1;b.activate();b.focus();c||a.position();a.refresh()}:e.noop;ea=S.content().isInline()?function(){S.content().deactivate();
S.content().blur()}:e.noop;return l.internal({activateInline:Y,deactivateInline:ea,element:S.ui().element,viewport:S.ui().viewport,connect:S.ui().connect,focus:S.content().focus,blur:S.content().blur,getContent:va,toTransfer:e.compose(g.changed,va),setContent:wa,insertHtmlAtCursor:S.insertFilteredHtmlAtCursor,isDirty:S.laundry().isDirty,setDirty:S.laundry().setDirty,fromTransfer:function(a){var b=S.undo();g.cata(a,function(a){b.disable(function(){wa(a)});b.replaceTop()},function(a){wa(a);b.save()})},
uploader:e.constant(fa),state:function(){var b=S.state();return a.merge(b,{spelling:na.state(),macros:ua.state(),filters:S.filter().customFilters().state()})},cleanup:function(){Da.cleanup()},destroy:function(){var a=va();S.content().deactivate();S.content().teardown(a);a=d.map(c.values(Ea),e.apply);d.each(a.concat([ca,ia,na,Da,ua,ya,fa,xa,Ia,S]),function(a){a.destroy()})},events:Ba.registry,communication:S.communication,fullscreen:S.fullscreen,content:S.content,ui:S.ui,undo:S.undo,smartview:S.smartview,
keyboard:S.keyboard,filter:S.filter,operations:S.operations,macros:e.constant(ua),getMode:h.pencil,isPrettyPrinting:function(){return!0===T.content.prettyprint}})}});k("50",["3p","3t","3c"],function(b,d,c){var a=c.pencil(),e=c.code(),f=function(a){var b=a.old().toTransfer();a.nu().fromTransfer(b)},g={transition:f,factory:b,style:c.pencil},h={transition:f,factory:d,style:c.code};return{toMode:function(a,b){b(a.style(),function(b){var c=b.swap(a.factory,{},{});return function(){a.transition(c);c.destroy()}})},
goingToDesign:function(a){return a===e},alternate:function(b){return b===e?a:e},detect:function(a){return a===e?g:h}}});k("ar","dv 6u 30 4x 3z 1a 1x 43 3n l 2m 2o".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p){return{generate:function(q){var r=e.create({change:a(["type"])}),s=k.fromTag("div");h.add(s,[c.resolve("html-switch-wrapper"),c.resolve("layer-editor")]);var t=k.fromTag("div");h.add(t,[c.resolve("html-switch"),c.resolve("icon"),c.resolve(q)]);f.set(t,"data-icon",q);n.append(s,t);var u=function(a,
b){var d=f.get(t,"data-icon");g.remove(t,c.resolve(d));g.add(t,c.resolve(a));f.set(t,"data-icon",a);f.set(t,"title",b)},v=function(){return f.get(t,"data-icon")},w=b.tap(function(){r.trigger.change(v())}),x=l.bind(s,"click",w.instance);return{render:function(a){n.append(a,s)},destroy:function(){p.remove(s);x.unbind()},current:v,switchto:function(a){u(a,d.translate("toolbar.switch-"+a));w.control.unblock()},spin:function(){u("spin",d.translate("loading.wait"));w.control.block()},events:r.registry}}}});
k("51","b 4e 7 s p 50 39 ar 4x 3z 4f o".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p){var q=function(a,b){return{destroy:c.noop,init:c.noop,setMode:c.die("Code view is not enabled, cannot switch modes"),events:k.create({change:l([])}).registry}},r=function(a){a=n(a);return{switchto:a.set,current:a.get,render:c.noop,spin:c.noop,destroy:c.noop,events:k.create({change:l([])}).registry}},s=function(c,n){var q=n.css+"/codemirror.css",s=k.create({change:l(["style","swapper"])}),x=n.showButton?h.generate(n.mode):
r(n.mode);x.events.change.bind(function(a){z(a.type())});var y=a.none(),B=[],z=function(a){y.fold(function(){throw"Cannot set mode before Code View has loaded";},function(b){if(c.get().getMode()!==a){x.spin();var d=f.detect(a);b.get(function(b){b.fold(function(b){x.switchto(a);p.error(b);p.error("Code View non-functional due to error downloading script file")},function(){f.toMode(d,function(a,b){s.trigger.change(a,b)})})})}})},A=function(a){var b=c.get();x.switchto(a);x.render(b.viewport())},C=function(a){a(e.value(!0))};
return{destroy:function(){x.destroy();b.each(B,function(a){a.unbind()})},setMode:z,init:function(b){y.fold(function(){d.addStylesheet(q,C).get(function(c){c.fold(function(a){p.error(a);p.error("Code View disabled due to error loading stylesheet")},function(){y=a.some(g.load.codeview(n.js));A(b)})})},function(a){A(b)})},events:s.registry}};return function(a,b){return(!0===b.bundled?s:q)(a,b)}});k("iq","9k b qp 7 4t 6u 1f bk 30 bl bm bn k1 1a 2k 1x 43 3n l 2m 2o q".split(" "),function(b,d,c,a,e,f,g,
h,l,k,n,p,q,r,s,t,u,v,w,x,y,B){return function(z,A,B,D,E,F){var G=w.fromTag("div");D.updateUi(G);u.add(G,[l.resolve("editor-container"),"ephox-textbox-font",l.resolve("layer-editor"),l.resolve("fullscreen-maximized")]);r.set(G,"lang",g.get());h.addClasses(G);var I=q(),H=b.toolbar(I,f.translate);A.events.toolbar.bind(H.enter);H.events.exit.bind(z.focus);var L=k(),J=s.body(),K=w.fromTag("div");t.add(K,l.resolve("socket"));var M=d.map(["dragover","drop"],function(a){return v.bind(K,a,function(a){a.kill()})});
I.integrate(G,H,L,K);var Q=c({layerClass:l.resolve("layer-below-editor"),background:"rgba(255, 255, 255, 0.92)"}),R=l.resolve("body-fullscreen"),P=E.autoresize?n(E):p();P.events.change.bind(function(a){H.refresh();B.refresh()});return{element:function(){return G},socket:function(a){x.append(K,a.element())},viewport:a.constant(K),connect:function(a){Q.show();t.add(J,R);x.append(a,G);e.detect(G);P.hookup(z.element());return!0},destroy:function(){d.each(M,function(a){a.unbind()});H.destroy();t.remove(J,
R);y.remove(G);Q.destroy();P.destroy();L.destroy()},banners:L.element,displayBanner:L.display,hideBanner:L.hide,position:function(){I.init(H,L,K,E,F)},refresh:function(){I.update();H.refresh()},toolbar:H}}});k("as",["7","6n","iq","6q"],function(b,d,c,a){return{build:function(a,f,g,h,l,k,n,p){var q=c(a,f,g,k,n,p),r=h.full(q);r.init();return{element:q.element,socket:q.socket,viewport:q.viewport,init:function(b,c,f,h){c=r.config(a.isInline(),c,l,f,h);d.setup(q,k,a,b,g,f,c);r.loaded()},connect:q.connect,
destroy:function(){q.destroy();r.destroy()},displayBanner:q.displayBanner,hideBanner:q.hideBanner,position:b.noop,refresh:q.refresh,tabstrip:q.toolbar,state:b.constant(p)}},bounds:function(){return a.view}}});k("52","s 50 3t as 4z 4x 3z 2k 1b 29 q".split(" "),function(b,d,c,a,e,f,g,h,l,k,n){return function(n){var q=b.none(),r=b.none(),s=g.create({maximize:f([]),restore:f([])}),t=function(b){q=k.parent(n.get().element());q.getOrDie("maximize called on editor that is not in the DOM.");n.swap(c,{ui:{layout:a},
fullscreen:{layout:void 0!==b.layout()?b.layout():e}}).destroy();var d=n.get();d.fullscreen().select();d.connect(h.body());d.events.loaded.bind(function(){d.focus();s.trigger.maximize()})},u=function(a){n.swap(c,{ui:{layout:void 0!==a.layout()?a.layout():e}}).destroy();var b=n.get();b.fullscreen().deselect();a=q.getOrDie("restore called on editor that was not previously in the DOM.");n.get().connect(a);b.events.loaded.bind(function(){b.focus();s.trigger.restore()})};return{init:function(a){if(d.goingToDesign(a)){a=
n.get();var c=n.get().element();r.each(function(a){if(l.eq(a,c))throw"Fullscreen init called twice on the same instance";});r=b.some(c);a.fullscreen().events.maximize.bind(t);a.fullscreen().events.restore.bind(u)}},destroy:function(){},events:s.registry}}});k("at",["a","b"],function(b,d){return function(){var c=[];return{setCallback:function(a){b.isFunction(a)&&c.push(a)},done:function(a){d.each(c,function(b){b.apply(null,[a])});c=[]}}}});k("ir","qq qr 2w fy 7 s cw 1a".split(" "),function(b,d,c,a,
e,f,g,h){var l=function(a){return a.result};return{blobTob64:function(a,b){var c=h.get(b,g.blobId());h.remove(b,g.blobId());a.get(c).each(function(a){h.remove(b,g.blobId());h.set(b,"src",l(a.data()))})},b64ToBlob:function(e,l){var k=h.get(l,"src"),q=function(a){console.warn("Unable to read Base64 image data: ",a,k);return f.none()};e.lookupByData(k).fold(function(){var g=b.toBlob(k);return d.cata(g,f.none,q,function(b){var d=a.createObjectURL(b),g=c.generate("image");return f.some(e.add(g,b,d,{result:k}))})},
f.some).each(function(a){h.set(l,g.blobId(),a.id());h.set(l,"src",a.objurl())})}}});k("av",["b","ir","cw"],function(b,d,c){return{configure:function(a,e){a.addSelector(a.output(),"img["+c.blobId()+"]",function(a){b.each(a,function(a){d.blobTob64(e,a)})});a.addSelector(a.input(),"img:not(["+c.blobId()+"])[src]",function(a){b.each(a,function(a){d.b64ToBlob(e,a)})});var f=function(a){return b.each(a,c.cleanup)};a.add(a.output(),c.uploadContainer(),f);a.add(a.history(),c.uploadContainer(),f);a.add(a.internal(),
c.uploadContainer(),f)},blobId:c.blobId}});k("is","cw 1x l 2m 35 2o 2y 29".split(" "),function(b,d,c,a,e,f,g,h){return{removeUi:function(a){g.ancestor(a,"."+b.uploadContainer()).each(function(a){var b=h.children(a);e.before(a,b);f.remove(a)})},addUi:function(e){var f=c.fromTag("div");d.add(f,b.uploadContainer());a.before(e,f);a.append(f,e)}}});k("b0","b fh 7 s p cw is 4g 33 1a 2y o".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p){var q=l.immutable("image","blobInfo"),r=h.generate([{failure:["error"]},
{success:["result","images","blob"]}]),s=function(a,c,d,e){b.each(c,function(a){k.set(a,"src",e.location);k.remove(a,f.blobId())});return v(a,d)},t=function(a,b,c,d,e,g){var h=a.lookupByData(e.result).getOrThunk(function(){return a.add(b,c,d,e)});k.set(g,f.blobId(),h.id());return q(g,h)},u=function(a,b){var c=k.get(b,f.blobId());return a.get(c).fold(function(){return e.error(c)},function(a){return e.value(q(b,a))})},v=function(a,b){return a.get(b).fold(function(){return e.error("Internal error with blob cache")},
function(c){a.remove(b);return e.value(c)})};return{prepareForUpload:function(b,c,d){var e=b.isActive(c);b.register(d,c);g.addUi(d);return e?a.none():a.some(c)},handleUpload:function(a,d,e,f,h,l,k){var m=function(){p.error("Internal error with blob cache",h);k(r.failure({status:c.constant(666)}))};a.upload(l,h,function(a){var c=d.findById(f,h);b.each(c,g.removeUi);a.fold(function(a){k(r.failure(a))},function(a){s(e,c,h,a).fold(m,function(b){k(r.success(a,c,b))})});d.report(h,c,a.isValue())})},registerAssets:function(a,
f,g){return b.bind(g,function(b){return d.cata(b,function(b,c,d,g){return n.descendant(f,'img[src="'+d+'"]').fold(function(){return[e.error("Image that was just inserted could not be found: "+d)]},function(f){return[e.value(t(a,b,c,d,g,f))]})},c.constant([]))})},registerBlob:t,findBlobs:function(a,c,d){d=a.findAll(d);return a.inProgress()?[]:b.map(d,function(a){return u(c,a)})}}});k("aw","fh fx 3l 93 fz g2 98 8d b0".split(" "),function(b,d,c,a,e,f,g,h,l){var k=function(k){var m=function(c){var m=
c.image(),p=c.blobInfo(),t=f.changedBounds(m);return h.resampleAction(t,p.blob(),function(f){if(f===p.blob())return e.pure(c);var h=a.updater(a.keepResample,m),t=g.applyEdit(m);f=d.single(f).bind(t).map(h);return e.map(f,function(a){return b.cata(a,function(a,b,c,d){return l.registerBlob(k,a,b,c,d,m)},function(a,b,d){return c})})})};return function(a){return c.mapM(a,m)}};return{instance:function(a,b){return!0===a.immediate?c.pure:k(b)}}});k("qs",["s","6u"],function(b,d){var c={400:"errors.http.400",
401:"errors.http.401",403:"errors.http.403",404:"errors.http.404",407:"errors.http.407",409:"errors.http.409",413:"errors.http.413",415:"errors.http.415",500:"errors.http.500",501:"errors.http.501"};return{get:function(a,e){return b.from(c[a]).map(function(a){return d.translate(a,e)})}}});k("it",["a","7","r","be","qs"],function(b,d,c,a,e){var f=function(c){return b.isString(c)&&""!==c.trim()?{description:d.constant(c),link:d.constant(null)}:a.get("error.imageupload.generic")},g=function(b,c){var f=
c.status();return e.get(f,b).fold(function(){var c;c=0===f?"error.imageupload.cors":400<=f&&500>f?"error.code.images.not.found":"error.imageupload";return a.get(c,[b])},function(a){return{description:d.constant(a),link:d.constant(null)}})},h=function(a,b){return{instance:function(){return c.cached(function(c){c=b(c);a.show(c)})}}};return{simple:function(a){return h(a,f)},url:function(a,b){return h(a,d.curry(g,b))}}});k("x0",["2g"],function(b){return function(){return new (b.getOrDie("FormData"))}});
k("qu",["a","b","x0","33","v"],function(b,d,c,a,e){var f=["jpg","png","gif","jpeg"];return{failureObject:a.immutable("message","status","contents"),getFilename:function(a,c){var l;b.isString(a.name)&&!e.endsWith(a.name,".tmp")?l=a.name:b.isString(a.type)&&e.startsWith(a.type,"image/")?(l=a.type.substr(6),l=d.contains(f,l)?c+"."+l:c):l=c;return l},buildExtra:function(a,b,d){var e=c();e.append(a,b,d);return{data:e,contentType:!1,processData:!1}}}});k("10u",[],function(){return{recompose:function(b){var d=
"";""!==b.protocol&&(d+=b.protocol,d+=":");""!==b.authority&&(d=d+"//"+b.authority);d+=b.path;""!==b.query&&(d+="?",d+=b.query);""!==b.anchor&&(d+="#",d+=b.anchor);return d}}});k("13q",["v"],function(b){return{remove:function(d){for(var c="";""!==d;)if(b.startsWith(d,"../"))d=b.removeLeading(d,"../");else if(b.startsWith(d,"./"))d=b.removeLeading(d,"./");else if(b.startsWith(d,"/./"))d="/"+b.removeLeading(d,"/./");else if("/."===d)d="/";else if(b.startsWith(d,"/../"))d="/"+b.removeLeading(d,"/../"),
c=b.removeTrailing(c,c.substring(c.lastIndexOf("/")));else if("/.."===d)d="/",c=b.removeTrailing(c,c.substring(c.lastIndexOf("/")));else if("."===d||".."===d)d="";else{var a=d.match(/(^\/?.*?)(\/|$)/)[1];d=b.removeLeading(d,a);c+=a}return c}}});k("13r",["v"],function(b){return{merge:function(d,c,a){if(""!==a&&""===d)return"/"+c;a=d.substring(d.lastIndexOf("/")+1);return b.removeTrailing(d,a)+c}}});k("10v",["v","gt","13q","13r"],function(b,d,c,a){return{transform:function(e,f){var g={strictMode:!0},
h=d.parse(e,g),g=d.parse(f,g),l={};""!==g.protocol?(l.protocol=g.protocol,l.authority=g.authority,l.path=c.remove(g.path),l.query=g.query):(""!==g.authority?(l.authority=g.authority,l.path=c.remove(g.path),l.query=g.query):(""===g.path?(l.path=h.path,l.query=""!==g.query?g.query:h.query):(b.startsWith(g.path,"/")?l.path=c.remove(g.path):(l.path=a.merge(h.path,g.path,e.authority),l.path=c.remove(l.path)),l.query=g.query),l.authority=h.authority),l.protocol=h.protocol);l.anchor=g.anchor;return l}}});
k("x1",["10u","10v"],function(b,d){return{resolve:function(c,a){var e=d.transform(c,a);return b.recompose(e)}}});k("qv","a 6 oj v6 p qu v x1".split(" "),function(b,d,c,a,e,f,g,h){return function(l){var k=function(){var a=l.url,b=a.lastIndexOf("/"),a=0<b?a.substr(0,b):a,a=void 0===l.basePath?a:l.basePath;return g.endsWith(a,"/")?a:a+"/"}();return{upload:function(g,p,q){g=g.blob();var r=function(a,b,c){q(e.error(f.failureObject(a,b,c)))},s=f.getFilename(g,p);p=d.merge(!0!==l.credentials?{}:{xhrFields:{withCredentials:!0}},
f.buildExtra("image",g,s));c.post(l.url,{},function(c){var d;try{var f=a.parse(c);if(b.isString(f.location))d=f.location;else{r("JSON response did not contain a string location",500,c);return}}catch(g){d=c}c=d.split(/\s+/);c=h.resolve(k,1===c.length&&""!==c[0]?c[0]:s);q(e.value({location:c}))},r,p)}}}});k("qw","a p qu 33 o 3m".split(" "),function(b,d,c,a,e,f){var g=a.immutable("id","filename","blob","base64");return function(a){return{upload:function(l,k,n){var p=function(a){n(d.error(a))},q=function(a){b.isString(a)?
n(d.value({location:a})):(e.error("Image upload result was not a string"),p(""))},r=c.getFilename(l.blob(),k),s=g(k,r,l.blob(),l.data().result);f(function(){a(s,q,p)},0)}}}});k("iv",["qu","qv","qw"],function(b,d,c){return{direct:function(a){return d(a)},custom:function(a){return c(a)},failureObject:function(a,c,d){return b.failureObject(a,c,d)},getFilename:function(a,c){return b.getFilename(a,c)},buildExtra:function(a,c,d){return b.buildExtra(a,c,d)}}});k("iu",["6","p","qt","iv"],function(b,d,c,a){return function(e,
f){return{upload:function(g,h,l){g=g.blob();h=a.getFilename(g,h);h=b.merge(e.headers(),a.buildExtra("image",g,h));c.json().post(f,function(a){l(d.value(a))},function(b,c,e){l(d.error(a.failureObject(b,c,e)))},h)}}}});k("ax","a 7 it iu iv 33".split(" "),function(b,d,c,a,e,f){var g=f.immutable("uploader","errors");return{choose:function(f,l,k){return!0!==f.bundled?g({upload:d.die},{instance:d.constant(d.die("Image Upload is disabled"))}):b.isString(f.service)?g(a(k,f.service),c.url(l,f.service)):b.isFunction(f.handler)?
g(e.custom(f.handler),c.simple(l)):g(e.direct(f.direct),c.url(l,f.direct.url))}}});k("ay",["1n","fy","s","33"],function(b,d,c,a){var e=a.immutable("id","blob","objurl","data");return function(){var a={},g=function(a){d.revokeObjectURL(a.objurl())};return{add:function(b,c,d,g){c=e(b,c,d,g);return a[b]=c},get:function(b){return c.from(a[b])},remove:function(b){var c=a[b];delete a[b];void 0!==c&&g(c)},lookupByData:function(d){return c.from(b.find(a,function(a){return a.data().result===d}))},destroy:function(){b.each(a,
g);a={}}}}});k("az","b iw cw 4x 3z 1a 46".split(" "),function(b,d,c,a,e,f,g){var h="data-"+d.resolve("image-upload"),l=function(a,b){return g.descendants(a,"img["+h+'="'+b+'"]')},k=function(a){return g.descendants(a,"img:not(["+h+"])["+c.blobId()+"]")};return function(){var c=[],d=[],g=e.create({complete:a(["response"])}),r=function(a){c=b.filter(c,function(b,c){return b!==a});!1===s()&&(g.trigger.complete(d),d=[])},s=function(){return 0<c.length};return{findById:l,findAll:k,register:function(a,b){f.set(a,
h,b);c.push(b)},report:function(a,c,e){b.each(c,function(a){f.remove(a,h);d.push({success:e,element:a.dom()})});r(a)},inProgress:s,isActive:function(a){return b.contains(c,a)},events:g.registry}}});k("53","a b s k 86 at au 50 av aw ax ay az b0 o".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s){return function(a,u){var v=p(),w=f(),x=q(),y=e(a.ui),B=n.choose(u,y,a.communication()),z=B.uploader(),A=B.errors(),C=k.instance(u,v);x.events.complete.bind(function(a){w.done(a.response())});var D=function(a,
b,c,d){r.handleUpload(z,x,v,a,b,c,function(a){a.fold(function(a){d(a)},F)})},E=function(b){a.content().body().each(function(a){var c=A.instance(),e=r.registerAssets(v,a,b.assets());d.each(e,function(b){b.fold(function(a){s.error(a)},function(b){!0===u.immediate&&G(a,b,c)})})})},F=function(b,c,d){a.undo().rewrite(d.objurl(),b.location)},G=function(a,b,c){!1!==u.bundled&&r.prepareForUpload(x,b.blobInfo().id(),b.image()).each(function(d){D(a,d,b.blobInfo(),c)})},I=function(a){d.each(a,function(a){x.report(a,
c.none(),!1)})},H=function(a,b){var c=g.partition(b),e=c.values;I(c.errors);var f=A.instance();C(e).get(function(b){b=g.partition(b);0<b.errors.length&&(y.showKey("imageedit.generic"),s.error("Image resample on upload errors: ",b.errors),I(b.errors));d.each(b.values,function(b){G(a,b,f)})})},L=function(c){b.isFunction(c)&&w.setCallback(c);!0!==u.bundled?w.done([]):a.content().body().fold(function(){w.done([])},function(a){var b=r.findBlobs(x,v,a);0!==b.length||x.inProgress()?H(a,b):w.done([])})};
return{init:function(b){h.goingToDesign(b)&&(b=a.filter(),l.configure(b,v),a.uploader().events.uploadAssets.bind(E),a.uploader().events.pasteUpload.bind(function(){!0===u.immediate&&L()}),a.uploader().events.registerBlob.bind(function(a){var b=a.id(),c=a.blob(),d=a.bloburl();a=a.data();v.add(b,c,d,a)}));y.reset()},reconstitute:L,destroy:function(){v.destroy()}}}});k("3s","b 50 3c 51 52 53".split(" "),function(b,d,c,a,e,f){return function(g,h,l,k){var n=e(g),p=f(h,l.imageupload);l=a(g,l.codeview);
var q=[n,p],r=q.concat([l]);n.events.restore.bind(function(){k.restore();s(r,c.code())});n.events.maximize.bind(function(){k.save();s(q,c.code())});l.events.change.bind(function(a){p.reconstitute(function(){var b=a.swapper()(g);g.get().events.loaded.bind(function(){h.focus()});h.reconnect();b()})});var s=function(a,c){b.each(a,function(a){a.init(c)})};h.events.connected.bind(function(){s(r,d.alternate(h.getMode()))});return{setMode:l.setMode,uploadImages:p.reconstitute,destroy:function(){b.each(r,
function(a){a.destroy()});g.destroy()}}}});ta.define("b2",[],function(){return'/*\n * Keep this file as small as possible.\n * It is injected into the JavaScript, so it needs to be tiny.\n */\n\n/*\n * Animate from 0 to 359, not 0 to 360, as they are the same and FireFox does nothing\n *\n * Until we have token replacement, manual shorthand for "ephox-polish-spin"\n */\n\n@keyframes e-p-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n\n/* Until we have token replacement, manual shorthand for "ephox-polish-spinner-img" */\n\n.e-p-s-img {\n  animation: e-p-spin 2s infinite linear;\n  width: 30px;\n  height: 30px;\n  margin: 2px 2em 0 auto;\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAIVBMVEUAAABAQEBDQ0NERERERERCQkJDQ0NERERDQ0NEREREREQTPu3mAAAACnRSTlMAENDPwGBwsKB/qy4kVgAAAFpJREFUCNdjAAImAwYI4FoApooFuBYwWgAZXoZMCsJLgAyhpQwMUYpABmMiA4OYAAMCaC2GklqLwIxFMAmoYkmQYmGQdkOQgYpMBkIgA4tAVmggLAU7QwFIAADjyQ3FWhtneAAAAABJRU5ErkJggg==") 0/cover;\n}'});
k("62","s 2k l 2m 2o b1 b2".split(" "),function(b,d,c,a,e,f,g){var h=0,l=b.none();return{add:function(){if(0===h){var e=c.fromTag("style");f.set(e,g);a.append(d.body(),e);l=b.some(e)}h++},remove:function(){0!==h&&0===--h&&(l.each(e.remove),l=b.none())}}});k("3u","6 7 s 60 4u 3v 61 4w 62 3y 63 4f 2l l 64 2d 2m 2o 65 3m".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x){return function(y,B){var z=h.state(B),A=p(null),C=r.fromTag("div"),D=function(){t.set(C,'<div class="e-p-s-img"></div>');
E()},E=void 0===y.content.inline?d.noop:function(){if(!1===y.ui.toolbar.visible)q.set(C,"display","none");else{var a={isInline:d.constant(!0),element:d.constant(y.content.inline)},a=n.offsetFrom(a,C,s.get(C),y.ui);q.setAll(C,{position:"absolute",left:a.left+"px",top:a.top-4+"px"})}},F=null,G=d.die("API unavailable while the editor is loading"),I={body:d.constant(c.none()),doc:G,execCommand:G,getSelectedText:G,focus:G,deactivate:d.noop,blur:d.noop},H=void 0===y.content.inline?A.get:function(){return t.get(y.content.inline)};
return f.internal({activateInline:E,blur:G,cleanup:d.noop,communication:d.constant(g(y)),connect:function(a){F=x(D,1E3);u.append(a,C);l.add();return!1},content:d.constant(I),deactivateInline:d.noop,destroy:function(){w(F);l.remove();v.remove(C)},element:d.constant(C),events:k.events(),failure:function(){w(F);l.remove();t.set(C,"<p>Unable to load editor. See browser console for details.</p>")},filter:z.filter,focus:G,fromTransfer:function(a){e.cata(a,A.set,A.set)},fullscreen:h.fullscreen,getContent:H,
getMode:G,insertHtmlAtCursor:G,isDirty:z.laundry.isDirty,isPrettyPrinting:function(){return!0===y.content.prettyprint},keyboard:k.keyboard,macros:z.macros,operations:k.operations,setContent:function(a){void 0===y.content.inline?A.set(a):t.set(y.content.inline,a);z.laundry.setDirty(!1)},setDirty:z.laundry.setDirty,smartview:k.smartview,state:function(){var c=H(),c=a.isEmpty(c)?{}:{content:{clean:c,marked:c},undo:{initial:{clean:c,marked:c}}};return b.deepMerge(z.getState(),c)},toTransfer:d.compose(e.changed,
A.get),ui:k.ui,undo:d.constant(h.undo()),uploader:d.constant(h.uploader()),viewport:d.constant(C)})}});k("3w",["c","6"],function(b,d){return{settings:function(c){var a=b.detect(),e={ui:{toolbar:{display:!1}},spelling:{bundled:!1},highlighter:{bundled:!1},table:{bundled:!1},resize:{bundled:!1},codeview:{bundled:!1},imageEdit:{bundled:!1},imageupload:{immediate:!0}},f={resize:{bundled:!1}},a=a.deviceType.isTouch()?e:a.browser.isIE()?f:{};return d.deepMerge(a,void 0===c.content||void 0===c.content.inline?
{}:{fullscreen:{bundled:!1},codeview:{bundled:!1},plaincodeview:{bundled:!1}})}}});k("66","b 7 s 1f 1a b3 20 29 v".split(" "),function(b,d,c,a,e,f,g,h,l){var k={isRtl:d.constant(!1)},n={isRtl:d.constant(!0)},p=function(a){return b.exists(["ar","fa","he"],function(b){return l.startsWith(a,b)})};return function(a){var b=p(a);return{directionAt:function(a){return"rtl"===(g.isText(a)?h.parent(a):c.some(a)).map(f.getDirection).getOr("ltr")?n:k},uiDirection:function(){return b?n:k},updateUi:function(a){e.set(a,
"dir",b?"rtl":"ltr")},destroy:d.noop}}});k("3x","6 7 r 1f 66 4x 3z".split(" "),function(b,d,c,a,e,f,g){return function(h,l){var k=g.create({create:f(["instance"]),loaded:f([]),focus:f([]),dirty:f([]),internal:f(["command","data"])}),n=c.cached(function(){k.trigger.loaded()}),p=function(a){a.events.focus.bind(function(){k.trigger.focus()});a.events.dirty.bind(function(){k.trigger.dirty()});a.events.internal.bind(function(a){k.trigger.internal(a.command(),a.data())});a.events.loaded.bind(n)};p(h);var q=
h,r=d.compose(e,a.get);return{get:function(){return q},swap:function(a,c){var e=q;e.cleanup();var f=b.deepMerge(l,c),g=e.state(),f=a(f,r(),g);p(f);k.trigger.create(f);q=f;return{old:d.constant(e),nu:d.constant(f),destroy:function(){e.destroy()}}},destroy:function(){q.cleanup();q.destroy()},events:k.registry}}});k("2c","b 3f 6 t 3p 3q 3r 3s 3t 3u 3v 3w 3x 3y 3z 40 l o q 31".split(" "),function(b,d,c,a,e,f,g,h,l,k,n,p,q,r,s,t,u,v,w,x){var y=function(a){return c.deepMerge(f.settings(a.resources),a,p.settings(a))};
return function(p,z){var A=y(p);a.setLanguage(A.ui.locale.code);var C=c.deepMerge(f.state(),z),D=d.capture(u.fromDom(w),x),E=k(A,C),F=q(E,A),G=g(F),C=h(F,G,A,D),D=s.create({loaded:t([],F.events.loaded),focus:t([],F.events.focus),dirty:t([],F.events.dirty),connected:t([],G.events.connected),internal:t(["command","data"],F.events.internal)});a.waitForLoad().get(function(c){c=a.getFailures(c);0===c.length?(F.swap("code"===A.codeview.mode?e:l).destroy(),G.reconnect()):(b.each(c,function(a){v.error(a)}),
v.error("Required resources are not available. Cancelling editor load."),E.failure())});return n.external({activateInline:G.activateInline,communication:r.communication,connect:G.connect,content:G.content,deactivateInline:G.deactivateInline,element:G.element,events:D.registry,filter:G.filter,focus:G.focus,getContent:G.getContent,getMode:G.getMode,insertHtmlAtCursor:G.insertHtmlAtCursor,isDirty:G.isDirty,isPrettyPrinting:G.isPrettyPrinting,keyboard:G.keyboard,macros:G.macros,operations:G.operations,
setContent:G.setContent,setDirty:G.setDirty,smartview:G.smartview,state:G.state,ui:G.ui,undo:G.undo,setMode:C.setMode,uploadImages:C.uploadImages,registerBlob:C.registerBlob,destroy:C.destroy})}});k("1k","2a 23 2b 7 2c 1a 2d".split(" "),function(b,d,c,a,e,f,g){var h=function(a,c,h){var k=b.withOptions(a,h);k.content&&k.content.tabindex&&(0,f.remove)(a,"tabindex",k.content.tabindex);h=e(k);var q=g.get(a),r=f.get(a,"style");c(a);g.set(a,"");h.connect(a);d.set(h,q);return{polish:h,restore:function(b){g.set(a,
b);null!==r&&void 0!==r&&0<r.length?f.set(a,"style",r):f.remove(a,"style");k.content&&k.content.tabindex&&(0,f.set)(a,"tabindex",k.content.tabindex);return a}}};return{replace:function(a,b){return h(a,c.explicit,b)},takeover:function(b,c){return h(b,a.noop,c)}}});k("1c",["1k","6"],function(b,d){return{replace:function(c,a){var e=d.deepMerge(a,{platform:{fillscreen:!0}}),e=b.takeover(c,e);return{polish:e.polish,restore:e.restore}}}});k("1d","a b 1n 2e i 6 s v n".split(" "),function(b,d,c,a,e,f,g,h,
l){var k=function(a,c){var e={};if(void 0===a)return e;d.each(c,function(c){var d=c.name(),d=a[d];void 0!==d&&(c.validate(d),e[c.output()]=b.isArray(c.contents)?k(d,c.contents):d)});return e},n=function(a){return d.map(void 0===a?[]:a,function(a){var b=k,c=e.string("prefix"),d=e.string("suffix"),g;g=[e.string("color"),e.string("background-color")];g=f.merge(e.object("style"),{contents:g});return b(a,[c,d,g])})},p=function(a){if(void 0===a||void 0===a.fonts)return[];a=a.fonts;if(!b.isArray(a))throw new l("The fonts configuration was not an array");
var c=function(a,b){console.error(a+" :",b);throw new l(a);};return d.map(a,function(a){if(b.isString(a))return{value:a,text:a};b.isObject(a)||c("The fonts array value was not a string or object",a);void 0!==a.value&&b.isString(a.value)||c("The fonts value configuration was not a string or is undefined",a);void 0===a.text||b.isString(a.text)||c("The fonts text configuration was not a string",a);void 0!==a.text&&b.isString(a.text)&&0===a.text.length&&c("The fonts text configuration was an empty string",
a);return{value:a.value,text:a.text&&0<a.text.length?a.text:a.value}})},q=function(a){a=k(void 0===a?{}:a,[e.arrayOfStrings("languages")]);return void 0===a.languages?{}:{languages:d.map(a.languages,function(a){return a.toLowerCase()})}},r=function(a){return void 0===a.styles?{}:{styles:d.filter(a.styles,function(a){a=a.rule;return!(void 0===a||"."===a||0<=a.indexOf("..")||0<=a.indexOf("#"))})}},s=function(a){var c=k(a,[e.arrayOfStrings("plugins")]),c=void 0===c.plugins?[]:c.plugins,d=k(a.ui,[e.string("locale",
"code")]),g;void 0===a.autosubmit?g=!0:(e.bool("autosubmit").validate(a.autosubmit),g=a.autosubmit);var s=k(a.content,[e.arrayOfObjects("highlighters")]),t=k(a.paste,[e.string("style"),e.bool("enableFlashImport")]),z=k(a.css,[e.arrayOfStrings("stylesheets"),e.string("documentStyles")]),A=k(a.css,[e.arrayOfObjects("styles")]),C=k(a.ui,[e.bool("shortcuts","features")]),D=q(a.ui),E;E=a.codeview;E=k(void 0===E?{}:E,[e.bool("enabled"),e.bool("showButton")]);E={bundled:void 0===E.enabled||!0===E.enabled,
showButton:void 0===E.showButton||!0===E.showButton};var F;var G=a.spelling;if(void 0===G||void 0===G.url)F={service:!1};else if(b.isString(G.url))F={url:G.url,service:!0};else throw new l("Spelling URL was not a string");G=a.images;G=f.merge({allowLocal:!0},void 0===G?{}:G);e.bool("allowLocal").validate(G.allowLocal);var G=G.allowLocal,I=a.images,I=k((void 0===I?{}:I).editing,[e.bool("enabled"),e.string("proxy"),e.number("preferredWidth"),e.number("preferredHeight")]);void 0!==I.enabled&&(I.bundled=
I.enabled);var H;if(G){var L=a.images;H=!1===I.bundled?!0:!1;L=(void 0===L?{}:L).upload;if(void 0!==L)if(void 0!==L.handler){if(!b.isFunction(L.handler))throw new l("Image Upload Handler was not a function");H={handler:L.handler,immediate:H,bundled:!0}}else{if(!b.isString(L.url))throw new l("Image Upload URL was not a string");H={direct:k(L,[e.string("url"),e.string("basePath"),e.bool("credentials")]),immediate:H,bundled:!0}}else H={}}else H={};var L=a.ui,L=k((void 0===L?{}:L).toolbar,[e.arrayOfToolbarGroups("items"),
e.arrayOfStrings("contextual")]),J;var K=a.ui;if(void 0===K)J={};else{if(void 0===K.toolbar)J={};else if(J=K.toolbar,void 0!==J.offset){J=J.offset;if(!b.isObject(J)||void 0===J.top||void 0===J.left)throw new l("toolbar offset must be an object with left and top");if(!b.isNumber(J.top)&&!b.isNumber(J.left))throw new l("toolbar offset values must be numbers");J={draggable:!0,offset:{left:J.left,top:J.top}}}else J={};K=k(K.toolbar,[e.bool("visible"),e.bool("draggable")]);J=f.deepMerge(J,K)}var M;K=a.basePath;
if(void 0===K)M=void 0;else{if(!b.isString(K))throw new l("The basePath configuration value was not a string");M=h.removeTrailing(K,"/")}K=p(a.ui);a=k(a.ui,[e.string("aria-label","editorName")]);a=f.merge(a,{locale:d,toolbar:J});d=M;K={faces:K};s={external:n(s.highlighters)};J=t.style;return{resources:d,plugins:c,spelling:F,font:K,ui:a,shortcuts:C,autosubmit:g,highlighter:s,smartclipboard:{paste:"plain"===J?{forceText:!0}:{officeStyles:"retain"===J?"merge":void 0!==J?J:"prompt",htmlStyles:"retain"===
J?"merge":void 0!==J?J:"merge",allowLocalImages:G,enableFlashImport:!1===t.enableFlashImport?!1:!0}},parlance:D,content:z,imageEdit:I,imageupload:H,blocktag:r(A),fileupload:{allowLocalImages:G},platform:{toolbar:L,allowLocalImages:G},plaincodeview:{bundled:E.bundled},codeview:E}},t=function(b){var d=void 0===b.privateapi?{}:b.privateapi;b=k(d.ui,[e.func("bounds"),e.bool("showHelpHint")]);var h=k(d.integration,[e.string("type"),e.string("version")]),n=void 0===d.content?{}:d.content,p=k(n.macros,[e.arrayOfStrings("whitelist")]),
n=k(n,[e.string("base")]);void 0!==p.whitelist&&(p.whitelist=g.some(p.whitelist));var q=a.paramList(),r=k(d.mentions,q),s=c.keys(r).length,d=k(d.output,[e.bool("prettyprint")]);if(0<s){if(s!==q.length)throw new l("Missing @mentions configuration. Expected "+q.length+" objects, was "+s);r.bundled=!0}return{ui:b,help:{integration:h},macros:p,content:f.merge(n,d),mentions:r}};return function(a){a=void 0!==a?a:{};return f.deepMerge(s(a),t(a))}});k("u",["b"],function(b){return{getPath:function(d){var c=
document.getElementsByTagName("script");return(c=b.find(c,function(a){return a.src.indexOf(d)===a.src.length-d.length}))?c.src.substring(0,c.src.indexOf(d)):void 0}}});k("5","67rstuv".split(""),function(b,d,c,a,e,f,g){var h=c.cached(function(){return a.from(f.getPath("textboxio.js")).map(function(a){return g.removeTrailing(a,"/")})}),k=function(a){return a+"/resources"};return{setupResources:function(c){return a.from(c.resources).orThunk(h).map(k).fold(d.die("basePath auto detection failed, please provide one in the editor configuration"),
function(a){a=e.load(a);return b.deepMerge(c,{resources:a})})},speculate:function(b){a.from(b).orThunk(h).map(k).each(e.load)}}});k("2s","41 c 7 s 1x 1b 3n l 32 q 3m".split(" "),function(b,d,c,a,e,f,g,h,k,m,n){var p=function(a,b,c){var d=function(){var a=h.fromDom(m.activeElement);b(a)&&c()};return g.bind(a,"blur",function(){n(d,200)})},q=function(a,b,c){return g.bind(a,"focusout",function(a){t(a,b)&&c()})},r=function(a,b,c){return g.bind(a,"blur",function(a){t(a,b)&&c()})},s=function(){var a=d.detect();
return a.browser.isFirefox()?p:a.browser.isIE()?q:r}(),t=function(b,c){return a.from(b.raw().relatedTarget).map(h.fromDom).forall(c)};return{register:function(a,c,d,h){var m=g.bind(a,"focus",d),n=s(a,function(d){return!k.closest(d,function(d){return f.eq(a,d)||f.eq(c(),d)||e.has(d,b.magicBox())})},h);return{destroy:function(){m.unbind();n.unbind()}}}}});k("2t",["42","1a","1x","43","2l"],function(b,d,c,a,e){return function(f,g,h){c.add(g,b.base());return{toolbarShow:function(){c.add(g,b.active());
e.set(f(),"display","block")},toolbarHide:function(){c.remove(g,b.active());e.set(f(),"display","none")},isVisible:function(){return c.has(g,b.active())},restore:function(){a.remove(g,[b.base(),b.active()]);d.setAll(g,h)}}}});k("1l","23 2s 2t 6 2c 2u 1a 2k 1b 2v 2d".split(" "),function(b,d,c,a,e,f,g,h,k,m,n){return{replace:function(p,q){var r=a.deepMerge(q,{content:{inline:p}}),s=g.clone(p),t=e(r),u=c(t.element,p,s),v=f(u.toolbarHide,u.toolbarShow,!1),w=function(){var a=u.isVisible();v.on();!1===
a&&t.activateInline()},x=function(){t.deactivateInline();v.off()},y=d.register(p,t.element,w,x),r=function(){m.active().each(function(a){k.eq(a,p)||x()})};r();t.events.connected.bind(r);t.events.loaded.bind(function(){t.content().getSelection().bind(w)});var B=t.focus,r={polish:a.merge(t,{focus:function(){w();B()}}),restore:function(a){y.destroy();u.restore();n.set(p,a);return p}};t.connect(h.body());b.set(t,n.get(p));return r}}});k("44",["1a","l"],function(b,d){return{attach:function(c,a,e,f){if(4!==
arguments.length)throw"requires 4 parameters";var g=function(a){return function(){var e=d.fromTag("input");b.setAll(e,{type:"hidden",name:a});c.append(e.dom());return function(a){e.val(a)}}},h=e.getOrThunk(g(a)),k=f.getOrThunk(g(a+"_styles"));return function(a){h(a.content);k(a.styles)}}}});k("45",[],function(){return function(b){var d=!1;return{submit:function(){d=!0;b.submit[0]?b.submit[0].click():b.submit.click?b.submit.click():b.submit();d=!1},inprogress:function(){return d}}}});k("2x",["44",
"45"],function(b,d){var c=function(a,b){var c=a.onsubmit,g=d(a);a.onsubmit=function(d){if(g.inprogress())return!0;b(function(){c&&!1===c.apply(a)||setTimeout(g.submit,0)});return!1};return{unbind:function(){a.onsubmit=c}}};return{attachToFormSubmit:c,attachToParentFormSubmit:function(a,d,f,g,h){if(5!==arguments.length)throw"requires 5 parameters";var k=a.parents("form:first");if(0!==k.size()){var m=k.get(0),n=b.attach(k,d,g,h);c(m,function(a){n(f());a()})}}}});k("1m","2w 2a 23 2b 2x s 2c 1a 2l l 2m 2o 2y 29 2z".split(" "),
function(b,d,c,a,e,f,g,h,k,m,n,p,q,r,s){var t=function(a,b,e,h){k.set(b,"display","none");var m=g(d.withOptions(b,h)),n=s.get(b);m.connect(a);c.set(m,n);var q=!0===h.autosubmit?u(b,m):f.none();return{polish:m,restore:function(c){q.each(function(a){a.unbind()});s.set(b,c);e.fold(function(){k.remove(b,"display")},function(a){k.set(b,"display",a)});p.remove(a);return b}}},u=function(a,b){return q.closest(a,"form").map(function(d){return e.attachToFormSubmit(d.dom(),function(d){b.uploadImages(function(){s.set(a,
c.get(b));d()})})})};return{replace:function(c,d){var e=k.getRaw(c,"display");return r.parent(c).fold(function(){return null},function(){var f=h.get(c,"id"),f=f?"ephox_"+f:b.generate("ephox"),g=m.fromTag("div");h.set(g,"id",f);k.copy(c,g);a.copyFrom(c,g);n.before(c,g);return t(g,c,e,d)})}}});k("e","1c 1d 5 1k 1l 1m 6 7 r".split(" "),function(b,d,c,a,e,f,g,h,k){var m={textarea:f,div:a,body:b},n={div:e,blockquote:e,article:e,aside:e,figure:e,figcaption:e,footer:e,header:e,nav:e,section:e};return function(a){var b=
function(b,e){var f=k.cached(function(){var b=g.deepMerge(d(e),a);return c.setupResources(b)});return{constructors:h.constant(b),options:f}};return{classic:function(a){return b(m,a)},inline:function(a){a=g.deepMerge({ui:{toolbar:{draggable:!0}}},a);return b(n,a)}}}});k("h",["i","7"],function(b,d){var c=function(a){return{name:a.name,required:d.constant(!1),validate:a.validate}};return{bool:d.compose(c,b.bool),func:d.compose(c,b.func),number:d.compose(c,b.number),object:d.compose(c,b.object),string:d.compose(c,
b.string)}});k("3","abcdef8ghij7klmno".split(""),function(b,d,c,a,e,f,g,h,k,m,n,p,q,r,s,t,u){return function(v){var w=a(),x=e(v),y=function(a,c){var d;d=b.isString(a)?s.one(a).getOrThunk(p.die("Selector did not match any elements: "+a)):r.fromDom(a);return w.getOrCreate(d,c)},B=function(a,c){b.isString(a)?u.error("Selector did not match a "+c+": ",a):u.error("Element was not a "+c+": ",a);throw new t("Unable to create textbox.io editor");},z=c.detect(),A=function(a){b.isString(a)||n(a,[m.domElement("element")]);
return b.isString(a)?s.all(a):d.map(a,r.fromDom)},C=function(a,b){var c=A(a),c=d.map(c,function(a){return w.getOrCreate(a,b)});return q.cat(c)};return f.makeReadOnly({replace:function(a,b){n(arguments,[m.stringOrDom("element"),k.object("options")]);return y(a,x.classic(b)).getOrThunk(p.curry(B,a,"div or textarea"))},replaceAll:function(a,b){n(arguments,[m.stringOrArray("elements"),k.object("options")]);return C(a,x.classic(b))},inline:function(a,b){if(z.deviceType.isTouch())throw new t("Mobile does not not support inline editing");
n(arguments,[m.stringOrDom("element"),k.object("options")]);return y(a,x.inline(b)).getOrThunk(p.curry(B,a,"supported tag for inline editing"))},inlineAll:function(a,b){if(z.deviceType.isTouch())throw new t("Mobile does not not support inline editing");n(arguments,[m.stringOrArray("elements"),k.object("options")]);return C(a,x.inline(b))},get:function(a){n(arguments,[m.string("selector")]);return w.get(a)},getActiveEditor:function(){return w.getActiveEditor().getOr(null)},definePlugin:function(a,
c){n(arguments,[m.string("namespace"),m.object("code")]);h.get(a).each(function(){throw new t("namespace "+a+" is already defined");});if(void 0===c.initialize||!b.isFunction(c.initialize))throw new t("plugin does not have an initialize function");return h.register(a,c)},version:g,isSupported:p.constant(!0)})}});k("4",["c","p","o","q"],function(b,d,c,a){var e=function(a){return d.error("ERROR: Textbox.io requires "+a+" or above")},f=b.detect().os,g=b.detect().browser,h="CSS1Compat"===a.compatMode||
"html"===a.doctype;return{supported:function(){if(g.isIE()&&11>g.version.major)return e("Internet Explorer 11");if(f.isOSX()&&g.isSafari()&&9>g.version.major)return e("Safari 9");if(f.isiOS()&&9>f.version.major)return e("iOS 9");if(!h&&g.isIE())return d.error("ERROR: Document is not in standards mode. Textbox.io requires standards mode on Internet Explorer.");h||void 0===c.warn||c.warn("WARNING: Document is not in standards mode. Textbox.io may experience user interface issues.");return d.value()}}});
k("0","1234567".split(""),function(b,d,c,a,e,f,g){var h=function(a){b.textboxio=a},k=g.compose(h,d);return function(){var d=b.install;b.install=function(g,p){b.install=d;a.supported().fold(k,function(){var a=null===p||void 0===p?{onprem:!0}:p,a=null===g||void 0===g?a:f.deepMerge(a,{resources:g});h(c(a));e.speculate(a.resources)})}}});fa("0")()})();
install();
